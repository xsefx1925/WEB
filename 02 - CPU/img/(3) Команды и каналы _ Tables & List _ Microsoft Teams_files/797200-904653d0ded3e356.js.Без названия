"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[797200],{81868:(e,t,r)=>{r.d(t,{I:()=>n});const n=(0,r(391567).O)({dialogSurface:{B6of3ja:"ffj4heq",Bxyxcbc:"f12sa3kj"},dialogBody:{Bxyxcbc:"fpuvf92"}})},927215:(e,t,r)=>{r.d(t,{d:()=>s});let n=[];function s(e){n.push(e)}},242340:(e,t,r)=>{var n,s;r.d(t,{sk:()=>n,$n:()=>s,I6:()=>i,Vt:()=>a,Jh:()=>o,UU:()=>l,EJ:()=>d,Rm:()=>c,_U:()=>u,x_:()=>p,Ko:()=>g}),function(e){e.CONFIGURATIONS="configurations",e.CONTEXTUAL_NOTIFICATIONS="contextual-notifications",e.END="end",e.HEADER="header",e.IN_APP_NOTIFICATIONS="in-app-notifications",e.MAIN="main",e.MID_NAV="mid-nav",e.MODAL="modal",e.MONITOR="monitor",e.NAV="nav",e.NAV_CONTROLS="nav-controls",e.NOTIFICATIONS="notifications",e.PRE_CACHE="pre-cache",e.START="start",e.SUBNAV="sub-nav",e.TITLE_BAR="title-bar",e.TOASTS="toasts"}(n||(n={})),function(e){e.configurations="configurations",e.contextualNotifications="contextualNotifications",e.end="end",e.header="header",e.inAppNotifications="inAppNotifications",e.main="main",e.midNav="midNav",e.modal="modal",e.monitor="monitor",e.nav="nav",e.navControls="navControls",e.notifications="notifications",e.preCache="preCache",e.start="start",e.subNav="subNav",e.titleBar="titleBar",e.toasts="toasts"}(s||(s={}));const i={[n.CONFIGURATIONS]:s.configurations,[n.CONTEXTUAL_NOTIFICATIONS]:s.contextualNotifications,[n.END]:s.end,[n.HEADER]:s.header,[n.IN_APP_NOTIFICATIONS]:s.inAppNotifications,[n.MAIN]:s.main,[n.MID_NAV]:s.midNav,[n.MODAL]:s.modal,[n.MONITOR]:s.monitor,[n.NAV_CONTROLS]:s.navControls,[n.NAV]:s.nav,[n.NOTIFICATIONS]:s.notifications,[n.PRE_CACHE]:s.preCache,[n.START]:s.start,[n.SUBNAV]:s.subNav,[n.TITLE_BAR]:s.titleBar,[n.TOASTS]:s.toasts};var a,o,l,d;!function(e){e.DEFAULT="default",e.FOLDED="folded",e.UNFOLDED="unfolded"}(a||(a={})),function(e){e.COLLAPSED="COLLAPSED",e.EXPANDED="EXPANDED"}(o||(o={})),function(e){e.INLINE="inline",e.OVERLAY="overlay"}(l||(l={})),function(e){e.COLLAPSE_STATE="collapseState",e.DISPLAY_MODE="displayMode",e.FOLD_STATE="foldState",e.LEGACY_FOLD_STATE="legacyFoldState",e.HEIGHT="height",e.IS_HIDDEN="isHidden",e.WIDTH="width"}(d||(d={}));const c={minimal:"minimal",focus:"focus",standard:"standard",minimode:"minimode",immersive:"IMMERSIVE"},u=360,p=360,g=250},879639:(e,t,r)=>{r.d(t,{Jj:()=>n,SN:()=>s,Oe:()=>i,As:()=>o,OJ:()=>l});var n,s,i,a=r(242340);!function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(n||(n={})),function(e){e.LINE_LOADER="line-loader"}(s||(s={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.PHASE_STATE_MACHINE_DISPOSED="phase-state-machine-disposed",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(i||(i={}));const o={[a.sk.HEADER]:{height:{collapsed:"6.1rem",expanded:"30rem",expandedSmall:"22rem"}},[a.sk.TITLE_BAR]:{height:{standard:"4.8rem",focus:"3.2rem"}}},l="resize-divider-focused"},144577:(e,t,r)=>{var n;r.d(t,{Y:()=>n}),function(e){e[e.None=0]="None",e[e.LoggedInConsole=1]="LoggedInConsole",e[e.AddedIntoDiagnostics=2]="AddedIntoDiagnostics",e[e.ThrottledForDiagnostics=4]="ThrottledForDiagnostics",e[e.SentToTelemetry=8]="SentToTelemetry"}(n||(n={}))},984866:(e,t,r)=>{var n;r.d(t,{B:()=>n}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod",e.fr="fr",e.de="de"}(n||(n={}))},551118:(e,t,r)=>{var n,s,i;r.d(t,{pG:()=>n,Ly:()=>s,Mv:()=>i}),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter",e.ChannelListSearchFilter="channelListSearchFilter",e.CallingPerf="callingPerf",e.TeamsAndChannelsTable="teamsAndChannelsTable",e.DiscoverSurfaceFeedList="discoverSurfaceFeedList",e.AllChannelSystemMessages="channelInfoPaneAllSystemMessages",e.AllPinnedPosts="channelInfoPaneAllPinnedPosts",e.UnifiedFunPicker="unifiedFunPicker",e.CreateTeamGallery="createTeamGallery",e.AddMember="addMember",e.MeetForWorkList="meetForWorkList",e.MeetForWorkSearchFilter="meetForWorkSearchFilter",e.PeopleAppContactList="peopleAppContactList",e.SimpleCollabLeftRail="simpleCollabLeftRail",e.UserOnboardingToTeam="UserOnboardingToTeam",e.TrinityChannelsTab="TrinityChannelsTab",e.SliceViewMessgeList="SliceViewMessgeList",e.ThreadList="ThreadList"}(n||(n={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChannelInfoPane="channelInfoPane",e.ChannelSettings="channelSettings",e.ChatList="chatList",e.Communities="communitites",e.ConvUxChannelL1="convUxChannelL1",e.ConvUxChannelL2="convUxChannelL2",e.ConvUxChannelL1RightPane="convUxChannelL1RightPane",e.ConvUxChannelL2RightPane="convUxChannelL2RightPane",e.ThreadedChatL1="threadedChatL1",e.ThreadedChatL2="threadedChatlL2",e.ThreadedChatL1RightPane="threadedChatL1RightPane",e.ThreadedChatL2RightPane="threadedChatL2RightPane",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.FlyoutPeopleL2="flyoutPeopleL2",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate",e.ChannelList="ChannelList",e.ManageThreadMembers="manageThreadMembers",e.ManageChannelThreadMembers="manageChannelThreadMembers",e.ManagePrivateChannelThreadMembers="managePrivateChannelThreadMembers",e.ManageSharedChannelThreadMembers="manageSharedChannelThreadMembers",e.ManageTeams="manageTeams",e.ChannelInvitationsTab="channelInvitationsTab",e.DiscoverSurface="discoverSurface",e.ThreadMembersSearch="threadMembersSearch",e.SharedChannelPendingInvites="sharedChannelPendingInvites",e.PendingJoinRequests="pendingJoinRequests",e.SelectPeoplePickerExtensibility="selectPeoplePickerExtensibility",e.ChannelsTable="channelsTable",e.SpeedDial="SpeedDial",e.CommunitiesJoinRequests="communitiesJoinRequests",e.PeopleApp="peopleApp",e.CommentStreamChatPane="commentStreamChatPane",e.FollowPresenceSettings="followPresenceSettings",e.MentionSliceList="MentionSliceList",e.TagMentionSliceList="TagMentionSliceList",e.ThreadsSliceList="threadsSliceList",e.SavedSliceList="SavedSliceList"}(s||(s={})),function(e){e.HeartbeatMonitor="HeartbeatMonitor",e.CallingPerfMonitor="CallingPerfMonitor"}(i||(i={}))},515292:(e,t,r)=>{var n,s,i,a,o,l,d,c,u,p,g,h,m,f,I,C,T,y,S,b,A;r.d(t,{qv:()=>n,Kt:()=>i,VA:()=>o,lM:()=>l,Pr:()=>d,Kv:()=>c,To:()=>u,PY:()=>p,bh:()=>g,D2:()=>h,np:()=>f,zD:()=>I,pU:()=>C,s4:()=>T,d8:()=>y,Cu:()=>S,wy:()=>b}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(n||(n={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(s||(s={})),function(e){e.GuardianChat="GuardianChat"}(i||(i={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(o||(o={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(l||(l={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(d||(d={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(c||(c={})),function(e){e.background="background",e.foreground="foreground"}(u||(u={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(p||(p={})),function(e){e.copy="Copy"}(g||(g={})),function(e){e.nav="nav",e.notification="notification"}(h||(h={})),function(e){e.Cold="cold",e.Warm="warm"}(m||(m={})),function(e){e.TopLevel="L1",e.DrillDown="L2"}(f||(f={})),function(e){e.SettingsPrivacyPage="SettingsPrivacyPage",e.LpcMeProfileCard="LpcMeProfileCard"}(I||(I={})),function(e){e.tflExternal="TFLExternal",e.tfwUser="TFWUser",e.pstnUser="PSTN"}(C||(C={})),function(e){e.addMembers="addMembers",e.pinChannel="pinChannel",e.unpinChannel="unpinChannel",e.favoriteChannel="favoriteChannel",e.manageChannel="manageChannel",e.getChannelEmail="getChannelEmail",e.getChannelLink="getChannelLink",e.editChannel="editChannel",e.editChannelConnectors="editChannelConnectors",e.editChannelWorkflows="editChannelWorkflows",e.editChannelRetentionLabel="editChannelRetentionLabel",e.deleteChannel="deleteChannel",e.leaveChannel="leaveChannel",e.toggleChannelOrder="toggleChannelOrder",e.archiveChannel="archiveChannel",e.unarchiveChannel="unarchiveChannel",e.findInChannel="findInChannel",e.channelNotificationSettings="channelNotificationSettings",e.lastChannelHide="lastChannelHide",e.manageTeam="manageTeam",e.setChannelRecommendation="setChannelRecommendation"}(T||(T={})),function(e){e.pinned="pinned",e.shown="shown",e.hidden="hidden"}(y||(y={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared",e.Standalone="Standalone"}(S||(S={})),function(e){e.General="General",e.NotGeneral="NotGeneral"}(b||(b={})),function(e){e.Unknown="Unknown",e.VSB="VSB",e.MM="MM",e.Lrg="Lrg"}(A||(A={}))},173065:(e,t,r)=>{var n;r.d(t,{Q:()=>n}),function(e){e.Perf="perf",e.Scenario="scenarions",e.Logging="loggingns",e.Heartbeat="heartbeatns",e.Http="httpns",e.UserBI="userbins",e.Endpoint="endpointns"}(n||(n={}))},969251:(e,t,r)=>{r.d(t,{c:()=>n});class n{constructor(e,t){this.router=e,this.coreSettings=t,this.categorySubscriptions=new Map}init(){this.channel=new MessageChannel,this.router.postMessage("initCoreSettingsWorker",void 0,[this.channel.port2]),this.registerListeners()}registerListeners(){this.channel&&(this.channel.port1.onmessage=e=>{const{data:t}=e;"settingsRequest"===t.type&&this.handleSettings(t.payload),"subscribeCategory"===t.type&&this.handleSubscription(t.payload),"unsubscribeCategory"===t.type&&this.handleUnsubscription(t.payload)})}handleSubscription({category:e}){if(this.categorySubscriptions.has(e))return;const t=this.coreSettings.getObservable(e).subscribe((t=>{this.channel?.port1.postMessage({type:"categorySubscriptionResponse",payload:{values:t,category:e}})}));this.categorySubscriptions.set(e,t)}handleUnsubscription({category:e}){const t=this.categorySubscriptions.get(e);t&&(t.unsubscribe(),this.categorySubscriptions.delete(e))}handleSettings({category:e,settings:t,id:r}){const n=this.coreSettings.get(e),s={};t?.forEach((e=>{s[e]=n[e]})),this.channel?.port1.postMessage({type:"settingsResponse",payload:{values:s,id:r}})}}},189007:(e,t,r)=>{r.d(t,{V:()=>o});var n=r(401368),s=r(743659);const i="default",a=5e3;class o{constructor(e,t,r,n){this.windowProvider=e,this.coreSettings=t,this.isSender=n,this._eventsPerInterval=0,this._captureEvents=!0,this._captureContext=!0,this._capturedEvents={},this._capturedContext={},this.broadcastChannel=new BroadcastChannel("TelemetryDebugChannel"),r&&(this._capturedContext=r.context,this._capturedEvents=r.events),this.isSender||(this.broadcastChannel.onmessage=e=>{"event"in e.data&&this.captureEvent(e.data.event,e.data.logger,e.data.userContextId),"context"in e.data&&this.captureContext(e.data.context.key,e.data.context.value,e.data.context.logger,e.data.context.userContextId)}),this.start()}get capturingEvents(){return this._captureEvents}setCaptureEvents(e){this._captureEvents=e,this.createWindowIntervalOnce()}get capturingContext(){return this._captureContext}setCaptureContext(e){this._captureContext=e,this.createWindowIntervalOnce()}get events(){return this._capturedEvents}get context(){return this._capturedContext}get eventsPerSecond(){return this._eventsPerInterval}get eventSubscription(){return o._eventSubscription}captureEvent(e,t,r,n){const s=r||i;if(n&&(e.sampled=n),this.isSender)this.broadcastChannel.postMessage({event:e,userContextId:s,logger:t});else if(this._captureEvents){if(this._capturedEvents=this._capturedEvents||[],this._capturedEvents[t]={...this._capturedEvents[t]??{},[s]:[...this._capturedEvents[t]?.[s]??[],e]},void 0!==t&&this._capturedEvents){const e=this._capturedEvents[t];if(e){const t=e[s];if(t&&t.length>a){const e=a-Math.floor(500);t.length=e}}}o._dirty=!0}}captureContext(e,t,r,n){const s=n||i;this.isSender?this.broadcastChannel.postMessage({context:{key:e,value:t,userContextId:s,logger:r}}):this._captureContext&&(this._capturedContext=this._capturedContext||{},this._capturedContext[r]={...this._capturedContext[r]??{},[s]:{...this._capturedContext[r]?.[s]??{},[e]:t}})}clear(){this._capturedEvents={},this._capturedContext={}}start(){const e=this.coreSettings?.get(n.w.Telemetry);this._captureEvents=e?.debugMenuCaptureEvents??!1,this._captureContext=e?.debugMenuCaptureContext??!1,this.createWindowIntervalOnce(),o._eventSubscription.next()}stop(){this.windowProvider&&void 0!==o._intervalId&&(this.windowProvider.clearInterval(o._intervalId),o._intervalId=void 0,o._eventSubscription.next())}getTotalEventCount(){return this._capturedEvents&&"object"==typeof this._capturedEvents?Object.values(this._capturedEvents).reduce(((e,t)=>{if(!t||"object"!=typeof t)return e;return e+Object.values(t).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0)}),0):0}createWindowIntervalOnce(){if((this._captureEvents||this._captureContext)&&this.windowProvider&&void 0===o._intervalId){let e=0;o._intervalId=this.windowProvider.setInterval((()=>{e+=1,this._eventsPerInterval=this.getTotalEventCount()/e,o._dirty&&(o._eventSubscription.next(),o._dirty=!1)}),1e3)}}}o._dirty=!1,o._eventSubscription=new s.B},861960:(e,t,r)=>{r.d(t,{b:()=>l,Z:()=>d});var n=r(401368),s=r(173065),i=r(679521),a=r(396588),o=r(480354);const l=-1;class d{constructor(){this.FractionalBuckets=1e3,this.ExpandedFractionalBuckets=1e6,this.ConvertToWholeFactor=.01,this.WholeNumberBuckets=100,this.DefaultCohort=0,this.DefaultSampleRate=100,this.rulesLookup={},this.cohortBoundary=this.DefaultCohort,this.telemetrySettings={},this.deviceId=null,this.userId=null,this.blockZeroSampleRate=!1,this.preAuthUserSamplingId=null,this.cohortSupressionId=null,this.updateSamplingSettings=e=>{if(e){this.telemetrySettings=e;const t=e.enableToolingSamplingRules?e.toolingSamplingRules??{}:{},r=e.samplingRules??{},n=e.cdlWorkerSamplingRules??{};this.rulesLookup=(0,o.merge)(t,r,n),this.setCohortBoundry(),this.blockZeroSampleRate=e.enableBlockZeroSampleRate}}}initialize(e){e.getObservable(n.w.Telemetry).subscribe(this.updateSamplingSettings),this.telemetrySettings=e.get(n.w.Telemetry),this.updateSamplingSettings(this.telemetrySettings)}static getInstance(){return this.eventSuppressionService||(this.eventSuppressionService=new d),this.eventSuppressionService}setSamplingByUser(e){this.userId||(this.userId=e,this.setCohortBoundry())}setSamplingByPreAuthId(e){this.preAuthUserSamplingId=e,this.setCohortBoundry()}setSamplingByDevice(e){this.deviceId=e,this.setCohortBoundry()}getCurrentCohort(){return this.cohortBoundary}get samplingMetadata(){return{samplingId:this.getCohortId(),numBuckets:this.getBuckets(),cohortBoundary:this.getCurrentCohort(),rules:this.currentRules}}get currentRules(){return this.rulesLookup}shouldSuppressEvent(e,t="*"){return this.getSampleRate(e,t,"*")===l}getCrossClientScenarioSampleRate(e){if(this.telemetrySettings.enableExpandedCrossClientScenarioDefaultSampling&&e===a.SQ.Expanded)return this.DefaultSampleRate}getSampleRate(e,t="*",r="*"){const n=this.rulesLookup[e];if(void 0!==n){const e=void 0!==n[`${t}|${r}`]?n[`${t}|${r}`]:void 0!==n[t]?n[t]:void 0!==n[`*|${r}`]?n[`*|${r}`]:void 0!==n["*"]?n["*"]:this.DefaultSampleRate;if(0===e&&this.blockZeroSampleRate)return l;if(this.cohortBoundary!==this.DefaultCohort)return this.cohortBoundary>e?l:e}return this.DefaultSampleRate}getMaximumSampleRateForEvent(e,t){return e===s.Q.Scenario?["success","failure","timeout","abandoned","incomplete","tab_switched","app_minimized"].reduce(((r,n)=>{const s=this.getSampleRate(e,t,n);return Math.max(r,s)}),l):this.DefaultSampleRate}getCohortId(){return this.cohortSupressionId}setCohortBoundaryByIdType(e,t){return t&&t>l&&t<=this.DefaultSampleRate?void(this.cohortBoundary=t):e}getBuckets(){return this.telemetrySettings.enableExpandedFractionalBuckets?this.telemetrySettings.ecsProvidedBuckets&&this.telemetrySettings.ecsProvidedBuckets>0?this.telemetrySettings.ecsProvidedBuckets:this.ExpandedFractionalBuckets:this.FractionalBuckets}setCohortBoundry(){if(this.cohortBoundary!==this.DefaultCohort)return;let e=null;const t=this.telemetrySettings,r=this.getBuckets(),n=r*this.ConvertToWholeFactor;!this.userId&&t.enablePreAuthIdSampling?e=this.preAuthUserSamplingId:t.enableDeviceIdSampling?e=this.setCohortBoundaryByIdType(this.deviceId,this.telemetrySettings.deviceIdSampleCohort):t.enableUserIdSamplingV2&&(e=this.setCohortBoundaryByIdType(this.userId,this.telemetrySettings.userIdSampleCohort)),t.enablePreAuthIdSampling||t.enableDeviceIdSampling||t.enableUserIdSamplingV2?e&&(this.cohortSupressionId=e,this.cohortBoundary=((0,i.M)(e)%r+1)/n):this.userId&&(this.cohortBoundary=(0,i.M)(this.userId)%this.WholeNumberBuckets+1)}}},290236:(e,t,r)=>{r.d(t,{AR:()=>E});var n=r(927215),s=r(401368),i=r(396588),a=r(885617),o=r(189388),l=r(804437),d=r(556742),c=r(313285),u=r(384477),p=r(999974),g=r(969251),h=r(735030),m=r(189007),f=r(861960);class I{constructor(){this.propagators={}}addCallback(e,t){const r=this.propagators[e];this.propagators[e]=r?{...r,callbacks:[...r.callbacks,t]}:{filters:void 0,usingCache:!1,cache:{},callbacks:[t]};const n=this.propagators[e];if(n){const{cache:e,usingCache:r}=n;r&&Object.keys(e).forEach((r=>{const n=e[r];n&&t(r,n[0],n[1])}))}}updateFilter(e,t,r=!1){const n=this.propagators[e];n?(n.filters=t,n.usingCache=r):this.propagators[e]={filters:t,usingCache:r,cache:{},callbacks:[]}}send(e,t,r){Object.keys(this.propagators).forEach((n=>{const s=this.propagators[n];if(s){const i=s.filters;i?i.has(e)&&(s.usingCache&&(s.cache[e]=[t,r]),this.propagators[n]?.callbacks.forEach((n=>n(e,t,r)))):this.propagators[n]?.callbacks.forEach((n=>n(e,t,r)))}}))}}var C=r(442424),T=r(743659);class y{constructor(e,t,r,n){this.enablePauseToTelemetry=e,this.pauseTelemetrySettings=t,this.sendOfflineStateToSDK=r,this.logger=n,this.activeTimer=void 0,this.isTelemetryPaused=!1}handleTelemetryPause(e,t){try{if(!this.enablePauseToTelemetry||!this.pauseTelemetrySettings)return;if(this.isTelemetryPaused)return;this.clearActiveTimer();const t=this.getPauseDuration(e);if(void 0===t)return;this.logger.infoToTelemetry?.(`[telemetry-pause-handler] handleTelemetryPause Pausing telemetry for ${t}ms`,"telemetry_instrumentation_telemetry_pause_handler"),this.isTelemetryPaused=!0,this.sendOfflineStateToSDK(),this.activeTimer=setTimeout((()=>this.handleTelemetryResume(t)),t)}catch(e){const r=this.logger??t;r.errorToTelemetry?.(`Error in [telemetry-pause-handler] handleTelemetryPause errorCode: ${e?.errorCode}`,"telemetry_instrumentation_telemetry_pause_handler")}}clearActiveTimer(){try{this.activeTimer&&(clearTimeout(this.activeTimer),this.activeTimer=void 0)}catch(e){this.logger.errorToTelemetry?.(`Error in [telemetry-pause-handler] clearActiveTimer errorCode: ${e?.errorCode}`,"telemetry_instrumentation_telemetry_pause_handler")}}handleTelemetryResume(e){try{const t=this.isTelemetryPaused;if(this.isTelemetryPaused=!1,t)try{this.sendOfflineStateToSDK()}catch(e){this.logger.errorToTelemetry?.(`Error in [telemetry-pause-handler] handleTelemetryResume final unpause logic ${e?.errorCode}`,"telemetry_instrumentation_telemetry_pause_handler")}this.logger.infoToTelemetry?.(`[telemetry-pause-handler] handleTelemetryPause Resuming telemetry after ${e}ms`,"telemetry_instrumentation_telemetry_pause_handler")}catch(e){this.logger.errorToTelemetry?.(`Error in [telemetry-pause-handler] handleTelemetryResume ${e?.errorCode}`,"telemetry_instrumentation_telemetry_pause_handler")}}getPauseDuration(e){try{const t=this.pauseTelemetrySettings?.[e];return"number"==typeof t||void 0===t?t:void 0}catch(t){return void this.logger.errorToTelemetry?.(`Error in [telemetry-pause-handler] getPauseDuration for key ${e} errorCode: ${t?.errorCode}`,"telemetry_instrumentation_telemetry_pause_handler")}}}const S=a.MP.default,b=e=>"object"==typeof e&&"piiKind"in e&&"number"==typeof e.piiKind&&e.piiKind in C.f0&&"value"in e,A=(e,t,r,n,s,i)=>{const a=new p.EE;return a.name=e,a.eventType=t,a.timestamp=Date.now(),a.setProperty("EventInfo.BaseType",t),r&&(((e,t,r)=>{let n=null;for(const r in t)t.hasOwnProperty(r)&&(n=t[r],null!=n&&""!==n&&(b(n)?e.setProperty(r,(0,l.oJ)(n.value),n.piiKind):e.setProperty(r,(0,l.oJ)(n))))})(a,r),i?.applyColumnBlockingRules(e,s??t,a,n),n&&a.setProperty(n.columnName,(0,l.oJ)(n.packedData))),s&&a.setProperty("EventInfo.Identifier",s),a};class _{constructor(){this._contextPropagator=new I,this._sessionId="",this._silent=!1,this._sharedWorkerOptions={delayLoadingWorker:!1,isSharedWorkerEnabled:!1,isWorkerEnabled:!1},this._cachedOperation=[],this._cachedOperationWithTransfer=[],this._workerInited=!1,this._captureEventAndContextData=!0,this._primaryUserId="",this._primaryTenantId="",this._users=new Set,this.enablePauseToTelemetry=!1,this.isNetworkOnline=!0,this.setTransmitTimerCallInitiation=async()=>{try{this.telemetryPauseHandler?.handleTelemetryPause("CALL_INITIATION_PAUSE",this._consoleLogger)}catch(e){const t=e instanceof Error?`Error initiating call setTransmitTimerCallInitiation errorName: ${e.name}`:"Unknown error type initiating call setTransmitTimerCallInitiation";this._consoleLogger?.errorToTelemetry?.(t,"telemetry_instrumentation_telemetry_pause_handler")}},this.setTransmitDefault=async()=>{try{this.telemetryPauseHandler?.handleTelemetryPause("CALL_ACCEPTANCE_PAUSE",this._consoleLogger)}catch(e){const t=e instanceof Error?`Error initiating call setTransmitDefault errorName: ${e.name}`:"Unknown error type initiating call setTransmitDefault";this._consoleLogger?.errorToTelemetry?.(t,"telemetry_instrumentation_telemetry_pause_handler")}},(0,n.d)((()=>{this._cachedOperation=[],this._sharedWorkerOptions.sharedWorkerUrl=void 0})),this.performanceObserverSubject=new T.B}startPerformanceObserver(){this._router?.postMessage("startPerformanceObserver")}stopPerformanceObserver(){this._router?.postMessage("stopPerformanceObserver")}getUsers(){return this._users}getPrimaryUserId(){return this._primaryUserId}getPrimaryTenantId(){return this._primaryTenantId}get eventCapture(){return this._eventCapture||(this._eventCapture=new m.V),this._eventCapture}set eventCapture(e){this._eventCapture&&this._eventCapture?.stop(),this._eventCapture=e}get sessionId(){return this._sessionId}setCdlContextCallback(e){this._contextPropagator.addCallback("cdl",((t,r,n)=>{e(t,r?.toString()??"",n)}))}setMultiContextCallback(e){this._contextPropagator.addCallback("maglev",((t,r,n)=>{e(t,r?.toString()??"",n)}))}setCollectorContextCallback(e){this._collectorContextCallback=e}setEndpointHealth(e){this._getEndpointHealth=e}getEndpointHealth(e,t){return this._getEndpointHealth?this._getEndpointHealth(e,t)?.isHealthy:void 0}setupReinitSubscriptions(e){if(!this._initializeParams||!e.enableTelemetryRegionReinit)return;let t=!1;e.oneDsCollectorUrl&&this._initializeParams.oneDsCollectorUrl!==e.oneDsCollectorUrl&&(this._initializeParams.oneDsCollectorUrl=e.oneDsCollectorUrl,t=!0),e.telemetryServer&&this._initializeParams.config.collectorUrl!==e.telemetryServer&&(this._initializeParams.config.collectorUrl=e.telemetryServer,t=!0),e.defaultToken&&this._initializeParams.appTokens.default!==e.defaultToken&&(this._initializeParams.appTokens.default=e.defaultToken,t=!0),t&&(this._sendOrCacheOperation("flushForReinit",this._initializeParams),this.logReinitEvent()),void 0!==e.telemetryRegionFetchComplete&&null!==e.telemetryRegionFetchComplete&&this.setContext("telemetryRegionFetchComplete",e.telemetryRegionFetchComplete),e.telemetryRegion&&this.setContext("UserInfo.TelemetryRegion",e.telemetryRegion),void 0!==this._collectorContextCallback&&t&&e.telemetryRegionFetchComplete&&e.telemetryRegion&&this._collectorContextCallback(e.enableTelemetryRegionReinit,e.telemetryRegion,e.telemetryRegionFetchComplete)}setupChannelSubscription(e){this._captureEventAndContextData=!!e?.debugMenuCaptureEvents}initializePauseHandler(e,t){this.enablePauseToTelemetry=!!e.enablePauseToTelemetry,this.telemetryPauseHandler=new y(this.enablePauseToTelemetry,e.pauseTelemetrySettings??void 0,(()=>this.sendOfflineStateToSDK()),t)}initialize(e,t){var r;const{workerOptions:n,services:a,...l}=e,{coreSettings:u,columnSuppressionService:p}=a,I=u.get(s.w.Telemetry);l.enableMergedExpIds=I.enableMergedExpIds??!1;const{workerType:C,workerSetup:T}=n;this._initializeParams=l,this._initializeParams&&((r=this._initializeParams).defaultLoggerName??(r.defaultLoggerName=S)),this._silent=l.isSilent,this._sharedWorkerOptions.delayLoadingWorker=l.delayLoadingWorker??!1,this._sharedWorkerOptions.isSharedWorkerEnabled=l.enableSharedWorker??!1,t&&(this._consoleLogger=t,l.config.log=void 0,l.enableDebugTrace=!0),this.initScenario=e.services.scenarioFactory.newScenario(i.Cu.TelemetryWorkerInitialization),this.initScenario?.appendEventData({"Instrumentation.WorkerType":C}),this.columnSuppressionService=p,this.setContext("authStatus","pre auth"),this._initializeDefer=(0,d.v)(),(0,c.a)(this._initializeDefer.promise,3e4).catch((e=>{this.setContext("Session.TelemetryWorkerType","embed"),this.initScenario?.appendEventData({"Instrumentation.Error":"WorkerTimeout"}),this.initScenario?.mark(i.BQ.WorkerTimeout),this._router=new h.K(new o.M),this._setupWorker(this._router,l)}));try{this._router=T(),this._setupWorker(this._router,l),this.setContext("Session.TelemetryWorkerType",C)}catch(e){let t="Unknown";e instanceof Error&&(t=e.name),this.initScenario?.mark(i.BQ.WorkerStartupError,{"Instrumentation.Error":t})}if(Array.isArray(I.multiContextColumns)){const e=new Set(I.multiContextColumns);this._contextPropagator.updateFilter("maglev",e,!0)}else t.warnNoPii?.("Failed to update maglev multi context filter, setting in unexpected format "+typeof I.multiContextColumns);if(Array.isArray(I.cdlMultiContextColumns)){const e=new Set(I.cdlMultiContextColumns);this._contextPropagator.updateFilter("cdl",e,!0)}else t.warnNoPii?.("Failed to update maglev multi context filter, setting in unexpected format "+typeof I.cdlMultiContextColumns);l.documentInfo.deviceId&&f.Z.getInstance().setSamplingByDevice(l.documentInfo.deviceId);u.getObservable(s.w.Telemetry).subscribe((e=>{this._updateSDKwithPrivacyGuard(e),this._updateSDKWithLogSanitizer(e),this._updateSecondPartyTelemetryFlag(e),this._updateSDKWithOfflineTelemetry(e),this.setupReinitSubscriptions(e),this.setupChannelSubscription(e),this.initializePauseHandler(e,t)}));const y="broadcast"===C;if(this.eventCapture=new m.V(void 0,a.coreSettings,this.eventCapture,y),("shared"===C||"dedicated"===C)&&void 0!==this._router){new g.c(this._router,u).init()}}setupNewLiteExperiencePort(){const e=new MessageChannel,t=(0,u.aq)();return this._sendOrCacheOperation("setupChannelMessengerPort",{identifier:t},[e.port1]),{port:e.port2,teardownCallback:this.teardownLiteExperiencePort.bind(this,t)}}createEvent(e,t,r,n,s,i){return A(e,t,r,s,i,this.columnSuppressionService)}async flush(e){return this._silent?new Promise(((e,t)=>{t()})):new Promise(((t,r)=>{this._router?(this._router.registerMessageHandler("flushed",(()=>{this._router&&this._router.unregisterMessageHandler("flushed"),t()})),this._router.postMessage("flush",{isAsync:e})):r()}))}logEvent(e,t,r=""){if(!this._silent&&(this._sendOrCacheOperation("logEvent",{key:e,value:t,userContextId:r}),this._captureEventAndContextData||this._eventCapture?.capturingEvents)){const n=e||this._initializeParams?.defaultLoggerName||a.MP.default;this._eventCapture?.captureEvent(t,n,r)}}initializeSecondPartyLogger(e,t,r=!1){this.enableSecondPartyTelemetry&&this._sendOrCacheOperation("newSecondPartyOneDsLogger",{key:e,value:{ingestionToken:t,useTeamsContext:r}})}logSecondPartyEvent(e,t){this.enableSecondPartyTelemetry&&!this._silent&&this._sendOrCacheOperation("logSecondPartyEvent",{key:e,value:t})}initializeLogger(e,t){this._sendOrCacheOperation("newLogger",{key:e,value:t})}logOutUser(e){e&&(this._sendOrCacheOperation("logOutUser",{userContextId:e}),this._users.delete(e))}setPrimaryUser(e,t){e&&(this._primaryUserId=e,this._primaryTenantId=t,this._users.has(e)||this._users.add(e),this._sendOrCacheOperation("setPrimaryUser",{userContextId:e,userTenantId:t}))}setContext(e,t,r,n){if("UserInfo.Id"===e&&"string"==typeof t&&(f.Z.getInstance().setSamplingByUser(t),t&&!this._users.has(t)&&this._users.add(t)),!this.columnSuppressionService?.isContextColumnOk(e))return;const s=(0,l.oJ)(t??""),i={key:e,value:s,pii:r,userContextId:n};this._initializeParams?.defaultLoggerName&&this._initializeParams?.defaultLoggerName!==a.MP.default&&(i.logger=this._initializeParams.defaultLoggerName),this._sendOrCacheOperation("setContext",i),(this._captureEventAndContextData||this._eventCapture?.capturingContext)&&this._eventCapture?.captureContext(e,s,i.logger??a.MP.default,n),this._contextPropagator.send(e,t,n)}setPrivacyGuardUserInfo(e,t){this._sendOrCacheOperation("setPrivacyGuardUserInfo",{userNames:e,upns:t})}setDeviceAuthToken(e){this._sendOrCacheOperation("setDeviceAuthToken",e)}start(){this._silent||this._sendOrCacheOperation("start")}stop(){this._silent||this._sendOrCacheOperation("stop")}Verbose(e){this._consoleLogger&&this._consoleLogger.debug(e)}Error(e){this._consoleLogger&&this._consoleLogger.error(e)}Info(e){this._consoleLogger&&this._consoleLogger.debug(e)}updateNetworkState(e){this.isNetworkOnline=e,this.sendOfflineStateToSDK()}getTelemetryPauseHandler(){return this.telemetryPauseHandler}sendOfflineStateToSDK(){try{const e=!!this.telemetryPauseHandler?.isTelemetryPaused,t=!(this.isNetworkOnline&&!e);if(!this._silent){const e=!t;this._sendOrCacheOperation("setOnlineState",e)}}catch(e){this._consoleLogger?.errorToTelemetry?.(`Error in [telemetry-provider] sendOfflineStateToSDK errorCode: ${e?.errorCode}`,"telemetry_instrumentation_telemetry_pause_handler")}}teardownLiteExperiencePort(...e){if(e.length<1||"string"!=typeof e[0])return;const t=e[0];this._sendOrCacheOperation("teardownChannelMessengerPort",{identifier:t})}_setupWorker(e,t){return e.registerMessageHandler("sessionId",(e=>{this._sessionId=e?.value})),e.registerMessageHandler("batchDone",(()=>{this._workerInited=!0,this.initScenario?.stop()})),e.registerMessageHandler("workerInitialized",(()=>{this._initializeDefer?.resolve(),this.initScenario?.mark(i.BQ.WorkerInitialized),this._workerInited||(this._cachedOperation.length>0&&this._router?(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]):0===this._cachedOperation.length&&this._router&&(this._workerInited=!0),this._cachedOperationWithTransfer.length>0&&(this._cachedOperationWithTransfer.forEach((e=>{e.name&&this._router?.postMessage(e.name,e.params,e.transfer)})),this._cachedOperationWithTransfer=[]))})),e.registerMessageHandler("error",(e=>{this.Error(e)})),e.registerMessageHandler("info",(e=>{this.Info(e)})),e.registerMessageHandler("verbose",(e=>{this.Verbose(e)})),e.registerMessageHandler("onPerformanceObserverEntries",(e=>{this.performanceObserverSubject.next(JSON.parse(e))})),this._sendOrCacheOperation("newLogger",{key:this._initializeParams?.defaultLoggerName??S,value:t.appTokens.default}),this._sendOrCacheOperation("logSession",{name:this._initializeParams?.defaultLoggerName??S,state:p.Yj.STARTED,sessionId:t.sessionId,sessionStartTime:t.sessionStartTime}),this._sendOrCacheOperation("sessionId",t.sessionId),e.postMessage("initialize",t),e}logReinitEvent(){const e="loggingns",t="instrumentation_reinit",r="info",n=f.Z.getInstance().getSampleRate(e,t,r);if(n===f.b)return;const s=this.createEvent(e,t,{message:"Triggering logger reinit",sampleRate:n,"EventInfo.Identifier":t,logLevel:r});this.logEvent(a.MP.default,s)}static getInstance(){return this.telemetryProviderInstance||(this.telemetryProviderInstance=new _),this.telemetryProviderInstance}_sendOrCacheOperation(e,t,r){this._workerInited&&this._router?(this._cachedOperation.length>0&&(this._router.postMessage("batch",this._cachedOperation),this._cachedOperation=[]),this._cachedOperationWithTransfer.length>0&&(this._cachedOperationWithTransfer.forEach((e=>{e.name&&this._router?.postMessage(e.name,e.params,e.transfer)})),this._cachedOperationWithTransfer=[]),r?this._router.postMessage(e,t,r):this._router.postMessage(e,t)):(r&&this._cachedOperationWithTransfer.push({name:e,params:t,transfer:r}),this._cachedOperation.push({name:e,params:t}))}_updateSecondPartyTelemetryFlag(e){this.enableSecondPartyTelemetry=Boolean(e.enableSecondPartyTelemetry)}_updateSDKwithPrivacyGuard(e){if(e&&this._initializeParams){const t=!!e.enablePrivacyGuard;t!==this._initializeParams?.enablePrivacyGuard&&(this._initializeParams.enablePrivacyGuard=t,this._sendOrCacheOperation("updateSDKWithPrivacyGuard",t))}}_updateSDKWithLogSanitizer(e){if(e&&this._initializeParams){const t=!!e.enableLogSanitizer;if(t!==this._initializeParams?.enableLogSanitizer){this._initializeParams.enableLogSanitizer=t;const r={warn:e.logSanitizerConfig?.warn??[],sanitize:e.logSanitizerConfig?.sanitize??[],skipObjectKeys:e.logSanitizerConfig?.skipObjectKeys??!0,scannerOptions:e.logSanitizerConfig?.scannerOptions??{}};this._initializeParams.logSanitizerConfig=r,this._sendOrCacheOperation("updateSDKWithLogSanitizer",{flag:t,logSanitizerConfig:r})}}}_updateSDKWithOfflineTelemetry(e){if(e&&this._initializeParams){const t=!!e.enableOfflineTelemetry;t!==this._initializeParams?.enableOfflineTelemetry&&(this._initializeParams.enableOfflineTelemetry=t,this._sendOrCacheOperation("updateSDKWithOfflineTelemetry",t))}}}const E=()=>_.getInstance()},735030:(e,t,r)=>{r.d(t,{K:()=>s});var n=r(670926);class s extends n.k{constructor(e){super(),this.worker=e,this.worker.initialize(this)}postMessage(e,t){const r=this.messageHandlers[e];r&&r(t)}}},475959:(e,t,r)=>{r.d(t,{y:()=>g});var n=r(700331),s=r(442424),i=r(908808);const a="(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",o="[0-9a-fA-F]{1,4}",l=`(\\s|^|\\[)(${`(?:${o}:){1,7}:|(?:${o}:){7}${o}|(?:${o}:){6}(?::${o}|${a})|(?:${o}:){5}(?:(?::${o}){1,2}|:${a})|(?:${o}:){4}(?:(?::${o}){1,3}|(?::${o}){0,1}:${a})|(?:${o}:){3}(?:(?::${o}){1,4}|(?::${o}){0,2}:${a})|(?:${o}:){2}(?:(?::${o}){1,5}|(?::${o}){0,3}:${a})|(?:${o}:){1}(?:(?::${o}){1,6}|(?::${o}){0,4}:${a})|(?::(?:(?::${o}){1,7}|(?::${o}){0,5}:${a}|:))|(?:fe80|FE80):(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}`})(\\s|$|\\])`,d=/^statics.teams.cdn.office.net$/,c=/^precompiled-(web|shared)-worker-[a-z0-9]+\.js$/,u={[s.f0.SmtpAddress]:new RegExp("\\S+@\\S+\\.\\S+","g"),[s.f0.IPV4Address]:new RegExp(a,"g"),[s.f0.PhoneNumber]:new RegExp("(?:[^-\\d]|^)(?:\\+?1[-.]?)?\\(?([0-9]{3})\\)?[-.]?([0-9]{3})[-.]?([0-9]{4})(?!\\d)","g"),[s.f0.Uri]:new RegExp('((http[s]?:\\/\\/(?<host>[^(\\/|\\?)]+)\\S)|(data:text\\/)|(data:image)|(data:application)|(file:)|([s]?ftp:\\/\\/[\\S]+\\/)|(mailto:))(?<path>([^(.|")]+[^\\"\\s]+))'),[s.f0.FilePath]:new RegExp(`((\\s(\\w+))(\\/).+?(?=((\\.${(0,i.I4)().join(")|(\\.")})|($))))`,"g")};function p(e,t){switch(e){case s.f0.SmtpAddress:case s.f0.IPV4Address:case s.f0.PhoneNumber:case s.f0.FilePath:return t.replace(u[e],(e=>(0,n.sha256)(e)));case s.f0.IPv6Address:return function(e){const t=new RegExp(l,"g");let r,s="";do{if(r=t.exec(e),r&&4===r.length){const i=r.index+r[1].length;s=`${s}${e.substring(0,i)}${(0,n.sha256)(r[2])}`;const a=i+r[2].length;e=e.substring(a),t.lastIndex=0}}while(r);return`${s}${e}`}(t);case s.f0.Uri:{let r,s="";do{if(r=u[e].exec(t),r){const e=t.substring(0,r.index);let i=t.substring(r.index);const{host:a,path:o}=r?.groups||{},l=a&&d.test(a),u=o&&c.test(o);l||u||(i=i.replace(o,(e=>(0,n.sha256)(e))));const p=5;t=i.substring(p),s=`${s}${e}${i.substring(0,p)}`}}while(r);return s=`${s}${t}`,s}default:return}}function g(e,t=[]){if(e){0===t.length&&t.push(s.f0.Uri,s.f0.SmtpAddress,s.f0.IPV4Address,s.f0.IPv6Address,s.f0.PhoneNumber);for(const r of t)e=p(r,e)}return e}},999974:(e,t,r)=>{r.d(t,{EE:()=>c,Yj:()=>s});var n,s,i=r(828735),a=r(442424),o=r(812178),l=null;class d{constructor(){this.key=null,this.value=null,this.pii=null}static _isPii(e){if(e==a.f0.NotSet)return!1;var t=!1;for(var r in a.f0)isNaN(r)||r==e&&(t=!0);return t}}class c{constructor(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}setProperty(e,t,r){if(!e||!this.properties[e]&&!c._propertyNameRegex.test(e))throw new u(n.INVALID_PROPERTY_NAME);this.properties[e]={key:e,value:t,pii:r!=a.f0.NotSet?r:null}}unsetProperty(e){if(!e)throw new u(n.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])}}c._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(n||(n={}));class u{constructor(e){this.errorCode=null,this.errorCode=e}ErrorCode(){return this.errorCode}toString(){switch(this.errorCode){case n.INVALID_TENANT_TOKEN:return"Invalid tenant token";case n.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case n.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case n.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case n.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case n.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case n.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case n.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case n.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}}}class p{constructor(e){this.contextMap=new o.T,this.piiKind=a.f0.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}setAppId(e){e&&this.contextMap.Add("AppInfo.Id",e)}setAppVersion(e){e&&this.contextMap.Add("AppInfo.Version",e)}setAppClientType(e){e&&this.contextMap.Add("AppInfo.ClientType",e)}setAppLanguage(e){e&&this.contextMap.Add("AppInfo.Language",e)}setDeviceId(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)}setDeviceOsName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)}setDeviceOsVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)}setDeviceBrowserName(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)}setDeviceBrowserVersion(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)}setUserId(e,t){e&&this.contextMap.Add("UserInfo.Id",e),d._isPii(t)&&(this.piiKind=t)}setUserMsaId(e){e&&this.contextMap.Add("UserInfo.MsaId",e)}setUserANID(e){e&&this.contextMap.Add("UserInfo.ANID",e)}setUserAdvertisingId(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)}setUserTimeZone(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)}setUserLanguage(e){e&&this.contextMap.Add("UserInfo.Language",e)}setUserRing(e){e&&this.contextMap.Add("UserInfo.Ring",e)}setUserTenantId(e){e&&this.contextMap.Add("UserInfo.TenantId",e)}}class g{static initialize(e){g.documentInfo=e;var t=e.appLanguage;t&&g.semanticContext.setAppLanguage(t);var r=e.userLanguage;r&&g.semanticContext.setUserLanguage(r);var n=(new Date).getTimezoneOffset(),s=n%60,i=(n-s)/60,a="+";i>0&&(a="-"),s=Math.abs(s);var o=a+((i=Math.abs(i))<10?"0"+i:i.toString())+":"+(s<10?"0"+s:s.toString());g.semanticContext.setUserTimeZone(o),g.semanticContext.setDeviceBrowserName(g._getBrowserName()),g.semanticContext.setDeviceBrowserVersion(g._getBrowserVersion()),g.semanticContext.setDeviceOsName(g._getOsName()),g.semanticContext.setDeviceOsVersion(g._getOsVersion()),g.semanticContext.setDeviceId(e.deviceId),g.firstLaunchTime=e.firstLaunchTime,g.semanticContext.setAppVersion(e.appVersion)}static _getUserAgent(){return g.documentInfo.userAgent}static _userAgentContainsString(e){return g._getUserAgent().indexOf(e)>-1}static _isIe(){return g._userAgentContainsString("Trident")}static _isEdge(){return g._userAgentContainsString(g.BROWSERS.EDGE)}static _isEdgeAnaheim(){return g._userAgentContainsString("Edg/")}static _isOpera(){return g._userAgentContainsString("OPR/")}static _getBrowserName(){return g._isOpera()?g.BROWSERS.UNKNOWN:g._userAgentContainsString(g.BROWSERS.PHANTOMJS)?g.BROWSERS.PHANTOMJS:g._isEdge()?g.BROWSERS.EDGE:g._isEdgeAnaheim()?g.BROWSERS.EDGEANAHEIM:g._userAgentContainsString(g.BROWSERS.ELECTRON)?g.BROWSERS.ELECTRON:g._userAgentContainsString(g.BROWSERS.CHROME)?g.BROWSERS.CHROME:g._userAgentContainsString(g.BROWSERS.FIREFOX)?g.BROWSERS.FIREFOX:g._userAgentContainsString(g.BROWSERS.SAFARI)?g.BROWSERS.SAFARI:g._userAgentContainsString(g.BROWSERS.SKYPE_SHELL)?g.BROWSERS.SKYPE_SHELL:g._isIe()?g.BROWSERS.MSIE:g.BROWSERS.UNKNOWN}static _getBrowserVersion(){return g._isIe()?function(){var e,t=g._getUserAgent(),r=t.match(new RegExp(g.BROWSERS.MSIE+" "+g.REGEX_VERSION));if(r)return r[1];if(e=t.match(new RegExp("rv:"+g.REGEX_VERSION)))return e[1]}():function(e){var t;e===g.BROWSERS.SAFARI?e="Version":e===g.BROWSERS.EDGEANAHEIM&&(e="Edg");if(t=g._getUserAgent().match(new RegExp(e+"/"+g.REGEX_VERSION)))return t[1];return g.UNKNOWN_VERSION}(g._getBrowserName())}static _getOsName(){return g._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?g.OPERATING_SYSTEMS.WINDOWS_PHONE:g._getUserAgent().match(/ arm;/i)?g.OPERATING_SYSTEMS.WINDOWS_RT:g._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?g.OPERATING_SYSTEMS.IOS:g._getUserAgent().match(/android/i)?g.OPERATING_SYSTEMS.ANDROID:g._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?g.OPERATING_SYSTEMS.LINUX:g._getUserAgent().match(/(macintosh|mac os x)/i)?g.OPERATING_SYSTEMS.MACOSX:g._getUserAgent().match(/(windows|win32)/i)?g.OPERATING_SYSTEMS.WINDOWS:g.OPERATING_SYSTEMS.UNKNOWN}static _getOsVersion(){return g._getOsName()===g.OPERATING_SYSTEMS.WINDOWS?function(){var e=g._getUserAgent().match(new RegExp("Windows NT "+g.REGEX_VERSION));if(e&&g.VERSION_MAPPINGS[e[1]])return g.VERSION_MAPPINGS[e[1]];return g.UNKNOWN_VERSION}():g._getOsName()===g.OPERATING_SYSTEMS.MACOSX?function(){var e=g._getUserAgent().match(new RegExp(g.OPERATING_SYSTEMS.MACOSX+" "+g.REGEX_VERSION_MAC));if(e){var t=e[1].replace(/_/g,".");if(t){var r=function(e){if(e.indexOf(".")>-1)return".";if(e.indexOf("_")>-1)return"_";return null}(t);return r?t.split(r)[0]:t}}return g.UNKNOWN_VERSION}():g.UNKNOWN_VERSION}}g.semanticContext=new p(!0),g.firstLaunchTime=-1,g.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},g.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},g.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},g.REGEX_VERSION="([\\d,.]+)",g.REGEX_VERSION_MAC="([\\d,_,.]+)",g.UNKNOWN_VERSION="Unknown",g.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",g.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(s||(s={}));class h{static initialize(e,t){if(!h._initialized){if(!t)throw new u(n.INVALID_TENANT_TOKEN);h._defaultToken=t,h._config.collectorUrl||(h._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),l||(l=i.zC.CreateTelemetryManager()).Initialize(h._config),l.Start(),g.initialize(e),h._initialized=!0}}static initializeWithConfiguration(e,t,r){if(!r.collectorUrl)throw new u(n.INVALID_COLLECTOR_URL);h._config.collectorUrl=r.collectorUrl,h.initialize(e,t)}static flush(e){l.Flush(e)}static addCallbackListener(e){h._initialized&&l.AddListener(e)}static setContext(e,t,r){""!==t&&"null"!==t&&"undefined"!==t?h._contextProperties.setProperty(e,t,r):h._contextProperties.unsetProperty(e)}static isInitialized(){return h._initialized}static getDefaultToken(){return h._defaultToken}static getSemanticContext(){return h._semanticContext}static __addTestHookListener(e){h._initialized&&l.__AddTestHookListener(e)}static __clearTestHookListener(){h._initialized&&l.__ClearTestHookListener()}static __backToUninitialized(){h._config=new i.go,h._semanticContext=new p(!0),h._contextProperties=new c,l=i.zC.CreateTelemetryManager(),h._initialized=!1}}h._initialized=!1,h._defaultToken=null,h._config=new i.go,h._contextProperties=new c,h._semanticContext=new p(!0)},331235:(e,t,r)=>{var n,s,i;r.d(t,{d1:()=>n,gI:()=>s,f_:()=>i,Kq:()=>a,wf:()=>o,Hh:()=>l,ui:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.callTransferV2SubsequentFilters="callTransferV2SubsequentFilters",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.followPresence="followPresence",e.statusNote="statusNote",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.externalSuggestedContacts="externalSuggestedContacts",e.forwardMessage="forwardMessage",e.virtualEvent="virtualEvent",e.flyout="flyout",e.fluidAtMention="fluidAtMention",e.chatNotesAtMention="chatNotesAtMention",e.signersList="signersList",e.addToCommunities="addToCommunities",e.copyTags="copyTags",e.adaptiveCard="adaptiveCard",e.selectPeopleFilter="selectPeopleFilter",e.addToMeetingRegularChannel="addToMeetingRegularChannel",e.tflDefault="tflDefault",e.tflZeroStateFallback="tflFilterFallback",e.powerbar="powerbar",e.forwardMessageSingleSelection="forwardMessageSingleSelection",e.callForwardNoUserSelection="callForwardNoUserSelection",e.pickerFilterFallback="pickerFilterFallback",e.callingDefault="callingDefault",e.powerbarSearchV2Filter="powerbarSearchV2Filter"}(n||(n={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.Copilots="Copilots",e.CallQandAA="CallQandAA",e.Channels="Channels",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.Moderator="Moderator",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.ExpandedPersonalContact="ExpandedPersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.SkypeConsumer="SkypeConsumer",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers",e.NonEmailSecurityGroupsWithDLs="NonEmailSecurityGroupsWithDLs",e.UnNamedGroupChats="UnNamedGroupChats",e.Teams="Teams",e.ChannelsWithPostPermissions="ChannelsWithPostPermissions"}(s||(s={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(i||(i={}));const a={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},o={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},l={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},728478:(e,t,r)=>{r.d(t,{H:()=>l,G:()=>o});var n=r(331235);const s={[n.d1.callForwardGroupSelection]:[n.gI.AADTenant,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Pstn,n.gI.CallQandAA],[n.d1.meetingRoomCall]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.DisabledUser,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.PersonalContact,n.gI.CallQandAA,n.gI.Federated,n.gI.FederatedConsumer,n.gI.ImplicitContacts,n.gI.SkypeConsumer,n.gI.TflConsumer],[n.d1.searchSuggestions]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.GroupChats,n.gI.Xtap,n.gI.Meetings,n.gI.TflSmsName,n.gI.SkypeConsumer],[n.d1.addToMeetingForSharedChannel]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.TeamTags,n.gI.GroupChats,n.gI.Xtap,n.gI.TflOffNetworkEmails,n.gI.TflOffNetworkPhones,n.gI.TflConsumer,n.gI.SkypeConsumer,n.gI.ImplicitContacts],[n.d1.calendarPeoplePicker]:[n.gI.AADTenant,n.gI.Guest,n.gI.Federated,n.gI.DisabledUser,n.gI.PersonalContact,n.gI.ModernGroup,n.gI.DL,n.gI.SkypeConsumer],[n.d1.searchResults]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.SkypeConsumer],[n.d1.addToTeam]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.DisabledUser,n.gI.SkypeConsumer,n.gI.NonEmailSecurityGroupsWithDLs,n.gI.TeamTags],[n.d1.newChat]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.TeamTags,n.gI.TflSmsName,n.gI.ExtendedDirectoryUsers,n.gI.SkypeConsumer,n.gI.UnNamedGroupChats],[n.d1.transfer]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.DisabledUser,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.SkypeConsumer,n.gI.Federated],[n.d1.callTransferV2SubsequentFilters]:[],[n.d1.addToCall]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.DisabledUser,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.PersonalContact,n.gI.CallQandAA,n.gI.Federated,n.gI.FederatedConsumer,n.gI.ImplicitContacts,n.gI.SkypeConsumer,n.gI.TflConsumer,n.gI.Xtap,n.gI.Room],[n.d1.addToChat]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.DisabledUser,n.gI.TeamTags,n.gI.ExtendedDirectoryUsers,n.gI.UnNamedGroupChats],[n.d1.searchPeopleFilter]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.SkypeConsumer],[n.d1.callRouting]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.SkypeConsumer],[n.d1.delegationSelection]:[n.gI.AADTenant,n.gI.B2BMembers,n.gI.SkypeConsumer],[n.d1.presenceSettings]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.addToMeeting]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.UnNamedGroupChats],[n.d1.meetingSchedule]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.DL,n.gI.ModernGroup,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.addToSpeedDialOrContacts]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.CallQandAA,n.gI.SkypeConsumer],[n.d1.addContacts]:[n.gI.AADTenant,n.gI.Guest,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.CallQandAA,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.atMention]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.orgChart]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.shareContact]:[n.gI.AADTenant,n.gI.SkypeConsumer],[n.d1.priorityContactsSelection]:[n.gI.AADTenant,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Pstn,n.gI.SkypeConsumer,n.gI.Guest],[n.d1.taggedContactsSelection]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.DL,n.gI.SkypeConsumer],[n.d1.shareToTeams]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.DisabledUser,n.gI.UserDefinedGroup,n.gI.SkypeConsumer],[n.d1.escalateMessage]:[n.gI.AADTenant,n.gI.SkypeConsumer],[n.d1.voicemailTransferTarget]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.DisabledUser,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.SkypeConsumer],[n.d1.addToSharedChannel]:[n.gI.AADTenant,n.gI.Xtap,n.gI.SkypeConsumer],[n.d1.externalSuggestedContacts]:[n.gI.ImplicitContactsForSMBSuggestions,n.gI.SkypeConsumer],[n.d1.exceptionHandlingPerson]:[n.gI.AADTenant],[n.d1.exceptionHandlingVoiceapp]:[n.gI.CallQandAA],[n.d1.forwardMessage]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.UserDefinedGroup,n.gI.TeamTags,n.gI.TflSmsName,n.gI.ExtendedDirectoryUsers,n.gI.SkypeConsumer,n.gI.GroupChats,n.gI.Meetings,n.gI.UnNamedGroupChats],[n.d1.statusNote]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.UserDefinedGroup,n.gI.ModernGroup,n.gI.TflSmsName,n.gI.ExtendedDirectoryUsers,n.gI.SkypeConsumer],[n.d1.virtualEvent]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.flyout]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.DisabledUser,n.gI.TeamTags,n.gI.ExtendedDirectoryUsers,n.gI.SkypeConsumer],[n.d1.fluidAtMention]:[n.gI.AADTenant,n.gI.Room,n.gI.Guest,n.gI.B2BMembers,n.gI.Bot,n.gI.Pstn,n.gI.SkypeConsumer],[n.d1.chatNotesAtMention]:[n.gI.AADTenant],[n.d1.signersList]:[n.gI.AADTenant,n.gI.Federated,n.gI.Guest,n.gI.B2BMembers],[n.d1.addToCommunities]:[n.gI.FederatedConsumer,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.PersonalContact,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.TeamTags,n.gI.GroupChats,n.gI.Xtap,n.gI.TflOffNetworkEmails,n.gI.TflOffNetworkPhones,n.gI.TflConsumer,n.gI.SkypeConsumer,n.gI.ImplicitContacts],[n.d1.adaptiveCard]:[n.gI.AADTenant],[n.d1.selectPeopleFilter]:[n.gI.AADTenant,n.gI.Guest],[n.d1.copyTags]:[n.gI.TeamTags],[n.d1.followPresence]:[n.gI.AADTenant],[n.d1.addToMeetingRegularChannel]:[n.gI.AADTenant,n.gI.Federated,n.gI.Guest,n.gI.B2BMembers,n.gI.Room],[n.d1.tflDefault]:[n.gI.AADTenant,n.gI.B2BMembers,n.gI.Guest,n.gI.Federated],[n.d1.powerbar]:[],[n.d1.forwardMessageSingleSelection]:[],[n.d1.callForwardNoUserSelection]:[],[n.d1.pickerFilterFallback]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.PersonalContact,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.TeamTags,n.gI.GroupChats,n.gI.Xtap,n.gI.TflOffNetworkEmails,n.gI.TflOffNetworkPhones,n.gI.TflConsumer,n.gI.SkypeConsumer,n.gI.ImplicitContacts],[n.d1.callingDefault]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.PersonalContact,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.TeamTags,n.gI.GroupChats,n.gI.Xtap,n.gI.TflOffNetworkEmails,n.gI.TflOffNetworkPhones,n.gI.TflConsumer,n.gI.SkypeConsumer,n.gI.ImplicitContacts],[n.d1.tflZeroStateFallback]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.PersonalContact,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.TeamTags,n.gI.GroupChats,n.gI.Xtap,n.gI.TflOffNetworkEmails,n.gI.TflOffNetworkPhones,n.gI.TflConsumer,n.gI.SkypeConsumer,n.gI.ImplicitContacts],[n.d1.powerbarSearchV2Filter]:[n.gI.AADTenant,n.gI.Guest,n.gI.B2BMembers,n.gI.Federated,n.gI.FederatedConsumer,n.gI.Bot,n.gI.DisabledUser,n.gI.DL,n.gI.ModernGroup,n.gI.PersonalContact,n.gI.UserDefinedGroup,n.gI.Pstn,n.gI.CallQandAA,n.gI.Room,n.gI.TeamTags,n.gI.GroupChats,n.gI.Xtap,n.gI.TflOffNetworkEmails,n.gI.TflOffNetworkPhones,n.gI.TflConsumer,n.gI.SkypeConsumer,n.gI.ImplicitContacts]};var i=r(480354);const a=(e,t)=>(0,i.flatten)(e.filter((([e,r])=>e===t)).map((([e,t])=>t))),o={[n.f_.Substrate]:[n.gI.AADTenant,n.gI.Guest,n.gI.GroupChats,n.gI.DL,n.gI.ModernGroup,n.gI.Room,n.gI.ExtendedDirectoryUsers,n.gI.PersonalContact,n.gI.MTOUsers,n.gI.CallQandAA],[n.f_.AAD]:[n.gI.Guest],[n.f_.IndexedDb]:[n.gI.Federated,n.gI.FederatedConsumer,n.gI.SkypeConsumer,n.gI.TflConsumer,n.gI.Bot,n.gI.Pstn],[n.f_.MiddleTier]:[],[n.f_.TopNCache]:[],[n.f_.Memory]:[],[n.f_.TFLZeroState]:[]};class l{constructor(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeExpandedPersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeSkypeConsumer=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeNonEmailSecurityGroupsWithDLs=!1,this.includeUnNamedGroupChats=!1,this.includeChannels=!1,this.includeChannelsWithPostPermissions=!1,this.includeTeams=!1,this.moderatorsOnly=!1,this.includeCopilots=!1,this.includeAADTenant=(0,i.includes)(e,n.gI.AADTenant),this.includeGuest=(0,i.includes)(e,n.gI.Guest),this.includeFederated=(0,i.includes)(e,n.gI.Federated),this.includeFederatedConsumer=(0,i.includes)(e,n.gI.FederatedConsumer),this.includeBot=(0,i.includes)(e,n.gI.Bot),this.includeCopilots=(0,i.includes)(e,n.gI.Copilots),this.includeDisabledUser=(0,i.includes)(e,n.gI.DisabledUser),this.includeDL=(0,i.includes)(e,n.gI.DL),this.includeModernGroup=(0,i.includes)(e,n.gI.ModernGroup),this.includePersonalContact=(0,i.includes)(e,n.gI.PersonalContact),this.includeExpandedPersonalContact=(0,i.includes)(e,n.gI.ExpandedPersonalContact),this.includeUserDefinedGroup=(0,i.includes)(e,n.gI.UserDefinedGroup),this.includePstn=(0,i.includes)(e,n.gI.Pstn),this.includeCallQandAA=(0,i.includes)(e,n.gI.CallQandAA),this.includeRoom=(0,i.includes)(e,n.gI.Room),this.includeTeamTags=(0,i.includes)(e,n.gI.TeamTags),this.includeGroupChats=(0,i.includes)(e,n.gI.GroupChats),this.includeMeetingChats=(0,i.includes)(e,n.gI.Meetings),this.includeXtap=(0,i.includes)(e,n.gI.Xtap),this.includeOffNetworkEmails=(0,i.includes)(e,n.gI.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,i.includes)(e,n.gI.TflOffNetworkPhones),this.includeSkypeConsumer=(0,i.includes)(e,n.gI.SkypeConsumer),this.includeTflConsumer=(0,i.includes)(e,n.gI.TflConsumer),this.includeTflSmsName=(0,i.includes)(e,n.gI.TflSmsName),this.includeImplicitContacts=(0,i.includes)(e,n.gI.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,i.includes)(e,n.gI.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,i.includes)(e,n.gI.ExtendedDirectoryUsers),this.includeMTOUsers=(0,i.includes)(e,n.gI.MTOUsers),this.includeTfl2WaySmsUsers=(0,i.includes)(e,n.gI.Tfl2WaySmsUsers),this.includeB2BMembers=(0,i.includes)(e,n.gI.B2BMembers),this.includeNonEmailSecurityGroupsWithDLs=(0,i.includes)(e,n.gI.NonEmailSecurityGroupsWithDLs),this.includeUnNamedGroupChats=(0,i.includes)(e,n.gI.UnNamedGroupChats),this.includeChannels=(0,i.includes)(e,n.gI.Channels),this.includeChannelsWithPostPermissions=(0,i.includes)(e,n.gI.ChannelsWithPostPermissions),this.moderatorsOnly=(0,i.includes)(e,n.gI.Moderator),this.includeTeams=(0,i.includes)(e,n.gI.Teams)}}l.fromName=(e,t=[])=>{if(!(e in s))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const r=a(t,!0),n=a(t,!1),o=i.without.apply(null,[(0,i.concat)(s[e],r),...n]);return new l(o,e)},l.createFrom=(e,t,r)=>new l(t||e.includeFeatures,r||e.name),l.includesAll=(e,t)=>(0,i.every)(t,(t=>(0,i.includes)(e.includeFeatures,t))),l.includesAny=(e,t)=>(0,i.some)(t,(t=>(0,i.includes)(e.includeFeatures,t)))},336714:(e,t,r)=>{var n,s,i;r.d(t,{SV:()=>n,Yw:()=>s,xi:()=>i,Xz:()=>a,ir:()=>o,eX:()=>l,Ed:()=>d,L:()=>c,X3:()=>u,s9:()=>p,GA:()=>g,FL:()=>h,gm:()=>m}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(n||(n={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(s||(s={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(i||(i={}));const a=["Large","XMedium","Medium","Small","XSmall"],o={GUEST:"GUEST",FAMILIAR:"FAMILIAR",UNFAMILIAR:"UNFAMILIAR",UNVERIFIED:"UNVERIFIED",EMAIL_VERIFIED:"EMAIL_VERIFIED"},l={PSTN:"PSTN",CONTACT:"CONTACT",GUEST:"GUEST",MTO:"MTO",SHARED_CHANNEL:"SHARED_CHANNEL",FEDERATED:"FEDERATED",TFL_CONSUMER:"TFL_CONSUMER",SFC:"SFC",CCM:"CCM",ANONYMOUS_B2C:"ANONYMOUS_B2C",ANONYMOUS_B2B:"ANONYMOUS_B2B",ACS:"ACS",EMAIL_VERIFIED:"EMAIL_VERIFIED"};var d,c;!function(e){e[e.HighTrustFederation=1]="HighTrustFederation",e[e.SharedChannelXTAPEnabled=2]="SharedChannelXTAPEnabled"}(d||(d={})),function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Pager="Pager",e.Organization="Organization",e.HomeFax="HomeFax",e.BusinessFax="BusinessFax",e.Other="Other",e.Unknown="Unknown",e.Assistant="Assistant",e.OtherFax="OtherFax",e.Radio="Radio"}(c||(c={}));const u={Private:"Private",Public:"Public"};var p,g,h;!function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed",e.forbidden="forbidden"}(p||(p={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.UpdateNameAndSkypeAvatar="updateNameAndSkypeAvatar",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateProfileAvatar="update_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl",e.GetProfilePicturePolicy="getProfilePicturePolicy",e.GetExternalProfilesByAliases="getExternalProfilesByAliases"}(g||(g={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(h||(h={}));const m=["displayName","imageUri","selfAvatarLastupdatedTime","profileType","avatarETag"]},364591:(e,t,r)=>{r.d(t,{qQ:()=>n,Pk:()=>s,$o:()=>i,V5:()=>a,PC:()=>o});const n={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},s={botType:"BOT"},i={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",PublicDistributionList:"PublicDistributionList",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",skypeUser:"SkypeUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser",room:"Room",nonFederated:"nonFederated",emailVerified:"emailverifiedanonuser",teamTag:"TeamTag",implicitContact:"ImplicitContact"},a={MTOUser:64,B2BMember:32},o={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},597204:(e,t,r)=>{r.d(t,{OJ:()=>g,Oc:()=>h,iB:()=>y,mc:()=>S,et:()=>b,F:()=>A,X7:()=>v,fV:()=>P,mo:()=>U,lT:()=>x,jP:()=>D,SG:()=>w,af:()=>L,F6:()=>M});var n,s=r(336714),i=r(331235),a=r(401368),o=r(984866),l=r(364591),d=r(480354),c=r(728478),u=r(985486),p=r(621634);const g="unknown_email_address@invalid.teams.ms",h="4:",m="8:tfloffnetwork:",f=`${m}email:`,I=`${m}phone:`,C="19:",T="50:sms:",y="50:smsunverified:",S="unknown user",b="8:teamsvisitor:",A="8:guest:",_="8:acs:",E="8:gcch-acs:",v=4,P="28:orgid:",N=["live","sip_profile","myspace","c2c","sms"],U="28:";var x;!function(e){e.peoplePickerMTSelection="people_picker_mt_selection",e.peoplePickerGroupConversation="people_picker_group_conversation_selection",e.peoplePickerCachedPeople="people_picker_is_cached_people_selection",e.peoplePickerTeamTags="people_picker_team_tags",e.peoplePickerScheduledTags="people_picker_scheduled_tags",e.peoplePickerSubstrateSelection="people_picker_substrate_selection",e.peoplePickerDistributionList="people_picker_distribution_list",e.peoplePickerImplicitContact="people_picker_implicit_contact",e.peoplePickerPSTNSelection="people_picker_pstn_selection",e.peoplePickerChannelConversation="people_picker_channel_conversation_selection",e.peoplePickerTeamConversation="people_picker_team_conversation_selection"}(x||(x={}));const D="TflContacts";var w;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList",e.Guest="Guest"}(w||(w={}));class L{static isUnknownUser(e){return e.email===g||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return g}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplayNameWithPostfixAndSecurityLabel(e,t,r,s,i,l){const{id:d}=e;let{displayName:c}=e,u=null;const{enableExternalTagForPSTNUsers:p,enableLabelingUsersByTrustLevel:g,enableMTOLabel:h}=t.get(a.w.People),m=t.get(a.w.Metadata).environment===o.B.life;if(!c)return{displayName:null,securityLabel:u};if(e.isRenamed&&(c=this.checkAndAddEditedTag(c,r),u=this.getEditedUserTag(r)),m)return this.isAnonymousUser(d)&&(c=this.checkAndAddGuestTag(c,r),u=this.getGuestUserTag(r)),{displayName:c,securityLabel:u};if(this.isAnonymousTfwUser(s)&&g){const t="type"in e&&"intenant"===e.type;s===d||t||(c=this.checkAndAddUnverifiedTag(c,r),u=this.getUnverifiedTag(r))}else{if(this.isMTOUser(e))return this.getMTOUserDisplayNamePostfixHelperAndSecurityLabel(!!h,!!l,"mtoLabel"in e?e.mtoLabel:null,c,r);if(this.isAnonymousUser(d)){const t=this.getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,c,!!g,r);c=t.displayName,u=t.securityLabel}else if(this.isFederatedUser(e)||this.isExtendedDirectoryUser(e)||this.isTFLConsumerUser(e)||this.isSfcUser(e))c=n.checkAndAddExternalTag(c,r),u=this.getExternalTag(r);else if(g&&("isAnonymousB2bUser"in e&&e.isAnonymousB2bUser||this.isAcsUserMri(d)))c=this.checkAndAddUnverifiedTag(c,r),u=this.getUnverifiedTag(r);else if(this.isGuestUser(e))c=this.checkAndAddGuestTag(c,r),u=this.getGuestUserTag(r);else if(p&&this.isPSTNUser({mri:e.id})||n.isPersonalContactUser(e)||n.isImplicitContactItem(e)){const s=n.getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e.id,c,t,!!i,r);c=s.displayName,u=s.securityLabel}}return{displayName:c,securityLabel:u}}static getUserDisplayNameWithPostfix(e,t,r,n,s,i){return this.getUserDisplayNameWithPostfixAndSecurityLabel(e,t,r,n,s,i).displayName}static getUserSecurityLabel(e,t,r,n,s,i){const a=this.getUserDisplayNameWithPostfixAndSecurityLabel(e,t,r,n,s,i).securityLabel;if(!a)return null;const o=a.match(/\(([^)]+)\)/g);return o&&o.length?o[o.length-1].slice(1,-1):null}static checkAndAddEditedTag(e,t){const r=this.getDefaultEditedDisplayName(t),n=this.getEditedUserTag(t);let s=e;return e.includes(n)||e===r||(s+=` ${n}`),s}static checkAndAddGuestTag(e,t){const r=this.getDefaultGuestDisplayName(t),n=this.getGuestUserTag(t);let s=e;return e.includes(n)||e===r||(s+=` ${n}`),s}static checkAndAddExternalTag(e,t){const r=this.getDefaultExternalDisplayname(t),n=this.getExternalTag(t);let s=e;return e.includes(n)||e===r||(s+=` ${n}`),s}static checkAndAddUnverifiedTag(e,t){const r=this.getDefaultUnverifiedDisplayname(t),n=this.getUnverifiedTag(t);let s=e;return e.includes(n)||e===r||(s+=` ${n}`),s}static isSecurityLabel(e,t){switch(e){case this.getExternalTag(t):case this.getUnverifiedTag(t):case this.getGuestUserTag(t):return!0;default:return!1}}static checkAndAddEmailVerifiedTag(e,t){const r=this.getDefaultEmailVerifiedDisplayname(t),n=this.getEmailVerifiedTag(t);let s=e;return e.includes(n)||e===r||(s+=` ${n}`),s}static getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e,t,r,s,i){const{enableLabelingUsersByTrustLevel:o,disableUnverifiedLabelForPSTNUsers:l}=r.get(a.w.People),{emergencySmsNumbers:d,hotlineSMSNumbers:c}=r.get(a.w.Messaging);return o?l||s||this.isEmergencyOrHotlinePhoneNumber(e,d||[],c||[])?{displayName:n.checkAndAddExternalTag(t,i),securityLabel:this.getExternalTag(i)}:{displayName:n.checkAndAddUnverifiedTag(t,i),securityLabel:this.getUnverifiedTag(i)}:{displayName:n.checkAndAddExternalTag(t,i),securityLabel:this.getExternalTag(i)}}static getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,t,r,n){let s;return this.isEmailVerifiedAnonUser(e)?(t=this.checkAndAddEmailVerifiedTag(t,n),s=this.getEmailVerifiedTag(n)):"isCcmUser"in e&&e.isCcmUser?(t=this.checkAndAddExternalTag(t,n),s=this.getExternalTag(n)):r?(t=this.checkAndAddUnverifiedTag(t,n),s=this.getUnverifiedTag(n)):(t=this.checkAndAddGuestTag(t,n),s=this.getGuestUserTag(n)),{displayName:t,securityLabel:s}}static getMTOUserDisplayNamePostfixHelperAndSecurityLabel(e,t,r,s,i){return e&&t&&r?{displayName:`${s} (${r})`,securityLabel:`(${r})`}:e?{displayName:s,securityLabel:null}:{displayName:n.checkAndAddExternalTag(s,i),securityLabel:this.getExternalTag(i)}}static getDefaultEditedDisplayName(e){return e.stringTranslate("calling","default_edited_displayname",{defaultValue:"Edited"})}static getEditedUserTag(e){return e.stringTranslate("calling","edited_user_postfix",{defaultValue:"(Edited)"})}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getDefaultEmailVerifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_email_verified_displayname",{defaultValue:"Email-verified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static getEmailVerifiedTag(e){return e.stringTranslate("peoplePicker","email_verified_user_postfix",{defaultValue:"(Email verified)"})}static applyFeatureFlagSettings(e,t){let r=e.includeFeatures;const n=Boolean(t.get(a.w.Messaging).enableConsumerConversations);switch(e.name){case i.d1.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:s}=t.get(a.w.Federated);s||(r=(0,d.difference)(r,[i.gI.Federated])),e&&(r=(0,d.difference)(r,[i.gI.Bot])),r=n?(0,d.difference)(r,[i.gI.Federated]):(0,d.difference)(r,[i.gI.TflConsumer]);break}case i.d1.pickerFilterFallback:{const{enableTflTfwFederation:e,enableTfwTflFederation:s}=t.get(a.w.Host);n?e&&(r=(0,d.difference)(r,[i.gI.Federated])):s&&(r=(0,d.difference)(r,[i.gI.TflConsumer]));break}case i.d1.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:s}=t.get(a.w.Federated);s||(r=(0,d.difference)(r,[i.gI.Federated])),e&&(r=(0,d.difference)(r,[i.gI.Bot]));break;case i.d1.addToChat:const{enableFederatedUsersInAddToChat:o}=t.get(a.w.Federated),{enableTfwFederationOnTfl:l,enableTfwTflFederation:c}=t.get(a.w.Host);n?l||(r=(0,d.difference)(r,[i.gI.Federated])):(o||(r=(0,d.difference)(r,[i.gI.Federated])),c||(r=(0,d.difference)(r,[i.gI.TflConsumer])));const{enableDLsInAddToChat:u}=t.get(a.w.DistributionLists);u||(r=(0,d.difference)(r,[i.gI.DL]));break;case i.d1.addToTeam:const{enableFederatedUsersInAddToTeam:p}=t.get(a.w.Federated);p||(r=(0,d.difference)(r,[i.gI.Federated]));break;case i.d1.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:g}=t.get(a.w.Federated);g||(r=(0,d.difference)(r,[i.gI.Federated]))}return c.H.createFrom(e,r)}static filterSearchResults(e,t,r){let s=t;return(e=n.applyFeatureFlagSettings(e,r)).includeFederated||(s=s.filter((e=>!(n.isFederatedUser(e)||n.isSfcUser(e)||n.isTFLConsumerUser(e))))),e.includeGuest||(s=s.filter((e=>!n.isGuestUser(e)))),e.includeBot||(s=s.filter((e=>!n.isBot(e)))),e.includeDL||(s=s.filter((e=>!n.isDistributionList(e)))),e.includePstn||(s=s.filter((e=>!n.isPSTNUser(e)))),e.includeAADTenant||(s=s.filter((e=>!n.isInTenantUser(e)))),e.includeCallQandAA||(s=s.filter((e=>!n.isCallQorAAUser(e)))),e.includeSkypeConsumer||(s=s.filter((e=>!n.isSfcUser(e)))),e.includeTflConsumer||(s=s.filter((e=>!n.isTFLConsumerUser(e)))),e.includeTflSmsName||(s=s.filter((e=>!n.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(s=s.filter((e=>!n.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(s=s.filter((e=>!n.isTFLSmsVerifiedMri(e?.mri||"")))),e.includeB2BMembers||(s=s.filter((e=>!n.isB2BMember(e)))),e.includeRoom||(s=s.filter((e=>!n.isConfRoom(e)))),e.includeCopilots||(s=s.filter((e=>!n.isCopilotBot(e.mri,r)))),s}static isMixedChatUser(e,t){const r=!e&&n.isFederatedUser({type:t})||e&&n.isTFLConsumerUser({type:t})||e&&n.isSfcUser({type:t});return Boolean(r)}static isCopilotBot(e,t){const{copilotAppsIds:r}=t.get(a.w.Messaging)??{};return!(!e||!r?.some((t=>`${U}${t}`===e)))}static isSfCUserPrefix(e){return-1!==N.indexOf(e)}static matchEmailAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e.toLowerCase()===t.address?.toLowerCase()))}static matchPhoneAliasInMeProfile(e,t){return!(0,d.isEmpty)(t)&&(0,d.some)(t,(t=>e===t.number))}static generatePstnProfile(e,t,r,s,i,o,c){let g;const{enableExternalTagForPSTNUsers:m,enableLabelingUsersByTrustLevel:f,disableUnverifiedLabelForPSTNUsers:I}=o?.get(a.w.People)??{},{emergencySmsNumbers:C,hotlineSMSNumbers:T,enablePaidSmsChat:y}=o?.get(a.w.Messaging)??{},S=e.slice(h.length),b=n.getHotlineNumberMapping(S,o);if(s&&r){const n=(0,p.kZ)(S),i=(0,u.n4)(n,r,s,!0);g={mri:e,displayName:(0,d.isEmpty)(t)?y&&b?.shortCode||i.display:t,givenName:i.display,description:y&&b?i.display:void 0,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.$o.pstn,telephoneNumber:i.display}}else g={mri:e,displayName:y&&b?.shortCode||t,description:y&&b?.phoneNumber||void 0,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:l.$o.pstn,telephoneNumber:b?.phoneNumber||S};return m&&i?.stringTranslate&&(!f||I||c||this.isEmergencyOrHotlinePhoneNumber(e,C||[],T||[])?g.decoratedDisplayName=n.checkAndAddExternalTag(g.displayName||t,i):g.decoratedDisplayName=n.checkAndAddUnverifiedTag(g.displayName||t,i)),g}static convertStringToBlobFile(e){const t=e.split(",")[1];if((0,d.isEmpty)(t))return;const r=atob(t),n=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(r.length),i=new Uint8Array(s);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);return new Blob([i],{type:n})}static getPhoneNumbers(e){let t=[];return e?.telephoneNumber&&t.push(e.telephoneNumber),e?.phones&&e.phones.length>0&&(t=t.concat(e.phones.map((e=>e.number)))),t}static getExtendedDirectoryPhoneNumber(e){return n.getPhoneNumbers(e)[0]}static isPartialSCContext(e,t){return!!(e&&!t||!e&&t)}static getFederationType(e,t){let r;const s={type:t};return e?n.isTFLUser(s)?r="tflWithTfl":n.isFederatedUser(s)&&(r="tflWithTfw"):n.isSfcUser(s)?r="tfwWithSfc":n.isTFLConsumerUser(s)?r="tfwWithTfl":n.isFederatedUser(s)&&(r="tfwWithTfw"),r}static getTfwExtendedDirectoryMembership(e,t={}){const{mri:r,userType:n}=e,{excludeOffNetwork:s=!0}=t;return!s&&this.isTFLOffNetworkUser(r)?"offNetwork":this.isPEUPUser(n)?"pending":this.isEUPUser(n)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return w.NotResolved;const{type:t,userType:r}=e;if(!t)return w.NotResolved;switch(t){case"Federated":case"TflConsumer":case"SkypeConsumer":case l.$o.pstn:return w.External;case"person":case"ADUser":return r&&"Guest"===r?w.Guest:w.User;case"Group":return w.DistributionList;default:return w.User}}static isValidNameForInitialsAvatarForPstnUser(e,t){return!!(n.isPSTNUser({mri:e})&&n.isValidNameForInitialsAvatar(t))}static isValidNameForInitialsAvatar(e){const t=new RegExp("(^\\p{L})","iu");return!!(!!e&&t.test(e))}static getDescriptionForPstnContact(e,t,r,s,i){let o;const{mri:l,displayName:c}=e,u=l.split(h)[1],{enablePaidSmsChat:p}=i.get(a.w.Messaging)??{};return p&&n.isPSTNUser({mri:l})&&s&&(n.isTextSameAsPhoneNumber(c,u,t)||(0,d.forEach)(s,(e=>{n.isTextSameAsPhoneNumber(u,e.number,t)&&(o=r.stringTranslate("people",n.getPhoneTypePeopleKey(e.type),{phoneNumber:e.number}))}))),o}static isSearchV2EnabledForPicker(e,t,r){return!!r&&(!(!e||!t)&&!t.includes(e))}static areUnNamedGroupChatsEnabledForPicker(e,t,r){return!!r&&(!(!e||!t)&&t.includes(e))}static areChannelsEnabledForPicker(e,t,r){return!!r&&(!(!e||!t)&&t.includes(e))}static areTeamsEnabledForPicker(e,t,r){return!!r&&(!(!e||!t)&&t.includes(e))}static getTeamPickerItemIdForTeam(e){return`${e}_team`}static getTeamIdFromTeamPickerItemId(e){return e.replace("_team","")}static isTextSameAsPhoneNumber(e,t,r){if(!e||!t)return!1;if(e.toLocaleLowerCase()===t.toLocaleLowerCase())return!0;const n=(0,p.kZ)(e),s=(0,u.n4)(n,"peopleUtilities_isTextSameAsPhoneNumber_Name",r),i=(0,u.n4)(t,"peopleUtilities_isTextSameAsPhoneNumber_Phone",r);return s?.diallable===i?.diallable}static getPhoneTypePeopleKey(e){switch(e){case s.L.Mobile:return`phone_type_${s.L.Mobile}`;case s.L.Business:return`phone_type_${s.L.Business}`;case s.L.Home:return`phone_type_${s.L.Home}`;case s.L.Pager:return`phone_type_${s.L.Pager}`;case s.L.Organization:return`phone_type_${s.L.Organization}`;case s.L.HomeFax:return`phone_type_${s.L.HomeFax}`;case s.L.BusinessFax:return`phone_type_${s.L.BusinessFax}`;case s.L.Assistant:return`phone_type_${s.L.Assistant}`;case s.L.OtherFax:return`phone_type_${s.L.OtherFax}`;case s.L.Radio:return`phone_type_${s.L.Radio}`;default:return`phone_type_${s.L.Other}`}}static isEmergencyOrHotlinePhoneNumber(e,t,r){const n=e.slice(h.length);return t.includes(n)||r.includes(n)}static getHotlineNumberMapping(e,t){const r=t?.get(a.w.People)?.hotlineNumbersMapping||[{shortCode:"988",phoneNumber:"+18002738255"}];for(const t of r)if(e===t?.shortCode||e===t?.phoneNumber)return t}}n=L,L.getTrustIndicatorLabel=(e,t,r=!1)=>{if(e.trustLabel)return e.trustLabel;switch(e.trustLevel){case"FAMILIAR":return r?t.stringTranslate("people","trust_indicator_external_familiar_aria_label"):t.stringTranslate("people","external_label");case"UNFAMILIAR":return r?t.stringTranslate("people","trust_indicator_external_unfamiliar_aria_label"):t.stringTranslate("people","external_label");case"GUEST":return t.stringTranslate("people","guest_label");case"UNVERIFIED":return t.stringTranslate("people","unverified_label");case"EMAIL_VERIFIED":return t.stringTranslate("people","email_verified_label");default:return""}},L.getDisplayNameWithTrustLabelForAria=(e,t,r)=>{if(!t)return e;return`${e} ${n.getTrustIndicatorLabel(t,r,!0)}`},L.getTrustIndicatorTooltip=(e,t,r)=>{let n=t;const{trustLevel:s,trustReason:i}=e;switch(n||(n=r.stringTranslate("people","trust_indicator_tooltip_default_name")),s){case"FAMILIAR":if("CONTACT"===i)return r.stringTranslate("people","trust_indicator_tooltip_pstn_contact",{displayName:n});if("FEDERATED"===i||"SHARED_CHANNEL"===i||"CCM"===i)return r.stringTranslate("people","trust_indicator_tooltip_familiar_default",{displayName:n});if("MTO"===i)return null;case"UNFAMILIAR":if("PSTN"===i)return r.stringTranslate("people","trust_indicator_tooltip_pstn_not_contact");if("FEDERATED"===i||"CONTACT"===i)return r.stringTranslate("people","trust_indicator_tooltip_unfamiliar_default");if("TFL_CONSUMER"===i||"SFC"===i)return r.stringTranslate("people","trust_indicator_tooltip_tfl_or_sfc");if("ANONYMOUS_B2B"===i)return r.stringTranslate("people","trust_indicator_tooltip_not_federated");case"GUEST":return r.stringTranslate("people","trust_indicator_tooltip_guest",{displayName:n});case"UNVERIFIED":return r.stringTranslate("people","trust_indicator_tooltip_unverified");case"EMAIL_VERIFIED":return r.stringTranslate("people","trust_indicator_tooltip_email_verified");default:return null}},L.getFamiliarTrustworthy=(e,t)=>({trustLevel:"FAMILIAR",trustReason:e,trustLabel:t}),L.getUnfamiliarTrustworthy=e=>({trustLevel:"UNFAMILIAR",trustReason:e}),L.getGuestTrustworthy=()=>({trustLevel:"GUEST",trustReason:"GUEST"}),L.getUnverifiedTrustworthy=e=>({trustLevel:"UNVERIFIED",trustReason:e}),L.getEmailVerifiedTrustworthy=()=>({trustLevel:"EMAIL_VERIFIED",trustReason:"EMAIL_VERIFIED"}),L.getUserTrustworthy=(e,t)=>{const{enableTrustIndicator:r}=t.get(a.w.People),s=n.isInTenantUser(e)&&!n.isB2BMemberMTOUser(e);if(!r||s||n.isUnknownUser(e)||n.isAnonymousUser(e.currentUserMri))return null;switch(!0){case e.isContact:return n.getFamiliarTrustworthy("CONTACT");case n.isImplicitContactItem(e):return n.getUnfamiliarTrustworthy("CONTACT");case n.isPSTNUser(e):return n.getUnfamiliarTrustworthy("PSTN");case n.isMTOUser(e):return e.mtoLabel?n.getFamiliarTrustworthy("MTO",e.mtoLabel):null;case n.isFederatedUser(e):return n.getFederatedUserTrustworthy(e.trustReason,e.trustworthy);case n.isTFLConsumerUser(e):return n.getUnfamiliarTrustworthy("TFL_CONSUMER");case n.isSfcUser(e):return n.getUnfamiliarTrustworthy("SFC");case n.isGuestUser(e):return n.getGuestTrustworthy();case n.isAnonymousUser(e.mri):return n.isEmailVerifiedAnonUser(e)?n.getEmailVerifiedTrustworthy():e.isCcmUser?n.getFamiliarTrustworthy("CCM"):n.getUnverifiedTrustworthy("ANONYMOUS_B2C");case n.isAcsUserMri(e.mri):return n.getUnverifiedTrustworthy("ACS");case n.isAnonymousB2bUser(e):return n.getUnfamiliarTrustworthy("ANONYMOUS_B2B");default:return null}},L.getFederatedUserTrustworthy=(e,t)=>t||(e===s.Ed.SharedChannelXTAPEnabled?n.getFamiliarTrustworthy("SHARED_CHANNEL"):e===s.Ed.HighTrustFederation?n.getFamiliarTrustworthy("FEDERATED"):n.getUnfamiliarTrustworthy("FEDERATED")),L.isEmailVerifiedAnonUser=e=>"type"in e&&e.type?.toLowerCase()===l.$o.emailVerified,L.isFederatedUser=e=>!!e.isFederated||e.type?.toLowerCase()===l.$o.federated.toLowerCase(),L.isGuestUser=e=>e.type===l.$o.guest||e.userType===l.$o.guest||e.peopleSubType===l.$o.guest,L.isPersonalContactUser=e=>e.type===l.$o.personalContactUser||e.userType===i.gI.PersonalContact,L.isTFLUser=e=>e.type===l.$o.tflUser,L.isSkypeUser=e=>e.type===l.$o.skypeUser,L.isTFLConsumerUser=e=>e.type===l.$o.tflConsumer,L.isTFLSmsUser=e=>e.id&&n.isTFLSmsMri(e.id),L.isTFLSmsFriendlyNameUser=e=>e.id&&n.isTFLSmsMri(e.id)&&e.friendlyName,L.isInTenantUser=e=>!(e.type?.toLowerCase()!==l.PC.type.person.toLowerCase()&&e.type!==l.$o.ADUser||n.isGuestUser(e)||e.isFederated),L.isBot=e=>e.type?.toUpperCase()===l.Pk.botType,L.isDistributionList=e=>e.type===l.$o.DistributionList&&(!e.objectType||e.objectType===l.$o.DistributionList),L.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(h),L.isSfcUser=e=>e.type===l.$o.skypeConsumer,L.isTflOrSkypeConsumerUser=e=>n.isTFLConsumerUser(e)||n.isSfcUser(e),L.isMTOUser=e=>e.profileType===l.V5.MTOUser||e.userType===l.$o.MTOUser||e.peopleSubType===l.$o.MTOUser,L.isB2BMemberMTOUser=e=>n.isMTOUser(e)&&(e.type===l.$o.ADUser||e.type===l.$o.person),L.isFederatedMTOUser=e=>n.isMTOUser(e)&&n.isFederatedUser(e),L.isB2BMember=e=>e.profileType===l.V5.B2BMember||e.userType===l.$o.B2BMember,L.isRoom=e=>e.peopleSubType===l.$o.room,L.isB2BGuest=e=>e.userType===l.$o.guest,L.isSharedChannelUser=e=>n.isFederatedUser(e)&&e.xtapUser,L.isExtendedDirectoryUser=e=>n.isPEUPUser(e.userType)||n.isEUPUser(e.userType)||e.type===l.$o.extendedDirectoryUser,L.isConfRoom=e=>e.userType===l.$o.room,L.isPEUPUser=e=>e===l.$o.PendingOrgContact,L.isEUPUser=e=>e===l.$o.OrgContact,L.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),L.isCallQorAAUser=e=>e.type===l.$o.voiceApp,L.isAnonymousB2bUser=e=>e.type?.toLowerCase()===l.$o.nonFederated.toLowerCase()||e.isAnonymousB2bUser,L.isAnonymousUser=e=>n.isAnonymousTfwUser(e)||n.isAnonymousTflUser(e),L.isAnonymousTfwUser=e=>e?.startsWith(b),L.isAnonymousTflUser=e=>e?.startsWith(A),L.isAnonymousPstn=e=>e?.startsWith("4:anonymous"),L.isAcsUserMri=e=>!(!e||![_,E].some((t=>e.startsWith(t)))),L.isTFLOffNetworkUser=e=>0===e?.indexOf(m),L.isTFLOffNetworkPhoneUser=e=>0===e?.indexOf(I),L.isTFLOffNetworkEmailUser=e=>0===e?.indexOf(f),L.isTFLSmsUnVerifiedMri=e=>0===e?.indexOf(y),L.isTFLSmsVerifiedMri=e=>0===e?.indexOf(T),L.isTFLSmsMri=e=>0===e?.indexOf(T)||0===e?.indexOf(y),L.isTFLSmsOrOffNetworkPhoneMri=e=>n.isTFLOffNetworkPhoneUser(e)||n.isTFLSmsMri(e),L.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>n.isTFLSmsUnVerifiedMri(e)||n.isTFLOffNetworkPhoneUser(e),L.isTFLOffNetworkOrSmsUnVerifiedMri=e=>n.isTFLOffNetworkUser(e)||n.isTFLSmsUnVerifiedMri(e),L.isEnterpriseUserMri=e=>0===e?.indexOf("8:orgid:"),L.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const t=e.split(":");return!!(2===t.length||3===t.length&&n.isSfCUserPrefix(t[1]))},L.isDisplayNameUnknownUser=e=>e?.toLowerCase()===S||"unknown"===e?.toLowerCase(),L.isConversationItem=e=>0===e.id?.indexOf(C),L.isUnNamedConversationItem=e=>void 0!==e.groupChatName&&(null===e.groupChatName||0===e.groupChatName.length),L.isChannelPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===x.peoplePickerChannelConversation&&0===e.id?.indexOf(C),L.isTeamPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===x.peoplePickerTeamConversation&&0===e.id?.indexOf(C),L.isImplicitContactItem=e=>e.userType===l.$o.implicitContact||e.peopleSubType===l.$o.implicitContact,L.isTag=e=>"Tag"===e.type,L.getPhoneNumberFromMri=e=>e&&n.isTFLSmsUnVerifiedMri(e)?e.slice(y.length):"";const M=e=>e.mri||e.objectId||e.concatenatedId},424794:(e,t,r)=>{r.d(t,{Y:()=>n});const n={AmsImage:"AmsImage",AmsImageDownload:"AmsImageDownload",CustomEmoji:"CustomEmoji",Branding:"Branding",AppsPlatform:"AppsPlatform",FileDownload:"FileDownload",DownloadFileActions:"DownloadFileActions",CommunitiesDetailsByJoinLink:"CommunitiesDetailsByJoinLink",CommunitiesFetchThreadProperties:"CommunitiesFetchThreadProperties",SubscribeCommunitiesUpdate:"SubscribeCommunitiesUpdate",FetchCommunitiesDetails:"FetchCommunitiesDetails",CommunitiesLoader:"CommunitiesLoader",FileUploadPreviewService:"FileUploadPreviewService",InlineImageSerializer:"InlineImageSerializer",CustomEmojiService:"CustomEmojiService",ChatResolvers:"ChatResolvers",AmsResolvers:"AmsResolvers",UploadCachedAssetsJob:"UploadCachedAssetsJob",CodeSnippetsSerializer:"CodeSnippetsSerializer",VideoMessageUploadService:"VideoMessageUploadService",InlineVideoSerializer:"InlineVideoSerializer",DownloadSkypeFiles:"DownloadSkypeFiles",AnnouncementPostMessage:"AnnouncementPostMessage",CustomVideoBackgroundsService:"CustomVideoBackgroundsService",OperatorCobranding:"OperatorCobranding",AppsChat:"AppsChat",AppsEmbed:"AppsEmbed",AppsTeamsAndChannels:"AppsTeamsAndChannels",GetBlobImageUrl:"GetBlobImageUrl",AdaptiveCard:"AdaptiveCard",ListCard:"ListCard",MiniAdaptiveCard:"MiniAdaptiveCard",O365ConnectorCard:"O365ConnectorCard",O365ConnectorCardFetchAPIEffect:"O365ConnectorCardFetchAPIEffect",ComposeInlineImageHandler:"ComposeInlineImageHandler",ImageCopySerializer:"ImageCopySerializer",GalleryExtension:"GalleryExtension",CustomAvatarV9:"CustomAvatarV9",AppProfileCard:"AppProfileCard",ActionableAppProfileCard:"ActionableAppProfileCard",AudioCard:"AudioCard",CallingMeetingBranding:"CallingMeetingBranding",AppAttribution:"AppAttribution",CardPreviewContainer:"CardPreviewContainer",CardActions:"CardActions",CardImage:"CardImage",HeroCard:"HeroCard",MiniCardGrid:"MiniCardGrid",MiniCard:"MiniCard",ThumbnailCard:"ThumbnailCard",CodeSnippetCard:"CodeSnippetCard",ComposeAmsImage:"ComposeAmsImage",GalleryViewV2:"GalleryViewV2",GalleryView:"GalleryView",Thumbnail:"Thumbnail",RichFilePreviewImageUtils:"RichFilePreviewImageUtils",RichFilePreviewThumbnail:"RichFilePreviewThumbnail",CallingMeetingBrandingLoadImageCore:"CallingMeetingBrandingLoadImageCore"}},798515:(e,t,r)=>{r.d(t,{Z2:()=>n,zg:()=>s,Fi:()=>i,Jy:()=>a,Y0:()=>o,D$:()=>l,Bv:()=>d,V6:()=>c,n6:()=>u,kW:()=>p,gQ:()=>g});const n=180,s=2,i=.5,a=10,o=48,l=62,d=87.8,c=20,u=250,p=1e4,g=20971520},449778:(e,t,r)=>{r.d(t,{IC:()=>S,FF:()=>b,vB:()=>A,Ap:()=>_,D$:()=>E,N7:()=>v,Xd:()=>P,MC:()=>N,Mw:()=>w,lo:()=>L,fq:()=>M,qD:()=>k,QK:()=>F});var n=r(182635),s=r(798515);const i="asm.skype.com",a="api.ams.gcc.teams.microsoft.com",o="urlp.ams.gcc.teams.microsoft.com",l="api.ams.gov.teams.microsoft.us",d="api.ams.dod.teams.microsoft.us",c="api.asyncgw.teams.microsoft.scloud",u="api.asyncgw.teams.microsoftonline.cn",p="api.asyncgw.teams.eaglex.ic.gov",g="asyncgw.teams.microsoft.com",h="/v1/objects",m="/views/video",f="/ams",I="teams.microsoft.com",C=/^\/asm\/[a-z]+/i,T=/^\/asm\/[a-z]+\/v1\/objects/i,y=/v1\/objects\/([^/]{1,300})/i;var S,b;function A(e){if(e&&E(e)){const t=e.match(y);return t&&t[1]||""}return""}function _(e){const t=(0,n.yz)(e).toLowerCase(),r=(0,n.Yn)(e);return t.endsWith(i)||t===a||t===l||t===d||t===c||t===u||t===p||t===o||t.endsWith(g)||t===I&&C.test(r)}function E(e){if(L(e))return!0;const t=(0,n.Yn)(e);return _(e)&&(t.startsWith(h)||T.test(t))}function v(e){if(!e)return!1;const t=(0,n.Yn)(e);return!(!L(e)||!t.endsWith(m))||_(e)&&t.endsWith(m)}function P(e){return v(e)?b.Video:E(e)?b.Image:b.None}async function N(e){const t=e instanceof Blob?new Uint8Array(await(e.arrayBuffer?.())):e;if(!t||t.length<6)return!1;if(71!==t[0]||73!==t[1]||70!==t[2])return function(e){if(!e)return!1;let t=-1,r=-1;for(let n=0;n<e.length-4;n++)if(97===e[n]&&99===e[n+1]&&84===e[n+2]&&76===e[n+3]&&(r=n),73===e[n]&&68===e[n+1]&&65===e[n+2]&&84===e[n+3]){t=n;break}return r>=0&&t>r}(t);let r=0;for(let e=0;e<t.length-9&&!(U(t,e)&&(x(t,e+8)||D(t,e+8))&&(r++,r>1));e++);return r>1}function U(e,t){return 33===e[t]&&249===e[t+1]&&4===e[t+2]}function x(e,t){return 44===e[t]}function D(e,t){return 33===e[t]&&255===e[t+1]&&11===e[t+2]}function w(e,t){if(!e||!E(e)||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")}function L(e){return(0,n.Yn)(e).toLowerCase().startsWith(f+h)}function M(e){return e>s.gQ}function k(e){if(!e||"image/*"===e)return"";const t=e.match(/^image\/([^*]+)$/);return t?t[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(S||(S={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(b||(b={}));const F=async e=>{const{src:t,logger:r,size:n,type:i}=e,a=document.createElement("canvas"),o=a.getContext("2d");if(o)return new Promise((e=>{const l=new Image;l.onload=()=>{try{const{height:r,width:d}=l;let c=1;if(void 0!==n&&M(n)&&(c=s.gQ/n,"image/jpeg"===i&&(c+=.9*(1-c))),(d>s.kW||r>s.kW)&&(c=Math.min(c,s.kW/Math.max(r,d))),1===c)return void e(void 0);const u=c*d,p=c*r;a.width=u,a.height=p,o.drawImage(l,0,0,u,p),a.toBlob((r=>{const n=r?URL.createObjectURL(r):null;if(n)return URL.revokeObjectURL(t),void e(n);e(t)}),i??"image/png")}catch(n){r.error(`Error resizing image, error: ${n}`),e(t)}finally{a.remove()}},l.src=t}));a.remove()}},712003:(e,t,r)=>{r.d(t,{hR:()=>s,Nw:()=>i,DA:()=>l});const n=globalThis;function s(e,t){const r=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!r.has(t)){if(t&&"object"==typeof t){if(r.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t?.errorCode)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}function i(e,t=!0){if(null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,o(a(t)))}catch(e){return"Stringifying error failed"}}const a=(e=!0)=>(t,r)=>{if(r instanceof Error){const t={};return Object.getOwnPropertyNames(r).forEach((n=>{"stack"===n?e||(t[n]=("string"==typeof r.stack?r.stack:"").split("\n").map((e=>e.trim())).filter((e=>!!e))):t[n]=r[n]})),t}return r},o=e=>{const t=new WeakSet;return(r,n)=>{if("object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return e(r,n)}},l=()=>{try{const e=n.msCrypto||n.crypto;return`${[1e7]}-1000-4000-8000-100000000000`.replace(/[018]/g,(t=>(t^e.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)))}catch{const e="xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx",t="0123456789abcdef";let r=0,n="";for(let s=0;s<36;s++)"-"!==e[s]&&"4"!==e[s]&&(r=16*Math.random()|0),"x"===e[s]?n+=t[r]:"y"===e[s]?(r&=3,r|=8,n+=t[r]):n+=e[s];return n}}},431256:(e,t,r)=>{r.d(t,{Z8:()=>n,X0:()=>o,_v:()=>l,lW:()=>d,Gy:()=>c,L7:()=>u,rd:()=>p,HT:()=>g});var n,s=r(912435),i=r(183111),a=r(480354);!function(e){e.Text="text/plain",e.Html="text/html",e.Png="image/png"}(n||(n={}));const o=e=>{const t=e.document.getSelection();if(t){if(t.toString())return!0;if(t.rangeCount>0){if(t.getRangeAt(0).cloneContents().childElementCount>0)return!0}}return!1},l=(e,t,r,s)=>{const i=e.document,o=i.createElement("div");(0,a.assign)(o.style,{color:"transparent",outline:"none",boxShadow:"none",background:"transparent"}),o.setAttribute("aria-hidden","true");const l=i.createElement(t);((e,t)=>{(0,a.assign)(e,t),t&&Object.keys(t).forEach((r=>e.setAttribute(r,t[r])))})(l,r),s&&(0,a.assign)(l.style,s),o.appendChild(l),i.body.appendChild(o);const d=i.getSelection();if(d){d.removeAllRanges();const e=i.createRange();e.selectNode(l),d.addRange(e)}const c=e=>{e.stopPropagation(),e.preventDefault();const t=e.clipboardData;t&&(t.clearData(),t.setData(n.Text,l.textContent||l.outerHTML),t.setData(n.Html,l.outerHTML)),i.removeEventListener("copy",c)};i.addEventListener("copy",c);i.execCommand("copy")||i.removeEventListener("copy",c),i.body.removeChild(o)},d=(e,t)=>{try{e.navigator.clipboard.writeText(t)}catch{throw f("copyToClipboard")}},c=async(e,t)=>e.navigator.clipboard.writeText(t),u=async(e,t,r)=>{if(r.navigator.clipboard&&r.navigator.clipboard.write&&r.ClipboardItem)await m(e,t,r,r.ClipboardItem);else{h(e,t,!1,r)}},p=({htmlString:e,host:t})=>{g(e,e,t)},g=(e,t,r)=>{h(e,t,!0,r)},h=(e,t,r,n)=>{const s=n.document,i=r=>{const n=r&&r.clipboardData;n&&(n.setData("text/html",e),n.setData("text/plain",t),r.preventDefault())};s.addEventListener("copy",i);const a=s.execCommand("copy");if(s.removeEventListener("copy",i),!a){if(!(r&&n.navigator.clipboard&&n.navigator.clipboard.write&&n.ClipboardItem))throw f("copyRichAndPlainStringToClipboard");m(e,t,n,n.ClipboardItem)}},m=async(e,t,r,n)=>{const s=new n({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([t],{type:"text/plain"})});await r.navigator.clipboard.write([s])},f=e=>(0,s.$5)(e,i.O4.FeatureNotSupported,"",void 0,"The copy command is not supported or enabled")},679521:(e,t,r)=>{function n(e){let t=5381;for(let r=0;r<e.length;r++)t=(t<<5)+t+e.charCodeAt(r);return t>>>0}r.d(t,{M:()=>n})},804437:(e,t,r)=>{r.d(t,{JT:()=>i,oJ:()=>a,M5:()=>o,Gu:()=>d,hR:()=>c});var n=r(480354),s=r(912435);function i(e,t,r){return e=l(e,t,r=r||a),1===t.length&&"object"==typeof t[0]&&(e=l(e,t[0],r)),e}function a(e){if(null===e)return"null";if(void 0===e)return"undefined";const t=typeof e;if("string"===t)return e;if("number"===t||"boolean"===t)return String(e);if("function"===t)return"";if((0,n.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(t){return c(e)}}function o(e,t){let r=`[errorType=${typeof e}]`;return r+=e?"object"==typeof e?`[errorName=${e.name}][errorMessage=${e.message}][errorStack=${e.stack}]`:`[error=${e.toString()}]`:`[error=Undefined ${t} Error]`,(0,s.Mr)(r)}function l(e,t,r){for(const n in t)t.hasOwnProperty(n)&&(e=e.replace(`{${n}}`,r(t[n])));return d(e)}function d(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function c(e,t){const r=new WeakSet;return JSON.stringify(e,((e,t)=>{if(!r.has(t)){if(t&&"object"==typeof t){if(r.add(t),t instanceof Map||t instanceof Set)return Array.from(t);if(t instanceof Error)return`${t.name}: ${t.message}`;if(t.constructor&&t.constructor!==Object&&t.constructor!==Array||t.prototype)return}return t}}),t)}},384477:(e,t,r)=>{r.d(t,{aq:()=>i,Df:()=>a,UQ:()=>o});var n=r(144577);const s=/[xy]/g;function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(s,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function a(e,t){try{if(void 0!==e&&"number"==typeof e)return t===n.Y.None?!(e&n.Y.LoggedInConsole):!!(e&t)}catch{console.log("Not valid")}}function o(e,t){return t|e}},800042:(e,t,r)=>{r.d(t,{L:()=>n});const n={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,zero:48,a:65,c:67,v:68,command:91,contextMenu:93,number0:48,number9:57,numpad0:96,numpad9:105,numpadAdd:107,numpadSubtract:109,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,hyphen:189,forwardslash:191,meta:224}},985310:(e,t,r)=>{var n,s,i,a,o,l;r.d(t,{SA:()=>n,Sx:()=>s,SV:()=>i,wX:()=>a,Sq:()=>o,S6:()=>l}),function(e){e.Windows="windows",e.Mac="mac",e.Linux="linux",e.ChromeOS="chromeos",e.Android="android",e.IOS="ios",e.WindowsPhone="windowsphone",e.Unknown="unknown"}(n||(n={})),function(e){e.Default="default",e.DefaultV2="defaultV2",e.DefaultTfl="tfl-default",e.Dark="dark",e.DarkV2="darkV2",e.DarkTfl="tfl-dark",e.HighContrast="contrast"}(s||(s={})),function(e){e.Dark="dark",e.Light="light",e.Contrast="contrast"}(i||(i={})),function(e){e.Light="0",e.Dark="1",e.Contrast="2",e.DefaultV2="3",e.DarkV2="4",e.DefaultTfl="5",e.DarkTfl="6"}(a||(a={})),function(e){e.HighContrast="#FFFFFF_#000000_#FFFF00"}(o||(o={})),function(e){e.ColorContrastOverride="(forced-colors: active)",e.Light="(prefers-color-scheme: light)",e.Dark="(prefers-color-scheme: dark)"}(l||(l={}))},788281:(e,t,r)=>{r.d(t,{Pi:()=>n,I$:()=>i,Hf:()=>a});var n,s=r(800042);!function(e){e.CHAT_LIST="chat-list",e.CHAT_MESSAGES_LIST="chat-messages-list",e.COMPOSE_FIELD="compose-field",e.CHANNEL_LIST="channel-list",e.CHAT_AND_CHANNEL_LIST="chat-and-channel-list"}(n||(n={}));const i={layoutIndependent:{ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",Digit0:"0",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",F1:"f1",F2:"f2",F3:"f3",F4:"f4",F5:"f5",F6:"f6",F7:"f7",F8:"f8",F9:"f9",F10:"f10",F11:"f11",F12:"f12",F13:"f13",F14:"f14",F15:"f15",F16:"f16",F17:"f17",F18:"f18",F19:"f19",F20:"f20",F21:"f21",F22:"f22",F23:"f23",F24:"f24",Numpad0:"0",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",NumpadAdd:"+",NumpadComma:",",NumpadDecimal:".",NumpadDivide:"/",NumpadEnter:"\n",NumpadEqual:"=",NumpadMultiply:"*",NumpadSubtract:"-",Enter:"enter",Space:"space"},specialCharacters:{Backquote:"`",Backslash:"\\",BracketLeft:"[",BracketRight:"]",Comma:",",Equal:"=",IntlBackslash:"\\",IntlYen:"yen",Minus:"-",Period:".",Quote:"'",Semicolon:";",Slash:"/"},alphabet:{KeyA:"a",KeyB:"b",KeyC:"c",KeyD:"d",KeyE:"e",KeyF:"f",KeyG:"g",KeyH:"h",KeyI:"i",KeyJ:"j",KeyK:"k",KeyL:"l",KeyM:"m",KeyN:"n",KeyO:"o",KeyP:"p",KeyQ:"q",KeyR:"r",KeyS:"s",KeyT:"t",KeyU:"u",KeyV:"v",KeyW:"w",KeyX:"x",KeyY:"y",KeyZ:"z"},unsupported:{AltLeft:null,AltRight:null,AudioVolumeDown:null,AudioVolumeMute:null,AudioVolumeUp:null,Backspace:null,BrowserBack:null,BrowserForward:null,BrowserHome:null,BrowserRefresh:null,BrowserSearch:null,CapsLock:null,ContextMenu:null,ControlLeft:null,ControlRight:null,Convert:null,Delete:null,Eject:null,End:null,Escape:null,Home:null,Insert:null,IntlRo:null,KanaMode:null,LaunchApp1:null,LaunchApp2:null,LaunchMail:null,Lang1:null,Lang2:null,MediaTrackNext:null,MediaTrackPrevious:null,MediaPlayPause:null,MediaStop:null,MetaLeft:null,MetaRight:null,NonConvert:null,NumLock:null,PageDown:null,PageUp:null,Pause:null,Power:null,PrintScreen:null,ScrollLock:null,ShiftLeft:null,ShiftRight:null,Sleep:null,Tab:null,WakeUp:null}},a={modifiers:["ctrl","shift","alt","meta","cmd","option","command"],nonPrintableCharacterMap:{backspace:{code:[s.L.backspace],key:["Backspace"],value:"backspace"},tab:{code:[s.L.tab],key:["Tab"],value:"tab"},enter:{code:[s.L.enter],key:["Enter"],value:"enter"},shift:{code:[s.L.shift],key:["Shift"],value:"shift"},ctrl:{code:[s.L.control],key:["Ctrl"],value:"ctrl"},alt:{code:[s.L.alt],key:["Alt"],value:"alt"},capslock:{code:[s.L.capsLock],key:["CapsLock"],value:"capslock"},esc:{code:[s.L.escape],key:["Escape","Esc"],value:"esc"},space:{code:[s.L.space],key:["Spacebar"," "],value:"space"},pageup:{code:[s.L.pageUp],key:["PageUp"],value:"pageup"},pagedown:{code:[s.L.pageDown],key:["PageDown"],value:"pagedown"},end:{code:[s.L.end],key:["End"],value:"end"},home:{code:[s.L.home],key:["Home"],value:"home"},left:{code:[s.L.left],key:["ArrowLeft","Left"],value:"left"},up:{code:[s.L.up],key:["ArrowUp","Up"],value:"up"},right:{code:[s.L.right],key:["ArrowRight","Right"],value:"right"},down:{code:[s.L.down],key:["ArrowDown","Down"],value:"down"},insert:{code:[s.L.insert],key:["Insert"],value:"insert"},del:{code:[s.L.delete],key:["Delete","Del"],value:"del"},meta:{code:[s.L.command,s.L.contextMenu,s.L.meta],key:["Meta"],value:"meta"},f1:{code:[s.L.f1],key:["F1"],value:"f1"},f4:{code:[s.L.f4],key:["F4"],value:"f4"},f6:{code:[s.L.f6],key:["F6"],value:"f6"},f10:{code:[s.L.f10],key:["F10"],value:"f10"},f11:{code:[s.L.f11],key:["F11"],value:"f11"}},specialCharactersMap:{106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",124:"f13",125:"f14",126:"f15",127:"f16",128:"f17",129:"f18",130:"f19",131:"f20",132:"f21",133:"f22",134:"f23",135:"f24",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}}},24114:(e,t,r)=>{var n;r.d(t,{C:()=>n}),function(e){e.AcsUser="8:acs:",e.AcsGcchUser="8:gcch-acs:",e.Bot="28:",e.DodUser="8:dod:",e.GcchUser="8:gcch:",e.Pstn="4:",e.PstnExtension=";ext=",e.User="8:orgid:"}(n||(n={}))},323824:(e,t,r)=>{r.d(t,{K:()=>s,H:()=>i});var n=r(167090);const s=e=>{const t=/^P.*T(?:([.,\d]+)H)?(?:([.,\d]+)M)?(?:([.,\d]+)S)?/.exec(e);function r(e){return t&&t[e]?Number(t[e].replace(",",".")):0}return r(3)+r(2)*n.lS+r(1)*n.Zm},i=e=>{const t=e<0;e=Math.abs(e);const r=Math.floor(e/n.Zm),s=Math.floor((e-r*n.Zm)/n.lS),i=e-r*n.Zm-s*n.lS;return`${t?"-":""}${a(r,":",!0)}${a(s,":")}${a(i)}`},a=(e,t="",r=!1)=>0===e&&r?"":e<10?`0${e}${t}`:`${e}${t}`},908808:(e,t,r)=>{r.d(t,{qR:()=>n,p_:()=>a,I4:()=>o});const n="other",s="WebLink";var i;function a(e){return!!i[e]||e===s}function o(){return Object.keys(i).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note",e[e.whiteboard=300]="whiteboard",e[e.loop=301]="loop",e[e.page=302]="page"}(i||(i={}))},985486:(e,t,r)=>{r.d(t,{n4:()=>d,UZ:()=>f,zj:()=>S});var n=r(480354),s=r(24114),i=r(391091),a=r(401368),o=r(621634),l=r(281045);const d=(e,t,r,n)=>{let s={normalized:e,diallable:e,display:e};const{logger:i,userLocale:a,isDialPlansEnabled:l,allowNonE164Mri:d,phoneNumberUtil:u,phoneNumberFormat:h}=r;if(!u||!h)return i.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!u}, isPhoneNumberFormatDefined=${!!h}`),s;if(!e)return i.warn(`[formatPhoneNumber] No phone number provided from: ${t}`),s;if(i.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${t}`),!n){const t=(0,o.tv)(e),n=c(t,r);if(i.log(`[formatPhoneNumber] cleaned_formatting, Phone number without alpha: ${n}`),l){if(s=T(n,r),i.log(`[formatPhoneNumber] isInternalExtension? ${s.isInternalExtension}`),s.isInternalExtension)return s}else i.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),s.normalized=n;d||(s.normalized=p(s.normalized,h.E164,r,!0),i.log("[formatPhoneNumber] NonE164 mri are not allowed"))}s={...s,...g(s.normalized,r)};try{const e=u.getInstance().parseAndKeepRawInput(s.normalized,a);s.display=u.getInstance().formatInOriginalFormat(e,h.INTERNATIONAL),s.isValid=u.getInstance().isPossibleNumber(e)&&u.getInstance().isValidNumber(e)}catch(e){i.error(`[formatPhoneNumber] ${e}`),s.display=s.normalized,s.isValid=!1}return i.log(`[formatPhoneNumber] isValid? ${s.isValid}`),s},c=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const r=u(e,t),n=e.substring(r.length);return t.phoneNumberUtil.convertAlphaCharactersInNumber(r)+n},u=(e,t)=>{if(!t.phoneNumberUtil)return t.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!t.phoneNumberUtil}`),e;const r=t.phoneNumberUtil.EXTN_PATTERN_,n=e.search(r);return n>=0?e.substring(0,n):e},p=(e,t,r,n,s)=>{const{userLocale:i,logger:a,phoneNumberUtil:o,phoneNumberFormat:l}=r;if(!o||!l)return a.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}, isPhoneNumberFormatDefined=${!!l}`),e;const d=t||l.INTERNATIONAL,c=C(e,r,"parseAndFormatNumber");if(!I(c,r,s))return c;try{if(n){const e=o.getInstance().parse(c,i);return o.getInstance().format(e,d)}{const e=o.getInstance().parseAndKeepRawInput(c,i);return o.getInstance().formatInOriginalFormat(e,d)}}catch(e){return a.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),c}},g=(e,t)=>{const{enableFormattingFixForExtension:r}=t;return{diallable:u(e,t),extension:r?m(e,t):h(e,t)}},h=(e,t)=>{const r=C(e,t,"getExtension");return m(r,t)},m=(e,t)=>{const{enablePstnWithExtnFix:r,enableFixForDtmfTone:n,logger:s,userLocale:i,phoneNumberUtil:a}=t;if(!a)return s.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!a}`),"";if(!r&&!n&&!I(e,t))return s.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return a.getInstance().parse(e,i).getExtension()||""}catch(e){return s.error("Failed to parse and format a phone number",e),""}},f=(e,t,r,n)=>{const{logger:i}=t;let a=`${s.C.Pstn}${e}`;return r&&(a+=`${s.C.PstnExtension}${r}`),i.log(`[generateMriForPstn] context: ${n} Generated MRI: ${a} for dialOutNumber: ${e} ${r?`and extension: ${r}`:""}`),a},I=(e,t,r)=>{const{userLocale:n,logger:s,phoneNumberUtil:i}=t;if(!i)return s.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!i}`),!1;if(!e)return!1;try{const s=C(e,t,"isStandardFormatNormalized"),a=i.getInstance().parse(s,n),o=i.getInstance().isPossibleNumber(a);return r?o:o&&i.getInstance().isValidNumber(a)}catch(e){return s.error("[isStandardFormatNormalized] error:",e),!1}},C=(e,t,r)=>{const{isDialPlansEnabled:n,logger:s}=t;s.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${r}`);const i=(0,o.tv)(e);return n?T(i,t).normalized:i},T=(e,t)=>{const{normalizationRules:r,logger:n,coreSettings:s,ituCountryPrefix:a}=t,o={normalized:e,diallable:e,display:e};if(!r.length)return o;const l=new i.g(r,a,n,s).normalize(e);return o.normalized=l.phoneNumber,o.diallable=l?.phoneNumber,o.display=l?.phoneNumber,o.isInternalExtension=l?.isInternalExtension,o.isValid=l.isNormalized,o},y=(e,t,r,s,i)=>{let a;if(!(0,n.isEmpty)(e)){const t=s?.getInstance().getRegionCodeForCountryCode(Number(e));if(t)return a=t.toLowerCase(),r.log(`Setting locale based on dial plan to ${a}`),a}const o=i?.()||t||"en-US";return o?(a=o.substring(o.indexOf("-")+1).toLowerCase(),r.log(`Setting locale based on teams locale to ${a}`),a):(r.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},S=async(e,t,n,s)=>{const i=e.get(a.w.Calling);let o;try{o=await(async(e,t)=>{let n;try{const s=()=>r.e(725236).then(r.t.bind(r,787838,23));n=await(0,l.wg)(s,"libphonenumber-bundle",t),e.log("[getLibPhoneNumber] Loaded @microsoft/google-libphonenumber.")}catch(t){return e.errorToTelemetry?.(`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. Name: ${t?.name}, Message: ${t?.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${t?.message}`)}return n})(n,s)}catch(e){return n.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!i.allowNonE164Mri,isDialPlansEnabled:!!i.enableDialPlans,enablePstnWithExtnFix:!!i.enablePstnWithExtnFix,normalizationRules:i.dialPlanPolicy?.normalizationRules||[],ituCountryPrefix:i.dialPlanPolicy?.ituCountryPrefix||"",enableFormattingFixForExtension:!!i.enableFormattingFixForExtension,userLocale:y(i.dialPlanPolicy?.ituCountryPrefix||"",t,n,o.PhoneNumberUtil),enableFixForDtmfTone:!!i.enableFixForDtmfTone,logger:n,phoneNumberUtil:o.PhoneNumberUtil,phoneNumberFormat:o.PhoneNumberFormat,coreSettings:e}}},391091:(e,t,r)=>{r.d(t,{g:()=>i});var n=r(401368),s=r(621634);class i{constructor(e,t,r,n){this.iTUCountryPrefix=t,this.logger=r,this.coreSettings=n,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){let t=i.removeFormatCharacters(e);t=i.removeGuid(t);const r=this.coreSettings?.get(n.w.Calling);if(this.logger?.log(`[normalize] Feature flag: stopNormalizationOnPlus=${r?.stopNormalizationOnPlus}`),r?.stopNormalizationOnPlus&&t.startsWith("+"))return this.logger?.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:t,isNormalized:!0};let a=1;for(const r of this.normalizeRules){const{pattern:n,translation:s,isInternalExtension:i}=r;if(n.test(t)){const r=t.replace(n,s);return this.logger?.log(`[normalize] [${e}] was normalized into [${r}] using rule ${a} of ${this.normalizeRules.length}: ruleExpression=[${n}] translation=[${s}] isInternalExtension=[${i}].`),{phoneNumber:r,isInternalExtension:i,isNormalized:!0}}a++}if(this.logger?.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${r?.addCountryCodeDuringNormalization}].`),r?.addCountryCodeDuringNormalization&&!t.startsWith("+")&&(0,s.wk)(t)){const n=this.iTUCountryPrefix||r.dialPlanPolicy?.ituCountryPrefix,s=n?`+${n}`:"",i=`${s}${t}`;return this.logger?.log(`[normalize] [${e}] was normalized into [${i}] by adding country code [${s}].`),{phoneNumber:i,isNormalized:!!s}}return{phoneNumber:t}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const t of e)try{this.normalizeRules.push({pattern:new RegExp(t.pattern),translation:t.translation,isInternalExtension:t.isInternalExtension})}catch(e){this.invalidRules.push(t.pattern)}}}},621634:(e,t,r)=>{r.d(t,{Ku:()=>s,QA:()=>i,h4:()=>a,vk:()=>c,Iy:()=>u,IK:()=>p,KM:()=>g,kZ:()=>h,tv:()=>m,wk:()=>f});var n=r(24114);const s=e=>Boolean(e&&e.startsWith(n.C.Pstn)),i=e=>e.some((e=>s(e))),a=e=>!(!e||![n.C.AcsUser,n.C.AcsGcchUser].some((t=>e.startsWith(t)))),o=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,l=/^\+?\d*[ ]*(\([ ]*\d+[ ]*\))?[0-9 -]+((?:;ext=([0-9]{1,7})|[ \t,]*(?:e?xt(?:ensi(?:o?|))?n?|??|[,x#~]|int|anexo|)[:\.]?[ \t,-]*([0-9]{1,7})#?|[- ]+([0-9]{1,5})#))?$/i,d=e=>e.indexOf("_"),c=e=>{if(!s(e))return!1;const t=e.slice(n.C.Pstn.length);return-1!==d(t)},u=(e,t)=>o.test(e)&&t,p=e=>{let t=e.slice(n.C.Pstn.length);const r=d(t);return-1!==r&&(t=t.slice(0,r)),t},g=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:"",h=e=>e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,""),m=e=>{const t=(e=>e.replace(/[ \(\)\-_\/]+/g,""))(h(e));return t},f=e=>l.test(e?.trim())},506222:(e,t,r)=>{r.d(t,{M3:()=>o,xu:()=>l,Yf:()=>d,rq:()=>c,UP:()=>u,iw:()=>p,Me:()=>g,wR:()=>h,SK:()=>f});var n=r(813415),s=r(345081),i=r(136864);const a=[{name:"Default"},{name:"Light",code:57339},{name:"MediumLight",code:57340},{name:"Medium",code:57341},{name:"MediumDark",code:57342},{name:"Dark",code:57343}],o=(e,t,r=!1,s=!0,i=!1)=>{if("CustomEmoji"===e.__typename)return e.shortcuts[0];const o=e.description;if(!e.id||!s&&!r)return o;const{id:l,skinTone:d}=(0,n.lj)(e.id);let c=e.shortcuts?.[0]??`(${l})`;if(i&&c.match(I)){const e=s&&t?.emoticonAriaOpeningParenthesis||"left paranthesis",r=s&&t?.emoticonAriaClosingParenthesis||"right paranthesis";c=c.replace(/\(/,`${e} `).replace(/\)/,` ${r}`)}if(e.diverse){const e=(t&&t[`emoticonSkintone${a[d].name}`])??"";return r?f(t?.emoticonCombinedSkintoneTitle??"",{name:o,skinTone:e,shortName:c}):f(t?.emoticonNameWithSkintone??"",{name:o,skinTone:e})}return r?f(t?.emoticonCombinedTitle??"",{name:o,shortName:c}):o},l=e=>"TeamsEmoji"===e?.__typename||"Emoticon"===e?.__typename,d=e=>l(e)?e.description:e.shortcuts[0],c=(e,t,r,i)=>s.g_.has(e)?(0,n.ym)(u(e,t,r),"small",{enableSkypeCMSEmoticons:t,pesEmoticonCdnAssetsUrl:i},!0):void 0,u=(e,t,r=!1)=>(t?r?(0,i.$)(e):s.g_.get(e):s.$v.get(e))??e,p=(e,t,r,n,s)=>{h(r,s).forEach((r=>{const s=c(r,e,n,t);if(s){(new Image).src=s}}))},g=e=>s.dq.get(e)?.unicode||s.mL.get(e)?.unicode||void 0,h=(e,t)=>Array.isArray(t)&&e?t:Array.from(s.g_.keys()),m=/\{\{([a-zA-Z]+)\}\}/g,f=(e,t)=>e?e.replace(m,((e,r)=>t[r]||e)):"",I=/^\({1}\w+\){1}$/},136864:(e,t,r)=>{r.d(t,{a:()=>i,$:()=>a});const n=new Map([["like","likeWithFaceMSER"],["star","starMSER"],["yes","like"]]),s=new Map([["like","yes"],["likeWithFaceMSER","like"],["starMSER","star"]]),i=e=>n.get(e)??e,a=e=>s.get(e)??e},137727:(e,t,r)=>{r.d(t,{gz:()=>n,q4:()=>s,bH:()=>i,qz:()=>a,D8:()=>o,S2:()=>l,LH:()=>d,UV:()=>c,Cm:()=>u,yT:()=>p});const n=100,s=60,i=20,a=24,o=30,l=40,d=16,c=50,u="CustomEmoji",p="recent"},813415:(e,t,r)=>{r.d(t,{au:()=>a,ym:()=>o,uj:()=>l,av:()=>d,DK:()=>c,zq:()=>u,NS:()=>p,lj:()=>g});var n=r(137727),s=r(345081);const i=new Map([["angry","angryV2"]]),a=(e,t=void 0)=>"legacy"===t?e.emoticonCdnAssetsUrl??"https://statics.teams.cdn.office.net/evergreen-assets/skype/v2":e.pesEmoticonCdnAssetsUrl??"https://statics.teams.cdn.office.net/evergreen-assets/personal-expressions/v2/assets/emoticons",o=(e,t,r,n=!0,s="",o=!1,c=!1,u=null)=>{const h=c?d(t,u,o):l(t,o),{id:m,skinTone:f}=g(e),I=0!==f?`_s${f+1}`:"";if(!r||!r.enableSkypeCMSEmoticons&&p(m)&&0===f||c){let e=i.get(m)||m;return p(m)||(e=`${e}${I}`),`${a(r,"legacy")}/${e}/${h}${n?"a":""}.png`}{const e=n?"_anim":"",t=s&&""!==s?`?v=${s}`:"";return`${a(r,"skype")}/${m}/default/${h}${e}_f${I}.png${t}`}},l=(e,t=!1)=>{switch(e){case"extra-large":return n.gz;case"large":return t?n.gz:n.UV;case"medium":return t?n.q4:n.D8;case"medium-large":return t?n.gz:n.S2;case"extra-small":return t?n.bH:n.LH;default:return t?n.UV:n.bH}},d=(e,t=null,r=!1)=>{const n=c(e,t);return r?2*n:n},c=(e,t=null)=>{switch(e){case"meeting-giant":return t?.xxxLargeIconSize||224;case"meeting-jumbo":return t?.xxLargeIconSize||168;case"meeting-overlay":return t?.overlayIconSize||64;case"extra-large":return t?.xLargeIconSize||140;case"large":return t?.largeIconSize||112;case"medium":return t?.mediumIconSize||84;case"small":return t?.smallIconSize||56;case"extra-small":return t?.xSmallIconSize||42;default:return t?.xxSmallIconSize||32}},u=(e,t)=>{switch(e){case n.gz:return t?n.gz:n.UV;case n.q4:return n.UV;case n.UV:return n.D8;case n.D8:return t?n.qz:n.bH;default:return e}},p=e=>s.dq.has(e)||s.mL.has(e),g=e=>{const t=e.match(/(?=^.{0,40}$)(\S+)-tone(\d)/);return t&&3===t.length?{id:t[1],skinTone:Number.parseInt(t[2],10)}:{id:e,skinTone:0}}},345081:(e,t,r)=>{r.d(t,{dq:()=>n,mL:()=>s,g_:()=>i,$v:()=>a,em:()=>o});const n=new Map([["smile",{unicode:"",shortcuts:[":)",":-)",":=)","(smile)"],duration:2.2083,steps:53}],["laugh",{unicode:"",shortcuts:[":d",":-d",":=d","(laugh)",":>",":->","(lol)"],duration:3.2083,steps:77}],["heart",{unicode:"",shortcuts:["(heart)","<3"],duration:.7083,steps:16}],["kiss",{unicode:"",shortcuts:["(kiss)",":*",":-*",":=*","(xo)"],duration:2.875,steps:50}],["sad",{unicode:"",shortcuts:[":(",":-(",":=(","(sad)",":<",":-<"],duration:2.625,steps:63}],["tongueout",{unicode:"",shortcuts:[":p",":-p",":=p","(tongueout)","(yum)"],duration:2.9583,steps:71}],["wink",{unicode:"",shortcuts:[";)",";-)",";=)","(wink)"],duration:1.5,steps:36}],["cry",{unicode:"",shortcuts:[";(",";-(",";=(","(cry)",":'("],duration:2.0833,steps:50}],["inlove",{unicode:"",shortcuts:["(inlove)","(love)",":]",":-]"],duration:2.625,steps:63}],["hug",{unicode:"",shortcuts:["(hug)","(bear)"],duration:3.1667,steps:76}],["cwl",{unicode:"",shortcuts:["(cwl)","(cryingwithlaughter)"],duration:2.5417,steps:61}],["lips",{unicode:"",shortcuts:["(lips)"],duration:3.7083,steps:89}],["blush",{unicode:"",shortcuts:[":$",":-$",":=$",':">',"(blush)"],duration:2.875,steps:69}],["surprised",{unicode:"",shortcuts:[":o",":-o",":=o","(surprised)"],duration:2.8333,steps:68}],["penguin",{unicode:"",shortcuts:["(penguin)","(dancingpenguin)","(penguindance)"],duration:2.6667,steps:64}],["yes",{unicode:"",shortcuts:["(y)","(yes)","(thumbsup)"],duration:1.6667,steps:40}],["cool",{unicode:"",shortcuts:["(cool)","8-)","8=)","b-)","b=)","(sunglasses)"],duration:1.5833,steps:38}],["rofl",{unicode:"",shortcuts:["(rofl)","(rotfl)"],duration:3.375,steps:81}],["cat",{unicode:"",shortcuts:["(cat)","(meow)","(kitty)"],duration:5,steps:120}],["monkey",{unicode:"",shortcuts:["(monkey)","(ape)"],duration:2.0833,steps:50}],["hi",{unicode:"",shortcuts:["(wave)","(hi)","(bye)"],duration:2.375,steps:57}],["snowangel",{unicode:"",shortcuts:["(snowangel)"],duration:2.5,steps:60}],["flower",{unicode:"",shortcuts:["(flower)"],duration:3.4583,steps:83}],["giggle",{unicode:"",shortcuts:["(chuckle)","(giggle)"],duration:1.875,steps:45}],["devil",{unicode:"",shortcuts:["(devil)"],duration:2.7917,steps:67}],["party",{unicode:"",shortcuts:["(party)","<o)","<:o)"],duration:2.9583,steps:71}],["worry",{unicode:"",shortcuts:["(worry)",":s",":-s",":=s","(worried)","(scared)"],duration:2.3333,steps:56}],["champagne",{unicode:"",shortcuts:["(champagne)","(sparkling)"],duration:2.5833,steps:62}],["sun",{unicode:"",shortcuts:["(sun)"],duration:1.0833,steps:26}],["star",{unicode:"",shortcuts:["(star)"],duration:2.6667,steps:64}],["polarbear",{unicode:"",shortcuts:["(polarbear)","(polarbearhug)"],duration:5,steps:120}],["dull",{unicode:"",shortcuts:["|-(","|(","|=(","(dull)","(eyeroll)"],duration:3.2083,steps:77}],["speechless",{unicode:"",shortcuts:[":|",":-|",":=|","(speechless)"],duration:2.7917,steps:67}],["wonder",{unicode:"",shortcuts:[":^)","(wonder)","(skeptical)"],duration:2.9167,steps:70}],["angry",{unicode:"",shortcuts:["(angry)",":@",":-@",":=@","x(","x-(","x=(",";@",";-@","(rage)"],duration:4.375,steps:105}],["puke",{unicode:"",shortcuts:["(puke)",":&",":-&",":=&","+o("],duration:3.2917,steps:79}],["facepalm",{unicode:"",shortcuts:["(facepalm)","(fail)"],duration:3.2083,steps:77}],["sweat",{unicode:"",shortcuts:["(:|","(sweat)"],duration:2.875,steps:69}],["holidayspirit",{unicode:"",shortcuts:["(holidayspirit)","(crazyxmas)","(crazychristmas)"],duration:1.5,steps:36}],["sleepy",{unicode:"",shortcuts:["|-)","i-)","i=)","(snooze)","(sleepy)","(sleeping)"],duration:3,steps:72}],["bow",{unicode:"",shortcuts:["(bow)"],duration:2.5,steps:60}],["makeup",{unicode:"",shortcuts:["(makeup)"],duration:4.5,steps:108}],["cash",{unicode:"",shortcuts:["(cash)","(money)"],duration:1.125,steps:27}],["lipssealed",{unicode:"",shortcuts:[":x",":-x",":#",":-#",":=x",":=#","(lipssealed)"],duration:2.0833,steps:50}],["shivering",{unicode:"",shortcuts:["(shivering)","(cold)","(freezing)"],duration:7.9167,steps:190}],["cake",{unicode:"",shortcuts:["(cake)"],duration:4.125,steps:99}],["headbang",{unicode:"",shortcuts:["(headbang)","(banghead)"],duration:2.9583,steps:71}],["dance",{unicode:"",shortcuts:["o/",":d/","(dance)"],duration:8.5833,steps:206}],["wasntme",{unicode:"",shortcuts:["(wasntme)"],duration:3.1667,steps:76}],["hungover",{unicode:"",shortcuts:["(hungover)"],duration:3.0417,steps:73}],["yawn",{unicode:"",shortcuts:["(yawn)"],duration:3.0833,steps:74}],["gift",{unicode:"",shortcuts:["(gift)"],duration:.5417,steps:13}],["angel",{unicode:"",shortcuts:["(angel)"],duration:3.5,steps:84}],["xmastree",{unicode:"",shortcuts:["(xmastree)","(christmastree)"],duration:1.125,steps:27}],["brokenheart",{unicode:"",shortcuts:["(brokenheart)"],duration:4.375,steps:105}],["think",{unicode:"",shortcuts:["(think)",":-?",":?",":=?","*-)"],duration:2.4583,steps:59}],["clap",{unicode:"",shortcuts:["(clap)"],duration:1.6667,steps:40}],["punch",{unicode:"",shortcuts:["(punch)","*|","*-|"],duration:1.8333,steps:44}],["envy",{unicode:"",shortcuts:["(envy)"],duration:2.8333,steps:68}],["handshake",{unicode:"",shortcuts:["(handshake)"],duration:2.5833,steps:62}],["nod",{unicode:"",shortcuts:["(nod)"],duration:2.125,steps:51}],["nerdy",{unicode:"",shortcuts:["(nerd)","8-|","b-|","8|","b|","8=|","b=|","(nerdy)"],duration:2,steps:48}],["emo",{unicode:"",shortcuts:["(emo)"],duration:2.25,steps:54}],["muscle",{unicode:"",shortcuts:["(flex)","(muscle)"],duration:2.4583,steps:59}],["mmm",{unicode:"",shortcuts:["(mm)","(mmm)","(mmmm)"],duration:3.875,steps:93}],["highfive",{unicode:"",shortcuts:["(highfive)","(hifive)","(h5)"],duration:1.5833,steps:38}],["turkey",{unicode:"",shortcuts:["(turkey)","(turkeydance)"],duration:2.0833,steps:50}],["call",{unicode:"",shortcuts:["(call)"],duration:1.9167,steps:46}],["movember",{unicode:"",shortcuts:["(movember)","(moustache)","(mustache)",":{"],duration:4.5833,steps:110}],["dog",{unicode:"",shortcuts:["(dog)"],duration:2.25,steps:54}],["coffee",{unicode:"",shortcuts:["(coffee)"],duration:1.1667,steps:28}],["poke",{unicode:"",shortcuts:["(poke)","(nudge)"],duration:3.125,steps:75}],["swear",{unicode:"",shortcuts:["(swear)"],duration:3.2083,steps:77}],["donttalktome",{unicode:"",shortcuts:["(donttalk)","(donttalktome)"],duration:2.5,steps:60}],["fingerscrossed",{unicode:"",shortcuts:["(fingers)","(fingerscrossed)","(crossedfingers)"],duration:2.6667,steps:64}],["rainbow",{unicode:"",shortcuts:["(rainbow)"],duration:.8333,steps:20}],["headphones",{unicode:"",shortcuts:["(headphones)"],duration:3.5,steps:84}],["waiting",{unicode:"",shortcuts:["(waiting)"],duration:2.125,steps:51}],["festiveparty",{unicode:"",shortcuts:["(festiveparty)"],duration:3.0417,steps:73}],["heidy",{unicode:"",shortcuts:["(squirrel)","(heidy)"],duration:3.125,steps:75}],["beer",{unicode:"",shortcuts:["(beer)"],duration:3.1667,steps:76}],["doh",{unicode:"",shortcuts:["(doh)"],duration:2.5,steps:60}],["bomb",{unicode:"",shortcuts:["(bomb)","(explosion)","(explode)"],duration:7.1667,steps:172}],["happy",{unicode:"",shortcuts:["(happy)"],duration:2.9167,steps:70}],["ninja",{unicode:"",shortcuts:["(ninja)"],duration:5.0833,steps:122}]]),s=new Map([["angryface",{unicode:"",shortcuts:[],duration:4.375,steps:105,pastName:"angry"}],["smileeyes",{unicode:"",shortcuts:[],duration:2.875,steps:69}]]),i=new Map([["like","yes"],["heart","heart"],["laugh","laugh"],["surprised","surprised"],["sad","sad"],["angry","angry"]]),a=i,o=new Map([["laughV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["laughV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV2-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehand-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["heartV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["yesV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["clapV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["surprisedV3-3D",{unicode:"",shortcuts:[],duration:2.125,steps:51}],["raisehandV3-3D",{unicode:"",shortcuts:[],duration:2.0833,steps:51}],["laughV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["heartV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["clapV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["surprisedV4-3D",{unicode:"",shortcuts:[],duration:4.25,steps:102}],["yesGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["yesGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}],["raisehandGestureLoading",{unicode:"",shortcuts:[],duration:1.5417,steps:37}],["raisehandGestureComplete",{unicode:"",shortcuts:[],duration:4.7083,steps:113}]])},270456:(e,t,r)=>{r.d(t,{R4:()=>g,IZ:()=>u,A_:()=>h});var n=r(957032),s=r(513432),i=r(959022);const a={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",width:"1px",position:"absolute"},o=s.forwardRef((({assertive:e,targetDocument:t,host:r},o)=>{const[l,d]=s.useState(""),c=s.useRef(),u=r??window,p=/Mac|iPod|iPhone|iPad/.test(u.navigator.platform),g=s.useCallback((e=>{d(e),null!==c.current&&u.clearTimeout(c.current),c.current=u.setTimeout((()=>{d(""),null!==c.current&&u.clearTimeout(c.current),c.current=null}),2e3)}),[c,u,d]);s.useImperativeHandle(o,(()=>({announce:g}))),s.useEffect((()=>()=>{null!==c.current&&u.clearTimeout(c.current)}),[c,u]);const h=t?t.body:u.document.body;let m=null;if(p){const e=t?t.activeElement:u.document.activeElement;m=e?.closest("*[aria-modal='true']")}const f=m||h;return i.createPortal((0,n.Y)("div",{"aria-live":e?"assertive":"polite","aria-atomic":"true",style:a,children:l}),f)}));var l=r(35871),d=r(106255),c=r(879749);const u=({children:e,targetDocument:t})=>{const r=(0,c.ur)();return(0,n.Y)(p,{host:r?.host,targetDocument:t,children:e})},p=({children:e,targetDocument:t,host:r})=>{const i=s.useRef(),a=s.useRef(),c=s.useCallback(((e,t)=>{const r=t?a.current:i.current;r&&r.announce(e)}),[a,i]),u=s.useMemo((()=>({announce:c})),[c]),p=s.useMemo((()=>({announce:(e,t)=>{const r=!!t&&!t.polite;c(e,r)}})),[c]);return(0,n.Y)(s.Fragment,{children:[(0,n.Y)(o,{assertive:!1,ref:i,targetDocument:t,host:r}),(0,n.Y)(o,{assertive:!0,ref:a,targetDocument:t,host:r}),(0,n.Y)(l.AnnounceProvider,{value:p,children:(0,n.Y)(d.AriaLiveContext.Provider,{value:u,children:e})})]})},g=d.AriaLiveContext.Consumer,h=()=>s.useContext(d.AriaLiveContext)},862606:(e,t,r)=>{r.d(t,{ab:()=>h,SX:()=>m,IN:()=>f,eh:()=>I,Qz:()=>C,Ur:()=>T});var n=r(957032),s=r(513432),i=r(911293),a=r(888591),o=r(728858),l=r(85966);const{useCallback:d,useEffect:c,useMemo:u,useRef:p,useState:g}=s,h=e=>{const{layoutPhaseStateMachineRef:t}=(0,l.yf)(),r=t.current,n=p(r),[s,d]=g(r.currentPhase>=e),h=u((()=>n.current.currentPhaseObservable.pipe((0,i.T)((t=>t>=e)),(0,a.F)())),[e,n]),m=(0,o.J)(h,{next:s?()=>s:d},!0);return c((()=>()=>m()),[m]),s&&m(),n.current===r||s?s||n.current.currentPhase>=e||r.currentPhase>=e:(d(!0),!0)},m=e=>{const{layoutPhaseStateMachineRef:t}=(0,l.yf)();return d((()=>t.current.currentPhase>=e),[t,e])},f=()=>{const{reportFirstPaintCallbackRef:e}=(0,l.yf)();e.current()},I=({component:e,fallback:t,minimumAppPhase:r})=>s=>h(r)?(0,n.Y)(e,{...s}):t?(0,n.Y)(t,{}):null,C=()=>{const{useAppPhasePostCriticalOnEveryPhaseCycle:e}=(0,l.yf)();return e()},T=()=>{const{useAppPhaseCompleteOnEveryPhaseCycle:e}=(0,l.yf)();return e()}},85966:(e,t,r)=>{r.d(t,{Sz:()=>c,yf:()=>u});var n=r(957032),s=r(513432),i=r(591831);const{createContext:a,memo:o,useContext:l}=s,d=a(void 0),c=o((({children:e,...t})=>(0,n.Y)(d.Provider,{value:(0,i.F)(t),children:e}))),u=()=>l(d)},844126:(e,t,r)=>{r.d(t,{t:()=>l});var n=r(957032),s=r(513432),i=r(879749),a=r(912435);class o extends s.PureComponent{constructor(e){super(e),this.render=()=>{const{children:e,fallbackUI:t=null}=this.props,{error:r}=this.state;return r?"function"==typeof t?t(r,this.resetError.bind(this)):t:e},this.handleError=(e,t)=>{if((0,a.XC)(e))throw e;const{errorHandler:r,onErrorCallback:n,scenarios:s,rethrowError:i,loggerName:o}=this.props;if(n&&n(e),r){if(r(e,t),i)throw e;return}let l="";try{l=JSON.stringify(e)}catch(t){l=`Failed to stringify error: ${e}`}if(s?.forEach((e=>{e.fail({reason:`Error in ${o}: ${l}`})})),this.logger.error(`error: \n    ${l}\n    componentStack: \n    ${t.componentStack}`),i)throw e};const{loggerName:t,newLogger:r}=this.props;this.state={error:null},this.logger=r(t,"components-error-boundary")}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){this.logger.error(`Error message: ${e?.message}.`),this.handleError(e,t)}resetError(){this.setState({error:null})}}const l=e=>(0,n.Y)(o,{...e,newLogger:(0,i.ur)().loggerFactory.newLogger})},468376:(e,t,r)=>{r.d(t,{e:()=>a});var n=r(513432),s=r(337917);class i extends n.Component{constructor(e){super(e),this.mounted=!1;const{i18n:t,namespace:r,namespaces:n}=e,s=(n||[]).filter((e=>!t.isNamespaceLoaded(e)));!r||t.isNamespaceLoaded(r)||s.includes(r)||s.push(r),this.state={namespacesToLoad:s}}componentDidMount(){const{i18n:e}=this.props;this.mounted=!0;const t=()=>{this.mounted&&this.setState((t=>({namespacesToLoad:t.namespacesToLoad.filter((t=>!e.isNamespaceLoaded(t)))})))};this.state.namespacesToLoad.length&&Promise.all(this.state.namespacesToLoad.map((t=>e.waitForNamespace(t)))).then(t).catch(t)}componentWillUnmount(){this.mounted=!1}render(){const{loaderRenderer:e,children:t}=this.props;return this.state.namespacesToLoad.length?e?e():null:t||null}}const a=(0,s.z)(i)},337917:(e,t,r)=>{r.d(t,{z:()=>i,D:()=>a});var n=r(957032),s=r(619761);const i=e=>t=>(0,n.Y)(s.I18nContext.Consumer,{children:r=>(0,n.Y)(e,{...{...t,i18n:r}})}),a=i},516902:(e,t,r)=>{r.d(t,{R:()=>c});var n=r(513432),s=r(141512),i=r(370118),a=r(873063),o=r(827767),l=r(35871),d=r(81868);const c=n.forwardRef(((e,t)=>{const r=(0,s.d)(e,t),n=(0,d.I)();return r.root.className=(0,i.z)(n.dialogBody,r.root.className),(0,a.$)(r),(0,l.useCustomStyleHook_unstable)("useDialogBodyStyles_unstable")(r),(0,o.k)(r)}))},854005:(e,t,r)=>{r.d(t,{E:()=>u});var n=r(513432),s=r(677861),i=r(710865),a=r(370118),o=r(85081),l=r(474281),d=r(35871),c=r(81868);const u=n.forwardRef(((e,t)=>{const r=(0,s.W)(e,t),n=(0,i.l)(r),u=(0,c.I)();return r.root.className=(0,a.z)(u.dialogSurface,r.root.className),(0,o.e)(r),(0,d.useCustomStyleHook_unstable)("useDialogSurfaceStyles_unstable")(r),(0,l.V)(r,n)}))},64143:(e,t,r)=>{r.d(t,{B:()=>a,s:()=>o});var n=r(957032),s=r(513432),i=r(370118);const a="fui-Primitive",o=s.forwardRef((function(e,t){const{as:r="div",...s}=e,o="string"==typeof e.children?"auto":void 0,l=(0,i.z)(a,e.className);return(0,n.Y)(r,{dir:o,...s,className:l,ref:t})}))}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/797200-904653d0ded3e356.js.map