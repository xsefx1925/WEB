"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[671442],{183985:(e,t,n)=>{n.d(t,{eW:()=>s,fH:()=>i,ER:()=>o,TE:()=>a,GO:()=>E,iy:()=>r,sz:()=>S,xv:()=>_});const s=5,i="CommonSubstrateService",o={APP_NAME:"Microsoft Teams",TOKEN_URL:"https://outlook.office.com/",AFD_BASE_URL:"https://teams.microsoft.com",SUBSTRATE_BASE_URL:"https://substrate.office.com",SUBSTRATE_SDF_BASE_URL:"https://substrate-sdf.office.com",SCENARIOS:{POWERBAR:"powerbar",FILE_ATTACH_RECOMMENDATIONS:"teamsDesktop.AttachFile",TFL_POWERBAR:"TFL.powerbar"},END_POINT:{SUBSTRATE_WARMUP:{V1:"search/api/v1/init?cvid={conversationId}&scenario={scenario}",V2:"search/api/v2/init?cvid={conversationId}&scenario={scenario}"},QUERY:{V2:"search/api/v2/query"},EVENTS:"search/api/v1/events?scenario={scenarioName}",SUGGESTIONS:{V1:"search/api/v1/suggestions?scenario={scenario}",DELETE:"search/api/v1/searchhistory"},SUGGESTIONS_GET:{V1:"search/api/v1/suggestions?scenario={scenario}&query=&cvid={cvid}&logicalId={logicalId}"},RECOMMENDATIONS:{V1:"search/api/v1/recommendations"},SUMMARIZATION:{V2:"CommCopilot/api/v3/summarize",AUTH:"commcopilot"},UKB:{ALL_SCORES:{BASE_URL:"https://substrate.office.com",PATH:"/userknowledgebase/v1.0/{currentUserUpn}/teams/affinityscore"}}},DEFAULT_V1_HEADERS:{"Content-Type":"application/json"},DEFAULT_HEADERS:{"Content-Type":"application/json","X-Client-Flights":"SearchV2Flight,SubstrateSearchFanoutFlight","X-Client-UI-Language":"userLocale"},CLIENT_FLIGHTS:{INTER_TENANT_SHARED_CHANNEL:"PERTENANTPFT,DsapiMemGrpCall,TMSUseRefiningQueries",NUOWO_FLIGHT_FOR_ALL_AND_MESSAGE:"TeamsSearchOnNuowoFlight",KEEP_ALIVE_DISABLED:"KeepAliveDisabledFlight",KEEP_ALIVE_ENABLED:"KeepAliveEnabledFlight",NUOWO_FLIGHT:"nuowoflight",ENABLE_QUERYASSIST_AUTOSUGGEST:"PeopleAsTextSuggestion",ENABLE_ANSWERS_WARMUP:"EnableAnswersWarmup",REQUEST_FILE_META_DATA_EXTENSION:"RequestFileMetaDataExtension",ENABLE_SELF_CHAT_SUGGESTION:"EnableSelfSuggestion",REC_ENABLE_MERGE_MESSAGES:"recEnableMergeMessages",ENABLE_TEAMS_HIDDEN_PEOPLE_DIRECTORY_SEARCH:"TeamsHiddenPeopleDirectorySearch",ENABLE_FILE_CHICLET_TRIGGER_CONTROL:"FileChicletTriggerControl",ENABLE_STATIC_HISTORY_QUERY_SUGGESTIONS:"IncludeHistoryInBMStatic",ENABLE_DYNAMIC_HISTORY_QUERY_SUGGESTIONS:"IncludeHistoryInBMDynamic",ENABLE_KPE_QUERY_SUGGESTIONS:"KPEinTD",ENABLE_PK_QUERY_SUGGESTIONS:"PeopleKeywordAsTextSuggestion",ENABLE_PERSON_QUERY_SUGGESTIONS:"TDPeopleSynthetic",ENABLE_SYNTHETIC_DYNAMIC_ORDERING:"syntvar2",ENABLE_WPS_QUERY_SUGGESTIONS:"BookmarksOnTeamsPowerBar",ENABLE_MESSAGE_KPE_TEAMS:"EnableMessageKPEinTeams",ENABLE_MESSAGE_KPE_BM:"EnableMessageKPEinBM",BACKFILL_WITH_MESSAGE_KPE:"BackfillWithMessageKPEs",ENABLE_LAST_SLOT_FOR_MESSAGE_KPE:"EnableLastSlotForMessageKPE",ADD_SLOT_FOR_MESSAGE_KPE:"AddSlotForMessageKPEinBM",ENABLE_MESSAGE_SUGGESTION_WARMUP:"EnableMsgSggInTeams",QUERY_MICROSERVICE_FLIGHT:"QueryMicroservice",ENABLE_FILES_TAB_NEW_FILTER_EXPERIENCE:"EnableFileFiltersViaKQL",DISABLE_REMOVE_GROUPID:"DisableShouldRemoveGroupIdWhenChannelFilterIsPresent",ENABLE_KQL_SUGGESTIONS:"EnableKql"},SERVER_FLIGHTS:{ENABLE_ADDITIONAL_PROPERTIES_FOR_TEAMS_CHAT:"AdditionalPropertiesForTeamsChat",REC_DISABLE_EXCHANGE_ATTACHMENTS:"recDisableExchangeAttachments",REC_DISABLE_RECEIVED_EXCHANGE_ATTACHMENTS:"recDisableReceivedExchangeAttachments",REC_ENABLE_5_RESULTS_IN_RESPONSE:"recEnable5ResultsInResponse",REC_SA_DOC_RANK_THRESHOLD_4_COMPOSE:"recSaDocumentRankingThreshold4Compose",REC_ENABLE_IS_TEAMS_MESSAGE:"recEnableIsTeamsMessage",REC_DISABLE_LOCALE_CHECK:"recDisableLocaleCheck",ENABLE_TEAMS_CHATS_GRAPH_SELECT:"TeamsChatsGraphSelect",ENABLE_TEAMS_GRAPH_CI_BASE_GRAMMAR:"TeamsGraphCIBaseGrammar",ENABLE_TEAMS_CHATS_MATCHING_MEMBERS:"TCCMatchingMembers",ENABLE_REMOVE_CHATS_WITHOUT_RELATION:"RemoveChatWithoutRelations",MERGE_TEAMS_AND_CHANNELS:"MergeTeamsAndChannelsPowerbar",DISABLE_MPL_SUPPRESSION:"TurnOffMPLSuppressionTeams",ENABLE_TEAMS_CHANNELS_DOMAIN:"EnableTeamsChannelDomainPowerbar",ENABLE_ED_USERS:"ServeEdContactsFromEdShards",ENABLE_IMAGE_SEARCH:"EnableMessageImageSearch"},HEADER_KEYS:{ANCHOR_MAILBOX:"x-anchormailbox",TIMESTAMP:"X-Client-LocalTime",CLIENT_ID:"clientRequestId",CLIENT_REQUEST_ID:"client-request-id",CLIENT_REQUEST_ID_V1:"Client-Request-Id",CLIENT_SESSION_ID:"client-session-id",CLIENT_SESSION_ID_V1:"Client-Session-Id",CONTENT_TYPE:"Content-Type",X_ANCHOR_MAILBOX:"X-AnchorMailbox",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_SESSION_ID:"x-ms-session-id",X_CLIENT_FLIGHTS:"X-Client-Flights",X_CLIENT_UI_LANGUAGE:"X-Client-UI-Language",X_CAFE_LATENCY_HEADER_ENABLED:"X-CafeLatencyHeaderEnabled",X_CLIENT_VERSION:"X-Client-Version",X_ROUTINGPARAMETER_SESSIONKEY:"X-RoutingParameter-SessionKey"},QUERY_PARAMS:{SET_FLIGHT:"setflight",DOMAIN_SCOPE:"domainscope"},QUERY_ANNOTATIONS:{PCS_DATASOURCE:"personScoped",PCS_DIMENSIONS:{Dimensions:[{DimensionName:"QueryType",DimensionValue:"PeopleCentricSearch"}]}}},a=3e4,E="$$",r="kqlPicker",S=2,_=2},305367:(e,t,n)=>{n.d(t,{OH:()=>a,E9:()=>E,_B:()=>r,mQ:()=>S,_t:()=>_,ER:()=>l,nP:()=>T,Gc:()=>c,Ci:()=>A,Eq:()=>I,O$:()=>p,XD:()=>d,CK:()=>R,iB:()=>C,$L:()=>N,gZ:()=>m,Pl:()=>u,KM:()=>L,V$:()=>O,b:()=>g,He:()=>h,Vs:()=>D,Oz:()=>P,zw:()=>M,as:()=>y,P1:()=>F,_n:()=>U,uI:()=>f,Uk:()=>v,TA:()=>H,mJ:()=>G,VX:()=>x,Vz:()=>B,uX:()=>W,_z:()=>b,r_:()=>k,gn:()=>w,LC:()=>Y,y7:()=>V,Td:()=>K,lq:()=>Q,h:()=>$,W$:()=>X,_2:()=>q,CU:()=>z,Xn:()=>j,LW:()=>Z,WG:()=>J,yY:()=>ee,ij:()=>te,TE:()=>ne,aS:()=>se,dD:()=>ie,i7:()=>oe,wZ:()=>ae,zj:()=>Ee,b$:()=>re,j8:()=>Se,G0:()=>_e,DV:()=>le,yH:()=>Te,u6:()=>ce,BZ:()=>Ae,sD:()=>Ie,KZ:()=>pe,hK:()=>de,y5:()=>Re,Pu:()=>Ce,g$:()=>Ne,CX:()=>me,lN:()=>ue,cJ:()=>Le,LQ:()=>Oe,KT:()=>ge,nE:()=>he,OK:()=>De,lp:()=>Pe,b7:()=>Me,VQ:()=>ye,DG:()=>Fe,Eu:()=>Ue,t$:()=>fe});var s=n(608378),i=n(183985),o=n(968634);const a="DateTime",E={DEFAULT_HEADERS:{"X-ClientType":"MicrosoftTeams","X-ClientScenario":"TeamsSearch"}},r={FROM:"From",WITH:"With"},S={CONTENT_SOURCES:{SHAREPOINT:s.Y.SharePoint,ONEDRIVE:s.Y.OneDriveForBusiness,EXCHANGE:s.Y.Exchange},DEFAULT_HEADERS:{"Content-Type":"application/json"},DEFAULT_REFINING_QUERY:"or(andnot(IsDocument:true,Title:or(OneNote_DeletedPages,OneNote_RecycleBin),SecondaryFileExtension:onetoc2,FileExtension:vtt,ContentClass:ExternalLink,and(ContentClass:STS_List_DocumentLibrary,SiteTemplateId:21),FileType:or(aspx,htm,html,mhtml),and(ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*,PromotedState:2)),ContentTypeId:or(0x010100F3754F12A9B6490D9622A01FE9D8F012,0x0120D520A808*),SecondaryFileExtension:or(wmv,avi,mpg,asf,mp4,ogg,ogv,webm,mov),FileType:or(ai,bmp,dib,dst,emb,eps,gif,ico,jpeg,jpg,odg,png,rle,svg,tiff,webp,wmf,wpd))",REFINER_STRING_NUOWO_FILES:"AllStorageProviderContexts:or(11,12)",ENTITY_REQUESTS_FIELDS:["DefaultEncodingUrl","FileName","FileType","HitHighlightedSummary","LastModifiedTime","LinkingUrl","ModifiedBy","OriginalPath","Path","Title","ServerRedirectedPreviewUrl","SpWebUrl","ChannelGroupId","FileExtension","VisualizationAccessURL","LastSharedWithMailboxOwnerByDisplayName","LastSharedWithMailboxOwnerDateTime","FileContextType","ClassicAttachmentVisualizationUrl","UniqueId"],ENTITY_REQUESTS_FIELDS_DEPRECATED:["SiteName","Size","Annotations","ListId","SiteId","WebId","ParentLink","ContentClass"],ENABLE_QUERY_UNDERSTANDING:!1,ENTITY_TYPE:"File",ENABLE_SPELLER:!1,EXTENDED_QUERIES_SEARCH_PROVIDER:"SharePoint",EXTENDED_QUERIES__QUERY:{SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",EnableQueryRules:!1,TrimDuplicates:!1,BypassResultTypes:!0,ProcessBestBets:!1,ProcessPersonalFavorites:!1,EnableInterleaving:!1,EnableMultiGeo:!0,RankingModelId:"ABBAABBA-AAAA-AAAA-CCCC-000000000426"},HITHIGHLIGHT:{HitHighlightedProperties:["HitHighlightedSummary"],SummaryLength:200},IDFORMAT:"EwsId",PASER_TYPE:"None",PROPERTY_SET:"Optimized",RESULTSMERGE:{Type:"Interleaved"},SORT:[{Field:"PersonalScore",SortDirection:"Desc"}],QUERY_ALTERATION_OPTIONS:{EnableAlteration:!1,EnableSuggestion:!0},TEXT_DECORATIONS:"Off",ANNOTATIONS_COUNT:1},_={QUERY_ALTERATION_OPTIONS:{EnableAlteration:!0,EnableSuggestion:!0}},l=(S.ENABLE_QUERY_UNDERSTANDING,S.ENABLE_SPELLER,S.PASER_TYPE,S.PROPERTY_SET,S.SORT,o.ck.File,S.EXTENDED_QUERIES_SEARCH_PROVIDER,S.EXTENDED_QUERIES__QUERY,{MESSAGES_TOP_RESULTS_COUNT:3,EMAILS_TOP_RESULTS_COUNT:3,TOKEN_URL:"https://outlook.office.com/",AFD_BASE_URL:"https://teams.microsoft.com",SUBSTRATE_BASE_URL:"https://substrate.office.com",SCENARIOS:{POWERBAR:"powerbar"},END_POINT:{SUBSTRATE_WARMUP:{V1:"search/api/v1/init?cvid={conversationId}&scenario={scenario}",V2:"search/api/v2/init?cvid={conversationId}&scenario={scenario}"},QUERY:"search/api/v2/query",QUERY_SEARCH_SERVICE:"searchservice/api/v2/query",SUGGESTIONS:{V1:"search/api/v1/suggestions"},EVENTS:"search/api/v1/events",BIZ_CHAT_HAND_OFF:"search/api/v1/prompts/link"},MAX_PAGE_SIZE:{MESSAGES:10,FILES:25,FILES_GRID:24,EMAILS:25,MEETINGS:25,TEAMS_CHANNELS:25,GROUP_CHATS:25,PEOPLE:25},DEFAULT_HEADERS:{"Content-Type":"application/json","X-Client-Flights":"SearchV2Flight,SubstrateSearchFanoutFlight,lutmsearchmsg,TMSParseRefiningQueries","X-Client-UI-Language":"userLocale"},CLIENT_FLIGHTS:{INTER_TENANT_SHARED_CHANNEL:"PERTENANTPFT,DsapiMemGrpCall,TMSUseRefiningQueries",TIMING_HEADER:"TimingHeaderFlightForTeams",ADD_SOFT_DELETE_FILTER:"AddSoftDeleteFilter",LSS_TIMEOUT_FLIGHT:"UpdateLssTimeoutFlight",BING_SPELLER_FLIGHT:"EnableBingSpeller",NUOWO_FLIGHT_FOR_ALL_AND_MESSAGE:"TeamsSearchOnNuowoFlight",USE_DSAPI_GROUP_IDS_FLIGHT:"UseDSAPIGroupIds",NUOWO_FLIGHT_FOR_FILES:"nuowoflight",FILTER_BOT_MESSAGES_ON_TEAMS_FLIGHT:"FilterBotMessagesOnTeamsFlight",KEEP_ALIVE_DISABLED:"KeepAliveDisabledFlight",KEEP_ALIVE_ENABLED:"KeepAliveEnabledFlight",NUOWO_FLIGHT_FOR_EMAILS:"nuowoflight",BOOST_ODB_FILES_FLIGHT:"ODBMergerBias10",DYNAMIC_RANKING_WPR:"DynamicWpc",DISABLE_BUILT_IN_AUGMENTATION_FLIGHT:"ShouldDisableSeperateBuiltInAugmentationsFlight",SINGLE_CALL_TOP_ANSWER:"WprForTeamsDesktop",CALENDER_ANSWER_CONFLICTS:"CalendarAnswerConflicts",CALENDER_ANSWER_HIT_HIGHLIGHT:"EnableCalendarHitHighlight",CALENDER_INSIGHTS_FLIGHT:"CalendarInsightsFlight",FETCH_FILE_ARTIFACTS:"FetchFileArtifacts",TCS_PROPERTIES:"TCSProperties",DYNAMIC_EMAIL_CONVERSATION_WPC:"DynamicEmailConversationWpc",TEAMS_DESKTOP_EMAIL_SEARCH_WPR:"TeamsDesktopEmailSearchWPR",PAYLOAD_REDUCTION:"enableSubstrateFileSearchPayloadReduction",DISABLE_TEAMS_SHARED_FILES_FILTER:"DisableTeamsSharedFilesFilter",WPR_DYNAMIC_SIZE:"WPRDynamicSizing",BROTLI_FLIGHT:"UseBrotliCompression",SHORTEN_CAPTIONS:"nwShortenCaptionsForTeamsCtrlfSearch",ENABLE_PUBLIC_GROUP_FILES_IN_TEAMS_FLIGHT:"EnablePublicGroupFilesInTeamsFlight",LONG_CAPTION_LENGTH_NEW_CARDS:"nwLongCaptionsForNewSerp",ENABLE_MULTIPLE_EVENTS_ANSWER:"TeamsDesktopEventsDomain",HYPERLINK_ANNOTATION_CAPTION:"nwHyperlinkFlight",CONTEXT_REGION_TOPIC_ANSWER:"MsbRrTopic",CONTEXT_REGION_WPR:"WPRTDContextRegion,AaDisableSuppressLowScoringAnswers",CONTEXT_REGION_ACRONYM_ANSWER:"WPRTDAcronymContextRegion",CONTEXT_REGION_MULTI_ANSWERS:"WPRMaxNumEntitiesSupportedInContextRegion2",CONTEXT_REGION_SINGLE_ANSWERS:"WPRMaxNumEntitiesSupportedInContextRegion1",CONTEXT_REGION_BOOKMARK_ANSWER:"WPRTDBookmarkContextRegion",CONTEXT_REGION_EMA_ANSWER:"WPRTDEMAContextRegion,TeamTuringPAAAnswer,PAAMergeAndRank",EMAIL_CLASSIC_ATTACHMENTS_FOR_TEAMS_FLIGHT:"EnableCAForTeamsFlight",EMAIL_CLASSIC_ATTACHMENTS_FOR_TEAMS_CONTROL_FLIGHT:"EnableCAForTeamsFlight-CF",CONTEXT_REGION_CONNECTOR_ANSWER:"WPRTDConnectorContextRegion",REQUEST_FILE_META_DATA_ENTENSTION:"RequestFileMetaDataExtension",ENABLE_FILE_CHICLET_TRIGGER_CONTROL:"FileChicletTriggerControl",ENABLE_GC_RANKING_WPR:"TDEnableRankGroupChatWpr",ENABLE_GC_DYNAMIC_RANKING_WPR1:"GroupChatDynamicRankingWpr1",ENABLE_GC_DYNAMIC_RANKING_WPR2:"GroupChatDynamicRankingWpr2",ENABLE_TnC_RANKING_WPR:"TDEnableRankTeamsChannelsWpr",ENABLE_TnC_DYNAMIC_RANKING_WPR1:"TeamsChannelsDynamicRankingWpr1",ENABLE_TnC_DYNAMIC_RANKING_WPR2:"TeamsChannelsDynamicRankingWpr2",BOOST_WSET_RESULTS:"BoostWsetResults",ENABLE_NEW_FILE_TIDBITS_FLIGHT:"EnableTeamsRankerInRAS",ENABLE_HIT_HIGHLIGHTED_SUMMARY_REMOVAL:"RemoveHitHighlightedSummary",ENABLE_AI_TOPICS_IN_CONTEXTUAL_SEARCH:"enableAITopicsInContextualSearch",ENABLE_CONVERSATION_GROUPING:{FLIGHT1:"CollapseConversationsForTeamsMessage",FLIGHT2:"EnableUseCustomIdAsTheImmutableId"},ENABLE_CONVERSATION_MATCHING:{FLIGHT1:"nwBFTMSConversatioMatch",FLIGHT2:"nwBFTMSConvMatchV2",FLIGHT3:"nwBFTMSConvMatchQueryAlt",FLIGHT4:"nwBFTMSCMTimeWindow240"},DYNAMIC_REFINERS_CLIENT_FLIGHT:"TeamsDynamicRefinersClientV1",FAKE_CONVERSATION_UX_FLIGHT:"FakeConversationUXFlight",QUERY_MICROSERVICE_FLIGHT:"QueryMicroservice",ENABLE_SMS_MESSAGES:"EnableSmsMessages",WPR_EVENT_BOP:"WprEventBop",DISABLE_LSS_WORKFLOW_FROM_CALENDAR_ANSWER:"ShouldExecuteLssWorkflowFromCalAnswerC",ENABLE_FILES_TAB_NEW_FILTER_EXPERIENCE:"EnableFileFiltersViaKQL",DISABLE_REMOVE_GROUPID:"DisableShouldRemoveGroupIdWhenChannelFilterIsPresent"},HEADER_KEYS:{ANCHOR_MAILBOX:"x-anchormailbox",TIMESTAMP:"X-Client-LocalTime",CLIENT_ID:"clientRequestId",CLIENT_REQUEST_ID:"client-request-id",CLIENT_SESSION_ID:"client-session-id",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_SESSION_ID:"x-ms-session-id",X_CLIENT_FLIGHTS:"X-Client-Flights",X_END2ENDLATENCYMS:"x-end2endlatencyms",X_CLIENT_VERSION:"X-Client-Version",X_ROUTINGPARAMETER_SESSIONKEY:"X-RoutingParameter-SessionKey"},MESSAGE_SEARCH:{ENTITY_TYPE_MESSAGE_CONVERSATION:o.ck.Conversation,ENTITY_TYPE_CONTEXTUAL_SEARCH:o.ck.ConversationTitle,SORT:[{Field:"Score",SortDirection:"Desc"}],DEFAULT_REQUEST_BODY:{entityType:o.ck.Message,contentSources:[s.Y.Teams],fields:["Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String","Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String","Extension_SkypeSpaces_ConversationPost_Extension_SkypeGroupId_String","Extension_SkypeSpaces_ConversationPost_Extension_SenderTenantId_String"],propertySet:"Optimized"},REQUEST_BODY_WITH_MESSAGE_SUBTYPE:{fields:["Extension_SkypeSpaces_ConversationPost_Extension_MessageSubType_String"]},REQUEST_BODY_WITH_PARENT_MESSAGE_ID:{FIELDS:["Extension_SkypeSpaces_ConversationPost_Extension_ParentMessageId_String"]},REQUEST_BODY_WITH_FILE_CHICLET:{entityType:o.ck.Message,contentSources:[s.Y.Teams],fields:["Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String","Extension_SkypeSpaces_ConversationPost_Extension_FileData_String","Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String","Extension_SkypeSpaces_ConversationPost_Extension_SkypeGroupId_String","Extension_SkypeSpaces_ConversationPost_Extension_SenderTenantId_String"],propertySet:"Optimized"},REQUEST_BODY_WITH_FILE_CHICLET_AND_IMAGESRC:{entityType:o.ck.Message,contentSources:[s.Y.Teams],fields:["Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String","Extension_SkypeSpaces_ConversationPost_Extension_FileData_String","Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String","Extension_SkypeSpaces_ConversationPost_Extension_SkypeGroupId_String","Extension_SkypeSpaces_ConversationPost_Extension_SenderTenantId_String","Extension_SkypeSpaces_ConversationPost_Extension_ImageSrc_String"],propertySet:"Optimized"},IMAGE_PREVIEW_ENTITY_FIELDS:["Extension_SkypeSpaces_ConversationPost_Extension_ImageSrc_String","Extension_SkypeSpaces_ConversationPost_Extension_AmsReferences_StringArray"]},EMAIL_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.Conversation,contentSources:[s.Y.Exchange],fields:["ParentFolderDisplayName"],propertySet:"Optimized"},SORT:[{Field:"Time",SortDirection:"Desc"}]},TEAM_CHANNEL_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.TeamsChannel,contentSources:[s.Y.Teams],HitHighlight:{HitHighlightedProperties:["HitHighlightedSummary"],SummaryLength:200},fields:[]},CHANNEL_COUNTS:{SUBSTRATE_TC:21,PRIVATE:2,SHARED:2,RENAMEDGENERAL:3}},MEETING_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.Event,contentSources:[s.Y.Exchange],supportedResultSourceFormats:["EntityData"],preferredResultSourceFormat:"EntityData",fields:[]}},GROUP_CHAT_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.Chat,contentSources:[s.Y.Teams],propertySet:"Optimized",fields:[]}},CONTEXTUAL_SEARCH_AI_TOPICS_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.ConversationTitle,contentSources:[s.Y.Teams],propertySet:"Optimized",fields:[]}},WARMUP_THROTTLE_MINUTES:5,SCENARIO_DIMENSION_VALUE:{WEB:"Web"},PEOPLE_SEARCH:{CONTENT_SOURCES:s.Y.Exchange,DEFAULT_REQUEST_BODY:{entityType:o.ck.People,Filter:{And:[{Or:[{Term:{Flags:"NonHidden"}}]},{Or:[{Term:{PeopleType:"Person"}},{Term:{PeopleType:"Other"}}]},{Or:[{Term:{PeopleSubtype:"OrganizationUser"}},{Term:{PeopleSubtype:"Guest"}},{Term:{PeopleSubtype:"Room"}}]}]}},FIELDS:["DisplayName","EmailAddresses","Department","CompanyName","OfficeLocation","Phones","JobTitle","PeopleType","PeopleSubtype","MRI","UserPrincipalName","HomeTenantName","HomeMRI","MTOLabel"]},DYNAMIC_REFINERS_CONFIG:{MIN_COUNT:0,MAX_COUNT:5}}),T={TODAY:"today",YESTERDAY:"yesterday",THIS_WEEK:"thisWeek",LAST_WEEK:"lastWeek",TWO_WEEKS_AGO:"twoWeeksAgo",THIS_MONTH:"thisMonth",LAST_MONTH:"lastMonth",THIS_YEAR:"thisYear",LAST_YEAR:"lastYear"},c={TODAY:"today",YESTERDAY:"yesterday",THIS_WEEK:"thisWeek",THIS_MONTH:"thisMonth"},A={TODAY:"today",YESTERDAY:"yesterday",LAST_SEVEN_DAYS:"lastSevenDays",LAST_FOURTEEN_DAYS:"lastFourteenDays",NEXT_SEVEN_DAYS:"nextSevenDays",NEXT_FOURTEEN_DAYS:"nextFourteenDays"},I={LIST:"list",CUSTOM:"custom"},p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=9,R={USERS_SEARCH_URL:"beta/users/searchV2",END_POINT:{INIT:{V1:"v1/suggestions/init"},SUGGESTIONS:{V1:"v1/suggestions",DELETE:"search/api/v1/searchhistory"},SUGGESTIONS_SOURCE:{V1:"v1/suggestions/{source}"}},DEFAULT_HEADERS:{"Content-Type":"application/json;charset=UTF-8"}},C={BASE_URL:"https://microsoft.sharepoint.com",DEFAULT_HEADERS:{Accept:"application/json","Content-Type":"application/json","X-ClientType":"SkypeTeams_FileSearch"},END_POINT:{FILE_SEARCH:"search/_api/search/postquery"}},N={Excel:"filetype:xls filetype:xlsx fileExtension:xls fileExtension:xlsx",PowerPoint:"filetype:ppt filetype:pptx fileExtension:ppt fileExtension:pptx",Word:"filetype:doc filetype:docx fileExtension:doc fileExtension:docx",Images:"filetype:png filetype:jpg filetype:jpeg filetype:gif fileExtension:png fileExtension:jpg fileExtension:jpeg fileExtension:gif",OneNote:"filetype:one fileExtension:one","Text file":"filetype:txt fileExtension:txt",PDF:"filetype:pdf fileExtension:pdf",Loop:"filetype:fluid filetype:loop fileExtension:fluid fileExtension:loop"},m={And:[{Or:[{Term:{Flags:"NonHidden"}}]},{Or:[{Term:{PeopleType:"Person"}},{Term:{PeopleType:"Other"}}]},{Or:[{Term:{PeopleSubtype:"OrganizationUser"}},{Term:{PeopleSubtype:"MTOUser"}},{Term:{PeopleSubtype:"Guest"}},{Term:{PeopleSubtype:"Room"}}]}]},u="Author",L="LastModifiedTime",O="GroupId",g="RelatedGroupId",h="ChannelGroupId",D="sent",P="hasattachment",M="mentions",y="from",F="Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String",U="Extension_SkypeSpaces_ConversationPost_Extension_Topic_String",f="clientthreadid",v="clientthreadid",H="(Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String:(topic OR space))",G="OneToOne",x="ResultSets",B="QueryAlterationResponse.QueryAlteration.AlteredQuery.RawString",W="QueryAlterationResponse.QueryAlterationType",b="QueryAlterationResponse.QueryAlteration.AlteredQuery.ReferenceId",k="Suggestion",w="@unq.gbl.spaces;messageid=",Y="messageid=",V="clientthreadid",K={PEOPLE_SEARCH_SERVICE:"ReactSERPServices:PeopleSearchService",SEARCH_SUBSTRAE_FILE_SERVICE:"ReactSERPServices:SearchSubstrateFileService",SHAREPOINT_SEARCH_SERVICE:"ReactSERPServices:SharepointSearchService",SUBSTRATE_SEARCH_SERVICE:"ReactSERPServices:SubstrateSearchService",LOKI_METAPREVIEW_SERVICE:"ReactSERPServices:LokiMetapreviewService",OSEARCH_SEARCH_SERVICE:"ReactSERPServices:OSearchSearchService",ODC_FILEPREVIEW_SERVICE:"ReactSERPServices:OdcFilePreviewService"},Q="https://loki.delve.office.com",$={FETCHED_FROM_CACHE:"Fetched from service cache"},X={MAX_PAGE_SIZE:25,DEFAULT_HEADERS:{"Content-Type":"application/json",Accept:"application/json"},HEADER_KEYS:{SKYPETOKEN:"X-SkypeToken",TIMESTAMP:"X-Client-LocalTime",CLIENT_ID:"clientRequestId"},CONVERSATION_TYPE:{ONETOONE:"OneToOne",GROUP:"Group"},SEARCH_TYPE:{MESSAGE:"osearch_messages",FILE:"osearch_files"},P2P_FILES_LIST_PAGE_SIZE:50},q={dateEqOperation:"eq",dateGtOperation:"gt",dateLtOperation:"lt",annotations:{mentions:"mentions",at:"at",files:"files",URIObject:"URIObject"}},z=5e3,j=1033,Z="https://api.onedrive.com/v1.0/shares/",J="/driveItem/thumbnails/0/large/content",ee="service::lw.onedrive.com::MBI_SSL",te="WLID1.1",ne=3e4,se="retry-after",ie=2,oe=5e3,ae=5e3,Ee=2,re="long",Se="en-us",_e="reactSearch",le="orgid:",Te=-30,ce=30,Ae=365,Ie="to",pe="Contextual",de=25,Re={MESSAGE:{[o.mf.Medium]:8,[o.mf.High]:10},PEOPLE:{[o.mf.Medium]:10,[o.mf.High]:12},FILE:{[o.mf.Medium]:5,[o.mf.High]:8},EMAIL:{[o.mf.Medium]:5,[o.mf.High]:8}},Ce="Microsoft.OutlookServices.Message",Ne={SERVICE_RECOURSE_REQUEST:"serviceRecourseRequest",SERVICE_RECOURSE_REQUEST_IS_SAME_QUERY_STRING:"serviceRecourseRequest.IsSameQueryString",SEARCH_RESULT_LAYOUT:"searchResultLayout"},me="V3",ue=6,Le="autosuggest",Oe=i.GO,ge={Id:"Id",P:"Provenance",CS:"ContentSource",RI:"ReferenceId",HHS:"HitHighlightedSummary",R:"Rank",SK:"SearchKey",SOS:"SortOrderSource",S:"Source",T:"Type",RST:"ResultSearchType",Source:"Source"},he={FSI:"SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId",FD:"SkypeSpaces_ConversationPost_Extension_FileData",TT:"SkypeSpaces_ConversationPost_Extension_ThreadType",SGI:"SkypeSpaces_ConversationPost_Extension_SkypeGroupId",STI:"SkypeSpaces_ConversationPost_Extension_SenderTenantId"},De={[o.ck.Message]:{Id:"Id",SOS:"SortOrderSource",II:"ItemId",AT:"AnnouncementTitle",CCI:"ClientConversationId",CTI:"ClientThreadId",DTS:"DateTimeSent",DT:"DisplayTo",HA:"HasAttachments",I:"Importance",IMI:"InternetMessageId",PFDN:"ParentFolderDisplayName",P:"Preview",S:"Sender",SB:"Subject",CI:"ConversationId",CT:"ConversationTopic",F:"From",MP:"MentionsPreview",CN:"ChannelName",TN:"TeamName",BFCGI:"BigFunnelConversationGroupIndex",E:"Extensions",Extensions:"Extensions"},[o.ck.File]:{DEU:"DefaultEncodingUrl",FN:"FileName",FT:"FileType",LMT:"LastModifiedTime",HHS:"HitHighlightedSummary",LU:"LinkingUrl",MB:"ModifiedBy",OP:"OriginalPath",P:"Path",T:"Title",SRPU:"ServerRedirectedPreviewUrl",LI:"ListId",SI:"SiteId",SWU:"SpWebUrl",UI:"UniqueId",WI:"WebId",PL:"ParentLink",CC:"ContentClass",CGI:"ChannelGroupId",FE:"FileExtension",FCT:"FileContextType",VAU:"VisualizationAccessURL",LSMODN:"LastSharedWithMailboxOwnerByDisplayName",LSMODT:"LastSharedWithMailboxOwnerDateTime",CAVU:"ClassicAttachmentVisualizationUrl",A:"Annotations",SN:"SiteName",S:"Size",AOU:"AuthorOWSUSER",C:"Created",EOU:"EditorOWSUSER",DI:"DocId",SEC:"SortByExpression_CustomComputedUserDiscoveryFacetPartial",FFC:"FileFromCI"},[o.ck.People]:{ID:"Id",DN:"DisplayName",GN:"GivenName",SN:"Surname",EA:"EmailAddresses",CN:"CompanyName",D:"Department",OL:"OfficeLocation",P:"Phones",JT:"JobTitle",IA:"ImAddress",PT:"PeopleType",PST:"PeopleSubtype",ADO:"ADObjectId",MRI:"MRI",UPN:"UserPrincipalName",C:"Confidence",EDO:"ExternalDirectoryObjectId",T:"Text",QT:"QueryText",S:"Score",PH:"PropertyHits",FD:"FeatureData",CS:"ConfidenceScore",UID:"UniqueId",HTN:"HomeTenantName",HMRI:"HomeMRI"}};var Pe;!function(e){e.Extensions="Extensions",e.Source="Source"}(Pe||(Pe={}));const Me={L1_SEARCH_MESSAGES:"MessagesConversation",L2_SEARCH_FROM_ALL:"AllConversationL2",L2_SEARCH_FROM_MESSAGES:"MessagesConversationL2"},ye={xls:"Excel",xlsx:"Excel",ppt:"PowerPoint",pptx:"PowerPoint",doc:"Word",docx:"Word",png:"Image",jpg:"Image",jpeg:"Image",gif:"Image",one:"OneNote",txt:"Text",pdf:"PDF",loop:"Loop",fluid:"Loop"},Fe={GRID:"grid",LIST:"list"},Ue={MESSAGES:"messages",PEOPLE:"People",MEETINGS:"Meetings"};var fe;!function(e){e.ORGANIZATION_USER="OrganizationUser",e.GUEST="Guest",e.ROOM="Room",e.IMPLICIT_CONTACT="ImplicitContact",e.PERSONAL_CONTACT="PersonalContact"}(fe||(fe={}))},968634:(e,t,n)=>{var s,i,o,a,E,r,S,_,l;n.d(t,{ol:()=>s,ck:()=>i,IS:()=>o,AC:()=>a,mf:()=>E,I_:()=>r,Cy:()=>S,ME:()=>_,uU:()=>l}),function(e){e.Teams="Teams",e.CalendarEvent="CalendarEvent",e.Mail="Mail"}(s||(s={})),function(e){e.Message="Message",e.Documents="Documents",e.Bookmarks="Bookmarks",e.People="People",e.Keywords="Keywords",e.Text="Text",e.File="File",e.Conversation="Conversation",e.Event="Event",e.AnswerBlock="AnswerBlock",e.Channel="Channel",e.Chat="Chat",e.Link="Link",e.TeamsChannel="TeamsChannel",e.PeopleAlsoAsk="PeopleAlsoAsk",e.Team="Team",e.Community="Community",e.None="None",e.ConversationTitle="ConversationTitle",e.EngageCommunity="EngageCommunity"}(i||(i={})),function(e){e.p2p="p2p",e.customspo="customspo",e.aggregatefiles="aggregatefiles",e.downloads="downloads",e.teams="teams",e.recent="recent",e.personal="personal",e.teamsSdk="teamsSdk"}(o||(o={})),function(e){e.Query="Query",e.Display="Display"}(a||(a={})),function(e){e.Normal="normal",e.Medium="medium",e.High="high"}(E||(E={})),function(e){e.High="High",e.Normal="Normal"}(r||(r={})),function(e){e.ChatContextualSearch="ChatContextualSearch",e.ChannelContextualSearch="ChannelContextualSearch",e.MetaOSContextualSearch="MetaOSContextualSearch",e.ConversationBasedSearchMessagesL1View="ConversationBasedSearchMessagesL1View",e.ConversationBasedSearchMessagesL2View="ConversationBasedSearchMessagesL2View"}(S||(S={})),function(e){e.TabSwitch="TabSwitch",e.AllTabToL2Conversation="AllTabToL2Conversation",e.MessagesTabToL2Conversation="MessagesTabToL2Conversation",e.Powerbar="Powerbar"}(_||(_={})),function(e){e.AllResultsWithPersonRefiner="AllResultsWithPersonRefiner",e.KeywordWithPersonRefiner="KeywordWithPersonRefiner",e.KeywordExtractedFromPersonKeywordRefiner="KeywordExtractedFromPersonKeywordRefiner",e.FileTypeWithPersonRefiner="FileTypeWithPersonRefiner",e.FileTypeWithKeywordRefiner="FileTypeWithKeywordRefiner",e.FileTypeWithPersonKeywordRefiner="FileTypeWithPersonKeywordRefiner",e.AllKpeRefiner="AllKpeRefiner",e.FilesKpeRefiner="FilesKpeRefiner"}(l||(l={}))},643642:(e,t,n)=>{n.d(t,{m:()=>o});var s=n(480354),i=n(305367);const o=(()=>{let e={};const t={};return{retrieve:(t,n)=>(0,s.get)(e,`domains.${t}.pagesData.${n}`,null),store:(t,n,i)=>((e,t,n,i)=>{const o=(0,s.get)(e,"instrumentationData.logicalId","");(0,s.set)(e,`domains.${t}.pagesData.${n}`,{results:i,logicalId:o})})(e,t,n,i),retrieveFeedbackLogicalId:(t,n)=>(0,s.get)(e,`feedback.${t}.pagesData.${n}`,null),storeFeedbackLogicalId:(t,n,i)=>{(0,s.set)(e,`feedback.${t}.pagesData.${n}`,i)},retrieveReplyChain:t=>((e,t)=>{const{teamId:n,convId:i,replyChainId:o,messageId:a,sentTime:E}=t;return(0,s.get)(e,`replyChains.${n};${i};${o};${a};${E}`,null)})(e,t),storeReplyChain:t=>((e,t)=>{const{teamId:n,convId:i,replyChainId:o,messageId:a,sentTime:E,data:r}=t;(0,s.set)(e,`replyChains.${n};${i};${o};${a};${E}`,r)})(e,t),getPostAuthor:t=>((e,t)=>(0,s.get)(e,`domains.messages.pagesData.${t}.postAuthorMris`,null))(e,t),setPostAuthor:(t,n)=>((e,t,n)=>(0,s.set)(e,`domains.messages.pagesData.${t}.postAuthorMris`,n))(e,t,n),retrieveReplyChainForPost:(t,n,i)=>((e,t,n,i)=>(0,s.get)(e,`replyChainsForPost.${t};${n};${i}`,null))(e,t,n,i),storeReplyChainForPost:(t,n,i,o)=>((e,t,n,i,o)=>(0,s.set)(e,`replyChainsForPost.${t};${n};${i}`,o))(e,t,n,i,o),getInstrumentationData:()=>(0,s.get)(e,"instrumentationData",{}),setInstrumentationData:(t,n,i,o,a)=>((e,t,n,i,o,a)=>{const E=(0,s.get)(e,"instrumentationData",{});(0,s.set)(e,"instrumentationData",{...E,...n&&{conversationId:n},...i&&{userId:i},...o&&{tenantId:o},...t&&{logicalId:t},...a&&{callerInfo:a}})})(e,t,n,i,o,a),setUpstreamTelmetryIds:(t,n)=>(0,s.set)(e,"upstreamTelemetryIds",{correlationId:t,searchStartCorrelationId:n}),clearUpstreamTelemetryIds:()=>(0,s.set)(e,"upstreamTelemetryIds",null),getUpstreamTelemetryIds:()=>(0,s.get)(e,"upstreamTelemetryIds",{}),retrieveFilePreview:t=>(0,s.get)(e,`filepreview.${t}`,null),storeFilePreview:(t,n)=>(0,s.set)(e,`filepreview.${t}`,n),clear:()=>e=(e=>({...e,domains:null,replyChains:null,replyChainsForPost:null}))(e),clearAll:()=>e={},clearDomain:t=>(0,s.set)(e,`domains.${t}`,null),setLoading:(e,n)=>(0,s.set)(t,`domains.${e}.dataPromise`,n),getLoading:e=>(0,s.get)(t,`domains.${e}.dataPromise`,null),clearLoading:e=>(0,s.set)(t,`domains.${e}`,null),setServiceRecourseRequest:t=>((e,t)=>{(0,s.set)(e,i.g$.SERVICE_RECOURSE_REQUEST,t)})(e,t),getServiceRecourseRequest:()=>(e=>(0,s.get)(e,i.g$.SERVICE_RECOURSE_REQUEST,null))(e),clearServiceRecourseRequest:()=>(e=>{(0,s.set)(e,i.g$.SERVICE_RECOURSE_REQUEST,null)})(e),setSearchResultLayout:(t,n)=>((e,t,n)=>{(0,s.set)(e,i.g$.SEARCH_RESULT_LAYOUT,{layout:t,layoutSetTimestamp:n})})(e,t,n),getSearchResultLayout:()=>(e=>(0,s.get)(e,i.g$.SEARCH_RESULT_LAYOUT,null))(e),clearIsSameQueryString:()=>(e=>{(0,s.get)(e,i.g$.SERVICE_RECOURSE_REQUEST,null)&&(0,s.set)(e,i.g$.SERVICE_RECOURSE_REQUEST_IS_SAME_QUERY_STRING,null)})(e),getNavLocationContext:()=>(e=>(0,s.get)(e,"navLocationContext",null))(e),getSearchStartTime:()=>(e=>(0,s.get)(e,"searchStartTime",null))(e),setNavLocationContext:t=>((e,t)=>{(0,s.set)(e,"navLocationContext",t)})(e,t),setSearchStartTime:t=>((e,t)=>{(0,s.set)(e,"searchStartTime",t)})(e,t),getPCSMode:()=>(e=>(0,s.get)(e,"pcsMode",null))(e),setPCSMode:t=>((e,t)=>{(0,s.set)(e,"pcsMode",t)})(e,t)}})()},478955:(e,t,n)=>{n.d(t,{zL:()=>X,O5:()=>q,b4:()=>z,kq:()=>j,$I:()=>Z,o9:()=>J,XU:()=>ee,Xd:()=>te,K1:()=>ne,a$:()=>se,JJ:()=>ie,WB:()=>oe,Oh:()=>ae,Ql:()=>Ee,qi:()=>re,oB:()=>Se,PA:()=>_e,Ft:()=>le,tj:()=>Te,sn:()=>ce,g5:()=>Ae,ci:()=>Ie,ol:()=>pe,D0:()=>de,dS:()=>Re,Y8:()=>Ce,ro:()=>Ne,tF:()=>me,s0:()=>ue,cK:()=>Le,xc:()=>Oe,es:()=>ge,ef:()=>he,U_:()=>De,D:()=>Pe,q7:()=>Me,r6:()=>ye,zx:()=>Fe,y:()=>Ue,En:()=>fe,m8:()=>ve,LW:()=>He});var s=n(167090),i=n(356477),o=n(682712),a=n(645033),E=n(431944),r=n(538790),S=n(619322),_=n(987803),l=n(107741),T=n(956879),c=n(685847),A=n(24193),I=n(420632),p=n(330705),d=n(179356),R=n(779826),C=n(677654),N=n(496344),m=n(994576),u=n(202628),L=n(298224),O=n(443639),g=n(305005),h=n(521888),D=n(48946),P=n(336085),M=n(225805),y=n(77828),F=n(85617),U=n(290684),f=n(445042),v=n(236233),H=n(439275),G=n(27824),x=n(261097),B=n(673745),W=n(112744),b=n(185264),k=n(269803),w=n(861590),Y=n(521944),V=n(210828),K=n(766077),Q=n(841825),$=n(440716);const X=e=>e instanceof Date?e:new Date(e),q=(e,t)=>X(e).getTime()<=X(t).getTime(),z=e=>(0,i.A)(pe(X(e)),1),j=(e,t=s.ZD.Sunday)=>(0,o.A)(X(e),{weekStartsOn:t}),Z=(e,t=s.ZD.Sunday)=>pe((0,a.A)(X(e),{weekStartsOn:t})),J=e=>0-X(e).getTimezoneOffset(),ee=(e,{hours:t,minutes:n,seconds:s,milliseconds:i})=>{let o=new Date(e);return void 0===t||isNaN(t)||(o=(0,E.A)(o,t)),void 0===n||isNaN(n)||(o=(0,r.A)(o,n)),void 0===s||isNaN(s)||(o=(0,S.A)(o,s)),void 0===i||isNaN(i)||(o=(0,_.A)(o,i)),o},te=(e,{hours:t,months:n,minutes:s,days:o,seconds:a})=>{let E=new Date(e);return void 0===t||isNaN(t)||(E=(0,l.A)(E,t)),void 0===s||isNaN(s)||(E=(0,T.A)(E,s)),void 0===a||isNaN(a)||(E=(0,c.A)(E,a)),void 0===o||isNaN(o)||(E=(0,i.A)(E,o)),void 0===n||isNaN(n)||(E=(0,A.A)(E,n)),E},ne=(e,t)=>te(e,{days:t}),se=(e,t)=>(0,I.A)(X(X(e)),t),ie=(e,t)=>(0,p.A)(X(e),t),oe=e=>e&&e.getTime(),ae=e=>(0,d.A)(X(e))*s.XP+(0,R.A)(X(e)),Ee=(e,t,n)=>{const s=X(t),i=X(e);switch(n){case"hours":return(0,C.A)(s,i);case"minutes":return(0,N.A)(s,i);case"seconds":return(0,m.A)(s,i);case"days":return(0,u.A)(s,i);case"weeks":return(0,L.A)(s,i);case"months":return(0,O.A)(s,i);case"milliseconds":return(0,g.A)(s,i);case"years":return(0,h.A)(s,i);case"calendarDays":return(0,D.A)(s,i)}},re=()=>{try{const e=Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions();return e&&e.timeZone}catch{return""}},Se=(e,t)=>!(!t||t.length<1)&&t.indexOf(X(e).getDay())>-1,_e=e=>{const t=se(new Date(Date.now()),1);return Ne(X(e),t)},le=(e,t)=>(0,P.A)(X(e),X(t)),Te=e=>(0,M.A)(X(e)),ce=e=>(0,y.A)(X(e)),Ae=e=>(0,F.A)(X(e)),Ie=e=>(0,U.A)(X(e)),pe=e=>(0,f.A)(X(e)),de=e=>(0,v.A)(X(e)),Re=(e,t)=>(0,H.A)(X(e),X(t)),Ce=(e,t)=>(0,G.A)(X(e),X(t)),Ne=(e,t)=>(0,x.A)(X(e),X(t)),me=(e,t)=>(0,B.A)(X(e),X(t)),ue=(e,t)=>(0,W.A)(X(e),X(t)),Le=e=>(0,b.A)(X(e)),Oe=e=>(0,k.A)(X(e)),ge=e=>(0,w.A)(X(e)),he=e=>(0,Y.A)(X(e)),De=e=>(0,V.A)(X(e)),Pe=e=>(0,K.A)(X(e)),Me=(e,t="extended",n="complete")=>(0,Q.A)(X(e),{format:t,representation:n}),ye=(e,t)=>(0,$.A)(X(e),t),Fe=(e,t)=>((e=new Date(e)).setMilliseconds(0),t?e.toISOString():Me(e)),Ue=(e,t=0,n=!1)=>{const s=te(new Date(e),{minutes:new Date(e).getTimezoneOffset()+t});return t>0&&n?pe(s):s},fe=e=>{const t=e.indexOf("T");if(t<=0)throw new Error(`Invalid date ${e}`);return`${e.substr(0,t)}T00:00:00.000Z`},ve=(e,t)=>{const n=Ee(e,t,"minutes"),i=Math.floor(n/s.XV),o=n%s.XV;return{durationDays:i,durationHours:Math.floor(o/s.XP),durationMinutes:o%s.XP}},He=e=>{if(!e)return null;switch(typeof e){case"string":try{return new Date(e).toISOString()}catch(t){if(t instanceof RangeError)return new Date(parseInt(e,10)).toISOString()}case"number":return new Date(e).toISOString();default:return null}}},14471:(e,t,n)=>{n.d(t,{bi:()=>s,M5:()=>o,XO:()=>_,kr:()=>I,qU:()=>d,zs:()=>R,fs:()=>C,TY:()=>N,zU:()=>m,wG:()=>u,fV:()=>L,aJ:()=>O,yD:()=>h,T5:()=>D,pc:()=>y});var s,i,o,a=n(259521),E=n(809121),r=n(480354),S=n(364591);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(s||(s={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(i||(i={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(o||(o={}));const _=e=>!!(e&&e.coExistenceMode&&s[e.coExistenceMode]),l=e=>!(e!==s.TeamsOnly),T=e=>!(-1===[s.Islands,s.IslandsWithTempInterop,s.IslandsWithVoipDeepLinking].indexOf(e)),c=e=>!(-1===[s.SfBOnly,s.SfBWithTeamsCollab,s.SfBWithTeamsCollabAndMeetings].indexOf(e)),A=(e,t,n=!1)=>{const s=[a.Vb,a.uM,a.QX,a.Sq,a.Ne,a.gI,a.cA,a.Bh,a.m2,a.Nk,a.zl],i=e.split(":");return s.some((e=>{const s=i.findIndex((t=>t===e.slice(0,-1)));return s>=0&&(n?i.splice(s+1,1):i.splice(s+1,0,t.slice(0,-1)),!0)})),i.join(":")},I=e=>!!e&&(0,r.startsWith)(e,a.gN.SkypeSpacesUser+a.K),p=e=>!!e&&e.includes(a.K)&&!(0,r.startsWith)(e,a.gN.SkypeSpacesUser+a.K),d=e=>!e||p(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.K):void 0,R=e=>!!e&&!(0,r.startsWith)(a.gN.SkypeSpacesUser+a.hh,e)&&e.includes(a.hh),C=e=>!!e&&!(0,r.startsWith)(a.gN.SkypeSpacesUser+a.O,e)&&e.includes(`:${a.O}`),N=e=>!e||C(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.O):void 0,m=e=>!e||R(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.hh):void 0,u=e=>!e||(e=>!!e&&!e.startsWith(a.gN.SkypeSpacesUser+a.OE)&&e.includes(a.OE))(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.OE):void 0,L=e=>{if(e){if(p(e))return A(e,a.K,!0);if(R(e))return A(e,a.hh,!0)}return e},O=e=>e?C(e)?A(e,a.O,!0):void 0:e,g={isAllowed:!1},h=(e,t,n,s,i,o,a,E)=>{const r=a&&a.coExistenceMode,S=o&&o.coExistenceMode;if(!r||!S)return{isAllowed:!0};if(s){const s=((e,t,n,s,i,o,a)=>{const E=a.newLogger("sfb-interop","services-utilities-sfb-interop");return o.isFederated?!s&&n?(E.log("Chat Disabled: current user is not provisioned on Sfb online"),g):o.coExistenceMode&&i.coExistenceMode?e&&n&&l(i.coExistenceMode)&&l(o.coExistenceMode)?{isAllowed:!1,mri:m(o.mri||"")}:n||t||!T(i.coExistenceMode)&&!T(o.coExistenceMode)?!n&&c(o.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:o.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:o.mri}:(E.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(E.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(o))})(e,t,n,i,o,a,E);if(!s.isAllowed)return s}else{const e=((e,t)=>t.coExistenceMode?e&&l(t.coExistenceMode)?{isAllowed:!1,mri:L(t.mri||"")}:!e&&c(t.coExistenceMode)?{isAllowed:!1,mri:d(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(n,a);if(!e.isAllowed)return e}return{isAllowed:!0}},D=e=>{const t=R(e);return P(e)||p(e)||t?(n=e)&&((0,r.startsWith)(n,a.gN.SkypeSpacesUser+a.cA)||(0,r.startsWith)(n,a.gN.SkypeSpacesUser+a.Bh)||(0,r.startsWith)(n,a.gN.SkypeSpacesUser+a.m2)||(0,r.startsWith)(n,a.gN.SkypeSpacesUser+a.Nk)||(0,r.startsWith)(n,a.gN.SkypeSpacesUser+a.zl))?e:t?e.replace(a.hh,""):e.replace(a.K,"").replace(a.v,""):e;var n},P=e=>!!e&&!(0,r.startsWith)(a.gN.SkypeSpacesUser+a.v,e)&&e.includes(a.v),M=(e,t,n,s)=>{const o=e.isFederated,a=(E=e.mri||"",(0,r.endsWith)(E,"@sfbonprem.unq.gbl.spaces"));var E;if(t&&o&&!a&&e.coExistenceMode){const t=i[e.coExistenceMode],o=n===i.TeamsOnly&&t===i.TeamsOnly;return o||s.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${i[n]} recipientCoexistenceMode:${i[t]}`),o}return s.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${o} isOnPremFederated:${a} coExistenceMode:${e.coExistenceMode}`),!1},y=(e,t,n,s,a,r)=>{if(!(e&&e.mri&&e.userType!==S.$o.guest&&e.type!==S.$o.skypeConsumer&&e.type!==S.$o.tflUser&&(0,E.Y$)(e.mri)))return n.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),o.Teams;if(e.isFederated)return n.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),M(e,a,r,n)?o.NativeFederated:o.Federated;const _=((e,t,n)=>{const s=e.coExistenceMode,a=i[s];if(n.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${i[a]}, MT coExistenceMode: ${s}`),i[a]!==s&&n.error(`getUserChatMode - Mapping error - coExistenceMode : ${i[a]}, MT coExistenceMode: ${s}`),a){const e=[i.SfBOnly,i.SfBWithTeamsCollab,i.SfBWithTeamsCollabAndMeetings],t=[i.TeamsOnly,i.Islands,i.IslandsWithVoipDeepLinking];if(e.includes(a))return o.SfB;if(t.includes(a))return o.Teams;n.warn(`getUserChatMode - unknown coExistenceMode ${i[a]}`)}else e.isShortProfile||n.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,n);if(_)return _;const l=I(e.mri),T=e.isSkypeTeamsUser,c=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return n.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${l}, isTeamsChatEnabled: ${c}, hasLoggedInToTeams: ${T}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${s}`),!l&&T&&c||e.isSipDisabled||!s?o.Teams:o.SfB}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/671442-8ac0f8dbe9d8bbf9.js.map