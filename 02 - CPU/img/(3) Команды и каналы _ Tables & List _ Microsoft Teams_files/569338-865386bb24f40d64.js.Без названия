(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[569338],{417291:(e,t,a)=>{"use strict";a.d(t,{K_:()=>m,qf:()=>h,CT:()=>g,G:()=>f,rJ:()=>v,Yc:()=>y,kp:()=>S,GC:()=>E,$Q:()=>C});var i=a(293980),n=a(942788),r=a(870866),o=a(734630),s=a(901746),_=a(638364),c=a(242030),l=a(712003),d=a(607504),p=a(539411),u=a(328792);const m=(e,t,a)=>{let n;if(t&&!a){const a=o.Vh.getAllOfType("User").filter((e=>e.profile.tid===t&&e.type!==i.aS.Anonymous));if(a.length>1){const t=o.Vh.getValue(s.O4.globalUser);if(n=!!e&&a.find((t=>t.id===e))||a.find((e=>e.id===t.id)),n)return n;throw{message:"Multiple users found in cache with same tenantId",errorCode:_.tG.MultipleUsersPresentWithSpecifiedIdentifier}}return a[0]}if(e){const t=o.Vh.getAllOfType("User");n=t?.filter((t=>t.id===e))[0]}else n=o.Vh.getValue(s.O4.globalUser);return n},h=e=>{if(!e)return[];return o.Vh.getAllOfType("User").filter((t=>t.id!==e&&t.homeAccountId===e))||[]},g=(e,t)=>{if(!e||!t)return;return h(e).find((e=>e.profile.tid===t))},f=(e,t)=>{if(!e||!t)return!1;return e.some((e=>e.cloud!==t&&!e.id.startsWith("dummy-user")))},v=async(e,t,a,i)=>{a?.addScenarioMark("auth_get_encryption_key_start");const r=o.Vh.getValue(s.O4.encryptionKey);if("object"==typeof r)return a?.addScenarioMark("auth_get_encryption_key_stop"),r;let _,c;a?.addScenarioMark("auth_get_exported_key_start");try{if(i&&(0,p.Y)(e)){const e=await t.loadModule(n.bx.Auth);_=(await e.acquireEncryptionKey({correlationId:a?.correlation.id||(0,l.DA)()})).result}else{const e=o.Vh.getValue(s.O4.exportedEncryptionKey);_=e?.exportedKey}}catch(e){return a?.addScenarioMark("auth_get_exported_key_stop",{error:e,reason:"Acquiring the exported key failed."},"failure"),a?.addScenarioMark("auth_get_encryption_key_stop"),null}if(!_)return a?.addScenarioMark("auth_get_exported_key_stop",{reason:"No exported encryption key."}),void a?.addScenarioMark("auth_get_encryption_key_stop");try{c=await e.crypto.subtle.importKey("raw",(0,d.X)(_),{name:"AES-CBC"},!0,["encrypt","decrypt"]),o.Vh.put(s.O4.encryptionKey,c),a?.addScenarioMark("auth_get_exported_key_stop")}catch(e){a?.addScenarioMark("auth_get_exported_key_stop",{error:e,reason:"Importing the key failed"},"failure"),c=null}return a?.addScenarioMark("auth_get_encryption_key_stop"),c},y=(e,t,a)=>{const n=i.p8[r.k[e]],_=m(t,void 0);if(!_)return void c.D.warn(`[AuthState] Account ${t} not found when attempting to write userAuthState`);const d=(0,u.X_)(_),p=(0,l.hR)(a?.reason)||n;o.Vh.put((0,s.Xr)(d).userAuthState,{state:n,reason:p,customError:a?{errorCode:a.errorCode||a.code,message:a.message,isExpected:a.isExpected,context:a.context,subContext:a.subContext,correlationId:a.correlationId,authSubErrorCode:a.authSubErrorCode}:null}),a?c.D.warn(`[AuthState] UserAuthState updated - ${t} : ${n} errorCode: ${a.errorCode} isExpected: ${a.isExpected} correlationId: ${a.correlationId}`):c.D.log(`[AuthState] UserAuthState updated - ${t} : ${n}`)},S=()=>o.Vh.getValue(s.O4.logoutState),E=()=>o.Vh.getValue(s.O4.previousSignInProgressState),C=()=>o.Vh.del(s.O4.previousSignInProgressState)},734630:(e,t,a)=>{"use strict";a.d(t,{Vh:()=>l,Fq:()=>f});var i=a(638364),n=a(242030),r=a(712003),o=a(328792),s=a(901746);const _=[i.yq,i.QF,i.ct],c={KeyVersion:"v1",UseAccountIdKey:!0};let l;const d=e=>c.UseAccountIdKey?e?.id||"":e?JSON.stringify({tenantId:e.tenantId,oid:e.oid,accountType:e.accountType,userName:e.userName}):JSON.stringify(void 0),p=(e,t,a)=>`tmp.auth.${c.KeyVersion}.${e}.${t}.${a}`,u=e=>{const{typeName:t,user:a}=e;return{user:e.user?d(a):"GLOBAL",typeName:t,key:e.key?e.key.toUpperCase():t}},m=(e,t)=>({storageKey:c.UseAccountIdKey?p(t.user,t.typeName,t.key):`$[${t.user}][${t.typeName}][${t.key}]`,loggingKey:p(e.user?`${e.user.id}`:t.user,t.typeName,t.key)});class h{constructor(e,t){this._coreSettings=t,this._expireOffsetSeconds=i.zB.SECONDS_FIVE_MINUTES,this._expireOffsetSecondsMin=i.zB.SECONDS_PER_MINUTE,this._searchParamsQsp="",this.internalCache={GLOBAL:{User:{},Token:{},MsalAccount:{}}},this._initializeCacheForCacheItem=(e,t)=>{void 0===this.internalCache[t]?(this.internalCache[t]={},this.internalCache[t][e]={}):void 0===this.internalCache[t][e]&&(this.internalCache[t][e]={})},this._addToExternalCache=async(e,t)=>{const a=this._coreSettings?.("disableSkipOpaqueDataToExternalCache");if(!a&&e.user?.id?.startsWith("opaque-"))return;let i=t;t.item.encryptedToken&&(i=this._deepCopyEncryptedToken(t));const o=u(e),{storageKey:s,loggingKey:_}=m(e,o);try{this._storage.setItem(s,(0,r.hR)(i))}catch(e){n.D.error(`error in putting key [${_}] in storage, error - [${(0,r.Nw)(e)}]`)}},this._deepCopyEncryptedToken=e=>{const t={...e.item};return t.skypeToken?t.skypeToken="":t.token="",{item:t,hitCount:e.hitCount,shouldRefresh:e.shouldRefresh,refreshAfter:e.refreshAfter}},this._deleteFromExternalCache=async e=>{const t=u(e),{storageKey:a,loggingKey:i}=m(e,t);try{this._storage.removeItem(a)}catch(e){n.D.error(`error in deleting key [${i}] in storage, error - [${(0,r.Nw)(e)}]`)}},this._flushExternalCache=async e=>{try{const t={};Object.keys(this._storage).forEach((a=>{_.forEach((e=>{if(-1!==a.indexOf(e)){const e=this._storage.getItem(a);e&&(t[a]=e)}})),(!e&&0===a.indexOf("$[")||!e&&0===a.indexOf("tmp.auth")||e&&-1!==a.indexOf("tmp.auth")&&(-1!==a.indexOf(e.oid)||e.id&&-1!==a.indexOf(e.id)))&&this._storage.removeItem(a)})),Object.keys(t).forEach((e=>{this._storage.setItem(e,t[e])}))}catch(e){n.D.error(`error in clearing storage, error - [${(0,r.Nw)(e)}]`)}},this._isGlobalUser=e=>{let t=this.internalCache.GLOBAL?.User?.User;return t||(t=this.get(s.O4.globalUser)),t&&(0,o.gn)((0,o.X_)(t.item),e)},this._putGlobalUserInCache=(e,t)=>{if(this._shouldSkipUpdatingGlobalUser(e,t))return;const a=e.user?"GLOBAL":d((0,o.X_)(t.item));if(this._initializeCacheForCacheItem("User",a),this.internalCache[a].User.User=t,this._shouldSkipUpdatingGlobalUserToExternalCache(a))return;const i=c.UseAccountIdKey?p(a,"User","User"):`$[${a}][User][User]`;this._storage.setItem(i,JSON.stringify(t))},this._shouldSkipUpdatingGlobalUserToExternalCache=e=>{const t=this._coreSettings?.("enableStopStorageToExternalCache");return!(!t||"GLOBAL"!==e||!(0,o.B5)(this._searchParamsQsp))},this._shouldSkipUpdatingGlobalUser=(e,t)=>{if(this.getValue(s.O4.globalUser)&&e.user&&!this._isGlobalUser(e.user))return!0;const a=t.item,i=this._coreSettings?.("buildCloud"),n=this._coreSettings?.("disableSetOnlyCurrentCloudGlobalUser");return!(n||!a||!i)&&a.cloud!==i},this._validateValue=(e,t)=>{if(!("Token"!==e.typeName||"object"==typeof t&&t.token&&t.expires))throw new Error("Invalid value for Token.");if(!("Discover"!==e.typeName||e.key!==i.xM||"object"==typeof t&&t.skypeToken&&t.expiration))throw new Error("Invalid value for Skype token.");if("User"!==e.typeName)return;const a=t,n=this._coreSettings?.("disableSkipOpaqueDataToExternalCache");if((!a.userName||!a.type||!a.role||!a.profile||void 0===a.isAuthenticated)&&(n||!e.user?.id?.startsWith("opaque-")))throw new Error(`Invalid value for user. userName exists: [${!!a.userName}], type: [${a.type}], role: [${a.role}], profile exists: [${!!a.profile}],isAuthenticated: [${a.isAuthenticated}]`);const r=this.internalCache.GLOBAL?.User?.User,s=(0,o.X_)(a);if(r&&!e.user&&!this._isGlobalUser(s))throw new Error("there is already global user in auth cache")},this._storage=e.localStorage,this._searchParamsQsp=e?.location?.search,n.D.info("auth_cache initialized")}updateSetting(e,t){n.D.log(`Updating authCache setting ${e} from ${c[e]} to ${t}.`),"KeyVersion"===e&&(t!==c.KeyVersion&&(this.internalCache={}),c.KeyVersion=t),"UseAccountIdKey"===e&&(t!==c.UseAccountIdKey&&(this.internalCache={}),c.UseAccountIdKey=t)}setExpiryOffset(e,t){e&&(this._expireOffsetSeconds=e),t&&(this._expireOffsetSecondsMin=t)}put(e,t){g(e),this._validateValue(e,t);const{typeName:a,key:i,user:n}=u(e),r="Token"===a||"Discover"===a&&"SKYPE-TOKEN"===i;r&&(t.fromCache=!0);let o=this.internalCache[n]?.[a]?.[i];return o?(o.hitCount=0,o.item=t):o={item:t,shouldRefresh:!1,hitCount:0},r&&(o.refreshAfter=function(e,t,a){const i=y(e,t);if(i&&a)return E(v(),i,a);return}(a,t,this.refreshPercents)),"User"===a&&this._putGlobalUserInCache(e,o),this._initializeCacheForCacheItem(a,n),this.internalCache[n][a][i]=o,this._addToExternalCache(e,o),!0}updateGlobalUser(e){const t="GLOBAL",a={item:e,shouldRefresh:!1,hitCount:0};return this._initializeCacheForCacheItem("User",t),this.internalCache[t].User.User=a,this._shouldSkipUpdatingGlobalUserToExternalCache(t)||this._addToExternalCache(s.O4.globalUser,a),!0}get(e){g(e);const t=u(e),{storageKey:a,loggingKey:i}=m(e,t),{typeName:o,key:s,user:_}=t;let c=this.internalCache[_]?.[o]?.[s];const l=!!c;if(!c)try{const e=this._storage?.getItem(a);if("RealmMap"===o&&e){c=JSON.parse(e);const t=Object.fromEntries(c.item);c.item=new Map(Object.entries(t))}else e&&(c=JSON.parse(e))}catch(e){n.D.error(`value for key [${i}] throw error. ${(0,r.Nw)(e)}`)}if(c)return this._initializeCacheForCacheItem(o,_),this.internalCache[_][o][s]=c,("Token"===o||"Discover"===o&&"SKYPE-TOKEN"===s)&&(c.shouldRefresh=this._shouldRefresh(c,o),c.hitCount++,this.internalCache[_][o][s]=c,this._addToExternalCache(e,c)),void 0===c.shouldRefresh?(n.D.info(`cacheItem '[${a}]' need to refresh`),void this.del(e)):(n.D.info(`returning cacheItem '[${a}]' from cache${c.shouldRefresh?", will be refreshed in background":""}. In memory:${+l} found: [${+!!c}]`),c);n.D.info(`value for key [${i}] not found in memory or storage`)}getValue(e){const t=this.get(e);return t?this._value(t):void 0}getAllOfType(e){const t=[],a=[];return Object.keys(this.internalCache).forEach((i=>{"GLOBAL"!==i&&Object.keys(this.internalCache[i][e]||{}).forEach((n=>{const{storageKey:r}=m({},{user:i,typeName:e,key:n});a.push(r),t.push(this.internalCache[i][e][n].item)}))})),Object.keys(this._storage).forEach((i=>{if(-1===a.indexOf(i)&&-1===i.indexOf(".GLOBAL.")&&-1!==i.indexOf(`.${e}.`))try{const e=this._storage.getItem(i);e&&t.push(JSON.parse(e)?.item)}catch(e){n.D.error(`value for key [${i}] throw error. ${(0,r.Nw)(e)}`)}})),t}del(e){if(!e)return n.D.error(`Invalid cacheKey: ${e}`),!1;if(!e.typeName)return n.D.error(`Invalid cacheKey type: ${e.typeName}`),!1;if("User"===e.typeName)return this.flush(e.user),!0;const t=u(e),{loggingKey:a}=m(e,t),{typeName:i,key:r,user:o}=t;this.internalCache[o]?.[i]?.[r]&&n.D.info(`Value of key: [${a}] exists before deletion]`);const s=this.internalCache[o]?.[i]?.[r]&&delete this.internalCache[o][i][r],_=this._deleteFromExternalCache(e);return n.D.info(`deleted from local auth-cache. key: [${a}], done - local: [${s}], storage: [${_}]`),s}delTokensWithError(e,t){const{user:a,typeName:i}=u({user:e,typeName:"Token"});if(this.internalCache[a]?.[i]){const n=this.internalCache[a][i];for(const a in n)n[a]?.item?.error?.errorCode===t&&this.del({user:e,typeName:i,key:a})}}deleteType(e,t){const{user:a,typeName:i}=u({user:e,typeName:t});if(this.internalCache[a]?.[i]){let t;if("Token"===i)t=this.internalCache[a][i];else{if("Discover"!==i)return;t=this.internalCache[a][i]}for(const a in t)a&&this.del({user:e,typeName:i,key:a})}}flush(e){if(!e){n.D.info("no user provided, flushing global user from cache");const t=this.internalCache.GLOBAL?.User?.User;if(!t)return;e=(0,o.X_)(t.item)}n.D.info(`flushing user ${e.id} data from cache`);const t=d(e);this.internalCache[t]={},this._flushExternalCache(e),this._isGlobalUser(e)&&(this.internalCache.GLOBAL={},this._storage.removeItem("$[GLOBAL][User][User]"),this._storage.removeItem("tmp.auth.v1.GLOBAL.User.User")),n.D.info("flushing completed")}_value(e){return e.item}_shouldRefresh(e,t){if(!["Discover","Token"].includes(t)||!e.item)return;const a=e.item,i=y(t,a);if(e.refreshAfter&&this.refreshPercents)return C(v(),e.refreshAfter,i,this._expireOffsetSecondsMin);if(a&&i){const e=i-this._expireOffsetSeconds,t=i-this._expireOffsetSecondsMin,a=v();if(a<=t)return a>=e}}get refreshPercents(){const e=this._coreSettings?.("proactiveTokenRefreshPercents");return Number(e??0)}}const g=e=>{if(!(-1===["Token","Discover"].indexOf(e.typeName)||e.key&&e.user))throw new Error(`key/user cannot be empty for type [${e.typeName}]: key: ${e.key}, user: ${+!!e.user}`)},f=(e,t)=>l||(l=new h(e,t),e.localStorage?.getItem("localDebug")&&e.loader&&(e.loader.authCache=l),l);function v(){return Math.round(Date.now()/i.zB.MILLI_PER_SECOND)}function y(e,t){return"Discover"===e?Math.round(t?.expiration/i.zB.MILLI_PER_SECOND):"Token"===e?t?.expires:void 0}const S=i.zB.SECONDS_PER_MINUTE*i.FQ.TEN;function E(e,t,a=.67){const i=t-e,n=e+Math.round(i*a),r=t-S;return Math.min(n,r)}function C(e,t,a,n=i.zB.SECONDS_PER_MINUTE){return!a||a<e+n?void 0:t<e}},901746:(e,t,a)=>{"use strict";a.d(t,{Xr:()=>n,bV:()=>r,O4:()=>o});var i=a(638364);const n=e=>({userDetail:{user:e,typeName:"Discover",key:"discover-user-details"},regionGtm:{user:e,typeName:"Discover",key:"discover-region-gtm"},skypeToken:{user:e,typeName:"Discover",key:"skype-token"},user:{user:e,typeName:"User"},tenants:{user:e,typeName:"Tenants"},loginValidation:{user:e,typeName:"LoginValidation"},userAuthState:{user:e,typeName:"UserAuthState"},meetingDetails:{user:e,typeName:"MeetingDetails"},telemetryInfo:{user:e,typeName:"TelemetryInfo"},realmMap:{user:e,typeName:"RealmMap"}}),r=(e,t,a)=>({user:e,typeName:"Token",key:`${t}${a?`-external-${a}`:""}`}),o={addAccountsSuggestionCoachMarkTimeStamp:{typeName:"addAccountsSuggestionCoachMarkTimeStamp"},logoutState:{typeName:i.QF},authSessionId:{typeName:i.ct},globalUser:{typeName:"User"},primaryUserId:{typeName:"PrimaryUserId"},encryptionKey:{typeName:"EncryptionKey"},deviceOsUpdateState:{typeName:"DeviceOsUpdateState"},exportedEncryptionKey:{typeName:"ExportedEncryptionKey"},initializationVector:{typeName:"InitializationVector"},previousSignInProgressState:{typeName:"PreviousSignInProgressState"},eOtpLoginUser:{typeName:"EotpLoginUser"},ropcLogoutState:{typeName:"RopcLogoutState"}}},212194:(e,t,a)=>{"use strict";a.d(t,{X4:()=>h,hl:()=>g,zR:()=>f,pz:()=>v,Dp:()=>E,xN:()=>C,x$:()=>b,VM:()=>w,Rr:()=>A,IO:()=>T,bH:()=>x});var i=a(293980),n=a(942788),r=a(396588),o=a(489955),s=a(396476),_=a(638364),c=a(242030),l=a(328792),d=a(712003),p=a(734630),u=a(901746),m=a(417291);const h=(e,t,a)=>{const i=v(e,t,a);return{...i,message:i.message,stack:i.stack,errorMetadata:{accountId:t?.result?.profile?.id,name:t?.result?.profile?.displayName,email:t?.result?.profile?.email}}},g=(e,t)=>{const a=t?.("buildCloud")||"",n=e.extraQueryParameters?.tenantId,r=M(n,e.domainHint||a,t),o=e.extraQueryParameters?.accountType||i.aS.Aad;return{correlation:e.correlation,silent:e.silent,extraQueryParameters:{...e.extraQueryParameters,authority:r},userIdentifier:{accountType:o,tenantId:n,id:e.accountId||"",userName:"",oid:""}}},f=e=>e.accountId&&e.extraQueryParameters?.tenantId,v=(e,t,a,i)=>{const n=t.isExpected||t.message?.includes("657rv")||t.errorMessage?.includes("657rv")||!1,r=(e=>e.replace(/[^"',;:\s]+@[^"',;:\s]+\.[^"',;:\s]+/g,"email"))(t?.errorMessage||t.message||"ErrorMessageMissing");return i?(0,o.$5)({context:"authentication",subContext:e,errorCode:t.errorCode||"ErrorCodeMissing",message:r,isExpected:n,correlationId:a.id,tag:S(r),systemErrorCode:y(r)}):(0,o.$5)({context:"authentication",subContext:e,errorCode:t.errorCode||"ErrorCodeMissing",message:r,isExpected:n,correlationId:a.id})},y=e=>{if(e&&e.includes("{"))try{const t=JSON.parse(e.substring(e.indexOf("{")));return t.SystemErrorCode??""}catch(e){return""}return""},S=e=>{if(e&&e.includes("{"))try{const t=JSON.parse(e.substring(e.indexOf("{")));return t.Tag??""}catch(e){return""}return""},E=(e,t,a)=>{const{accountId:i,correlation:r,prompt:o,loginHint:s,extraQueryParameters:_,windowId:c}=e,d=!!a?.("enableRopcFlow"),p={accountId:i,correlationId:r.id,domainHint:a?.("enableAad")?a?.("enableMultiCloud")?void 0:n.Zr.prod:n.Zr.life,extraQueryParameters:(0,l.pj)(_),loginHint:s,silent:"none"===o,windowId:c,useRopcFlow:d};return t.addEventData([`nativeArgs:{domainPresent:${p.domainHint}`,`extraParams:${p.extraQueryParameters?.length}`,"idPresent:"+ +!!p.accountId,"loginHintPresent:"+ +!!p.loginHint,`silent:${p.silent}`,`useRopcFlow:${p.useRopcFlow}}`]),p},C=(e,t,a,i)=>{const n=b(t.userIdentifier);if(!t.extraQueryParameters?.authority&&i?.("enableSetAuthorityAlways")){const e=t.tenantId||n.tenantId,a=i?.("buildCloud")||"",r=M(e,a,i);t.extraQueryParameters=t.extraQueryParameters||{},t.extraQueryParameters.authority=r}const r={resource:e,correlationId:t.correlation.id,accessTokenToRenew:t.accessTokenToRenew,claim:t.claim,silent:t.silent??"login"!==t.prompt,userIdentifier:n,tenantId:t.tenantId,extraQueryParameters:(0,l.pj)(t.extraQueryParameters),windowId:t.windowId};return a.addEventData(["nativeArgs:{","accessTokenPresent:"+ +!!r.accessTokenToRenew,"claimPresent:"+ +(0,l.uY)(t.claim),"idPresent:"+ +!!n?.id,`silent:${r.silent}`,"userToUse:"+ +!!n,"externalTenant:"+ +!!r.tenantId,"}"]),r},b=e=>({id:e.id,tenantId:e.tenantId,oid:e.oid,upn:e.userName}),w=(e,t,a)=>{let n;c.D.info("Getting user profile");const r=e.extendedProperties?.find((e=>"acct"===e.name)),o=e.extendedProperties?.find((e=>"idp"===e.name));r&&(n=+r.value);const s=o?o.value:void 0;let _;try{_=e.profile.id||(e.profile.oid.startsWith("000")?e.profile.oid.replace(/[0-]/g,""):e.profile.oid)}catch{_=e.profile.oid}const d=e.extendedProperties?.find((e=>"isCrossCloudUser"===e.name)),m=I(e,d?.value),h={tenantId:e.profile.tenantId,oid:e.profile.oid,accountType:(0,l.TF)(e.profile.tenantId),userName:e.userName,id:_};p.Vh.put((0,u.Xr)(h).telemetryInfo,{isCrossCloudUser:m});const g=k(e,!!t?.("enableMTO"),!!t?.("enableCCM"));let f=1===n?i.a7.Guest:i.a7.Member;g===i.as.Ccm&&(f=i.a7.Anonymous);const v=!!t?.("disableHomeTidAndCloud");let y,[S,E]=(0,l.tG)(e);return e.profile.isHomeAccount?(S=_,E=e.profile.tenantId,y=(0,l.xb)(e,t,a,_,S)):(E=e.homeTenantId||E,y=e.homeCloud?(0,l.sM)(e.homeCloud):void 0),{id:_,userName:e.userName||e.profile.email,profile:{acct:n,altsecid:"",amr:[],aud:"",exp:-1,idp:s,email:e.profile.email,family_name:"",given_name:e.profile.displayName,iat:1,iss:"",name:e.profile.displayName,preferred_username:e.userName||e.profile.email,nbf:-1,nonce:"",oid:e.profile.oid,onprem_sid:"",sub:"",tid:e.profile.tenantId,unique_name:e.profile.displayName,upn:e.profile.email,ver:"1.0",isHomeAccount:e.profile.isHomeAccount},isAuthenticated:!1,type:(0,l.TF)(e.profile.tenantId),cloud:(0,l.xb)(e,t,a,_,S),homeAccountId:S,homeTenantId:v?void 0:E,homeAccountCloud:v?void 0:y,role:f,subType:g}},k=(e,t,a)=>{let n=i.as.Default;if(t||a){const o={id:(0,d.DA)(),scenarioName:r.Cu.AuthGetUserSubType,source:"core-auth::getUserSubType"},[c,l]=(0,s.we)({options:{correlation:o},subContext:"auth-helper::getUserSubType",scenarioName:r.Cu.AuthGetUserSubType,source:"core-auth::getUserSubType"}),p=e.extendedProperties?.find((e=>e.name===_.bw));if(p){const e=t&&p.value.indexOf(_.Xz)>-1,r=a&&p.value.indexOf(_.Oi)>-1;e?n=i.as.Mto:r&&(n=i.as.Ccm)}l({reason:"Extended properties wids claim check done.",userSubType:n},"success")}return c.D.log(`User subType set to ${n}, enableMTO: ${t}`),n},A=e=>({token:e.result.token,idToken:e.result.idToken,expires:e.result.expires,fromCache:!1,account:e.result.account}),T=e=>e.errorCode===_.Cd.ApiContractViolation&&e.message.includes(_.Cd.UiAlreadyShowing),x=e=>e?.message?.match(/Tag\\?":\\?"([^\\"]*)/)?.[1]||"",I=(e,t)=>{if(!e.homeAccountId)return!1;if(e.profile.id===e.homeAccountId)return!1;const a=(0,m.K_)(e.homeAccountId,void 0);return(!a||e.profile.sovereignty!==i.Av.gcc||a.cloud!==i.el.prod)&&"1"===t},M=(e,t,a)=>`${(0,l.kR)(t,a)}${e}`},539411:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});const i=e=>!!e?.chrome?.webview},328792:(e,t,a)=>{"use strict";a.d(t,{nt:()=>v,O0:()=>S,al:()=>E,ge:()=>C,LL:()=>b,i3:()=>w,Jk:()=>k,rF:()=>A,tG:()=>T,YH:()=>x,TF:()=>I,kR:()=>M,xb:()=>O,nJ:()=>N,gP:()=>P,sM:()=>R,M_:()=>U,X_:()=>H,oh:()=>B,pj:()=>q,gf:()=>V,oF:()=>K,Ah:()=>j,Z0:()=>z,gn:()=>W,mq:()=>Q,ce:()=>Y,B5:()=>X,kO:()=>Z,ni:()=>J,TK:()=>ee,bE:()=>te,P9:()=>ae,uY:()=>ie,rA:()=>ne,RU:()=>re,XQ:()=>se,Iw:()=>_e,$d:()=>le,V6:()=>he,BR:()=>ye,__:()=>Ee,eN:()=>Ce,li:()=>be,QO:()=>we,QB:()=>ke,rm:()=>Ae});var i=a(480354),n=a(293980),r=a(494514),o=a(942788),s=a(242030),_=a(638364),c=a(734630),l=a(489955),d=a(449009),p=a(712003),u=a(901746),m=a(357400),h=a(417291),g=a(212194),f=a(912435);const v="9188040d-6c67-4c5b-b112-36a304b66dad";var y;!function(e){e.Otp="mail",e.GFed="google.com"}(y||(y={}));const S=({type:e,profile:t})=>(e===n.aS.Otp||e===n.aS.GFed||t.idp===y.Otp||t.idp===y.GFed)&&t.tid===_.xD.services,E=({cloud:e,profile:t},a)=>e===n.el.life&&t.tid===_.J&&a===n.el.prod;function C(e,t){return void 0!==t&&e!==t}function b(e,t,a){const i=a?.("disablePassExternalLoginIdentifier");return t.subType===n.as.Eotp&&(e.extraQueryParameters={...e.extraQueryParameters,otpAccount:!0,...!i&&_.iS}),e}const w=e=>(s.D.info(`[returnTokenForAnonUser][${e}] empty token return for anonymous user`),{token:"",expires:Math.floor((new Date).setMinutes(_.FQ.FIFTEEN)/_.zB.MILLI_PER_SECOND),fromCache:!0}),k=(e,t)=>{if(!e)return"";const a=t?.("instanceUrl"),i=a?`${a}${e??"common"}`:"";return s.D.log(`[getAuthorityFromCloud] Get Authority from cloud type - ${i}`),i},A=(e,t,a,i,n)=>{const r=t?.profile.tid||a||e?.tenantId;if(r&&(t||i||e?.isAnonEligible&&e?.isAnonRestrictionSatisfied))return x(r,void 0,t,void 0,n)},T=e=>{const t=e.homeAccountId?.split(".");let a,i;return t&&t.length>0&&(a=t[0],a?.startsWith("00000000-0000-0000")&&(a=a.replace("00000000-0000-0000-","").replace("-","")),t.length>1&&(i=t[1])),[a,i]},x=(e,t,a,i,r)=>{if(s.D.info("Anon flow - anonymous user created"),t=t||(e===_.J?n.el.life:n.el.prod),r&&i){(0,f.Mr)(i)!==i&&r?.addEventData(["meetingUniqueIdEuiiLeak:1"])}const o=`anon.${t}.${e}.${i}`;return{id:o,isAuthenticated:!0,userName:a?.userName||"anonymous",profile:{oid:B(o),tid:e,upn:a?.profile?.upn||"",puid:""},role:n.a7.Anonymous,type:n.aS.Anonymous,homeAccountId:o,homeTenantId:e,homeAccountCloud:a?.cloud||t,cloud:a?.cloud||t,subType:n.as.Default}},I=e=>e===r.lV?n.aS.MsaLife:n.aS.Aad,M=(e,t)=>{if(!e){if(t?.("disableUseBuildCloudForEmptyCloudInAuthotityFn"))return _.p2;e=t?.("buildCloud")||n.el.prod}const a=t?.("cloudAuthorityMap")??_.Pj,i=a.find((t=>t.cloud.toString()===e))?.authority;return i||_.p2},O=(e,t,a,i,r)=>{if(I(e.profile.tenantId)===n.aS.MsaLife)return n.el.life;if(t?.("enableMTMAAuthDataInMaglevStorage")||t?.("enableMTMAAuthDataInMaglevStorageViaHost")){const n=e.profile.sovereignty;if(r===i)return D(n);if(a)return a;const o=e.profile.environment;return N(o,e.profile.tenantId,t)}{const t=e.profile.sovereignty;return D(t)}},N=(e,t,a)=>{if(t===v)return n.el.life;switch(e){case n.nb.prod:return n.el.prod;case n.nb.gallatin:return n.el.gallatin;case n.nb.airgap08:return n.el.airgap08;case n.nb.airgap09:return n.el.airgap09;case n.nb.gov:const e=a?.("buildCloud");return e;default:return n.el.prod}},D=e=>{switch(e){case n.Av.prod:case n.Av.gcc:return n.el.prod;case n.Av.gcch:return n.el.gcch;case n.Av.dod:return n.el.dod;case n.Av.ag08:return n.el.airgap08;case n.Av.ag09:return n.el.airgap09;case n.Av.gallatin:return n.el.gallatin;default:return n.el.prod}},P=e=>{switch(e){case n.el.prod:return o.Zr.prod;case n.el.life:return o.Zr.life;case n.el.gcch:return o.Zr.gcch;case n.el.dod:return o.Zr.dod;case n.el.airgap08:return o.Zr.airgap08;case n.el.airgap09:return o.Zr.airgap09;case n.el.gallatin:return o.Zr.gallatin;default:return o.Zr.prod}},R=e=>{switch(e){case o.Zr.prod:return n.el.prod;case o.Zr.life:return n.el.life;case o.Zr.gcch:return n.el.gcch;case o.Zr.dod:return n.el.dod;case o.Zr.airgap08:return n.el.airgap08;case o.Zr.airgap09:return n.el.airgap09;case o.Zr.gallatin:return n.el.gallatin;default:return n.el.prod}},U=(e,t,a,r,o)=>{if(t?.subType===n.as.Ccm||t?.subType===n.as.Eotp)return t;if(!t||(0,i.isEmpty)(t.profile)||t.role===n.a7.Anonymous||t.userRole===_.FQ.TWO||!t.isAuthenticated&&e.isAnonEligible||!t.isAuthenticated&&r)return s.D.info("checking anon flow"),A(e,t,a,r,o);const c=void 0===t.role&&void 0===t.profile?.acct&&L(t?.homeAccountId,t?.profile?.oid,t?.cloud);return t.role=t.role===n.a7.Guest||1===t.profile?.acct||c?n.a7.Guest:n.a7.Member,F(t),G(t),$(t)},L=(e,t,a)=>e&&t&&a&&"life"!==a&&e!==t,F=e=>{if(e.profile?.tid===r.lV)return void(e.type=n.aS.MsaLife);const t=[n.aS.Msa,n.aS.Otp,n.aS.GFed];if(e.type&&-1!==t.indexOf(e.type))return;let a=0===e.profile?.altsecid?.indexOf("1:")?n.aS.Msa:n.aS.Aad;e.profile?.idp&&e.profile?.iss!==e.profile.idp&&(a=e.profile.idp===y.Otp?n.aS.Otp:a,a=e.profile.idp===y.GFed?n.aS.GFed:a),0===e.profile?.altsecid?.indexOf("1:")&&e.cloud===n.el.prod&&e.profile?.tid&&e.profile.tid!==_.xD.services&&(a=n.aS.Aad),e.type=a},G=e=>{e.type!==n.aS.MsaLife?e.cloud&&e.cloud!==n.el.prod||(e.cloud=n.el.prod):e.cloud=n.el.life},$=e=>(e.profile.oid=e.profile.oid||B(e.profile.tid),!e.profile.hasOwnProperty("upn")&&e.hasOwnProperty("userName")&&(e.profile.upn=e.userName||""),e.subType||(e.subType=n.as.Default),s.D.log(`User role = [${e.role}], type = [${e.type}], cloud = [${e.cloud}]`),e),H=e=>{if(!e)throw new Error("getUserIdentifier: User cannot be null");return{tenantId:e.profile.tid,oid:e.profile.oid,accountType:e.type,userName:e.userName,id:e.id}},B=e=>`8:defaultOid:${e}`,q=e=>{const t=[];for(const a in e)Object.hasOwnProperty.call(e,a)&&e[a]&&t.push({name:a,key:a,value:"string"==typeof e[a]?e[a]:(0,p.hR)(e[a])});return t},V=e=>{const{extraQueryParameters:t}=e;t?.otpAccount?c.Vh.put(u.O4.eOtpLoginUser,e.loginHint):c.Vh.del(u.O4.eOtpLoginUser)},K=(e,t)=>{t.addEventData(["update-global-user:t"]),t.addScenarioMark("auth_update_global_user_start");const a=(0,h.K_)(e,void 0);if(a)return t.addScenarioMark("auth_update_global_user_foundUser"),c.Vh.updateGlobalUser(a);throw t.addScenarioMark("auth_update_global_user_noUserFound"),i=t.correlation?.id,(0,l.$5)({context:"core-auth-base",subContext:"getUserFromAccountId",correlationId:i,errorCode:_.tG.UserNotFoundError,message:"Cannot update global user ude to missing user"});var i},j=(e,t)=>{if(!(t?.("disableHomeTidAndCloud")||e.homeTenantId&&e.homeAccountCloud)){if(e.profile.isHomeAccount)e.homeTenantId=e.profile.tid,e.homeAccountCloud=e.cloud;else{const t=(0,h.K_)(e.homeAccountId,void 0);e.homeTenantId=t?.profile.tid,e.homeAccountCloud=t?.cloud}c.Vh.put((0,u.Xr)(H(e)).user,e)}return e},z=e=>e?e?.id?e?.id:`${e?.oid}-${e?.tenantId}`:"unknown user",W=(e,t)=>!!e&&!!t&&((e.id||t.id)&&e.id===t.id||e.tenantId===t.tenantId&&e.oid===t.oid&&e.userName===t.userName),Q=(e,t,a)=>{const i=new CustomEvent(t,{detail:a});e?.dispatchEvent?.(i)},Y=(e,t,a,i,n)=>{const r=U(e,t,i,n,a);return r&&(s.D.info(`[auth-helper][getMappedUserAndSetItToCache][${a.correlation.id}] put user in cache.`),c.Vh.put((0,u.Xr)(H(r)).user,r),(0,d.zs)(!1,{correlation:a.correlation,accountId:r.id},"login"),a.addEventData(["setLoggedOut:0"])),r},X=e=>"postmessage"===new URLSearchParams(e).get("agent"),Z=(e,t,a,i,n)=>{if(_.Ib(e,t))throw n.addEventData(["scope_invalid:1"]),s.D.warn(`[core-auth-base][acquireToken][${i.source}][${i.id}] invalid scope. resource: [${e}]`),(0,l.$5)({context:"core-auth-base",subContext:"acquireToken",message:`request with [${a?.id}-${a?.oid}-${a?.tenantId}] sent from invalid resource: ${e}`,errorCode:_.tG.InvalidScopeResource,isExpected:!0,correlationId:i.id})},J=(e,t,a,i,n)=>(i.push("user_missing"),(0,l.$5)({context:"core-auth-base",subContext:e,errorCode:_.tG.UserNotFoundError,isExpected:a,message:`request sent with [${t}] failed as user not found`,innerError:new Error("User Null or empty"),correlationId:n})),ee=(e,t,a,i)=>(0,l.$5)({context:"core-auth-base",subContext:e,errorCode:_.tG.UnsupportedParameter,isExpected:a,message:`${t} parameter is not currently supported`,innerError:new Error(`${t} parameter is not currently supported`),correlationId:i});const te=(e,t,a,i,n,r)=>{i?.push(`errorCode:${t?.errorCode||"undefined"},errorMessage:${t?.message||"undefined"}`),i&&i.length>0&&i.push("$");const o=function(e,t,a="",i,n){return{contentType:a,context:"core-auth-base",correlationId:t?.correlationId,endpointUrl:n||"unset",errorCode:t?.errorCode||"AcquireToken Error",innerError:t,isExpected:t?.isExpected,message:(0,p.Nw)(t),reason:i?.join(";")||"",subContext:e}}(e,t,n,i,r),c=o.errorCode.includes(_.tG.InvalidScopeResource)||o.message?.includes(_.tG.InvalidScopeResource)||o.isExpected||o.innerError?.isExpected;return c?s.D.warning(`Error found ${(0,p.Nw)(t)}`):s.D.error(`Error found ${(0,p.Nw)(t)}`),c?a?.incomplete(o):a?.fail(o),o},ae=JSON.stringify({access_token:{xms_cc:{values:["CP1"]}}}),ie=e=>!(!e||e===ae),ne=(e,t,a,i,n)=>(a.tflClaim&&(a.accessTokenToRenew=a.tflClaim),void 0===a.prompt&&void 0===a.silent&&(!a.accessTokenToRenew&&!ie(a.claim)||i?.("disablePromptFor401")&&!((e,t)=>{const a=t?.("enablePromptResourcesFor401")||[];return!(!e||!a)&&Array.isArray(a)&&a.findIndex((t=>e.includes(t)))>-1})(e,i)?(a.prompt="none",a.silent=!0):(a.prompt="login",a.silent=!1)),n&&!a.accessTokenToRenew&&(a.forceRenew||!1===a.silent||"login"===a.prompt)&&(s.D.info("[core-auth-base][acquireToken] force renewing."),a.accessTokenToRenew=n.item.token),t.addEventData(["cacheToken:"+ +!!n,"tflClaim:"+ +!!a.tflClaim,"accessTokenToRenew:"+ +!!a.accessTokenToRenew,"forceRenew:"+ +!!a.forceRenew,`prompt: ${a.prompt}`,"silent:"+ +!!a.silent]),n?.item?.error?.errorCode&&t.addEventData([`errorInToken:[${n?.item?.error?.errorCode||""}]`]),a),re=async e=>{const{user:t,authTelemetry:a,environment:i,authProvider:r,options:o,getSetting:d}=e,p=d?.("buildCloud"),u=d?.("enableMultiCloud"),m=d?.("enableCCM"),h=d?.("enableRefreshTenantsForGuestDeeplink");if(s.D.log(`starting cloud misMatch check. Env: ${i}, buildCloud: ${p}, user tid: ${t.profile.tid}, user cloud: ${t.cloud}`),ce(t,d)){const e=await ve(t,o.correlation,r);return Promise.reject(e)}if(!t.cloud||!p||t.cloud===p&&t.subType!==n.as.Ccm)return s.D.log("No cloud mismatch detected."),a.addEventData(["cloudMismatch:0"]),t;const g=((e,t)=>{const a=t?.("enableMSAGuest"),i=t?.("enableTFLOnT21");return a&&!i&&e.cloud===n.el.life})(t,d);if(a.addEventData(["cloudMismatch:1","isMsaGuest:"+ +!!g,"enableCCM:"+ +!!m,"meetingDetails:"+ +!!o.meetingDetails]),g){a.addScenarioMark("msa_flow_start");const e=await de(t,o,r,a,p,d);if(e)return e}if(h&&o.extraQueryParameters?.isNewGuestUser){a.addScenarioMark("try_login_to_new_tenant_start");const e=await oe(t,o,r,a,p,d);if(e)return e}if(m&&o.meetingDetails&&t.cloud!==n.el.life){a.addScenarioMark("ccm_flow_start");const e=await pe(t,o,r,a,p,o.meetingDetails,d);if(e)return e}if(u){a.addScenarioMark("cloud_mismatch_detected",{reason:`_checkForCloudMismatchAndReboot. Env: ${i}, enableMultiCloud: ${u}, buildCloud: ${p}, user tid: ${t.profile.tid}, user cloud: ${t.cloud}`});const e=await ge(t,o.correlation,r);return Promise.reject(e)}c.Vh.del({user:H(t),typeName:"User"}),r.removeWebActiveUser?.();const f=await(0,l.pz)({name:_.tG.CloudMismatchNoMultiCloud,message:"cloud mismatch, reboot required",correlationId:o.correlation.id,context:"Login",subContext:"checkForCloudMismatch",errorCode:_.tG.CloudMismatchNoMultiCloud,isExpected:!0});return Promise.reject(f)},oe=async(e,t,a,i,n,r)=>{try{const o=await ue(e,t,a,t.extraQueryParameters?.tenantId,n,r),s=me(o,r);if(i.addEventData(["account:"+ +!!s,`sub:${s?.subType}`,`buildCloud:${n}`,`userCloud:${s?.cloud}`]),s)return i.addEventData(["newCcgaUser:1"]),i.addScenarioMark("try_login_to_new_tenant_end"),s;i.addScenarioMark("try_login_to_new_tenant_end")}catch(e){i.addScenarioMark("try_login_to_new_tenant_end",e)}},se=e=>{const{user:t,options:a,authTelemetry:i,getSetting:n}=e,r=a.meetingDeepLink;if(n?.("disableCrossCloudMeetingBlock")||!r)return;const o=r.includes("teams.live.com"),s=!(o||r.includes("teams.microsoft.com")),_=!("life"===t.cloud||"prod"===t.cloud);if(s&&"life"===t.cloud||_&&o)throw(0,l.pz)({message:"User attempted to join an invalid cross cloud meeting",name:"",errorCode:"InvalidMeeting",correlationId:i.correlation.id,context:"account-selection-dialog-renderer",subContext:"onItemClick",authSubErrorCode:"GenericAuthError"})},_e=(e,t)=>{t?.("enableWebTflMsaGuestFlow")&&(e?.profile?.altsecid?.indexOf("1:live")<0||"prod"!==e.cloud||c.Vh.put((0,u.Xr)(H(e)).userAuthState,{state:n.p8.Up,reason:"",visibilityState:n.cy.Shown}))},ce=(e,t)=>{if(e.cloud!==n.el.life||!t?.("enableMultiMsaRoadBlock")||!t?.("enableTFLOnT21"))return!1;return!!c.Vh.getAllOfType("User").find((t=>t.id!==e.id&&t.cloud===n.el.life&&t.type!==n.aS.Anonymous))},le=(e,t,a)=>{const i=a?.("buildCloud");if(!!a?.("isWebClientType")&&e.meetingDeepLink&&"interopMeetingLogin"===e.loginType)try{t.addScenarioMark("update_hostName_for_interop_start");const a=new URL(e.meetingDeepLink);a.hostname=i===n.el.prod?_.fu.TfwToTfl:_.fu.TflToTfw,a.searchParams.set("login_hint",e.loginHint||""),a.searchParams.set("webjoin","true"),e.redirectUrl=a.toString(),t.addScenarioMark("update_hostName_for_interop_end")}catch(e){t.addScenarioMark("update_hostName_for_Interop_fail",e)}},de=async(e,t,a,i,r,o)=>{try{const s=await ue(e,t,a,_.xD.services,r,o),l=s.webAccount??me(s,o),d=!!o?.("enableWebTflMsaGuestFlow");if(i.addEventData(["msa-account:"+ +!!l]),i.addScenarioMark("msa_flow_end"),l){d&&(l.id=l.homeAccountId??l.id);const e=await Ce(l,i.correlation,a);return c.Vh.put((0,u.Xr)(H(l)).userAuthState,{state:n.p8.Unknown,customError:{errorCode:e.errorCode,isExpected:e.isExpected,message:e.message,context:e.context,subContext:e.subContext,correlationId:e.correlationId,errorMetadata:e.errorMetadata},reason:"MsaUserNotAllowed"}),d||(l.homeAccountId=l.id),l.type=n.aS.Msa,l}}catch(e){i.addScenarioMark("msa_flow_end",e)}},pe=async(e,t,a,i,r,o,s)=>{if(e.subType===n.as.Ccm)return Se(e,i,o,e.profile.name,s);try{const _=await ue(e,t,a,o.tenantId,r,s),c=me(_,s);if(i.addEventData(["account:"+ +!!c,`sub:${c?.subType}`]),c)return c.subType===n.as.Ccm?Se(c,i,o,e.profile.name,s):(i.addEventData(["ccgaUser:1"]),c);i.addScenarioMark("ccm_flow_end")}catch(e){i.addScenarioMark("ccm_flow_end",e)}},ue=async(e,t,a,i,n,o)=>{const s=`${M(n,o)}${i}`,_=o?.("mtResource")||r.fP.MT;return await a.acquireToken(_,{correlation:t.correlation,silent:t.silent,userIdentifier:H(e),extraQueryParameters:{authority:s}})},me=(e,t)=>e&&e.account?(0,g.VM)(e.account,t):void 0,he=async(e,t,a,i)=>new Promise((async n=>{if(e.length<=0)return n({count:0,failure:[]});let r=0;const o=[];for(const s of e){r++;try{const e=t(s);await e}catch(e){o.push(r),a?.(e,r,s)}finally{if(i){const e=i(s);await e.catch((()=>{}))}r>=e.length&&n({count:r,failure:o})}}})),ge=async(e,t,a)=>(0,l.pz)({errorMetadata:await fe(e,t,a),authSubErrorCode:"MultiCloudMismatch",name:_.tG.CloudMismatch,message:"Cloud Mismatch Detected",context:"Login",correlationId:t.id,errorCode:_.tG.CloudMismatch,subContext:"checkForCloudMismatch",isExpected:!0}),fe=async(e,t,a)=>{const i=await(a.getUserImage?.({id:e.id,correlation:t}))||"";return{cloud:e.cloud,accountId:e.id,email:e.profile.email,name:e.profile.name,pictureBlob:i}},ve=async(e,t,a)=>(0,l.pz)({errorMetadata:await fe(e,t,a),authSubErrorCode:"MultiCloudMismatch",name:_.tG.MultiMSARoadBlock,message:"MultiMSARoadBlock Detected",context:"Login",correlationId:t.id,errorCode:_.tG.MultiMSARoadBlock,subContext:"MultiMSARoadBlock",isExpected:!0}),ye=(e,t,a,i)=>{ie(a)&&e.addEventData([`isSameToken: ${i===t.token}`]);const n=(e=>{const t=(e-Math.floor((new Date).getTime()/_.zB.MILLI_PER_SECOND))*_.zB.MILLI_PER_SECOND/_.zB.ONE_MINUTE;return Math.floor(t)})(t.expires);e.addEventData([`tokenLifeTime: ${n}`,`fromCache: ${t.fromCache}`])},Se=(e,t,a,i,r)=>{t.addEventData(["ccmUser:1"]);const o=r?.("disableNewCCMSeparator")?"_":"_teamsccm_";return a.isShortLinkUrl?(t.addEventData(["shortMeetingDetails:1"]),e.id=`${e.id}${o}${a.meetingCode}`):(t.addEventData(["legacyMeetingDetails:1"]),e.id=`${e.id}${o}${a.conversationId}`),e.type=n.aS.Anonymous,e.profile.name=i,c.Vh.put((0,u.Xr)(H(e)).meetingDetails,a),t.addScenarioMark("ccm_flow_end"),e},Ee=(e,t)=>{const{options:a,user:i,getSetting:r}=e,o=r?.("disableSetAnonymousSettingOnRedirect"),s=c.Vh.getValue(u.O4.eOtpLoginUser),l=!!a.extraQueryParameters?.otpAccount||!!s;l&&!o&&(0,m.M1)(!0);if(!(0,m.u_)(!!r?.("enableOTPMeetings")))return i;if(c.Vh.del(u.O4.eOtpLoginUser),!l||"mail"!==i.profile.idp||i.profile.tid!==_.xD.services)return i;const d=a.meetingDeepLink?.lastIndexOf("/")||0,p=a?.meetingDeepLink?.slice(d+1);return t.addEventData(["otpUser:1"]),i.subType=n.as.Eotp,i.type=n.aS.Anonymous,i.role=n.a7.Anonymous,i.profile.upn=i.userName,c.Vh.put((0,u.Xr)(H(i)).meetingDetails,a.meetingDetails||p),i},Ce=async(e,t,a)=>{const i=await(a.getUserImage?.({id:e.id,correlation:t}))||"",n={cloud:e.cloud,accountId:e.id,email:e.profile.email||e.userName,name:e.profile.name,pictureBlob:i};return(0,l.pz)({errorMetadata:n,authSubErrorCode:"MsaUserNotAllowed",name:_.tG.CloudMismatch,message:"msa user Detected",context:"Login",correlationId:t.id,errorCode:_.tG.MsaUserNotAllowed,subContext:"msaUserNotAllowedError",isExpected:!0})},be=e=>({id:`dummy-user-${e.profile?.tid}-${e.homeAccountId}`,userName:e.userName,profile:{acct:1,altsecid:"",amr:[],aud:"",exp:-1,email:e.profile?.email,family_name:"",given_name:e.profile?.given_name,iat:1,iss:"",name:e.profile?.name,preferred_username:e.userName||e.profile?.email,nbf:-1,nonce:"",oid:`dummy-user-${e.profile?.tid}`,onprem_sid:"",sub:"",tid:e.profile?.tid,unique_name:e.profile?.unique_name,upn:e.profile?.email,ver:"1.0",isHomeAccount:!1},homeAccountId:e.homeAccountId||e.id,homeTenantId:e.homeTenantId||e.profile?.tid,homeAccountCloud:e.homeAccountCloud||e.cloud,isAuthenticated:!1,type:n.aS.Aad,cloud:e.cloud,role:e.role}),we=(e,t)=>!t.some((t=>t.cloud===e)),ke=(e,t)=>{const a=t?.("cloudAuthorityMap");if(!a||!e)return;const i=e.split("/");if(i.length<4)return;const o=i?.[2],s=i?.[3];if(s&&s===r.lV)return n.el.life;const _=a.find((e=>e.authority===`https://${o}/`))?.cloud,c=t?.("buildCloud");return c!==n.el.dod&&c!==n.el.gcch||"dod"!==_&&"gcch"!==_?_?n.el[_]:void 0:c},Ae=(e,t)=>!!c.Vh.getAllOfType("User").find((t=>t.id===e?.id))?e:(c.Vh.del(u.O4.globalUser),t?.addScenarioMark("auth_web_global_user_invalid"),void t?.addEventData(["validGlobalUser:0","userId:"+ +!!e?.id]))},607504:(e,t,a)=>{"use strict";a.d(t,{J:()=>n,X:()=>r});var i=a(356184);const n=e=>i.Buffer.from(e).toString("base64"),r=e=>i.Buffer.from(e,"base64")},136680:(e,t,a)=>{"use strict";a.d(t,{lZ:()=>_,cR:()=>c,sG:()=>l,Rq:()=>d,ak:()=>p,KD:()=>u,O8:()=>m,TE:()=>h,oQ:()=>g});var i=a(293980),n=a(417291),r=a(734630),o=a(901746),s=a(328792);const _=e=>r.Vh.getValue((0,o.Xr)((0,s.X_)(e)).userAuthState),c=e=>{if(!e)return;const t=(0,n.K_)(e,void 0);if(!t||!t.homeAccountId||t.homeAccountId===t.id)return t;return(0,n.K_)(t.homeAccountId,void 0)},l=(e,t)=>{if(!e||!t)return;return r.Vh.getAllOfType("User").find((a=>a.homeAccountId===e&&a.profile.tid===t))},d=()=>r.Vh.getAllOfType("User")?.filter((e=>m(e)&&!u(e)))?.[0],p=(e,t)=>{const a=(0,n.K_)(e,void 0);if(!a)return"SkypeMigrationAccountSwap"===t?[(0,n.K_)(void 0,void 0),[]]:[a,[]];if(e){const t=(0,n.qf)(e)||[];return[a,t]}const i=(0,n.K_)(a.homeAccountId,void 0)||a,r=(0,n.qf)(i.id)||[];return i.id===a.id||m(i)?[i,r]:(r.push(i),[a,r.filter((e=>e.id!==a.id))])},u=e=>!(!e||!e.homeAccountId||e.homeAccountId===e.id),m=e=>e.type!==i.aS.Anonymous&&!e.id.startsWith("dummy-user-"),h=e=>{const t=r.Vh.getAllOfType("User")?.filter(Boolean)?.filter((t=>m(t)&&t.cloud===e)),a=t?.filter((e=>!u(e)));return a?.[0]||t?.[0]},g=e=>({message:`user for id: '${e}' not found. if id is undefined, global user should return`,errorCode:"NoAccountFoundForLogout",isExpected:!0,context:"get-user-utilities",subContext:"getUserForLogout",correlationId:"",name:"NoAccountFoundForLogout"})},449009:(e,t,a)=>{"use strict";var i;a.d(t,{Fe:()=>d,zs:()=>l}),function(e){e[e.HomeTenant=0]="HomeTenant",e[e.GuestTenant=1]="GuestTenant",e[e.Anonymous=2]="Anonymous"}(i||(i={}));var n=a(293980),r=a(901746),o=a(734630),s=a(242030),_=a(136680);const c=["logoutSetting"],l=(e,t,a,i)=>{s.D.log(`[core-auth-base][${a}][${t.correlation.id}] settings logged out state to: ${e}. Reason : ${t.reason||"unset"}, uid: ${t.accountId}`);const n={};c.forEach((e=>{void 0!==i?.(e)&&(n[e]=i?.(e))}));const _=i?.("buildCloud");if((o.Vh.getAllOfType("User").filter((e=>e.cloud===_))??[]).length>0&&e)return;if(!0===i?.("enableRopcFlow"))return;const l={isLoggedOut:e,reason:t.reason||"unset",settings:n};o.Vh.put(r.O4.logoutState,l)},d=e=>({accountId:e.id,isPrimaryUser:o.Vh.getValue(r.O4.primaryUserId)===e.id,isMostRecentUser:o.Vh.getValue(r.O4.globalUser)?.id===e.id,state:(0,_.lZ)(e)?.state||n.p8.Unknown,userType:p(e),isAuthenticated:!!e.isAuthenticated}),p=e=>e.type===n.aS.Anonymous?i.Anonymous:(0,_.KD)(e)?i.GuestTenant:i.HomeTenant},870866:(e,t,a)=>{"use strict";var i,n;a.d(t,{k:()=>i,n:()=>n}),function(e){e.Up="Up",e.InteractionRequired="InteractionRequired",e.AADReconnecting="AADReconnecting",e.SkypeReconnecting="SkypeReconnecting",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.RestartDevice="RestartDevice"}(i||(i={})),function(e){e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.Success="Success",e.LicenseError="LicenseError",e.SignInRestriction="SignInRestriction",e.RestartDevice="RestartDevice",e.Unknown="Unknown"}(n||(n={}))},942788:(e,t,a)=>{"use strict";var i,n,r,o,s,_;a.d(t,{Uh:()=>i,Zr:()=>n,F7:()=>r,C2:()=>o,bx:()=>s,Nu:()=>_}),function(e){e.SUCCESS="SUCCESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.TIMEOUT="TIMEOUT"}(i||(i={})),function(e){e.prod="prod",e.life="life",e.dod="dod",e.gcch="gcch",e.gallatin="gallatin",e.airgap08="airgap08",e.airgap09="airgap09"}(n||(n={})),function(e){e.Aad="Aad",e.MsaLife="MsaLife"}(r||(r={})),function(e){e.AADReconnecting="AADReconnecting",e.Failure="Failure",e.InteractionRequired="InteractionRequired",e.SignInRestriction="SignInRestriction",e.SkypeReconnecting="SkypeReconnecting",e.Up="Up"}(o||(o={})),function(e){e.UserDataXCloud="userdataxcloud",e.Auth="auth",e.Core="core",e.Hostcapabilities="hostcapabilities"}(s||(s={})),function(e){e[e.Msa=0]="Msa",e[e.MsaLife=1]="MsaLife",e[e.Other=2]="Other"}(_||(_={}))},494514:(e,t,a)=>{"use strict";var i,n,r,o,s;a.d(t,{IO:()=>i,Wx:()=>n,$b:()=>r,BV:()=>o,fP:()=>s,lV:()=>_,p$:()=>c,Vn:()=>l}),function(e){e.POP="pop",e.BEARER="Bearer"}(i||(i={})),function(e){e[e.Skype=0]="Skype",e[e.AAD=1]="AAD",e[e.CAE=2]="CAE"}(n||(n={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(r||(r={})),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(o||(o={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT="https://api.spaces.skype.com",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.AAD_V2_TFL="https://mtsvc.fl.teams.microsoft.com/teams.mt.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation",e.FORMS_AUTH_URL="MicrosoftForms.ReadWrite",e.SEARCH_SERVICE_AUTH_RESOURCE="https://searchsvc.fl.teams.microsoft.com/teams.search.readwrite",e.SUBSTRATE_TOKEN_URL="https://substrate.office.com/M365.Access",e.UNIFIED_STORAGE_QUOTA="https://graph.microsoft.com/Files.ReadWrite",e.MY_MS_PERSONAL_CONTENT_V2="https://my.microsoftpersonalcontent.com/v2/.default",e.HOME_MS_PERSONAL_CONTENT_V2="https://home.microsoftpersonalcontent.com/v2/.default",e.GRAPH_API_BASE_URL_DEFAULT="https://graph.microsoft.com/.default",e.AAD_MT_TFL="service::api.fl.teams.microsoft.com::MBI_SSL"}(s||(s={}));const _="9188040d-6c67-4c5b-b112-36a304b66dad";var c,l;!function(e){e.DEFAULT="DEFAULT",e.MEETING="MEETING",e.SKYPEMIGRATION="SKYPEMIGRATION"}(c||(c={})),function(e){e.License="License",e.SigninRestriction="SigninRestriction",e.Offline="Offline",e.MSA="MSA",e.AccessDenied="AccessDenied",e.FunctionalityNotAvailable="FunctionalityNotAvailable",e.Generic="Generic",e.STMUnsupported="STMUnsupported",e.NotTrialEligible="NotTrialEligible"}(l||(l={}))},135449:(e,t,a)=>{"use strict";var i,n;a.d(t,{p:()=>i,f:()=>n}),function(e){e.ActiveDirectoryGroupService="ActiveDirectoryGroupService",e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AppService="appservice",e.AppStudio="appstudio",e.AMS="asyncMediaService",e.AtpSafelinksService="atpSafelinksService",e.Attendee="attendee",e.AllFiles="allFiles",e.Auth="auth",e.Badger="badger",e.BRB="brb",e.CDN="cdn",e.CallingConversationService="callingConversationService",e.ChannelNotificationSettings="channelNotificationSettings",e.CognitiveService="cognitiveService",e.ChatService="chatservice",e.CMDArtifactsService="cmdArtifactsService",e.CmdMeetingIntelligenceService="cmdMeetingIntelligenceService",e.CMDServices="cmdServices",e.CNS="cns",e.CollabCloudService="collabCloudService",e.CSA="csa",e.CustomEmoji="customEmoji",e.CXCS="cxcs",e.DynamicsMarketing="dynamicsMarketing",e.DynamicsVirtualEvents="dynamicsVirtualEvents",e.ECS="ecs",e.Graph="graph",e.GroupsServiceV2="groupsServiceV2",e.SearchService="searchService",e.InstantAnswers="instantanswers",e.Iris="iris",e.CustomCopilotBotService="customCopilotBotService",e.Loki="loki",e.LokiWrapper="lokiWrapper",e.MeetingArtifacts="meetingArtifacts",e.MeetingIntelligenceService="meetingIntelligenceService",e.MeetingRecapService="meetingRecapService",e.MeetingRecapWorkingSetFilesService="meetingRecapWorkingSetFilesService",e.MeetingRecapSwa="meetingRecapSwa",e.MeetingRecapMOService="meetingRecapMOService",e.MeetingOptions="meetingOptionsService",e.MeetingTemplates="meetingTemplates",e.MiddleTier="mt",e.MsaContacts="msaContacts",e.MSGraph="msGraph",e.NetworkPing="networkPing",e.NotificationSettingsService="notificationSettingsService",e.OCV="ocv",e.Ocws="ocws",e.ODS="ods",e.OSearch="osearch",e.Payment="payment",e.PeopleTargetingService="peopleTargetingService",e.PhonelinkSmsService="phonelinkSmsService",e.PowerApps="powerapps",e.PPTCast="pptcast",e.Registrar="registrar",e.Sharepoint="sharepoint",e.ShareToOutlook="shareToOutlookService",e.Skype="skype",e.Substrate="substrate",e.Suggestion="suggestion",e.TAMS="teamsAdminService",e.TeamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.TeamsCopilotAggregator="teamsCopilotAggregator",e.TeamsCopilotService="teamsCopilotService",e.TeamsEmoji="teamsEmoji",e.TeamsPushService="teamsPushService",e.Tenants="tenants",e.TpnService="tpnService",e.UnifiedConsent="unifiedConsent",e.UnifiedPresence="unifiedPresence",e.UnifiedStorageQuotaService="unifiedStorageQuotaService",e.UserEntitlement="ues",e.UserProfileService="userProfileService",e.VivaInsights="vivaInsights",e.VirtualConsumerEvents="virtualConsumerEvents",e.CaptchaChallenge="captchaChallenge",e.Vroom="vroom",e.Webinar="webinar",e.Workflows="workflows",e.VivaInsightsMT="vivaInsightsMt",e.MeetingSchedulingService="schedulingService",e.Yammer="yammer",e.Places="places"}(i||(i={})),function(e){e.xMsClientType="x-ms-client-type",e.xMsClientVersion="x-ms-client-version",e.xMsSessionId="x-ms-session-id",e.xMsRequestId="x-ms-request-id",e.xMsClientCaller="x-ms-client-caller",e.xMsUserType="x-ms-user-type",e.xMsObjectId="x-ms-object-id"}(n||(n={}))},856429:(e,t,a)=>{"use strict";a.d(t,{x:()=>o,r:()=>s});var i=a(912435),n=a(183111);let r;const o=e=>async t=>{if(!r)return e(t);return e(t).then((e=>(r?.processResponse(e),e))).catch((e=>{throw r?.processError(e),e}))};function s(e,t){if(r){throw(0,i.$5)(n.Ir.Tasks,n.O4.AlreadyInitialized,"subscribeToSendNetworkTracking",void 0,"subscription exists")}r={processResponse:e,processError:t};return()=>{r=void 0}}},653982:(e,t,a)=>{"use strict";a.d(t,{tg:()=>b,s_:()=>x});var i,n=a(401368),r=a(173065),o=a(134185),s=a(515292);!function(e){e.HEALTHY="healthy",e.UNHEALTHY="unhealthy",e.UNKNOWN="unknown"}(i||(i={}));var _=a(400695),c=a(850305),l=a(804437),d=a(290236),p=a(845097),u=a(912435),m=a(480354);const h={headers:{sharePoint:{SPRequestGuid:"SPRequestGuid",SPClientServiceRequestDuration:"SPClientServiceRequestDuration",SPRequestDuration:"SPRequestDuration"}}},g="cache",f="cache-control",v="x-cache",y="electron";var S;!function(e){e.CDN="CDN",e.Shared="Shared",e.Browser="Browser",e.None="None"}(S||(S={}));let E="";async function C(e){const{status:t,responseHeaders:a,requestHeaders:i,performance:n}=e,r=await async function(e){try{return await e}catch(e){return}}(n);return Object.assign(e,{requestHeaders:(o=i,k(["clientRequestId","x-ms-request-id","x-ms-client-caller","x-ms-request-priority"],o)),responseHeaders:T(t,a),performance:O(r)});var o}const b=(e,t,a,o="")=>{const s=(t.get(n.w.Telemetry).httpnsDisabledServices??[]).map((e=>e.toLowerCase()));return async t=>{const{serviceName:n,apiName:h,result:g,innerError:f,operationLogs:v}=t;if(f&&(0,u.WZ)(f))return;t.operationLogs=await function(e){const t=e.map((async e=>{const{type:t,duration:a,result:i,request:n}=e;return{type:t,duration:a,result:i,request:n&&await C(n)}}));return Promise.all(t)}(v);const y=n.toLowerCase(),S=s.some((e=>e===y));E=o;const b=t.correlationId||(0,p.v4)(),k=P(n,h),A=(0,m.first)(t.operationLogs.map((e=>e.request?.responseHeaders?.serverRequestId)).filter(Boolean)),T=`Data call ${k} is completed with ${g}. CorrelationId: ${b}. ServerRequestId: ${A}.`;a.log(T),S||t.operationLogs.forEach((t=>{if(t.request){const{name:a,method:i}=t.request;I(e,D(n,a||h,i),"EM",t,b)}})),function(e,t,a){const{serviceName:n,apiName:o,createdTime:s,duration:p,parameters:u,result:m,statusCode:h,innerError:g,operationLogs:f}=e,v=function(e,t){const a=(0,d.AR)().getEndpointHealth(e,t);return void 0===a?i.UNKNOWN:a?i.HEALTHY:i.UNHEALTHY}(n,o);f.forEach((e=>{if(e.request){const{method:t}=e.request;!function(e,t,a,i,n,o,s){const _=t.request;if(_){const{duration:d,result:p}=t,{method:u,hostname:m,performance:h,responseHeaders:g,requestHeaders:f,dateTime:v,authPerformanceLogs:y}=_,S={apiName:i,serviceName:n,duration:d,result:w(p),correlationId:a,method:u,hostname:m,responseHeaders:(0,l.hR)(g),requestHeaders:(0,l.hR)(f),healthState:o,timestamp:v.toISOString(),hasInnerError:!!s};h&&(h.duration&&(S.perf_duration=h.duration.toString()),S.perf_details=(0,l.hR)({...h,...y})),(0,c.wW)(r.Q.Endpoint,e,S,void 0,void 0,void 0,E)}}(D(n,o,t),e,a,o,n,v,g)}}));const y=m===_.B.RequireStatusFailed?`${m}-${h}`:m,S={apiName:o,serviceName:n,duration:p,result:y,innerError:(0,l.hR)(g),correlationId:a,userAgent:t.navigator.userAgent,timestamp:s,operationLogs:(0,l.hR)(f),parameters:(0,l.hR)(u),ECT:t.navigator?.connection?.effectiveType,healthState:v},C=P(n,o);(0,c.wW)(r.Q.Endpoint,C,S,void 0,void 0,void 0,E)}(t,e,b)}};function w(e){let t;return e instanceof Error&&(t=e.innerException?`${e.reason} / ${(0,l.hR)(e.innerException)}`:e.reason),t||e||""}function k(e,t){const a={};return t&&e.forEach((e=>{t[e]&&(a[e]=t[e])})),a}function A(e=""){if(!e)return e;let t=0;return e.split(",").forEach((e=>{const a=e.split("/");t+=+a[0]+ +a[1]})),`${t}`}function T(e,t){return t?{contentLength:t["content-length"]||"-1",serverRequestId:t.contextid||t["x-serverrequestid"]||t["request-id"]||M(t),[g]:N(e,t),requestId:t["x-ms-request-id"],invalidToken:t["x-invalid-token"],afdCorrelationId:t["x-msedge-ref"],serverLatency:t["x-end2endlatencyms"],serviceOrigin:t["x-servicering"],cafeLatency:A(t["x-cafeproxylatency"]),requestPriority:t["x-ms-request-priority"]}:{}}const x=(e,t,a,i,n,r,s)=>{const _=s||o.nW[i?.status]||"",c=function(e){const t={};if(e)for(const a of Object.keys(e.headers)){t[a.toLowerCase()]=e.headers[a]}return t}(i),{serviceName:l,apiName:d,method:p,authPerformanceLogs:u}=a;I(r,D(l,d,p),"SEND",{type:o.ew.Initial,duration:e,result:_,request:{name:d||"undefined",dateTime:t,method:a.method,hostname:i&&new URL(i.url).hostname,status:i?.status,requestHeaders:a.headers||{},responseHeaders:c,performance:n,authPerformanceLogs:u}},a.correlationId)};const I=({navigator:e},t,a,i,n)=>{const _=i.request;if(_){const{dateTime:d,method:p,hostname:u,status:m,requestHeaders:h,responseHeaders:f,performance:v,authPerformanceLogs:S}=_,C={ECT:e?.connection?.effectiveType,hostname:u,transport:a,requestCreatedTime:d.toISOString(),networkState:e.onLine?s.Kv.ONLINE:s.Kv.OFFLINE,method:p,resultCode:m,requestResult:w(i.result),contentLength:f["content-length"]||-1,serverRequestId:f.contextid||f["x-serverrequestid"]||f["request-id"]||M(f),correlationId:n,duration:i.duration,authPerformanceLogs:(0,l.hR)(S)};!function(e,t,a,i,n){const r=i&&i.clientRequestId,s=a["x-ms-request-id"]||i["x-ms-request-id"];e.requestId=s,r&&(e.clientRequestId=r);a["x-invalid-token"]&&(e.invalidToken=a["x-invalid-token"]);t!==o.nW.OK&&(e.afdCorrelationId=a["x-msedge-ref"]);e.hasClaims=!!n&&!!n.hasClaims}(C,m,f,h,S),C[g]=N(m,f),function(e,t,a){if(a){const i=a.domainLookupEnd-a.domainLookupStart,n=a.connectEnd-a.connectStart,r=a.redirectEnd-a.redirectStart;if(i>0&&(e.dns=i),n>0&&(e.tcp=n),r>0&&(e.redirect=r),e.size=a.transferSize,e.payload=a.encodedBodySize,e.start=a.startTime,e.reqStart=a.requestStart,e.respStart=a.responseStart,a.duration){const i=a.duration;(-1===t.userAgent.toLowerCase().indexOf(y)||e.duration&&i>e.duration)&&(e.duration=i)}}}(C,e,v),(0,c.wW)(r.Q.Http,t,C,void 0,void 0,void 0,E)}};function M(e){let t=e[h.headers.sharePoint.SPRequestGuid.toLowerCase()]||"";return"[object String]"===Object.prototype.toString.call(t)&&t.length>0&&(t=[`${h.headers.sharePoint.SPRequestGuid}=${t}`,`${h.headers.sharePoint.SPClientServiceRequestDuration}=${e[h.headers.sharePoint.SPClientServiceRequestDuration.toLowerCase()]||""}`,`${h.headers.sharePoint.SPRequestDuration}=${e[h.headers.sharePoint.SPRequestDuration.toLowerCase()]||""}`].join(";")),t}function O(e){if(e){const{duration:t,domainLookupStart:a,domainLookupEnd:i,connectStart:n,connectEnd:r,redirectStart:o,redirectEnd:s,transferSize:_,encodedBodySize:c,startTime:l,requestStart:d,responseStart:p}=e;return{duration:t,dns:i-a,tcpHandshakeTime:r-n,redirectTime:s-o,transferSize:_,encodedBodySize:c,startTime:l,requestStart:d,responseStart:p}}return{}}function N(e,t){let a=S.None;if(t.hasOwnProperty(f)){const i=t[f];e===o.nW.NOT_MODIFIED?a=S.Browser:i.includes("no-store")||i.includes("no-cache")||(a=S.Browser,i.includes("public")&&(a+=", ".concat(S.Shared)))}else t.hasOwnProperty("expires")&&(a=S.Browser);if(t.hasOwnProperty(v)){t[v].toLowerCase().includes("hit")&&(a===S.None?a=S.CDN:a+=", ".concat(S.CDN))}return a}function D(e,t,a){return`${e}_${t||"undefined"}_${a}`}function P(e,t){return`${t}_${e}`}},363612:(e,t,a)=>{"use strict";a.d(t,{f:()=>s});var i=a(401368),n=a(173065),r=a(1586);const o=r.y0.NSD;class s{constructor(){this.enableFiltering=!1,this.eventPrivacyDataControlLevelOverrides={},this.initialized=!1,this.userPrivacyDataControlLevelMap=new Map,this.defaultUserPrivacyDataControlLevel=r.HA.Unset,this.updateSettings=(e={enablePrivacySuppressionServiceFiltering:void 0,privacySuppressionServiceEventPdcDefaults:void 0,privacySuppressionServiceUserPdcOverride:void 0,privacySuppressionServiceEventPdcOverrides:void 0})=>{this.enableFiltering=e.enablePrivacySuppressionServiceFiltering??!1,this.eventPrivacyDataControlDefaults=e.privacySuppressionServiceEventPdcDefaults??{},this.userPrivacyDataControlLevelOverride=this.ocpsTelemetryCategoryToUserPrivacyDataControlLevel(e.privacySuppressionServiceUserPdcOverride),this.eventPrivacyDataControlLevelOverrides=e.privacySuppressionServiceEventPdcOverrides?e.privacySuppressionServiceEventPdcOverrides:{},this.defaultUserPrivacyDataControlLevel=this.ocpsTelemetryCategoryToUserPrivacyDataControlLevel(e.ocpsSendTelemetry)}}static getInstance(){return this.privacySuppressionService||(this.privacySuppressionService=new s),this.privacySuppressionService}initialize(e){const t=e.getObservable(i.w.Telemetry);this.settingsSubscription=t.subscribe(this.updateSettings);const a=e.get(i.w.Telemetry);this.updateSettings(a),this.initialized=!0}destroy(){this.settingsSubscription?.unsubscribe(),this.initialized=!1}getPrivacySuppression(e,t,a,i=""){if(!this.initialized||!this.enableFiltering)return{suppress:!1};const n=this.getUserPrivacyLevel(i),r=this.getEventPrivacyLevel(e,t,a);return{suppress:this.isEventFiltered(n,r),eventpdclevel:r,userpdclevel:n}}setUserPrivacyLevel(e,t="NotConfigured"){this.userPrivacyDataControlLevelMap.set(e,this.ocpsTelemetryCategoryToUserPrivacyDataControlLevel(t))}getUserPrivacyLevel(e){return this.userPrivacyDataControlLevelOverride??this.userPrivacyDataControlLevelMap.get(e)??this.defaultUserPrivacyDataControlLevel}getEventPrivacyLevel(e,t,a){switch(e){case n.Q.Scenario:case n.Q.Logging:return this.referencePrivacyLevelSimpleType(e,t,a);case n.Q.UserBI:return this.referencePrivacyLevelUserbi(t);case n.Q.Perf:case n.Q.Heartbeat:case n.Q.Http:case n.Q.Endpoint:default:return this.referencePrivacyLevelUnsupported(e)}}isEventFiltered(e,t){switch(e){case r.HA.Basic:return t===r.y0.Enhanced;case r.HA.NSD:return t!==r.y0.NSD;default:return!1}}ocpsTelemetryCategoryToUserPrivacyDataControlLevel(e){switch(e){case"Required":return r.HA.Basic;case"Optional":return r.HA.Enhanced;case"Neither":return r.HA.NSD;default:return r.HA.Unset}}referencePrivacyLevelSimpleType(e,t,a){return this.eventPrivacyDataControlLevelOverrides[e]?.[t]??a??this.getSimpleSchemaPrivacyLevel(e,t)??this.referencePrivacyLevelUnsupported(e)}getSimpleSchemaPrivacyLevel(e,t){return r.jw[e]?.[t]}getUserBiSchemaPrivacyLevel(e,t){return r.jw[n.Q.UserBI]?.[e]?.[t]}getSchemaUserbiSubcategories(){return Object.keys(r.jw[n.Q.UserBI]??{})}referencePrivacyLevelUserbi(e){return e.split("_").map(this.mapUserBiIdentifierToPrivacyLevel,this).reduce(this.comparePrivacyLevels)}referencePrivacyLevelUnsupported(e){return this.eventPrivacyDataControlDefaults?.[e]??o}mapUserBiIdentifierToPrivacyLevel(e){for(const t of this.getSchemaUserbiSubcategories()){const a=this.eventPrivacyDataControlLevelOverrides[n.Q.UserBI]?.[t]?.[e]??this.getUserBiSchemaPrivacyLevel(t,e);if(a)return a}return this.referencePrivacyLevelUnsupported(n.Q.UserBI)}comparePrivacyLevels(e,t){return e===r.y0.NSD||t===r.y0.NSD?r.y0.NSD:e===r.y0.Basic||t===r.y0.Basic?r.y0.Basic:r.y0.Enhanced}}},850305:(e,t,a)=>{"use strict";a.d(t,{Tn:()=>u,DC:()=>m,Cs:()=>h,Oq:()=>g,wW:()=>f,ni:()=>v,ZU:()=>y});var i=a(290236),n=a(927215),r=a(885617),o=a(173065),s=a(861960),_=a(134185),c=a(363645),l=a(363612);const d="heartbeat",p=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;class u{constructor(e){this.initialized=!1,this.logger=r.MP.default,this.eventDecoratorCallbacks=[],this.flush=()=>this.telemetryProvider.flush(),this.telemetryProvider=e??(0,i.AR)(),(0,n.d)((()=>{this.initialized=!1,this.eventDecoratorCallbacks=[]}))}get sessionId(){return this.telemetryProvider.sessionId}initialize(e,t=r.MP.default){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),this.logger=t,this.initialized=!0)}static getInstance(){return this.telemetrySender||(this.telemetrySender=new u),this.telemetrySender}registerEventDecorator(e){this.eventDecoratorCallbacks.push(e)}sendTelemetry(e,t,a={},i,n,r,c=""){if(!this.initialized)return;const d=l.f.getInstance().getPrivacySuppression(e,t,void 0,c);if(d.suppress)return;t=t.replace(/\-/g,"_").toLowerCase();const u=e===o.Q.Http?a.resultCode:e===o.Q.Endpoint&&a.result&&_.nW[a.result]?_.nW[a.result].toString():e===o.Q.Endpoint&&a.hasInnerError?"fail":"success",m=s.Z.getInstance().getSampleRate(e,r??t,u),h=m===s.b;if(h&&!this.telemetryProvider.eventCapture?.capturingEvents)return;this.decorateEvent(t,a);const g=this.telemetryProvider.createEvent(e,t,a,i,n,r);this.appendPrivacySuppresionDataToEvent(d,g);const f=s.Z.getInstance().getCohortId()||"";p.test(f)&&g.setProperty("sampleCohortUserId",f),g.setProperty("sampleCohortValue",s.Z.getInstance().getCurrentCohort()),g.setProperty("sampleRate",m),h?this.telemetryProvider.eventCapture?.captureEvent({name:g.name,timestamp:g.timestamp,eventType:g.eventType,properties:g.properties},this.logger,c,!0):this.telemetryProvider.logEvent(this.logger,g,c)}sendScenarioEvent(e,t,a,i,n,r=""){if(!this.initialized)return;const _=(0,c.bq)(e),d=(0,c.KA)(e),p=_.replace(/\-/g,"_"),u=o.Q.Scenario,m=l.f.getInstance().getPrivacySuppression(u,_,d,r);if(m.suppress)return;let h=s.Z.getInstance().getSampleRate(u,p,a["Scenario.Status"]);"Scenario.CrossClientMode"in t&&(h=s.Z.getInstance().getCrossClientScenarioSampleRate(a["Scenario.Mode"])??h);const g=h===s.b;if(g&&!this.telemetryProvider.eventCapture?.capturingEvents)return;this.decorateEvent(p,t);const f={...a,...t},v=this.telemetryProvider.createEvent(u,_,f,i,n);this.appendPrivacySuppresionDataToEvent(m,v),v.setProperty("sampleCohortUserId",s.Z.getInstance().getCohortId()||""),v.setProperty("sampleCohortValue",s.Z.getInstance().getCurrentCohort()),v.setProperty("sampleRate",h),g?this.telemetryProvider.eventCapture?.captureEvent({name:v.name,timestamp:v.timestamp,eventType:v.eventType,properties:v.properties},this.logger,r,!0):this.telemetryProvider.logEvent(this.logger,v,r)}sendHeartbeatEvent(e){if(!this.initialized)return;const t=o.Q.Heartbeat,a=l.f.getInstance().getPrivacySuppression(t,d);if(a.suppress)return;this.decorateEvent(d,e);const i=this.telemetryProvider.createEvent(t,d,e);this.appendPrivacySuppresionDataToEvent(a,i),this.telemetryProvider.logEvent(this.logger,i,void 0)}sendLoggingEvent(e,t,a,i,n,r){if(!this.initialized)return;const _=o.Q.Logging,c=l.f.getInstance().getPrivacySuppression(_,e,void 0,i);if(c.suppress)return;const d=s.Z.getInstance().getSampleRate(_,a,t.logLevel),p=d===s.b;if(p&&!this.telemetryProvider.eventCapture?.capturingEvents)return;e=e.replace(/\-/g,"_").toLowerCase(),this.decorateEvent(e,t);const u=this.telemetryProvider.createEvent(_,e,t,n,r,a);this.appendPrivacySuppresionDataToEvent(c,u),u.setProperty("sampleCohortUserId",s.Z.getInstance().getCohortId()||""),u.setProperty("sampleCohortValue",s.Z.getInstance().getCurrentCohort()),u.setProperty("sampleRate",d),p?this.telemetryProvider.eventCapture?.captureEvent({name:u.name,timestamp:u.timestamp,eventType:u.eventType,properties:u.properties},this.logger,i,!0):this.telemetryProvider.logEvent(this.logger,u,i)}isLocalScenarioSampledOut(e){if(!this.initialized||this.telemetryProvider.eventCapture?.capturingEvents)return!1;const t=e.replace(/\-/g,"_"),a=o.Q.Scenario;return s.Z.getInstance().getMaximumSampleRateForEvent(a,t)===s.b}decorateEvent(e,t){this.eventDecoratorCallbacks.forEach((a=>a(e,t)))}appendPrivacySuppresionDataToEvent(e,t){e.eventpdclevel&&(e.userpdclevel||0===e.userpdclevel)&&(t.setProperty("eventpdclevel",e.eventpdclevel),t.setProperty("userpdclevel",e.userpdclevel))}}function m(e,t,a,i,n,r=""){u.getInstance().sendScenarioEvent(e,t,a,i,n,r)}function h(e){return u.getInstance().isLocalScenarioSampledOut(e)}function g(e,t,a,i,n,r=""){u.getInstance().sendLoggingEvent(e,t,a,r,i,n)}function f(e,t,a,i,n,r,o=""){u.getInstance().sendTelemetry(e,t,a,i,n,r,o)}function v(e){u.getInstance().sendHeartbeatEvent(e)}function y(e){u.getInstance().registerEventDecorator(e)}},1586:(e,t,a)=>{"use strict";a.d(t,{jw:()=>i,y0:()=>n,HA:()=>r});const i={scenarions:{private_stream_id_write:3,feeds_get_feeds_from_reply_chain:3,activity_slice_switch:3,activity_switch:3,headline_slice_item_switch:3,feeds_focused_load:3,feeds_focused_load_more:3,feeds_new_activity_from_long_poll:3,slices_feeds_focused_load:3,slices_feeds_focused_load_more:3,feeds_remove_activity_feed_item:3,feeds_store_feed_item_namespace_load:3,feeds_store_startup:3,missed_call_feed_callback_action:3,missed_call_feed_chat_action:3,notification_settings_graph_page_load:3,notification_settings_page_load:3,notification_settings_changed:3,notification_recommended_settings_load:3,notification_recommended_settings_changed:3,activity_contextual_settings_update:3,messaging_slice_sync_items_put:3,simple_collab_slice_switch:3,simple_collab_slice_feed_load:3,simple_collab_slice_feed_load_more:3,simple_collab_thread_slice_switch:3,simple_collab_thread_slice_feed_load:3,simple_collab_thread_slice_feed_load_more:3,activity_mark_as_read:3,whiteboard_save_annotation:3,initiator_load_annotation:3,non_initiator_load_annotation:3,whiteboard_start_annotation_clickthrough:3,whiteboard_stop_annotation_clickthrough:3,app_details_dialog_discover_more_apps_fetch_data:3,app_details_dialog_discover_more_apps_fetch_same_developer_apps:3,app_details_dialog_discover_more_apps_fetch_same_category_apps:3,app_details_dialog_can_use_bot_in_conversation:3,app_details_manager_get_conversations:3,get_app_suggestions_from_app_suggestions_service:3,get_app_suggestions_from_skype_teams_app_ranking:3,mex_custom_engine_agent_tab_loading:3,mex_declarative_agent_tab_loading:3,mex_navigate_to_bizchat_from_agent_in_call_or_meeting:3,mex_get_gpt_list:3,mex_cea_groupchat_to_personal_esc_agents_loading:3,mex_cea_groupchat_to_personal_escalation:3,parse_app_deeplink_params_from_url:3,apps_slash_command_compose_install_app_scenario:3,app_switcher_check_t1_cleanup_policy:3,app_switcher_observe_use_new_teams_policy:3,app_switcher_identify_cohort:3,app_switcher_identify_policy:3,appswitcher_tac_policy_expiration:3,auth_account_selection:3,google_auth_get_auth_code:3,get_google_auth_code_external_browser:3,auth_restart_learn_more_clicked:3,call_not_active_scenario:3,meet_now_failed_scenario:3,validation_scenario:3,transfer_call_scenario:3,transport_agent_initialization:3,transport_agent_reinitialization:3,transport_agent_lazy_load:3,transport_agent_incoming_session:3,transport_agent_session_ended:3,"b2g:incoming_command_received_scenario":3,"b2g:ack_incoming_command_failure":3,"b2g:ack_incoming_command_success":3,"b2g:send_outgoing_command":3,"b2g:room_remote_proximity_banner":3,show_call_transfer_ufd:3,transfer_call_using_ufd:3,select_transport_companion_devices:3,unselect_transport_companion_devices:3,face_enrollment:3,start_enrollment_voice:3,stop_enrollment_voice:3,cancel_enrollment_voice:3,voice_enrollment:3,recognizer_cancellation:3,recognizer_disconnection:3,delete_enrollment_voice:3,fetch_user_enrollment_status_voice:3,refresh_enrollment_status_voice:3,fetch_user_voice_signature:3,download_biometric_export_data:3,cache_enrollment_status_voice:3,get_cached_enrollment_status_voice:3,cache_user_voice_signature:3,get_cached_voice_signature:3,pns_ufd_notification:3,pns_background_loud_speech_suppressed_ufd:3,pns_background_loud_speech_suppressed_ufd_turn_pns_off:3,pns_update_user_passive_enrollment_consent:3,pns_get_user_passive_enrollment_consent:3,byod_attendee_view:3,byod_attendee_popout:3,byod_device_settings_toggle:3,delete_connected_calendar_setting:3,teams_cal_v3:3,cal_load_date_range_changed:3,cal_load_try_again:3,calendar_manage_virtual_event:3,screen_sharing_tab_trustedui_launch:3,nps_survey_anonymous_user_on_calling_end:3,call_history_query:3,call_history_missed_call_status_mutation:3,calls_app_tabs_query:3,call_history_resolver_fetch:3,call_history_maintenance_job:3,call_history_delta_sync_job:3,call_history_historical_sync_job:3,call_history_sync_workflow:3,mark_call_log_as_deleted_job:3,"mark-call-log-as-deleted-workflow":3,call_history_maintenance_workflow:3,ext_bots_invoke:3,ext_bots_messageback:3,ext_bots_card_action_chat_send_message:3,get_channel_shared_files:3,get_channel_system_messages:3,get_channel_pinned_posts:3,get_channel_recent_contributors:3,get_channel_recent_contributors_online:3,get_channel_system_messages_service_api:3,get_channel_pinned_posts_service_api:3,fetch_channel_system_messages_workflow:3,fetch_channel_system_messages_job:3,fetch_channel_pinned_posts_workflow:3,fetch_channel_pinned_posts_job:3,channel_l1_deeplink:3,channel_l2_deeplink:3,channel_copilot_streaming_answer:3,channel_get_email:3,channel_update_email_settings:3,channel_remove_email:3,channel_download_email:3,get_chat_pinned_messages:3,block_unblock_contact:3,flyout_search_l2:3,external_topn_idb_populate:3,external_get_topn_suggestions:3,cloud_peoplefeed_start_reliability:3,cloud_peoplefeed_stop_reliability:3,cloud_peoplefeed_receiver_start_reliability:3,cloud_peoplefeed_receiver_stop_reliability:3,cloud_peoplefeed_bot_invite:3,cloud_peoplefeed_bot_joined:3,cloud_peoplefeed_bot_left:3,cloud_peoplefeed_bot_setup:3,cloud_peoplefeed_focus:3,cloud_peoplefeed_enabled_receive:3,cloud_peoplefeed_room_toggle:3,cloud_peoplefeed_select_view:3,cloud_peoplefeed_enabled_send:3,render_communities_l1_main:1,render_communities_l2_main:1,communities_get_join_link:3,communities_guidelines_load:3,communities_guidelines_acked:3,communities_report_concern:3,communities_accept_invitation:3,communities_save_nickname:3,communities_edit_nickname_resolver:3,communities_edit_website_link:3,communities_decline_invitation:3,communities_request_join:3,create_community:3,community_delete_channel:3,edit_community:3,edit_community_avatar:3,communities_invite_users:3,communities_off_network_invite:3,community_member_role_update_mutation:3,communities_delete:3,communities_join_action:3,fetch_communities_details:3,communities_get_avatar:3,communities_join_requests_list:3,communities_join_requests_accept:3,communities_join_requests_decline:3,communities_join_request_report:3,communities_roster_summary:3,communities_fetch_join_information:3,communities_fetch_thread_properties:3,communities_create_channel:3,update_per_community_notification_settings:3,per_community_notification_settings:3,communities_welcome_bot_install:3,communities_welcome_bot_uninstall:3,communities_block_member:3,communities_unblock_member:3,communities_email_notification_settings:3,update_communities_email_notification_settings:3,get_communities_welcomebot_config:3,update_communities_welcomebot_config:3,roster_change_log_sync_job:3,communities_create_new_link:3,communities_share_join_link_toggle:3,communities_toast_event_nickname:3,communities_get_coverimage:3,communities_get_favicon:3,communities_update_coverimage:3,is_user_present_in_community:3,communities_fetch_members_details:3,search_featured_communities:3,get_communities_featured_state:3,update_community_featured_state:3,get_communities_pinned_posts:3,subscribe_communities_post_pin_unpin:3,communities_community_invite_load_data:3,communities_pending_invites_new_invitation_event:3,communities_pending_invites_accept_decline_mutation:3,communities_details_by_join_link:3,contacts_roaming_devices_sync:3,contacts_query:3,custom_copilot_attachment_install_app_scenario:3,custom_copilot_attachment_delete_app_scenario:3,discover_surface_network:3,discover_surface_feeds_cdl_processing:3,discover_surface_cdl_feed_scroll:3,discover_surface_hydrate_feed_item:3,discover_surface_user_preference_hydrate_item:3,discover_surface_feed_item_updates:3,discover_surface_settings:3,discover_surface_switch:3,discover_surface_switch_v2:3,discover_surface_feed_fetch_more:3,discover_surface_feed_send_feedback_signal:3,discover_surface_feed_user_action_signal:3,discover_surface_prepopulate_feeds:3,discover_surface_poll_feeds:3,discover_surface_teams_click_hydrate:3,embed_auth_strap:3,embed_badge_count:3,embed_open_chat:3,embed_open_chat_list:3,embed_open_chat_by_teams_link:3,embed_pre_auth:3,esp_app_ready:3,esp_window_render:3,esp_display_surface:3,wiki_read:3,extensibility_app_detailed_view_install_app_scenario:3,extensibility_app_picker_fetch_thread_data:3,extensibility_app_picker_fetch_recent_section_data:3,extensibility_app_picker_fetch_project_agent:3,extensibility_app_picker_fetch_suggested_section_data:3,unified_apps_fetch_app_capabilities:3,extensibility_app_picker_fetch_custom_section_data:3,extensibility_app_picker_fetch_cms_collections_manager:3,extensibility_app_picker_fetch_cms_collections_service:3,extensibility_apps_slash_command_fetch_suggested_section_data:3,extensibility_apps_slash_command_fetch_recent_section_data:3,extensibility_app_picker_prefetch_recent_section:3,extensibility_app_picker_prefetch_custom_section:3,unified_app_capabilities_load:3,extensibility_app_picker_prefetch_suggested_section:3,extensibility_app_picker_sections_load:3,extensibility_app_picker_all_sections_load:3,extensibility_app_picker_agent_section_load:3,extensibility_app_picker_app_click:3,extensibility_app_picker_post_install:3,extensibility_app_picker_uninstall:3,extensibility_app_picker_install_app_scenario:3,extensibility_app_picker_launch_agent_create_dialog:3,platform_flyout_get_installed_apps:3,ext_meeting_apps_flyout_fetch_grid_apps:3,ext_meeting_apps_filter_transform_sort_apps:3,platform_apps_flyout_grid_apps:3,platform_app_flyout_jit_install_app:3,platform_app_flyout_jit_install_and_enable_app:3,ext_me_uninstall_app:3,ext_meeting_app_flyout_install_app:3,ext_silent_install_preconsented_apps:3,ext_me_post_install_get_flyout_app:3,ext_meeting_flyout_silent_install_preconsented_apps:3,ext_me_install_app:3,ext_get_simple_app_model:3,ext_bot_message_feedback:3,ext_bot_message_feedback_dialog:3,ext_bot_view_prompts_menu:3,ext_bot_view_prompts_menu_item_click:3,ext_bot_zero_prompts_list:3,ext_bot_zero_prompts_command_click:3,ext_bot_message_action_compose:3,ext_bot_message_action_imback:3,ext_bot_message_action_odsl:3,ext_bot_message_suggested_actions_parse:3,ext_bot_message_streaming:3,ext_bot_message_streaming_first_chunk:3,ext_bot_message_citation:3,summary_knowledge_base_action_odsl:3,ext_powerbar_message_extension_renderer:3,ext_powerbar_message_extension_multi_commands:3,ext_powerbar_message_extension_full_card:3,ext_powerbar_message_extension_mini_cards:3,ext_powerbar_message_extension_mini_card_tap_action:3,ext_powerbar_message_extension_more_options:3,ext_powerbar_message_extension_task_module:3,ext_powerbar_message_extension_suggestions_plugin_load:3,ext_task_module_jit_install_from_card:3,ext_task_module_jit_install_from_message_extension:3,ext_task_module_jit_install_from_deeplink:3,ext_task_module_jit_install_for_custom_apps:3,ext_bot_avatar:3,ext_deeplink_to_chat:3,ext_deeplink_to_chat_message:3,m365_deeplink_to_chat:3,ext_deeplink_to_task_module:3,ext_task_module_fetch:3,ext_task_module_submit_action:3,ext_task_module_edit_action:3,ext_task_module_bot_preview_action:3,ext_bot_card_action:3,ext_me_card_action:3,ext_adaptive_card_media_element:3,ext_bot_sso_silent_auth:3,ext_bot_sso_post_consent_auth:3,ext_app_based_link_install_to_conversation:3,ext_adaptive_card_media_play:3,ext_get_workflows_templates:3,ext_list_catalog_extensions:3,ext_get_anonymous_app_preview:3,ext_get_flyout_filtered_me:3,ext_get_flyout_filtered_sections_me:3,ext_me_get_sections:3,ext_get_workflows_task_module_input:3,ext_upgrade_app:3,ext_launch_app_install:3,ext_preconsent_app_install:3,ext_launch_app_config:3,ext_install_side_load_app:3,ext_install_trusted_side_load_app:3,ext_install_trusted_side_load_app_from_ac_footer:3,ext_location_api_get_location:3,ext_location_api_show_location:3,ext_select_media:3,ext_get_media:3,ext_view_images:3,ext_select_people_contextual_search:3,ext_select_people_org_search:3,ext_bots_proactive_message_app_install:3,ext_task_module_jit_install:3,ext_bot_config:3,ext_add_workflow_to_apollo_cache:3,ext_me_app_installation:3,platform_fetch_tab_information:3,platform_fetch_app_definition:3,ext_copilot_auth_card_aad_flow:3,ext_meeting_copilot_auth_card_aad_flow:3,ext_copilot_auth_card_aad_flow_sme:3,ext_meeting_copilot_auth_card_aad_flow_sme:3,ext_copilot_me_authandconfig:3,ext_meeting_copilot_me_authandconfig:3,ext_copilot_bot_invoke:3,ext_meeting_copilot_bot_invoke:3,ext_action_execute_sso:3,ext_action_execute_oauth:3,ext_action_execute_authentication_jit:3,ext_group_scope_bot_sso_jit:3,adaptive_cards_v2_manager_delete_card_data:3,adaptive_cards_v2_manager_put_auth_block_usage_time:3,adaptive_cards_v2_manager_warmup_auth_block_usage_map:3,ext_app_profile_card_install_app:3,is_user_permitted_to_install_for_team_scope:3,ext_launch_connectors_dialog:3,ext_sdk_connectors_save_event:3,ext_sdk_connectors_remove_event:3,ext_launch_workflows_entry_dialog:3,ext_launch_workflows_widget_host_dialog:3,ext_copilot_plugin_auth:3,ext_meeting_copilot_plugin_auth:3,ext_task_module_card_action_invoke:3,files_super_picker:3,files_super_picker_render:3,"files_local_mru_files_trustedui-launch":3,files_chat_shared_tab_filter:3,file_browser_pre_warm_idle_state_trigger:3,file_browser_pre_warm_on_idle_state_trigger:3,file_spo_personal_od_token_prewarm:3,file_spo_home_od_token_prewarm:3,file_spo_other_domains_od_token_prewarm:3,file_browser_for_cft_pre_warm_on_idle_state_trigger:3,file_browser_for_cft_pre_warm_idle_state_trigger:3,file_browser_pre_warm:3,file_browser_pre_warm_on_idle:3,file_browser_pre_warm_for_cft:3,file_browser_pre_warm_for_cft_on_idle:3,file_name_conflict_v2:3,file_name_conflict_v2_reshare:3,file_name_conflict_v2_reshare_api:3,fetch_file_content:3,fetch_file_metadata:3,files_render_local_files:3,files_fetch_local_file_content:3,files_super_picker_auth_token:3,files_super_picker_site_info:3,files_super_picker_navigation_end:3,files_super_picker_close_action:3,files_send_message_post_upload:3,"fetch-channel-site-info-v2":3,documents_ams_attached_video_upload:3,documents_get_p2p_communities_files_list:3,get_unified_storage_quota:3,client_start:3,client_start_command:3,entity_command:3,default_command:3,navigation_command:3,first_app_load:3,flyout_launch:3,consent_launch:3,dynamic_import:3,core_cleanup:3,core_user_context_create:3,trusted_ui_loading:3,saved_message_slice_fetch:3,save_message:3,unsave_message:3,photos_fetch_data:3,photos_tab_load:3,exploratory_sign_up_for_trial:3,post_meeting_view_eligible_render:3,msg_meeting_chiclet_join_meeting:3,msg_meeting_chiclet_add_to_my_calendar:3,msg_meeting_chiclet_import_calendar_event:3,msg_meeting_chiclet_import_bygc_calendar_event:3,msg_meeting_chiclet_delete_from_calendar:3,msg_meeting_chiclet_accept_rsvp:3,msg_meeting_chiclet_view_event_details:3,get_connected_accounts:3,hard_delete_connected_account:3,add_external_account:3,remove_external_account:3,hard_delete_external_account:3,unlink_external_account:3,refresh_external_account:3,connected_account_refresh_srt_job:3,paywall_premium_benefits_settings_page_load:3,paywall_consumer_license_details_fetch:3,paywall_consumer_license_details_fetch_on_demand:3,add_or_update_google_contacts_sync_settings:3,connect_google_contacts:3,connected_calendar_cleanup:3,delete_connected_calendar_setting_mutation:3,delete_connected_calendar_events_cache:3,invite_offnetwork_phone_to_meeting:3,invite_offnetwork_phone_to_meetingchat:3,telemetry_worker_initialization:3,noop:3,auth_launch:3,load_live_persona_editor:3,meeting_copilot_word_summarization:3,meeting_copilot_ppt_summarization:3,ext_me_querycommand:3,ext_sme_querycommand:3,chat_deeplink:3,messaging_update_message_reaction:3,messaging_add_message_reaction:3,messaging_remove_message_reaction:3,chat_collab_streaming_answer:3,file_copilot_streaming_answer:3,chat_collab_streaming_subscription:3,emoticon_picker_latency:3,download_emoticon_metadata:3,ams_image_download_fetch_latency:3,render_image_in_lightbox:3,platform_app_ams_image_download_fetch_latency:3,ams_image_api_load:3,bot_urlp_image_api_load:3,serialize_cached_image:3,add_draft_image_to_cache:3,remove_draft_image_from_cache:3,image_download_using_proxy:3,ams_image_browser_load:3,ams_image_offline_download_fetch_latency:3,platform_app_ams_image_offline_download_fetch_latency:3,send_message_email_to_members:3,navigation_to_last_read_from_latest:3,navigation_to_latest_from_above:3,navigation_to_latest_from_last_read:3,navigation_to_latest_from_below_last_read:3,notifications_window_corner:3,toast_activation:3,web_toast_show:3,browser_toast:3,toast_ringtone:3,cross_client_toast_view:3,tfl_people_picker_search:3,fre_profile_age_group_undefined:1,get_at_mentions:3,get_at_mentions_team_app_install_or_channel_app_enable_setting:3,at_mentions_chats_search:3,at_mentions_chats_zero_state:3,at_mentions_channels_search:3,at_mentions_channels_zero_state:3,mentions_manager_get_mentions:3,mentions_manager_roster_update_sync:3,mentions_manager_users_zero_state:3,mentions_manager_users_ups_search:3,mentions_manager_teams_search:3,mentions_manager_tags_search:3,people_at_mentions:3,contacts_sync_settings_delete:3,contacts_sync_settings_cleanup:3,contacts_sync_settings_mutation:3,contacts_sync_settings:3,contacts_sync_settings_update:3,contacts_sync_sync_workflow:3,contacts_sync_unsync_workflow:3,capiv3_contacts_sync_settings:3,capiv3_get_contact_unification_migration_status:3,capiv3_update_banner_status:3,"mention-resolver-mutation-incrementprofilerequestcount":3,delete_blocked_user:3,asp_set_timeout_for_none_event:3,asp_set_timeout_for_missed_call_event:3,asp_set_timeout_for_meeting_event:3,asp_set_timeout_for_voicemail_event:3,asp_set_timeout_for_dailer_event:3,asp_set_timeout_for_telemetry_event:3,asp_push_none_event_to_device:3,asp_push_missed_call_event_to_device:3,asp_push_meeting_event_to_device:3,asp_push_voicemail_event_to_device:3,asp_push_dailer_event_to_device:3,asp_push_telemetry_event_to_device:3,asp_cancel_none_event:3,asp_cancel_missed_call_event:3,asp_cancel_meeting_event:3,asp_cancel_voicemail_event:3,asp_cancel_dailer_event:3,asp_cancel_telemetry_event:3,asp_invoke_main_client_view:3,asp_invoke_missed_call_view:3,asp_invoke_meeting_view:3,asp_invoke_voicemail_view:3,asp_invoke_dailer_view:3,asp_invoke_telemetry_view:3,undefined_asp_scenario:3,hid_device_asp_connection_from_app:3,hid_device_hid_configuration_from_app:3,hid_device_push_call_state_from_app:3,hid_device_push_notification_from_app:3,hid_device_request_call_start_telemetry_from_app:3,hid_device_request_device_change_telemetry_from_app:3,hid_device_request_bt_device_update_telemetry_from_app:3,hid_device_request_periodic_data_from_selected_device_telemetry_from_app:3,hid_device_device_triggered_telemetry_from_app:3,hid_device_pull_notification_context_from_app:3,hid_device_deskphone_setup_from_app:3,hid_device_display_setup_from_app:3,hid_device_select_driver_from_app:3,hid_device_open_from_app:3,hid_device_start_pulsing_from_app:3,hid_device_start_pulsing_from_app_to_non_selected_hid_device:3,hid_device_hook_on_device:3,hid_device_hook_on_non_selected_hid_device:3,hid_device_mute_on_device:3,hid_device_mute_on_non_selected_hid_device:3,hid_device_unmute_from_app:3,hid_device_unmute_from_app_to_non_selected_hid_device:3,hid_device_unmute_on_device:3,hid_device_flash_on_device:3,hid_device_flash_on_non_selected_hid_device:3,hid_device_unmute_on_non_selected_hid_device:3,hid_device_resume_from_app:3,hid_device_resume_on_device:3,hid_device_resume_on_non_selected_hid_device:3,hid_device_resume_from_app_to_non_selected_hid_device:3,hid_device_hold_from_app:3,hid_device_hold_from_app_to_non_selected_hid_device:3,hid_device_hold_on_device:3,hid_device_hold_on_non_selected_hid_device:3,hid_device_mute_from_app:3,hid_device_off_hook_from_app:3,hid_device_off_hook_from_app_to_non_selected_hid_device:3,hid_device_off_hook_on_device:3,hid_device_off_hook_on_non_selected_hid_device:3,hid_device_hook_from_app:3,hid_device_hook_from_app_to_non_selected_hid_device:3,hid_device_reject_on_device:3,hid_device_reject_on_non_selected_hid_device:3,hid_device_stop_pulsing_from_app:3,hid_device_stop_pulsing_from_app_to_non_selected_hid_device:3,hid_device_video_mute_from_app:3,hid_device_video_mute_from_app_to_non_selected_hid_device:3,hid_device_video_mute_on_device:3,hid_device_video_mute_on_non_selected_hid_device:3,hid_device_periodic_sync_on_device:3,hid_device_push_dynamic_bandwidth_notification_on_device:3,hid_device_asp_request_on_device:3,hid_device_asp_response_on_device:3,hid_device_content_camera_on_device:3,hid_device_content_camera_on_non_selected_hid_device:3,hid_device_teams_button_clicked_on_device:3,hid_device_teams_button_clicked_on_non_selected_hid_device:3,hid_device_vendor_extension_on_device:3,hid_device_display_attribute_on_device:3,hid_device_display_control_report_on_device:3,hid_device_character_attributes_on_device:3,hid_device_shortcut_button_context_ppt_live_active_on_device:3,hid_device_shortcut_button_context_ppt_live_inactive_on_device:3,hid_device_ppt_laser_point_long_pressed_on_device:3,hid_device_ppt_laser_point_long_pressed_on_non_selected_hid_device:3,hid_device_ppt_laser_point_released_on_device:3,hid_device_ppt_laser_point_released_on_non_selected_hid_device:3,hid_device_ppt_prev_slide_pressed_on_device:3,hid_device_ppt_prev_slide_pressed_on_non_selected_hid_device:3,hid_device_ppt_next_slide_pressed_on_device:3,hid_device_ppt_next_slide_pressed_on_non_selected_hid_device:3,unknown_connected_experiences_scenario:3,hid_answer_incoming_call_from_device:3,hid_auto_mute_toggle_from_hid_device:3,hid_call_auto_unmute_from_hid_device:3,device_change_from_app:3,dtmf_dialing:3,hfp_handle_flash_event_in_multiple_calls:3,hid_handle_flash_event:3,hid_handle_flash_event_in_multiple_calls:3,hid_handle_on_did_hook_event:3,hid_presence_subscription:3,hid_service_initialize:3,hid_service_reinitialize:3,hid_device_manager_reinit:3,hid_service_start_sfb_running_reg_watcher:3,hid_service_sfb_running_regkey_changed:3,hid_service_start_sfb_hid_disabled_reg_watcher:3,hid_service_sfb_hid_disabled_regkey_changed:3,hid_service_stop_sfb_reg_watcher:3,hid_setup_user_profile_for_display_devices:3,hid_update_active_device_in_call:3,asp_find_matching_slimcore_device:3,hid_triggered:3,hid_reject_from_device:3,asp_service_initialize:3,teams_device_services_init:3,meeting_view:3,none_view:3,gatt_service_initialize:3,gatt_device_manager_initialize:3,gatt_device_manager_destroy:3,gatt_device_manager_devices_changed:3,gatt_device_push_notification_from_app:3,gatt_device_push_call_state_from_app:3,gatt_device_pull_notification_context_from_app:3,gatt_device_request_call_start_telemetry_from_app:3,gatt_device_request_device_change_telemetry_from_app:3,gatt_device_request_bt_device_update_telemetry_from_app:3,gatt_device_request_periodic_data_from_selected_device_telemetry_from_app:3,gatt_device_device_triggered_telemetry_from_app:3,gatt_device_asp_reinit_from_app:3,gatt_device_asp_connection_from_app:3,gatt_device_teams_button_clicked_on_device:3,call_control_service_v2_init:3,peripherals_call_control_service_init:3,answer_incoming_call_from_bt_device:3,reject_incoming_call_from_bt_device:3,end_call_from_bt_device:3,hold_call_from_bt_device:3,handle_hold_event_from_bt_device_in_multiple_calls:3,handle_flash_from_bt_device_in_multiple_calls:3,update_active_bt_device_in_ongoing_call:3,report_new_incoming_call_to_bt_device:3,report_call_accepted_to_bt_device:3,report_new_outgoing_call_to_bt_device:3,report_call_connected_state_to_bt_device:3,report_hold_call_to_bt_device:3,report_resume_call_to_bt_device:3,person_by_id_load_batch:3,person_by_mri_or_email_load_batch:3,person_create_contact:3,person_update_contact:3,person_delete_contact:3,person_by_mri_query:3,person_by_email_query:3,person_contact_add_event_subscription:3,person_add_to_favorites_mutation:3,person_block_person_mutation:3,person_remove_from_favorites_mutation:3,person_unblock_person_mutation:3,person_set_speed_dial_system_tag_mutation:3,person_add_to_speed_dial_mutation:3,person_remove_from_speed_dial_mutation:3,person_speed_dial_contacts_query:3,person_add_tag_mutation:3,person_remove_tag_mutation:3,person_follow_presence_mutation:3,person_unfollow_presence_mutation:3,person_get_followed_presence_contacts_query:3,one_gql_me_contacts_query:3,fethcing_one_gql_contact_unification_migration_status:3,update_banner_status_mutation:3,PersonViewSchemaIsPstnCallingAllowedResolver:3,ext_add_app_dialog_fetch_app_definition:3,ext_add_app_dialog_fetch_teams_or_chats:3,ext_add_app_dialog_fetch_discover_more_apps_data:3,ext_add_app_dialog_fetch_app_store_rating:3,ext_add_app_dialog_get_install_options:3,ext_add_app_dialog_fetch_admin_app_request_config:3,ext_add_app_dialog_install:3,ext_add_app_dialog_upgrade:3,ext_add_app_dialog_request_access:3,ext_add_app_dialog_post_install:3,ext_add_app_dialog_populate_content:3,ext_add_app_dialog_share_app_deep_link:3,ext_install_app:3,ext_install_app_from_ac_footer:3,ext_install_app_result_cache_update:3,ext_in_context_store_app_enable_dialog:3,platform_userlifecycle_incontext_store_install_app_event:3,app_enable_consent_dialog:3,app_enable_consent_popover:3,platform_app_uninstall_dialog_v2_delete_app:3,ext_apps_platform_service_get_installed_apps:3,ext_apps_platform_service_get_installed_app:3,ext_apps_platform_service_get_installed_apps_for_user:3,ext_apps_platform_service_delete_app:3,ext_extract_app_definition_job:3,ext_tenant_staged_apps_sync_job:3,ext_tenant_staged_apps_upload_job:3,ext_tenant_staged_apps_delete_job:3,ext_sideload_apps_upload_workflow:3,ext_invalidate_apps_cache_workflow:3,ext_sideload_apps_upload_job:3,ext_sideload_apps_update_job:3,ext_apps_usage_manager_get_apps_usage:3,ext_apps_usage_manager_get_apps_usage_from_network:3,ext_apps_usage_manager_record_app_usage:3,ext_apps_usage_manager_record_app_action_usage:3,ext_apps_usage_manager_record_hosted_app_content_usage:3,ext_apps_usage_manager_record_app_commnd_usage:3,ext_apps_usage_manager_initialize:3,ext_apps_usage_manager_sync_with_backend:3,ext_apps_usage_manager_merge_and_save_apps_usage:3,ext_apps_usage_sync_workflow:3,ext_apps_usage_record_usage_sync_workflow:3,ext_contextless_apps_sync_strategy_sync_unconsented_mru_apps:3,ext_apps_usage_strategy_onstartup:3,ext_apps_usage_strategy_onappstatelonginactive:3,ext_apps_usage_manager_sync:3,ext_tenant_staged_apps_sync_workflow:3,ext_tenant_staged_apps_upload_workflow:3,ext_tenant_staged_apps_delete_workflow:3,ext_tenant_staged_apps_manager_sync_staged_apps:3,ext_tenant_staged_apps_manager_delete_staged_app:3,ext_tenant_staged_apps_manager_get_staged_apps:3,ext_tenant_staged_apps_manager_upload_staged_apps:3,ext_extract_app_definition_from_server:3,ext_get_user_installed_apps_job:3,ext_get_channel_installed_apps_job:3,aggregated_app_entitlements_sync_job:3,ext_get_batch_app_definitions_job:3,app_definitions_manager_get_templated_instance_app_def:3,app_definitions_manager_get_apps_eligibility_info_for_app_ids:3,app_definitions_manager_get_copilot_extensions:3,app_definitions_manager_get_app_templates:3,templated_apps_helper_get_templated_instance_app_def:3,apps_platform_worker_resolver_get_templated_instance_app_definition:3,apps_platform_worker_resolver_get_templated_instance_installed_app:3,user_installed_apps_manager_get_templated_installed_app:3,apps_platform_worker_resolver_install_templated_app:3,user_installed_apps_manager_install_templated_instance_app:3,user_installed_apps_manager_get_unsaved_pinned_apps_from_store:3,user_installed_apps_manager_merge_unsaved_pinned_apps_from_store:3,user_installed_apps_manager_update_bot_chat_info:3,chat_installed_apps_manager_install_templated_instance_app:3,team_installed_apps_manager_install_templated_instance_app:3,ext_install_user_app_job:3,ext_install_chat_app_job:3,ext_delete_app_job:3,ext_apps_platform_service_get_app_definition:3,ext_apps_platform_service_get_batch_app_definition:3,ext_apps_platform_service_install_app:3,ext_apps_platform_service_upgrade_app:3,ext_apps_platform_service_create_app_entitlement:3,ext_apps_platform_worker_resolver_block_unblock_bot_chat:3,ext_apps_platform_service_read_app_definitions:3,ext_apps_platform_service_read_app_entitlements:3,ext_apps_platform_service_write_app_definitions:3,ext_apps_platform_service_write_app_entitlements:3,ext_apps_platform_service_reset_app_entitlement_cache:3,ext_apps_platform_service_check_app_definitions_cache_expiration:3,ext_apps_platform_service_check_app_entitlements_cache_expiration:3,ext_apps_platform_service_get_user_app_policy:3,ext_apps_platform_service_can_user_manage_tenant_apps:3,ext_apps_platform_service_sideload_app_definition:3,ext_apps_platform_service_trusted_sideload_app_definition:3,ext_apps_platform_service_install_sideload_app:3,ext_apps_platform_service_install_trusted_sideload_app:3,ext_apps_platform_service_admin_app_catalog_upload:3,ext_get_app_impressions:3,ext_record_app_impression:3,ext_apps_update_all_fetch_policies:3,ext_get_installed_app_definition_from_teams_manager_cache:3,ext_get_installed_app_definition_from_chat_manager_cache:3,ext_get_installed_app_definition_from_user_manager_cache:3,ext_get_installed_app_definition_from_channel_manager_cache:3,ext_user_installed_apps_manager_get_installed_apps_for_appbar:3,app_definitions_manager_sync_batch_app_definitions:3,ext_app_def_images_manager_process_definitions:3,ext_app_def_images_manager_get_project_agent_url:3,ext_app_def_images_manager_process_wrapped_app_definitions:3,ext_app_def_images_manager_fetch_ams_images:3,ext_app_ams_images_fetch_job:3,ext_app_ams_images_fetch_workflow:3,ext_tabs_adaptor_manager_delete_pinned_tab:3,ext_tabs_adaptor_manager_create_pinned_tab:3,ext_tabs_adaptor_manager_update_pinned_tab:3,ext_tabs_adaptor_manager_get_pinned_tabs:3,ext_tabs_adaptor_manager_get_pinned_tabs_channel:3,contextless_installed_apps_manager_get_installed_apps:3,contextless_installed_apps_manager_add_app:3,contextless_installed_apps_manager_add_apps:3,contextless_installed_apps_manager_delete_app:3,chat_installed_apps_manager_invalidate_app_entitlements:3,team_installed_apps_manager_invalidate_app_entitlements:3,channel_installed_apps_manager_invalidate_app_entitlements:3,channel_installed_apps_manager_invalidate_team_app_statuses:3,user_installed_apps_manager_install_app:3,chat_installed_apps_manager_install_app:3,apps_platform_worker_resolver_install_app:3,apps_platform_worker_resolver_upgrade_app:3,apps_platform_worker_resolver_preview_deep_linked_app:3,extract_app_definition_manager_from_zip:3,extract_app_definition_manager_from_server:3,app_definitions_manager_get_app_definitions:3,app_definitions_manager_resolve_new_context:3,app_definitions_manager_app_setup_policy_hash_change:3,app_definitions_manager_app_permissions_policy_hash_change:3,app_definitions_manager_tenant_settings_last_updated_timestamp_update:3,app_definitions_manager_sync_app_definitions:3,app_definitions_manager_invalidate_app_definitions:3,user_installed_apps_manager_get_installed_apps:3,user_installed_apps_manager_sync_installed_apps:3,user_installed_apps_manager_get_pinned_apps:3,chat_installed_apps_manager_get_installed_apps:3,chat_installed_apps_manager_get_installed_apps_with_precheck:3,chat_installed_apps_manager_sync_installed_apps:3,channel_installed_apps_manager_get_installed_apps:3,channel_installed_apps_manager_sync_installed_apps:3,channel_installed_apps_manager_get_app_statuses:3,channel_installed_apps_manager_update_app_statuses:3,app_bar_m365apps_resolver:3,m365applinks_worker_resolver:3,apps_suggestion_utils_get_uninstalled_app_definitions:3,apps_suggestion_utils_get_apps:3,apps_suggestion_utils_get_installed_app_definitions:3,channel_installed_apps_manager_invalidate_app_statuses:3,app_bar_m365_default_app_resolver:3,app_bar_manager_get_fallback_default_app_id:3,app_bar_manager_pin_app:3,app_bar_manager_unpin_app:3,app_bar_manager_reorder_app:3,app_bar_m365apps_get_apps_for_suggestions_section:3,app_bar_m365apps_get_apps_for_uninstalled_apps_search_section:3,app_suggestions_service_get_app_suggestions:3,app_suggestions_service_get_app_suggestion_store_items:3,apps_platform_worker_resolver_app_definitions:3,apps_platform_worker_resolver_app_definition:3,apps_platform_worker_resolver_installed_apps:3,apps_platform_worker_resolver_installed_apps_v2:3,get_copilot_agents:3,escalate_agent_to_group_scope:3,apps_platform_worker_resolver_installed_apps_for_message_action:3,apps_platform_worker_resolver_installed_app:3,apps_platform_worker_resolver_installed_chat_apps_with_pre_check:3,apps_platform_worker_resolver_get_user_app_request:3,apps_platform_worker_resolver_create_user_app_request:3,custom_app_policy_sync_job:3,custom_app_policy_sync_workflow:3,app_policy_manager_custom_app_policy:3,custom_app_policy_check_for_command:3,apps_platform_worker_resolver_custom_app_policy:3,user_installed_apps_sync_job:3,app_definitions_sync_job:3,chat_installed_apps_sync_job:3,channel_installed_apps_sync_job:3,user_installed_apps_sync_workflow:3,app_definitions_sync_workflow:3,chat_installed_apps_sync_workflow:3,apps_platform_worker_resolver_installed_app_conversation:3,app_ratings_reviews_resolver_fetch_rating:3,gpt_definition_resolver_oauth_config_id:3,app_ratings_reviews_worker_resolver_fetch_rating:3,app_ratings_reviews_worker_resolver_fetch_reviews:3,app_ratings_reviews_worker_resolver_post_review:3,app_ratings_reviews_worker_resolver_update_review:3,app_ratings_reviews_worker_resolver_delete_review:3,app_ratings_reviews_worker_resolver_report_review:3,app_ratings_reviews_worker_resolver_last_active_app_for_rating:3,app_ratings_reviews_worker_resolver_mark_app_usage_for_rating:3,app_ratings_reviews_worker_resolver_snooze_app_usage_for_rating:3,app_usage_details_worker_resolver_fetch:3,apps_platform_worker_resolver_can_update_app:3,app_definitions_manager_get_app_definition_for_deep_link:3,entity_command_pin_app:3,entity_command_install_app_before_pin:3,user_installed_apps_manager_pin_app_to_app_bar_for_meta_os:3,apps_platform_worker_resolver_pin_app_to_app_bar_for_meta_os:3,ext_in_context_store_dialog_fetch_installed_apps:3,ext_in_context_store_dialog_check_if_user_is_allowed_to_install:3,ext_in_context_store_dialog_check_user_allowed_to_enable_disable_apps:3,ext_in_context_store_dialog_post_install:3,ext_in_context_store_dialog_post_install_or_enable:3,ext_in_context_store_dialog_populate_feed_collection_content:3,ext_in_context_store_dialog_populate_search_collection_content:3,ext_in_context_store_dialog_populate_apps_grid_content:3,load_fast_powerbar:3,powerbar_query:3,powerbar_email_search_query:3,powerbar_worker:3,powerbar_history_search:3,powerbar_zq_3s_fetch:3,powerbar_worker_slash_command:3,powerbar_query_slash_command:3,powerbar_query_first:3,powerbar_query_zerostate:3,powerbar_query_external:3,topn_idb_populate:3,get_topn_suggestions:3,files_topn_idb_populate:3,get_files_topn_suggestions:3,autosuggest_retry_namespace_load:3,powerbar_external_search_check:3,powerbar_external_search:3,powerbar_external_search_collab:3,powerbar_cache_query:3,public_preview_policy_job:3,report_user:3,report_chat_invite:3,room_people_count_send_enabled:3,room_people_count_source_summary:3,room_people_count_overall_summary:3,room_people_count_devices_changed:3,room_people_count_endpoint_metadata_updated:3,room_people_count_send_data_to_uwp:3,room_people_count_data_received:3,init_roster_grouping_service:3,roster_grouping_slimcore_join_status_event:3,roster_grouping_slimcore_error_event:3,roster_grouping_form_group_event:3,roster_grouping_leave_group_event:3,search_worker:3,sensitivity_label_ufd_scenario:3,search_all:3,search_feedback:3,search_message:3,search_files:3,search_people:3,search_communities:3,search_engage_communities:3,search_email:3,search_team_channel:3,search_channel_worker:3,search_communities_worker:3,search_meeting:3,search_contextual_chat:3,search_contextual_channel:3,search_contextual_topics:3,search_contextual_metaos:3,search_custom:3,"custom_search_pre-fetch":3,search_start:3,search_email_3s:3,search_chat_title:3,search_3s_prefetch:3,search_contextual_start:3,search_groupchats:3,search_tfl_people:3,search_context_region:3,serp_copilot:3,serp_copilot_t2:3,search_image:3,activity_messaging_slice_switch:3,activity_messaging_slice_feed_load:3,activity_messaging_slice_feed_load_more:3,messaging_slice_item_switch:3,activity_slices_startup:3,activity_slices_fetch_data_from_cdl:3,messaging_slice_store_startup:3,messaging_slice_store_catchup:3,messaging_slice_new_items_long_poll:3,messaging_slice_items_fetch:3,saved_messaging_slice_feed_load:3,saved_messaging_slice_feed_load_more:3,saved_messaging_slice_switch:3,thread_slice_mark_as_read:3,chat_create_invite_link:3,chat_get_invite_link:3,"claim-invite-link":3,"create-one-on-one-2-way-sms":3,search_phone_2way_sms:3,group_invite_offnetwork:3,"redeem-invite-link":3,"redeem-invite-link-mutation":3,redeem_skype_link_mutation:3,"scheduled-meeting-chiclet-get-calendar-event":3,"scheduled-meeting-chiclet-get-occurrence-event":3,"get-skype-entitlements":3,"get-premium-trial-enrollment-status":3,"update-premium-trial-enrollment-status":3,minimum_version_banner:3,minimum_version_banner_button:3,minimum_wv2_version_banner_button:3,minimum_wv2_version_banner:3,know_more_about_wv2:3,auth_signin_required_learn_more_clicked:3,unsupported_os_version_banner:3,unsupported_os_version_banner_button:3,unsupported_os_version_blocking_page_check:3,desktop_critical_version_check:3,ultrasound_enable_beacon_detector:3,ultrasound_disable_beacon_detector:3,ultrasound_enable_beacon_producer:3,ultrasound_init:3,ultrasound_payload_processing:3,ultrasound_set_audio_config:3,ultrasound_detect_multiple_mtrs:3,uc_load_host_app:1,uc_request_consent:1,uc_accept_consent:1,slimcore_vdi_init:3,vdi_bridge_stopped:3,slimcore_vdi_service_init:3,slimcore_pie_vdi_start_occlusion_tracking:3,slimcore_pie_vdi_stop_occlusion_tracking:3,vdi_pluginless_track_video_element:3,vdi_pluginless_stop_video_element_tracking:3,vdi_pluginless_start_occlusion_tracking:3,vdi_pluginless_stop_occlusion_tracking:3,slimcore_vdi_state_connect:3,slimcore_vdi_override_mode_history:3,slimcore_vdi_optimization_mode_state:3,slimcore_vdi_state_disconnect:3,slimcore_vdi_state_session_change:3,slimcore_vdi_hid_creator_id_state:3,pie_vdi_bridge_connected_telemetry:3,pie_vdi_bridge_disconnected_telemetry:3,pie_vdi_bridge_rtt_telemetry:3,pie_vdi_bridge_enqueue_event:3,vdi_restart_notification:3,slimcore_vdi_global_state_subscription_slimcorepievdistate:3,video_message_thumbnail_upload:3,video_message_transcript_metadata_upload:3,inline_video_async_transform:3,ams_video_upload:3,ams_video_object_create:3,video_message_preview:1,video_message_lazy_load:3,video_message_lazy_load_compose:3,video_message_playback:1,video_message_playback_init:1,oneplayer_loader_fetch:1,video_message_caption_check_status:1,video_attachment_lazy_load:1,video_attachment_playback_preroll:1,video_attachment_fetch_metadata:3,video_attachment_load_iframe:3,video_message_compose_transform:3,ecs_provider_fetch:3,ecs_secondary_user_overrides_manual_fetch:3,ecs_provider_vdi_change:1,ocdi_redirect:1,policies_push_effectiveness:3,policies_manager_sync_policies:3,policy_service_fetch_network:3,policies_service_get_policies:3,policies_fetch_data_resolvers:3,policies_resolvers:3,policies_sync_job:3,policies_sync_workflow:3,detect_third_party_cookie_support:1,user_preferences_manager_get_by_category:1,user_preferences_manager_set:3,user_preferences_manager_update_to_server:3,user_preferences_manager_handle_delta_update:3,user_preferences_worker_resolvers_query:1,user_preferences_sync_job:3,user_preferences_sync_workflow:3,user_preferences_worker_resolvers_query_category_based:3,user_preferences_worker_resolvers_mutation:3,ecs_cache_garbage_collection:3,network_online:1,network_offline:1,settings_changed_notification_sync:3,service_worker_update:1,non_initiator_ready_for_fluid_whiteboard:3,non_initiator_load_fluid_whiteboard:3,wiki_migration:3,wiki_migration_migration_start:3,wiki_migration_migration_complete:3},userbins:{moduleNames:{appBarItem:3,novaAppBar:3,appSwitcher:3,appSwitcherActiveCallDialog:3,appSwitcherT1DownloadDialog:3,appSwitcherWebActiveCallDialog:3,appSwitcherWebMultipleTabsDialog:3,appSwitcherConfirmationPage:3,ContextualBanner:3,entityHeader:3,entityHeaderActionButton:3,entityHeaderBackButton:3,navControls:3,navHistoryMenuItem:3,optionsMenuItem:3,optionsMenuButton:3,optionsMenuPopup:3,unsupportedDeeplinkDialog:3,immersiveSpeedBumpDialog:3,switchAccountDialog:3,settingsList:3,chatDensitySelector:3,themeSelector:3,themeSelectorDropdown:3,settingsToggle:3,inAppToastIconButton:3,inAppToastTextButton:3,connectedServicesSetting:3,ExperienceAnalyzeContentSetting:3,waffleButton:3,waffleApp:3,waffleError:3,titlebarSearchExpand:3,JunoSetting:3,appStartTheme:3,CoreErrorPage:3,ErrorPageSwitchToClassicButton:3,ErrorPageRestartButton:3,ErrorPageUseWebAppButton:3,ErrorPageDownloadDesktopAppButton:3,ErrorPageActionButton:3,CustomThemeColorSelector:3,atMentionItem:3,atMentionResultItem:3,blockContactList:3,contactsSyncControl:3},moduleTypes:{ContextualBanner:3,ErrorPage:3,atMentionResultList:3},actionScenarios:{bannerLinkAction:3,entityHeaderRendered:3,entityHeaderActionButton:3,appSwitcherConfirmationPageSwitchToT2:3,appSwitcherConfirmationPageGoBackToT1:3,appSwitcherActiveCallCancel:3,appSwitcherActiveCallConfirm:3,appSwitcherNewTeamsOnlyPolicy:3,appSwitcherT1DownloadCancel:3,appSwitcherT1DownloadConfirm:3,appSwitcherWebActiveCallCancel:3,appSwitcherWebActiveCallConfirm:3,appSwitcherWebMultipleTabsCancel:3,appSwitcherWebMultipleTabsConfirm:3,entityHeaderBack:3,backButtonHistory:3,forwardButtonHistory:3,displayBackNavigationHistoryMenu:3,closeBackNavigationHistoryMenu:3,closeForwardNavigationHistoryMenu:3,displayForwardNavigationHistoryMenu:3,t1AppUninstallCountReset:3,searchExpand:3,toggleAppSwitcher:3,toggleSimpleCollabAppSwitcherOn:3,toggleSimpleCollabAppSwitcherOffShowConfirmDialog:3,toggleSimpleCollabAppSwitcherOffConfirmDialogKeepOn:3,toggleSimpleCollabAppSwitcherOff:3,toggleChatsAndChannelsSuggestedRepliesSwitcherOn:3,toggleChatsAndChannelsSuggestedRepliesSwitcherOff:3,toggleChatsAndChannelsShowMessagePreviewOn:3,toggleChatsAndChannelsShowMessagePreviewOff:3,toggleChatsAndChannelsShowTimestampsOn:3,toggleChatsAndChannelsShowTimestampsOff:3,toggleFollowOSTheme:3,toggleMeetingTheme:3,toggleAnimationSwitcher:3,toggleOpenWindow:3,themeLight:3,themeDark:3,themeHighContrast:3,densityComfy:3,densityCompact:3,themeClassic:3,followOsTheme:3,navBack:3,navForward:3,navToHistoryMenuItem:3,unsupportedDeeplinkConfirm:3,unsupportedDeeplinkCancel:3,immersiveSpeedBumpDialogCancel:3,immersiveSpeedBumpDialogProceed:3,switchAccountDialogCancel:3,switchAccountDialogConfirm:3,settingsAndMore:3,optionsMenuAskCommunity:3,optionsMenuBRB:3,optionsMenuCast:3,optionsMenuGiveFeedback:3,optionsMenuGetHelp:3,optionsMenuKeyboard:3,optionsServicesUnavailable:3,optionsMenuRingSwitcher:3,optionsMenuServiceSwitcher:3,optionsMenuSettings:3,optionsMenuSuggestaFeature:3,optionsMenuSupport:3,optionsMenuStudentInsights:3,optionsMenuTraining:3,optionsMenuWhatsNew:3,optionsMenuZoomIn:3,optionsMenuZoomOut:3,optionsMenuZoomReset:3,optionsMenuDesktopDownload:3,optionsMenuMobileDownload:3,optionsMenuTeamsLabs:3,optionsMenuUpdate:3,optionsMenuTeamsInsider:3,optionsLinkYourPhone:3,optionsReconnectYourPhone:3,optionsMenuDialpad:3,closeWindow:3,restoreWindow:3,maximizeWindow:3,minimizeWindow:3,fullscreenWindow:3,openGeneralSettings:3,authOpenAccountsSettings:3,openCalendarSettings:3,openCallSettings:3,openNotificationsSettings:3,openAppearanceAndAccessibilitySettings:3,openAppearanceSettings:3,openAccessibilitySettings:3,openChatsAndChannelsSettings:3,openTranscriptionSettings:3,openProductionCapabilitiesSettings:3,openPhonelinkSettings:3,openPeopleSettings:3,openRecognitionSettings:3,openAppDevicePermisssionSettings:3,openPrivacySettings:3,openFilesSettings:3,openBenefitsSettings:3,openTeamsInsiderSettings:3,openAboutSettings:3,dismissToast:3,performToastAction:3,userSearchFromPersonalFlyout:3,openAppFromAppBar:3,openApp:3,launchPersonalFlyout:3,appsFlyoutOpen:3,personalAppAbout:3,popOutPlatformPersonalApp:3,clickAddFromPersonalFlyoutSuggestions:3,personalAppShare:3,quickAccessLinkClicked:3,flyoutSeeAllClicked:3,uninstallAppOnAppBarAndPersonalAppsFlyout:3,blockUnblockBotChatInPersonalAppsFlyout:3,personalFlyoutPrivacyLink:3,personalFlyoutTermsOfUseLink:3,personalFlyoutItemPermissions:3,toggleCCSSwitcher:3,ToggleExperienceAnalyzeContentSwitcher:3,waffleButtonClicked:3,excelLinkClicked:3,outlookLinkClicked:3,wordLinkClicked:3,oneDriveLinkClicked:3,powerPointLinkClicked:3,oneNoteLinkClicked:3,sharePointLinkClicked:3,teamsLinkClicked:3,yammerLinkClicked:3,ManageWorkflowsClicked:3,JunoButtonClicked:3,JunoSwitchClicked:3,JunoRadioButtonClicked:3,JunoImageRadioButtonClicked:3,JunoDropdownClicked:3,JunoCheckboxClicked:3,appStartTheme:3,ErrorPageActionClicked:3,AccentColorRed:3,AccentColorOrange:3,AccentColorYellow:3,AccentColorGreen:3,AccentColorTeal:3,AccentColorBlue:3,AccentColorPurple:3,AccentColorPink:3,AccentColorDefault:3,AccentColorGrey:3,MessageDownloadImage:3,messageOpenImage:3,contactsSync:3,removeBlockContact:3,selectAtMentionItem:3,OpenFollowSettings:3}},loggingns:{desktop_version_check:3,submit_augloop_proxy_operation_mutation_failed:1,augloop_proxy_operation_event_no_data:1,augloop_session_details_failed:1,submit_augloop_proxy_operation_failed:1,banner_dismissed_not_found:1,brb:1,capture_chunk_load_failures:3,cdl_policies_poke_event:3,cdl_policy_data_event:3,cdl_policy_poke_event:3,cdl_start_up_app_switch_from_t1:3,critical_version_check:1,crosstabs_tabs_count:1,crosstabs_tabs_counting_error:1,localstorage_category_update:1,localstorage_key_update:1,localstorage_size:1,policies_no_namespaces_to_sync:3,policies_push_usefulness:3,policies_settings_push_invalid_namespace:3,cdl_services_worker_worker_service_notify_worker_host_settings_changes_error:3,clear_t2_web_boot_attempts_failure:1,clear_t2_web_boot_attempts_success:1,ecs_utils_id_verification_failed_event:3,provider_cache_storage:3,namespace_loader:1,policies_skipping_sync:3,reboot_request:1,service_switch:3,service_worker_activated:1,service_worker_installed:1,service_worker_redundant:1,service_worker_request_reboot:1,service_worker_update_found:1,service_worker_update_skipped:1,service_worker_version_mismatch:1,settings_no_namespaces_to_sync:3,settings_skipping_sync:3,sw_cache_storage_read_failure:1,sw_cache_storage_write_failure:1,sw_install_integrity_check_performed:1,sw_fetch_manifest_failure:1,sw_fetch_manifest_from_cache_success:1,sw_fetch_manifest_from_network_success:1,sw_prefetch_main_chunks:1,teams_labs_service_cache_storage_error:1,teams_labs_service_initialization_complete:1,telemetry_i18next_wrapper:1,web_app_switcher_opt_out_redirection_fail:1,web_app_switcher_opt_out_redirection_success:1,web_infra_determine_pre_release_filter_failed:3,webclient_framework_exp_loader_event:1,webclient_framework_head_config:1,webclient_framework_policies_resolvers_fetch_failed_event:3,webclient_framework_policies_service_fetch_failed_event:3,webclient_framework_policies_service_fetch_partial_failed_event:3,webclient_framework_policies_worker_resolvers_poll_on_demand_failed_event:3,webclient_framework_policies_worker_resolvers_update_local_cache_failed_event:3,webclient_framework_ecs_client_invalid_cache:1,webclient_framework_ecs_secondary_user_overrides:3,webclient_framework_core_settings_context_flag:1,webclient_framework_user_preferences_resolvers_category_based_mutation_failed_event:3,webclient_framework_settings_update_queue:3,webclient_globalization_i18n_invalid_date_error:1,webclient_graphql_cache_error:1}};var n,r;!function(e){e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.NSD=3]="NSD"}(n||(n={})),function(e){e[e.Unset=0]="Unset",e[e.Basic=1]="Basic",e[e.Enhanced=2]="Enhanced",e[e.NSD=3]="NSD"}(r||(r={}))},363645:(e,t,a)=>{"use strict";function i(e){return Array.isArray(e)}function n(e){return i(e)?e[0]:e}function r(e){return i(e)?e[1]:void 0}a.d(t,{Al:()=>i,bq:()=>n,KA:()=>r})},475168:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var i=a(134185),n=a(912435),r=a(183111),o=a(200027);function s(e){return async t=>{try{return await e(t)}catch(e){if(e instanceof TypeError&&e.message?.toLowerCase()===o.p7){const a=t.headers&&t.headers.cache;if(a&&-1!==a.indexOf("only-if-cached"))return{status:i.nW.GATEWAY_TIMEOUT};e=(0,n.$5)(r.Ir.RejectHttpError,r.O4.RemoteOperationFailed,"rejectHttpError",void 0,e.message)}throw e}}}},200027:(e,t,a)=>{"use strict";a.d(t,{cS:()=>i,p7:()=>n,Us:()=>r});const i=3e4,n="failed to fetch",r="Request Timed Out"},770628:(e,t,a)=>{"use strict";a.d(t,{b:()=>s});var i=a(823013),n=a.n(i),r=a(313285),o=a(200027);const s=({url:e,method:t,body:a,headers:i,credentials:s,timeout:_=o.cS,skipHeaders:c=!1})=>{const l=new AbortController;return(0,r.a)(n()(e,{method:t,headers:c?{}:i&&new Headers(i),body:a,credentials:s,signal:l.signal}),_,o.Us,l).then((e=>{const t={};return e.headers.forEach(((e,a)=>t[a]=e)),{status:e.status,headers:t,body:e,url:e.url}}))}},564695:(e,t,a)=>{"use strict";a.d(t,{t:()=>s});var i=a(856429),n=a(653982);var r=a(770628),o=a(475168);const s=(0,i.x)(function(e){return async t=>{let i,r;const o=performance.now(),s=new Date;try{return r=await e(t),r}catch(e){throw i=e.code||e.message,r=e.serverResponse,e}finally{!function(e,t,i,r,o){const s=a.g;(0,n.s_)(r,t,i,e,e&&function(e){const t=performance.getEntriesByName(e);if(t.length>0&&"resource"===t[t.length-1].entryType)return t[t.length-1];return}(e.url),s,o)}(r,s,t,performance.now()-o,i)}}}((0,o.g)(r.b)))},735366:(e,t,a)=>{"use strict";var i,n,r,o,s,_;a.d(t,{PK:()=>i,Hs:()=>n,hf:()=>r,l2:()=>o,oH:()=>s,wX:()=>_,Of:()=>c,py:()=>l,WT:()=>d,o1:()=>p,Oq:()=>u,uH:()=>m,nT:()=>h}),function(e){e.Team="team",e.Scheduled="scheduled",e.Automatic="automatic",e.Any="any"}(i||(i={})),function(e){e.Shifts="shifts"}(n||(n={})),function(e){e.None="none",e.Owners="owners",e.Automatic="automatic"}(r||(r={})),function(e){e.Disabled="disabled",e.TeamOwners="teamOwners",e.TeamOwnersAndMembers="teamOwnersAndMembers"}(o||(o={})),function(e){e.None="None",e.JobTitle="JobFunction",e.Department="Department"}(s||(s={})),function(e){e.Get="get",e.Add="add",e.Delete="delete"}(_||(_={}));const c={Disabled:"Disabled",EnabledTeamOwner:"EnabledTeamOwner",EnabledTeamOwnerMember:"EnabledTeamOwnerMember"},l={Enabled:"Enabled",Disabled:"Disabled"},d={Enabled:"Enabled",Disabled:"Disabled"},p="s",u="au";var m,h;!function(e){e.CustomTagMode="custom tag mode",e.DisallowedSources="disallowed sources",e.OwnersCanOverwriteTagSettings="owners can override tag settings",e.SuggestedTags="suggested tags",e.TagPermissions="tag permissions"}(m||(m={})),function(e){e.Unknown="Unknown",e.FeatureNotEnabled="FeatureNotEnabled",e.NotAnOwner="NotAnOwner",e.NotAMember="NotAMember",e.SourceNotAllowed="SourceNotAllowed",e.TagNotFound="TagNotFound",e.TagAlreadyExists="TagAlreadyExists",e.ExceededTagsPerTeam="ExceededTagsPerTeam",e.ExceededTagsPerMember="ExceededTagsPerMember",e.ExceededMembersPerTag="ExceededMembersPerTag",e.TagIsDeleted="TagIsDeleted",e.MismatchedTagVersion="MismatchedTagVersion",e.MismatchedTeamTagSettingsVersion="MismatchedTeamTagSettingsVersion"}(h||(h={}))},608378:(e,t,a)=>{"use strict";var i,n,r,o;a.d(t,{zK:()=>i,dh:()=>n,gi:()=>r,P6:()=>o,hZ:()=>s,Y:()=>_,qK:()=>c,X3:()=>l,Ji:()=>d,xH:()=>p,Yq:()=>u,mV:()=>m,tU:()=>h,A8:()=>g,ys:()=>f,lp:()=>v,tE:()=>y,aR:()=>S,pC:()=>E,vZ:()=>C,y6:()=>b,jB:()=>w,bK:()=>k,Fg:()=>A,pR:()=>T,j9:()=>x,W6:()=>I,gd:()=>M,oY:()=>O,KE:()=>N,r8:()=>D,R$:()=>P,Ry:()=>R,rK:()=>U,ll:()=>L,O2:()=>F,b7:()=>G,eX:()=>$,HS:()=>H,Lo:()=>B,nP:()=>q,uy:()=>V,BN:()=>K,Wf:()=>j,sE:()=>z,Kn:()=>W,Is:()=>Q}),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(i||(i={})),function(e){e.Room="Room",e.OrganizationContact="OrganizationContact",e.OrganizationUser="OrganizationUser",e.PersonalContact="PersonalContact",e.PublicDistributionList="PublicDistributionList",e.UnifiedGroup="UnifiedGroup",e.Guest="Guest",e.VoiceApp="VoiceApp",e.DynamicDistributionGroup="DynamicDistributionGroup",e.MailUniversalDistributionGroup="MailUniversalDistributionGroup",e.MailNonUniversalGroup="MailNonUniversalGroup",e.MailUniversalSecurityGroup="MailUniversalSecurityGroup",e.UniversalSecurityGroup="UniversalSecurityGroup",e.ExchangeSecurityGroup="ExchangeSecurityGroup",e.MTOUser="MTOUser",e.PendingOrgContact="PendingOrgContact",e.OrgContact="OrgContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact"}(n||(n={})),function(e){e.NonHidden="NonHidden"}(r||(r={})),function(e){e.staticbrowse="staticbrowse",e.powerbar="powerbar",e.peoplepicker="peoplepicker",e.contextualsearch="contextualsearch",e.tflpowerbar="TFL.powerbar",e.peopleserp="peopleserp",e.tflpeopleserp="TFL.peopleserp",e.appstoresearch="appstore.search",e.goto="powerbar.goto"}(o||(o={}));const s={People:"People",File:"File",Text:"Text",Message:"Message",Image:"Image",Document:"Document",Channel:"Channel",Chat:"Chat",Team:"Team",Event:"Event",TopHit:"TopHit",App:"App",TeamsAndChannels:"TeamsChannel",Bookmark:"Bookmark",Filter:"Filter",Conversation:"Conversation",Contact:"Contact"};var _,c,l,d,p,u,m;!function(e){e.Teams="Teams",e.SharePoint="SharePoint",e.OneDriveForBusiness="OneDriveBusiness",e.SharePointAndOneDrive="SharePointAndOneDrive",e.Exchange="Exchange",e.ExchangeSharePointAndOneDrive="ExchangeSharePointAndOneDrive",e.ExchangeAndOneDrive="ExchangeAndOneDrive",e.ExchangeAndSharePoint="ExchangeAndSharePoint",e.SharepointOnline="SharepointOnline",e.Mailbox="Mailbox",e.Directory="Directory",e.SecurityGroups="SecurityGroups",e.ExtendedDirectory="ExtendedDirectory",e.ClassicAttachment="ClassicAttachment",e.ModernAttachment="ModernAttachment"}(_||(_={})),function(e){e.SearchActions="SearchActions",e.ClientDataSource="ClientDataSource",e.ResponseReceived="ResponseReceived",e.ResultsRendered="ResultsRendered",e.ClientLayout="ClientLayout",e.SearchEntityActions="SearchEntityActions",e.CachedContentRendered="CachedContentRendered",e.SearchFeedback="SearchFeedback",e.CounterfactualInformation="CounterfactualInformation"}(c||(c={})),function(e){e.Query="Query",e.Suggestions="Suggestions",e.Answers="Answers"}(l||(l={})),function(e){e.Group="Group",e.Entity="Entity"}(d||(d={})),function(e){e.Visible="Visible",e.Paritial="Partial",e.Hidden="Hidden"}(p||(p={})),function(e){e.Vertical="Vertical",e.Horizontal="Horizontal",e.Grid="Grid"}(u||(u={})),function(e){e.PERSON="PeopleSuggestion",e.GROUPCHAT="ChatSuggestion",e.CHANNEL="ChannelSuggestion",e.TEAM="TeamSuggestion",e.FILE="FileSuggestion",e.TEXT="TextSuggestion",e.SEARCH="More",e.JOINLINK="JoinLink",e.SEARCHEXTERNAL="SearchExternal",e.DIALOG="Dialog",e.FILEDOMAIN="FileDomain",e.MESSAGEDOMAIN="MessageDomain",e.GROUPCHATDOMAIN="GroupchatDomain",e.TCDOMAIN="TCDomain",e.APPSCOPEDDOMAIN="AppScopedDomain",e.APP="AppSuggestion",e.SEARCHFEEDBACK="SearchFeedback",e.LEARNINGSLOT="LearningSlot",e.DISCOVERSURFACEENTRY="DiscoverSurfaceEntry",e.COMMAND="SlashCommand",e.MESSAGESERPENTRY="MessageSerpEntry",e.CONTEXTUALSEARCHENTRY="ContextualSearchEntrypointSuggestion",e.PEOPLECENTRICSEARCH="PeopleCentricSearch",e.MOREAPPS="MoreApps",e.MESSAGEEXTENSIONAPP="MessageExtensionApp",e.BOOKMARK="BookmarkSuggestion",e.EXTERNAL="External",e.PCSSUGGESTION="PCSSuggestion",e.PCSFILTER="PCSFILTER",e.MESSAGE="MessageSuggestion",e.EVENT="EventSuggestion",e.HELP="HelpSuggestion",e.PSTNCALLING="PstnCallingSuggestion",e.MEETINGDOMAIN="MeetingDomain",e.KQL="KQLSuggestion",e.IMAGEDOMAIN="ImageDomain",e.IMAGE="ImageSuggestion",e.ENGAGECOMMUNITY="EngageCommunity"}(m||(m={}));const h={Messages:"Messages",People:"People",Files:"Files",Images:"Images",Communities:"Communities",All:"All",Emails:"Emails",Meetings:"Meetings",GroupChats:"GroupChats",TeamsAndChannels:"TeamsAndChannels",EngageCommunities:"EngageCommunities",Default:"Default"};var g,f,v,y,S,E,C,b,w,k,A,T,x,I,M,O,N,D,P,R,U;!function(e){e.Messages="Messages",e.People="People",e.Files="Files",e.Emails="Emails",e.Answer="Answer",e.TeamsChannel="TeamsChannel",e.GroupChats="GroupChats",e.Meetings="Meetings",e.EngageCommunities="EngageCommunities"}(g||(g={})),function(e){e[e.TOP=1]="TOP",e[e.MOP=2]="MOP",e[e.BOP=3]="BOP",e[e.ROP=1200]="ROP"}(f||(f={})),function(e){e.Bookmark="Bookmark",e.Event="Event",e.Acronym="Acronym",e.PeopleAlsoAsk="PeopleAlsoAsk",e.External="External"}(v||(v={})),function(e){e.SearchDone="SearchDone",e.VerticalClicked="VerticalClicked",e.ExpandLinkClicked="ExpandLinkClicked",e.PaginationClicked="PaginationClicked",e.ExitSearch="ExitSearch",e.ClearSearchText="ClearSearchText",e.FetchMoreResults="FetchMoreResults",e.ChevronClicked="ChevronClicked",e.FilterModified="FilterModified",e.ClearFilters="ClearFilters",e.LayoutChanged="LayoutChanged"}(y||(y={})),function(e){e.EntityClicked="EntityClicked",e.PreviewOpen="PreviewOpen",e.PreviewClose="PreviewClose",e.PopOutChat="PopOutChat",e.CopyLink="CopyLink",e.LinkClicked="LinkClicked",e.ExpandMessage="ExpandMessage",e.CollapseMessage="CollapseMessage",e.EntityActionTaken="EntityActionTaken",e.EntityRefinerClicked="EntityRefinerClicked",e.FileChicletClicked="FileChicletClick",e.CalendarJoinClick="CalendarJoinClick",e.ChatClick="ChatClick",e.CalendarRsvpClick="CalendarRsvpClick",e.MeetingRecapClick="MeetingRecapClick",e.ArtifactsClick="FileChicletOpenInBrowser",e.MeetingRecordingClick="RecordingClick",e.OpenInBrowser="OpenInBrowser",e.DownloadImage="DownloadImage",e.CopyImage="CopyImage",e.GoToChat="GoToChat",e.GoToChannel="GoToChannel"}(S||(S={})),function(e){e.SerpEntryClicked="SerpEntryClicked",e.NavigationalClick="NavigationalClick",e.CalendarJoinClick="CalendarJoinClick",e.ChatClick="ChatClick",e.MeetingRecapClick="MeetingRecapClick"}(E||(E={})),function(e){e.RightClickOpen="RightClickOpen",e.NewTabOpen="NewTabOpen",e.ContinueReading="ContinueReading",e.OpenInViewer="OpenInViewer",e.OpenInClient="OpenInClient",e.ReadingPaneOpen="ReadingPaneOpen"}(C||(C={})),function(e){e.SiteSearch="SiteSearch"}(b||(b={})),function(e){e.QueryType="QueryType",e.FormFactor="FormFactor"}(w||(w={})),function(e){e[e.Timeout=408]="Timeout"}(k||(k={})),function(e){e.EnterKey="EnterKey",e.SearchButton="SearchButton"}(A||(A={})),function(e){e.Init="SubstrateInit",e.Instrumentation="SubstrateInstrumentation",e.SerpCorsPreload="SerpCorsPreload",e.UkbAllScores="UkbAllScores"}(T||(T={})),function(e){e.IndexedDb="IndexedDB",e.Substrate="3S",e.Memory="Memory",e.MiddleTier="MiddleTier"}(x||(x={})),function(e){e.MESSAGES="MESSAGES",e.HISTORY="HISTORY",e.PEOPLEKEYWORDASTEXT="PEOPLEKEYWORDASTEXT",e.PEOPLEASTEXT="PEOPLEASTEXT",e.TEAMSMESSAGEKPE="TEAMSMESSAGEKPE",e.MEETINGS="MEETINGS",e.KQLASTEXT="KQLASTEXT"}(I||(I={})),function(e){e.Left="Left",e.Right="Right"}(M||(M={})),function(e){e.SEARCH="SEARCH",e.PERSON="PERSON",e.GROUPCHAT="GROUPCHAT",e.TEAM="TEAM",e.CHANNEL="CHANNEL",e.FILE="FILE",e.TEXT="TEXT",e.JOINLINK="JOINLINK",e.SEARCHEXTERNAL="SEARCHEXTERNAL",e.DIALOG="DIALOG",e.FILEDOMAIN="FILEDOMAIN",e.MESSAGEDOMAIN="MESSAGEDOMAIN",e.GROUPCHATDOMAIN="GROUPCHATDOMAIN",e.TCDOMAIN="TCDOMAIN",e.APP="APP",e.SEARCHFEEDBACK="SEARCHFEEDBACK",e.LEARNINGSLOT="LEARNINGSLOT",e.DISCOVERSURFACEENTRY="DISCOVERSURFACEENTRY",e.COMMAND="COMMAND",e.MESSAGESERPENTRY="MESSAGESERPENTRY",e.CONTEXTUALSEARCHENTRY="CONTEXTUALSEARCHENTRY",e.PEOPLECENTRICSEARCH="PEOPLECENTRICSEARCH",e.PCSFILTER="PCSFILTER",e.MOREAPPS="MOREAPPS",e.MESSAGEEXTENSIONAPP="MESSAGEEXTENSIONAPP",e.BOOKMARK="BOOKMARK",e.MESSAGE="MESSAGE",e.HELP="HELP",e.APPSCOPEDDOMAIN="APPSCOPEDDOMAIN",e.EVENT="EVENT",e.MEETINGDOMAIN="MEETINGDOMAIN",e.KQL="KQL",e.IMAGEDOMAIN="IMAGEDOMAIN",e.IMAGE="IMAGE",e.ENGAGECOMMUNITY="ENGAGECOMMUNITY"}(O||(O={})),function(e){e.PEOPLE="PEOPLE",e.GROUPCHATS="GROUPCHATS",e.TEAMS="TEAMS",e.CHANNELS="CHANNELS",e.TOPHITS="TOPHITS",e.QUERIES="QUERIES",e.SEARCHES="SEARCHES",e.HISTORY="HISTORY",e.FILES="FILES",e.SUGGESTED="SUGGESTED",e.SUGGESTEDSEARCH="SUGGESTEDSEARCH",e.SEARCHEXTERNAL="SEARCHEXTERNAL",e.DIALOG="DIALOG",e.PRIMARYDOMAIN="PRIMARYDOMAIN",e.APPS="APPS",e.TEAMSANDCHANNELS="TEAMSANDCHANNELS",e.FEEDBACK="FEEDBACK",e.COMMAND="COMMAND",e.LEARNINGSLOT="LEARNINGSLOT",e.CONTEXTUALSEARCHENTRY="CONTEXTUALSEARCHENTRY",e.DISCOVERSURFACEENTRY="DISCOVERSURFACEENTRY",e.PEOPLECENTRICSEARCH="PEOPLECENTRICSEARCH",e.WPS="WPS",e.MESSAGES="MESSAGES",e.HELP="HELP",e.PSTNCALLING="PSTNCALLING",e.GOTO="GOTO",e.EVENTS="EVENTS",e.KQLS="KQLS",e.IMAGES="IMAGES",e.ENGAGECOMMUNITY="ENGAGECOMMUNITY"}(N||(N={})),function(e){e.PEOPLE="People",e.GROUPCHATS="Chat",e.TEAMS="Team",e.CHANNELS="Channel",e.TOPHITS="TopHits",e.QUERIES="Text",e.SEARCHES="More",e.HISTORY="RecentSearch",e.FILES="File",e.SUGGESTED="Suggested",e.SUGGESTEDSEARCH="SuggestedSearch",e.SEARCHEXTERNAL="SearchExternal",e.DIALOG="Dialog",e.PRIMARYDOMAIN="PrimaryDomain",e.APPS="App",e.TEAMSANDCHANNELS="TeamsAndChannels",e.FEEDBACK="Feedback",e.COMMAND="SlashCommand",e.LEARNINGSLOT="LearningSlot",e.CONTEXTUALSEARCHENTRY="ContextualSearchEntrypoint",e.DISCOVERSURFACEENTRY="DISCOVERSURFACEENTRY",e.PEOPLECENTRICSEARCH="PEOPLECENTRICSEARCH",e.WPS="WPS",e.MESSAGES="Message",e.HELP="HELP",e.PSTNCALLING="PstnCalling",e.GOTO="Goto",e.EVENTS="Event",e.KQLS="KQLS",e.IMAGES="Image",e.ENGAGECOMMUNITY="EngageCommunity"}(D||(D={})),function(e){e.Author="Author",e.AuthorEmail="AuthorEmail",e.EmailSenderName="EmailSenderName",e.EmailSenderAddress="EmailSenderAddress"}(P||(P={})),function(e){e.None="none"}(R||(R={})),function(e){e.ALL="all"}(U||(U={}));var L,F,G,$,H,B,q,V;!function(e){e.Relevance="Relevance",e.DateTime="DateTime"}(L||(L={})),function(e){e.Chat="Chat",e.Meeting="Meeting",e.Channel="Channel"}(F||(F={})),function(e){e.Urgent="Urgent",e.Important="Important",e.IsMentioned="IsMentioned",e.HasImage="HasImage",e.HasAttachments="HasAttachments",e.HasLinks="HasLinks",e.IsRead="IsRead",e.IsAnnouncement="IsAnnouncement"}(G||(G={})),function(e){e.OneOnOneChat="OneOnOneChat",e.SelfChat="PersonalNotes",e.NamedGroupChat="NamedGroupChat",e.UnnamedGroupChat="UnnamedGroupChat",e.MeetingChat="MeetingChat",e.SharedChannel="SharedChannel",e.StandardChannel="StandardChannel"}($||($={})),function(e){e.Announcement="Announcement",e.Post="Post",e.Reply="Reply"}(H||(H={})),function(e){e.Catalog="Catalog"}(B||(B={})),function(e){e.Image="Image"}(q||(q={})),function(e){e.CONTEXTUALSEARCH_LEARNINGSLOT="ContextualSearchLearningSlot",e.GOTOMODE_LEARNINGSLOT="GotoModeLearningSlot"}(V||(V={}));const K={ReplyChainId:"replyChainId",ObjectId:"objectId",MeetingUrl:"skypeTeamsMeetingUrl",MeetingType:"meetingType",CleanGlobalObjectId:"cleanGlobalObjectId",MeetingDate:"meetingDate",MeetingMonth:"meetingMonth",ActiveMeeting:"activeMeeting",StartTime:"startTime",EndTime:"endTime"};var j;!function(e){e.ChatMeeting="ChatMeeting",e.ChannelMeeting="ChannelMeeting"}(j||(j={}));const z=[h.All,h.Messages,h.Files,h.Emails,h.GroupChats,h.People,h.Meetings,h.Images],W=[h.All,h.Messages,h.Files,h.Emails,h.Meetings,h.Images],Q=[h.All,h.Messages,h.Files,h.Images,h.GroupChats,h.TeamsAndChannels]},357400:(e,t,a)=>{"use strict";a.d(t,{M1:()=>o,u_:()=>s,oJ:()=>_});var i=a(401368),n=a(564695);const r={enableOTPMeetings:!1},o=e=>{r.enableOTPMeetings=e},s=e=>e||!!r.enableOTPMeetings;async function _(e,t,a,o){try{a.addScenarioMark("auth-web-get-organizer-ring-start");const{disableSetOtpEnabledFromHostTenantId:s,enableOTPMeetings:_,otpMeetingEnabledRings:c}=t?.get(i.w.Auth)||{};if(_)return void(r.enableOTPMeetings=!0);if(!c||s)return;a.addEventData(["makeConfigApiCall:1"]);const l=await async function(e,t,a,r){try{const{disableSetOtpEnabledFromHostOid:o,configApiBaseUrlWeb:s}=r?.get(i.w.Auth)||{},{Tid:_,Oid:c}=function(e,t){if(!e)return{};const a={};try{const t=new URL(e).search.substring(1),i=t?.split("&");return i.forEach((e=>{const t=e.split("=");a[decodeURIComponent(t[0])]=decodeURIComponent(t[1])})),{Tid:a.context?JSON.parse(a.context).Tid:null,Oid:a.context?JSON.parse(a.context).Oid:null}}catch(e){t.addEventData(["getUrlParams:Failure"])}return{Tid:null,Oid:null}}(e,a),l=t??_,d=s??"https://config.teams.microsoft.com/config/v1/MicrosoftTeams/1415_1.0.0.0?",p=o||!c?`${d}tenantId=${l}`:`${d}tenantId=${l}&id=${c}`,u=await(0,n.t)({url:p,method:"GET",headers:{},serviceName:"auth",apiName:"getConfig"}),m=await(u.body?.json()),h=m?.Segmentation?.TeamsRing;return a.addEventData([`organizerRing:${h}`]),h}catch(e){a.addEventData(["configApiCall:Failure"]),a.addScenarioMark("auth-web-get-meeting-config-failure")}return"general"}(e,o,a,t);if(!c.includes(l))return void a.addEventData(["setOTPEnabled:0"]);a.addEventData(["setOTPEnabled:1"]),r.enableOTPMeetings=!0}catch(e){a.addEventData(["setOTPEnabled:failure"])}}},638364:(e,t,a)=>{"use strict";a.d(t,{yq:()=>i,QF:()=>n,ct:()=>r,CO:()=>o,D2:()=>s,iS:()=>_,kj:()=>c,pw:()=>l,GT:()=>d,yx:()=>p,$Z:()=>u,Hd:()=>m,dQ:()=>h,fu:()=>g,tG:()=>f,Cd:()=>v,p2:()=>y,Pj:()=>S,NI:()=>E,xM:()=>C,Qr:()=>b,X7:()=>w,mJ:()=>k,oF:()=>A,$X:()=>T,i3:()=>I,vF:()=>M,ar:()=>N,Ib:()=>D,FQ:()=>P,jL:()=>R,zB:()=>U,xD:()=>L,J:()=>F,yB:()=>G,bw:()=>$,Xz:()=>H,Oi:()=>B,OF:()=>q,wk:()=>V,xH:()=>K,aF:()=>j,gl:()=>z,Qc:()=>W,Ee:()=>Q});const i="TflFreProfileCardDisplayed",n="LogoutState",r="authSessionId",o={nopa:"2"},s={coa:"1"},_={2003:"1"},c="tenantId",l="loginhint",d="login_hint",p="clientexperience",u="t2",m=12e4,h=5e3,g={TfwToTfl:"teams.live.com",TflToTfw:"teams.microsoft.com"},f={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",UserLicenseNotPresentTrialExpired:"UserLicenseNotPresentTrialExpired",UserLicenseNotPresentTrialHardBlocked:"UserLicenseNotPresentTrialHardBlocked",CloudMismatch:"CloudMismatch",CloudMismatchNoMultiCloud:"CloudMismatchNoMultiCloud",MultiMSARoadBlock:"MultiMSARoadBlock",InitFailure:"Core-auth init failure",NoMatchingUserFound:"NoMatchingUserFound",InteractionRequired:"InteractionRequired",RefreshTokenExpired:"refresh_token_expired",UnsupportedAccountType:"UnsupportedAccountType",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",NoNetwork:"NoNetwork",ErrorRateLimitExceeded:"ErrorRateLimitExceeded",MachineAsleep:"MachineAsleep",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",InvalidEndpoint:"endpoints_resolution_error",UnsupportedParameter:"UnsupportedParameter",UserAuthOrHomeAccountNotAvailable:"UserAuthOrHomeAccountNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken",HiddenUserErrorForLogin:"HiddenUserErrorForLogin",MsaUserNotAllowed:"MsaUserNotAllowed",ShowTenantPicker:"ShowTenantPicker",LogOutTriggeredFromCrossCloud:"Log out triggered cross cloud",NoSkypetokenAvailableInResponse:"NoSkypetokenAvailableInResponse",PushNotificationEventWithErrors:"PushNotificationEventWithErrors",NoTenantsFound:"NoTenantsFound",SkypeTokenResponseInvalidJson:"SkypeTokenResponseInvalidJson",AcquireTokenCloudMismatch:"AcquireTokenCloudMismatch",CrossCloudTenantInWeb:"CrossCloudTenantInWeb",SkypeTokenMigrationUnsupportedClient:"SkypeTokenMigrationUnsupportedClient",InvalidTenantResponse:"InvalidTenantResponse",RestartDevice:"RestartDevice"},v={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},y="https://login.microsoftonline.com/",S=[{cloud:"prod",authority:y},{cloud:"gallatin",authority:"https://login.partner.microsoftonline.cn/"},{cloud:"dod",authority:"https://login.microsoftonline.us/"},{cloud:"gcch",authority:"https://login.microsoftonline.us/"},{cloud:"life",authority:y},{cloud:"airgap09",authority:"https://login.microsoftonline.microsoft.scloud/"},{cloud:"airgap08",authority:"https://login.microsoftonline.eaglex.ic.gov/"}],E="InteractionRequiredAuthError",C="skype-token",b="discover-region-gtm",w="tmp.otp-meeting-key";var k,A,T;!function(e){e.signInButton="signInButton",e.joinNowButton="joinNowButton",e.authAddAccount="authAddAccount"}(k||(k={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com",e.IC3_GATEWAY_CAE_KEY_INT="https://ic3-testing.teams.office.com",e.IC3_GATEWAY_AAD_KEY_INT="https://ic3-non-cae-testing.teams.office.com",e.AAD_V2_TFL="https://mtsvc.fl.teams.microsoft.com/teams.mt.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(A||(A={})),function(e){e.openId="openId",e.profile="profile"}(T||(T={}));let x=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error","Sending silent Cross-Cloud request on unsupported version of Windows"];const I=e=>(e&&(x=[...x,...e]),x),M=()=>x;let O=[];const N=e=>(e&&(O=[...O,...e]),O),D=(e,t)=>{const a=t?e:e.replace(/\u200B/g,"").trim();return O.includes(a)};var P;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.TEN=10]="TEN",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY",e[e.TWO_HUNDRED_FIFTY_FIVE=255]="TWO_HUNDRED_FIFTY_FIVE"}(P||(P={}));const R={CLIENT_ERROR:-1,OK:200,BAD_REQUEST:400,UNAUTHORIZED_ACCESS:401,FORBIDDEN:403,NOT_FOUND:404,NOT_ACCEPTABLE:406,CONFLICT:409,LOCKED:423,TOO_MANY_REQUESTS:429,INTERNAL_SERVER_ERROR:500,SERVICE_UNAVAILABLE:503,NOT_MODIFIED:304};var U,L;!function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.ONE_DAY=864e5]="ONE_DAY",e[e.FIVE_MINUTES=3e5]="FIVE_MINUTES"}(U||(U={})),function(e){e.services="f8cdef31-a31e-4b4a-93e4-5f571e91255a"}(L||(L={}));const F="9188040d-6c67-4c5b-b112-36a304b66dad",G="organizations",$="wids",H="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",B="b44d8d43-c828-450b-9b6f-ae3788447705",q="X-MS-Migration",V="X-Ms-Test-User",K="tmp.trialLicenseSignUpAccountId",j=(P.TWO,U.MILLI_PER_SECOND,U.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim",SKYPE_ONLY_TEAMS_SHARED_DEVICES:"skype_only_teams_shared_devices"}),z={MTO:"MTO"},W={TENANTSV2:"/beta/users/tenantsv2"},Q="auth_home_tenant_placeholder"},242030:(e,t,a)=>{"use strict";a.d(t,{D:()=>n});var i=a(494514);const n=new class{constructor(){this.logLevel=i.$b.Info,this.localCallback=void 0,this.error=e=>this.logMessage(i.$b.Error,e),this.warning=e=>this.logMessage(i.$b.Warning,e),this.warn=e=>this.logMessage(i.$b.Warning,e),this.info=e=>this.logMessage(i.$b.Info,e),this.log=e=>this.logMessage(i.$b.Info,e),this.verbose=e=>this.logMessage(i.$b.Verbose,e),this.debug=e=>this.logMessage(i.$b.Verbose,e)}initialize(e,t=i.$b.Verbose){this.localCallback=e,this.logLevel=t}executeCallback(e,t){this.localCallback?this.localCallback(e,t):console&&console.log(t)}logMessage(e,t){if(e>this.logLevel)return;const a=`[Auth]: ${t}`;this.executeCallback(e,a)}}},672730:(e,t,a)=>{"use strict";a.d(t,{l:()=>i});class i{}i._authTelemetryCollection={},i._correlationMap={},i._userBiServiceMap={},i.getUserBiService=e=>i._userBiServiceMap[e]||i._userBiServiceMap.GLOBAL,i.setUserBiService=(e,t)=>{t?i._userBiServiceMap[e]=t:delete i._userBiServiceMap[e]},i.getAuthTelemetry=e=>i._authTelemetryCollection[e],i.setAuthTelemetry=(e,t)=>i._authTelemetryCollection[e]=t,i.delete=e=>{delete i._authTelemetryCollection[e];const t=Object.keys(i._correlationMap);for(const a in t)if(i._correlationMap.hasOwnProperty(t[a])){const n=t[a],r=i._correlationMap[n];r&&(i._correlationMap[n]=r.filter((t=>t!==e)))}},i.getCorrelation=e=>i._correlationMap[e],i.setCorrelation=e=>{if(!e.scenarioName)return;const t=i.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),i._correlationMap[e.scenarioName]=t}},396476:(e,t,a)=>{"use strict";a.d(t,{we:()=>h,yw:()=>m,d9:()=>u,$C:()=>v,nd:()=>f,FS:()=>y});var i=a(242030),n=a(712003),r=a(214568),o=a(319226),s=a(489955),_=a(672730),c=a(912435),l=a(638364);class d{constructor(e,t,a,d,p,u,m,h,g,f,v,y,S){this._scenarioFactory=e,this._correlation=t,this._asyncAuthCache=a,this._subContext=d,this._shouldCreateScenario=p,this._isBatch=u,this._timeoutMs=m,this._telemetryService=h,this._isMachineOnline=f,this._isMachineAwake=v,this._enableAuthTelemetryMachineStateCheck=y,this._authTelemetryMachineStateCheckOffsetMilliSeconds=S,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{e=this.scrubEuiiFromEventData(e),this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData={...this._localScenarioEventData,...e}},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},a)=>{t=this._mapEventData(t,a),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),this.logMessage(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,n.hR)(t)}]`)},this.closeScenario=(e={},t,a,n)=>{if(e=this._mapEventData(e,t),a)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(this._isBatch&&this._correlation.scenarioName&&(this._batchScenarioStartTime&&(e.perfDelta=performance.now()-this._batchScenarioStartTime),e.correlationId=e.correlationId??this._correlation.id,"success"===e.status?(0,o.G4)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,n):"failure"===e.status?(0,o.Bz)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,n):(0,o.Fy)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,n)),!this._scenario){const t=this._shouldCreateScenario?i.D.warn:i.D.log,a=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${a} [scenarioEventData]`,e),void _.l.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const r="failure"===e.status?i.D.error:i.D.log;this.logEventData(r,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),_.l.delete(this._correlation.id)},this.pauseScenario=e=>{this._scenario?(e={...e,...this._eventData},this._scenario.pause(e)):this.logMessage("pauseScenario called but actual scenario is not created yet.",i.D.warn)},this.resumeScenario=()=>{this._scenario?this._scenario.resume():this.logMessage("resumeScenario called but actual scenario is not created yet.",i.D.warn)},this.createScenario=(e,t,a)=>{this._scenario?this.logMessage(`createScenario called with [${this._subContext}][${(0,n.hR)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`,i.D.warn):(this._createScenario(e,a||this._timeoutMs,{...this._localScenarioEventData,...t}),this.logMessage(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const a={panelRegion:r.rP.main,panelType:r.HP.AuthStart,actionWorkload:r.E0.auth,actionSubworkload:r.i7.sisu,actionScenarioType:r.DB.appAuth,actionScenario:t.scenario,actionGesture:t.actionGesture||r.Od.auto},n=_.l.getUserBiService(e||"GLOBAL");n&&n.recordPanelAction(a,i.D)},this.recordAuthUserBiWithPropertiesTelemetry=(e,t)=>{const a={panelRegion:r.rP.main,panelType:e,actionWorkload:r.E0.auth,actionSubworkload:r.i7.sisu,actionScenarioType:r.DB.appAuth,actionGesture:r.Od.auto,dataBag:{category:"auth",data:{eventData:t}}},n=_.l.getUserBiService("GLOBAL");n&&n.recordPanelAction(a,i.D)},this.setUserToTelemetryContext=e=>{e&&(this._telemetryService?.setAuthContext(e),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`))},this.setUserDetailsToTelemetryContext=e=>{if(e){const{region:t}=e;void 0!==t&&this._telemetryService?.setCoreContext("UserInfo.Region",t),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{if(e.subContext=e.subContext||this._subContext,(e={...this._localScenarioEventData,...e}).error){const t=(0,c.Mr)(e.error.message);e.error={...e.error,message:t,errorMetadata:void 0},e.errorCode=e.error.code??e.error.errorCode,e.message=t||"",e.tag=e.error.tag,e.systemErrorCode=e.error.systemErrorCode,this.addEventData([`errorCode:${e.error.errorCode}`]),"errorMessage"in e.error&&"string"==typeof e.error.errorMessage&&(e.error.errorMessage=(0,c.Mr)(e.error.errorMessage))}return!t&&e.error&&(t=(0,s.$z)(e.error)?"incomplete":"failure"),e.eventData=(0,c.Mr)(this._eventData.join(",")),e.status=t||"success",e},this._createScenario=(e,t,a)=>{const n=t?{timeoutMs:t}:{};if(this._scenario=this._scenarioFactory.findScenario(e)||void 0,!this._scenario&&(this._scenario=this._scenarioFactory.newScenario(e,n),this._scenario.appendEventData({createdBy:"authTelemetry"}),this._shouldCheckMachineState()))if(this._machineStateCheckTimeoutId)globalThis.window.clearTimeout(this._machineStateCheckTimeoutId),this._machineStateCheckTimeoutId=void 0;else{const e=(t??l.Hd)-(this._authTelemetryMachineStateCheckOffsetMilliSeconds??l.dQ);this._machineStateCheckTimeoutId=globalThis.window.setTimeout((()=>this._checkMachineStateAndCloseScenario()),e),this.addEventData(["addTimerForEarlyStop"])}try{this._scenarioFactory.hoistScenarioToCore?.(this._scenario)}catch(e){i.D.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source,...a}),this._shouldCreateScenario=!0},this._shouldCheckMachineState=()=>!!this._enableAuthTelemetryMachineStateCheck&&(!1===this._isMachineOnline?.()||!1===this._isMachineAwake?.()),this._checkMachineStateAndCloseScenario=()=>{this._shouldCheckMachineState()&&(this.addEventData([`isMachineOnline:${this._isMachineOnline?.()??void 0},\n        isMachineAwake:${this._isMachineAwake?.()??void 0}`]),this._scenario?.isPaused?this.addEventData(["scenarioPaused,timerAborted"]):this.closeScenario({reason:"close-scenario-before-timeout"},"incomplete")),globalThis.window.clearTimeout(this._machineStateCheckTimeoutId),this._machineStateCheckTimeoutId=void 0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,a)=>{a.error||delete a.error;const i=this.splitStringEqually((0,c.Mr)((0,n.hR)(a)));for(const a of i)this.logMessage(`${t}${a}`,e)},this.splitStringEqually=(e,t=300)=>{const a=new RegExp(`.{1,${t}}`,"g"),i=e.match(a);return i||[]},this.logMessage=(e,t)=>{this._isBatch||(t?t(e):i.D.log(e))},this.scrubEuiiFromEventData=e=>{for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const a=t,i=e[a];"string"==typeof i&&(e[a]=(0,c.Mr)(i))}return e},this._loggingPrefix=this.loggingPrefix(),this._isBatch&&(this._batchScenarioStartTime=performance.now()),p&&(g?this._scenario=g:this._correlation?.scenarioName&&this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),this.logMessage(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${p}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return{...this._correlation}}}class p{constructor(e,t,a,i,n,r,o){this._scenarioProvider=e,this._asyncAuthCache=t,this._telemetryService=a,this._isMachineOnline=i,this._isMachineAwake=n,this._enableAuthTelemetryMachineStateCheck=r,this._authTelemetryMachineStateCheckOffsetMilliSeconds=o,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{const t=new d(this._scenarioProvider,e.correlation,this._asyncAuthCache,e.subContext,!0,e.isBatch??!1,e.timeoutMs,this._telemetryService,void 0,this._isMachineOnline,this._isMachineAwake,!!this._enableAuthTelemetryMachineStateCheck,this._authTelemetryMachineStateCheckOffsetMilliSeconds);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>_.l.getCorrelation(e)||[],this._createScenario=(e,t)=>{const{correlation:a,subContext:i,scenarioEventData:n,timeoutMs:r,scenario:o,isBatch:s}=e;let c=_.l.getAuthTelemetry(a.id);if(c)c.addEventData([`fn:${i}`]);else{const n=this._telemetryService?.getTelemetryServicesCache().get(e.scenarioEventData?.accountId);c=new d(n?.coreScenarioFactory||this._scenarioProvider,a,this._asyncAuthCache,i,t,s??!1,r,n?.telemetryService||this._telemetryService,o,this._isMachineOnline,this._isMachineAwake,!!this._enableAuthTelemetryMachineStateCheck,this._authTelemetryMachineStateCheckOffsetMilliSeconds),_.l.setAuthTelemetry(a.id,c)}return n&&c.appendScenarioEventData(n),_.l.setCorrelation(a),c}}}const u=(e,t)=>{_.l.setUserBiService(e||"GLOBAL",t)},m=e=>g({...e,startWithoutScenario:!1}),h=e=>{e.options.correlation={id:e.options.correlation?.id??(0,n.DA)(),scenarioName:e.options.correlation?.scenarioName??e.scenarioName,source:e.options.correlation?.source??e.source};const{options:{correlation:t},...a}=e;return g({correlation:t,...a})},g=e=>{const{correlation:t,subContext:a,scenarioEventData:i,eventData:n,timeoutMs:r,scenario:o,isBatch:s}=e,c=_.l.getAuthTelemetry(t.id),l=(e.startWithoutScenario||!t.scenarioName?v.createWithoutScenario:v.create)({correlation:t,subContext:a,scenarioEventData:i,timeoutMs:r,scenario:o,isBatch:s});n&&l.addEventData(n);return[l,(e,t,a)=>l.closeScenario(e,t,!!c,a)]},f=e=>v.getCorrelation(e);let v;const y=(e,t,a,n,r,o,s)=>{v||(v=new p(e,t,a,n,r,o,s),i.D.log("authTelemetryProvider initialized"))}},319226:(e,t,a)=>{"use strict";a.d(t,{SM:()=>_,G4:()=>c,Bz:()=>l,Fy:()=>d,xz:()=>p,$q:()=>f});var i=a(242030),n=a(712003);const r=1e3,o="batch_",s=e=>({typeName:"BatchScenario",user:e});function _(e){const t=e.getAllOfType("User");t?.forEach((t=>{try{const a={user:{tenantId:t.profile.tid,oid:t.profile.oid,accountType:t.type,userName:t.userName,id:t.id},typeName:"BatchScenario"};e.del(a)}catch(e){i.D.log("[deleteAllBatchDataFromStorage] - failed to delete batcScenario from storage")}}))}function c(e,t,a,i,n){u(e,t,`${o}${a}`,(e=>(e.successMetaData=g(i,e.successMetaData),e.successMetaData.batchScenarioCounter)),n)}function l(e,t,a,i,n){u(e,t,`${o}${a}`,(e=>(e.failureMetaData=g(i,e.failureMetaData),e.failureMetaData.batchScenarioCounter)),n)}function d(e,t,a,i,n){u(e,t,`${o}${a}`,(e=>(e.abandonedMetaData=g(i,e.abandonedMetaData),e.abandonedMetaData.batchScenarioCounter)),n)}const p=async(e,t,a)=>{const i=s(a),n=await t.getValue(i);if(n){for(const t in n)if(n[t]){m(e,t,n[t],a.id)}t.del(i)}};function u(e,t,a,n,o){if(!o)return void i.D.log("[updateBatchScenarioCount] Unable to get batch cache key: user is not defined");const _=s(o);t.getValue(_).then((s=>{const c=s?.[a]??{};n(c)>=r?(m(e,a,c,o.id),function(e,t,a,n){try{i.D.log(`[clearBatchScenarioFromCache] scenario: ${a}`),delete n?.[a],e.put(t,n)}catch(e){i.D.log(`[clearBatchScenarioFromCache] ${e?.message}`)}}(t,_,a,s)):function(e,t,a,n,r){try{return r?r[a]=n:r={[a]:n},e.put(t,r),!0}catch(e){return i.D.log(`[setBatchScenarioToAuthCache] ${e?.message}`),!1}}(t,_,a,c,s)}))}function m(e,t,a,i){a?.successMetaData&&h(e,t,a.successMetaData,"success",i),a?.failureMetaData&&h(e,t,a.failureMetaData,"failure",i),a?.abandonedMetaData&&h(e,t,a.abandonedMetaData,"abandoned",i)}function h(e,t,a,r,o){const s=e.newScenario(t),_=(0,n.DA)();i.D.log(`[sendBatchScenario] for ${t}, status: ${r}, correlationId:${_}`);const c={accountId:o,context:"auth-telemetry-helper",secondaryCorrelationId:_,batchScenarioData:a};switch(r){case"success":s.stop(c);break;case"failure":s.fail(c);break;default:s.cancel(c)}}function g(e,t){return t?(t.batchScenarioCounter++,t.batchEventData.push(e)):t={batchScenarioCounter:1,batchEventData:[e]},t}const f=(e,t)=>({id:t??(0,n.DA)(),source:e})},489955:(e,t,a)=>{"use strict";a.d(t,{$5:()=>o,r$:()=>s,pz:()=>_,BI:()=>c,$z:()=>l,Oi:()=>d});var i=a(638364),n=a(183111),r=a(712003);function o(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError,tag:e.tag,systemErrorCode:e.systemErrorCode})}const s=(e,t,a)=>{switch(e.code){case n.O4.NoNetwork:return _({name:"offlineEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"OfflineError",errorMetadata:void 0});case n.O4.SignInRestrictions:return _({name:"signInRestrictionEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"SignInRestriction",errorMetadata:a});case n.O4.RestartDevice:return _({name:"restartDeviceNeededEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"RestartDevice",errorMetadata:a})}return e};function _(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetadata:e.errorMetadata,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError,message:e.message,useTUIEndPage:e.useTUIEndPage})}function c(e){return(0,i.vF)().indexOf(e)>=0}function l(e){return e&&(e.isExpected||c(e.errorCode)||!!(t=e.message)&&(0,i.vF)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}function d(e,t,a,o=!0,s){let c,l,d="";const{name:p,email:u,pictureBlob:m,customError:h,shouldBypassEndPageLogout:g}=e;let f={accountId:a,name:p,email:u,pictureBlob:m,userLoggedIn:o};switch(t){case"LicenseError":c="licenseEndPage",l="show-license-error",d=n.O4.Forbidden;break;case"SignInRestriction":c="signInRestrictionEndPage",l="show-signin-restriction-error",d=n.O4.SignInRestrictions;break;case"MsaUserNotAllowed":c="msaUserNotAllowedEndPage",l="show-msa-user-not-allowed-error",d=i.tG.ShowTenantPicker,f={...f,preventLogout:g||!1};break;default:c="",l=""}return _({authSubErrorCode:t,errorCode:d,errorMetadata:f,name:c,message:h?.message||"",correlationId:h?.correlationId||(0,r.DA)(),context:h?.context||"endPageDataToAuthError",subContext:h?.subContext||l,useTUIEndPage:s})}},423636:(e,t,a)=>{"use strict";a.d(t,{t:()=>n});const i=new Map([["1f601_beamingfacewithsmilingeyes","😁"],["laugh","😆"],["sweatgrinning","😅"],["rofl","🤣"],["cwl","😂"],["smile","🙂"],["upsidedownface","🙃"],["meltingface","🫠"],["wink","😉"],["smileeyes","😊"],["angel","😇"],["inlove","🥰"],["hearteyes","😍"],["stareyes","🤩"],["1f618_facethrowingakiss","😘"],["kiss","😗"],["mmm","☺️"],["1f61a_kissingfacewithclosedeyes","😚"],["1f619_kissingfacewithsmilingeyes","😙"],["smilingfacewithtear","🥲"],["tongueout","😋"],["1f61b_facewithtongue","😛"],["winktongueout","😜"],["1f92a_zanyface","🤪"],["squintingfacewithtongue","😝"],["1f911_moneymouthface","🤑"],["1f917_huggingface","🤗"],["giggle","🤭"],["handovermouth","🫢"],["peekingeye","🫣"],["lipssealed","🤫"],["think","🤔"],["salute","🫡"],["1f910_zippermouthface","🤐"],["wonder","🤨"],["speechless","😐"],["expressionless","😑"],["blankface","😶"],["smirk","😏"],["unamused","😒"],["dull","🙄"],["1f62c_grimacingface","😬"],["faceexhaling","😮‍💨"],["1f925_lyingface","🤥"],["shaking","🫨"],["relieved","😌"],["pensive","😔"],["sleepy","😪"],["1f924_droolingface","🤤"],["sleepingface","😴"],["1f637_facewithmedicalmask","😷"],["ill","🤒"],["1f915_facewithheadbandage","🤕"],["1f922_nauseatedface","🤢"],["puke","🤮"],["1f927_sneezingface","🤧"],["1f975_hotface","🥵"],["shivering","🥶"],["hungover","🥱"],["1f635_dizzyface","😵"],["facewithspiraleyes","😵‍💫"],["1f92f_explodinghead","🤯"],["1f920_facewithcowboyhat","🤠"],["party","🥳"],["disguisedface","🥸"],["cool","😎"],["nerdy","🤓"],["1f9d0_facewithmonocle","🧐"],["confused","😕"],["diagonalmouth","🫤"],["worry","😧"],["sad","🙁"],["2639_frowningface","☹️"],["surprised","😮"],["1f62f_hushedface","😯"],["1f632_astonishedface","😲"],["blush","😊"],["1f97a_pleadingface","🥺"],["faceholdingbacktears","🥹"],["1f626_frowningfacewithopenmouth","😦"],["1f627_anguishedface","😧"],["fearful","😨"],["1f630_anxiousfacewithsweat","😰"],["1f625_sadbutrelievedface","😥"],["cry","😢"],["loudlycrying","😭"],["screamingfear","😱"],["veryconfused","😖"],["doh","😫"],["disappointed","😞"],["sweat","😓"],["weary","😩"],["1f62b_tiredface","😫"],["1f971_yawningface","🥱"],["1f624_facewithlookoftriumph","😤"],["angryface","😡"],["angry","😠"],["swear","🤬"],["devil","😈"],["1f47f_angryfacewithhorns","👿"],["skull","💀"],["2620_skullandcrossbones","☠️"],["poop","💩"],["1f921_clownface","🤡"],["1f479_japaneseogre","👹"],["1f47a_japanesegoblin","👺"],["ghost","👻"],["1f47d_extraterrestrialalien","👽"],["1f47e_alienmonster","👾"],["smilerobot","🤖"],["smilecat","😺"],["laughcat","😺"],["1f639_catwithtearsofjoy","😹"],["hearteyescat","😻"],["1f63c_catwithwrysmile","😼"],["1f63d_kissingcat","😽"],["1f640_wearycat","🙀"],["sadcat","😿"],["1f63e_poutingcat","😾"],["hearnoevil","🙉"],["seenoevil","🙈"],["speaknoevil","🙊"],["lips","💋"],["loveletter","💌"],["1f498_heartwitharrow","💘"],["1f49d_heartwithribbon","💝"],["sparklingheart","💖"],["growingheart","💗"],["1f493_beatingheart","💓"],["1f49e_revolvinghearts","💞"],["twohearts","💕"],["1f49f_heartdecoration","💟"],["2763_heartexclamation","❣️"],["brokenheart","💔"],["heartonfire","❤️‍🔥"],["mendingheart","❤️‍🩹"],["heart","❤️"],["heartpink","🩷"],["heartorange","🧡"],["heartyellow","💛"],["heartgreen","💚"],["heartblue","💙"],["heartlightblue","🩵"],["heartpurple","💜"],["heartbrown","🤎"],["heartblack","🖤"],["heartgrey","🩶"],["heartwhite","🤍"],["1f4af_hundredpointssymbol","💯"],["1f4a2_angersymbol","💢"],["1f4a5_collisionsymbol","💥"],["1f4ab_dizzysymbol","💫"],["1f4a6_splashingsweatsymbol","💦"],["1f4a8_dashsymbol","💨"],["1f573_hole","🕳️"],["bomb","💣"],["speechbubble","💬"],["eyeinspeechbubble","👁️‍🗨️"],["1f5e8_leftspeechbubble","🗨️"],["1f5ef_rightangerbubble","🗯️"],["1f4ad_thoughtballoon","💭"],["1f4a4_zzz","💤"],["coolcat","😎"],["cooldog","🐶"],["coolmonkey","😎"],["coolrobot","🤖"],["coolkoala","🐨"],["hearteyesdog","😍"],["hearteyesmonkey","😍"],["hearteyesrobot","😍"],["hearteyeskoala","😍"],["laughdog","😄"],["laughmonkey","😄"],["laughrobot","😄"],["laughkoala","😄"],["saddog","🙁"],["sadmonkey","🙁"],["sadrobot","🤖"],["sadkoala","🙁"],["dream","😌"],["headbang","😤"],["headphones","🎧"],["holidayspirit","🥳"],["idea","💡"],["movember","🧐"],["punch","🥊"],["rainbowsmile","🙂"],["wasntme","🙄"],["call","🤙"],["highfive","✋"],["hi","👋"],["like","👍"],["rock","🤘"],["sarcastic","👏"],["selfie","🤳"],["tmi","🤫"],["emo","😑"],["nod","🙂"],["shake","🙁"],["ttm","😒"],["wait","✋"],["whew","😅"],["facepalm","🤦"],["fingerscrossed","🤞"],["clap","👏"],["thewave1","🙌"],["oreoyum","(oreoyum)"],["1f44b_wavinghand","👋"]]),n=e=>i.get(e)},428479:(e,t,a)=>{"use strict";a.d(t,{ho:()=>o,XD:()=>c,F:()=>l,WG:()=>d,Vu:()=>u,aE:()=>m,Cv:()=>h,q3:()=>g,AS:()=>f,bD:()=>v,wF:()=>y,wS:()=>k,us:()=>A,_0:()=>T,Eu:()=>x});var i=a(323824);const n={landscape:400,portrait:200,square:250},r={landscape:225,portrait:355,square:250},o={width:1920,height:1080},s=1.7777778,_=.5625,c=6048e5,l="Video-Clip";var d;!function(e){e.success="success",e.failure="failure",e.pending="pending"}(d||(d={}));const p=new RegExp("^[0-9]+/[1-9][0-9]+$"),u=(e,t)=>`${e}/${t}`,m=e=>{if(e<=0)throw new Error("convertDurationSecToISO8601:Failed, input durationInSec should be greater than 0");const t=(0,i.H)(e).split(":"),a=3===t.length,n={hour:0,minute:1,second:2};a||(n.hour=-1,n.minute=0,n.second=1);const r=a?+t[n.hour]:0,o=+t[n.minute],s=+t[n.second];let _="PT";return r&&(_+=`${r}H`),o&&(_+=`${o}M`),s&&(_+=`${s}S`),_},h=e=>({progress:+e.split("/")[0],total:+e.split("/")[1]}),g=e=>p.test(e),f=(e,t)=>`${e}v1/objects/${t}/views/video`,v=e=>{const t={height:void 0,width:void 0};if(e.width&&e.height)t.width=+e.width,t.height=+e.height;else if(e.style){e.style.split(";").forEach((e=>{const[a,i]=e.split(":"),n=a?.trim();if("height"===n||"width"===n){const e=i&&parseInt(i.trim(),10);t[n]=e||void 0}}))}return t},y=(e,t,a)=>a?w():e&&t?e<t?S(e,t):e>t?E(e,t):C():b(),S=(e,t)=>{const a=n.portrait,i=r.portrait;return e/t<_?{width:e/t*i,height:i}:{width:a,height:t/e*a}},E=(e,t)=>{const a=n.landscape,i=r.landscape;return e/t<s?{width:e/t*i,height:i}:{width:a,height:t/e*a}},C=()=>({width:n.square,height:r.square}),b=()=>({width:n.landscape,height:r.landscape}),w=()=>({width:o.width,height:o.height}),k={volume:1,muted:!1,captionOn:!1},A="tmp.onePlayerSettings",T="OnePlayer-TextTrack-Settings",x='{"showTextTrack":true,"preferredLanguage":"spokenLanguage"}'},189183:(e,t,a)=>{"use strict";a.d(t,{M:()=>n});var i=a(506222);const n=(e,t,a=!1,n=!0,r=!1)=>{const o={emoticonAriaOpeningParenthesis:t.stringTranslate("funstuff","emoticon_aria_opening_parenthesis"),emoticonAriaClosingParenthesis:t.stringTranslate("funstuff","emoticon_aria_closing_parenthesis"),emoticonSkintoneDefault:t.stringTranslate("messaging","emoticon_skintone_default"),emoticonSkintoneLight:t.stringTranslate("messaging","emoticon_skintone_light"),emoticonSkintoneMediumLight:t.stringTranslate("messaging","emoticon_skintone_medium_light"),emoticonSkintoneMedium:t.stringTranslate("messaging","emoticon_skintone_medium"),emoticonSkintoneMediumDark:t.stringTranslate("messaging","emoticon_skintone_medium_dark"),emoticonSkintoneDark:t.stringTranslate("messaging","emoticon_skintone_dark"),emoticonCombinedSkintoneTitle:t.stringTranslate("funstuff","emoticon_combined_skintone_title",{skipInterpolation:!0}),emoticonNameWithSkintone:t.stringTranslate("funstuff","emoticon_name_with_skintone",{skipInterpolation:!0}),emoticonCombinedTitle:t.stringTranslate("funstuff","emoticon_combined_title",{skipInterpolation:!0})};return(0,i.M3)(e,o,a,n,r)}},566620:()=>{},20115:()=>{},653228:()=>{},259859:()=>{},903407:()=>{},586880:()=>{},348061:()=>{}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/569338-865386bb24f40d64.js.map