"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[589544],{319461:(e,t,n)=>{var a,i;n.d(t,{d:()=>a,J:()=>i}),function(e){e.HighMemoryUsage="HighMemoryUsage",e.CallingStackInitTimeoutOrFailure="CallingStackInitTimeoutOrFailure",e.GroupCallTimeoutOrFailure="GroupCallTimeoutOrFailure"}(a||(a={})),function(e){e.MeetingsAudio="1",e.MeetingsVideoOrScreenSharing="2",e.CallingCallDrops="3",e.MessagingOther="5",e.ActivityFeed="6",e.Crashing="7",e.Files="8",e.SearchSERPSearchResultsPage="9",e.SearchPowerbarAutosuggest="10",e.Other="11",e.MeetingsLiveCaptionsOrTranscript="14",e.TeamsChannelsMembership="15",e.Accessibility="17",e.Calendar="18",e.MeetingsOther="19",e.PlatformApps="20",e.PlatformBotsConnectors="21",e.PlatformTabs="22",e.TeamsChannelsCreateManageSettings="23",e.MessagingSync="25",e.PeopleProfiles="26",e.StatusPresence="27",e.TeamsChannelsPrivateAndSharedChannels="28",e.LocalizationTranslation="29",e.MeetingsAgendaNotes="30",e.MessagingCreateNewOrEdit="31",e.MessagingConversationWithExternalOrSkypeUsers="32",e.Tasks="34",e.Lists="35",e.Approvals="36",e.CallingOther="38",e.Performance="39",e.MessagingChatWindow="40",e.MessagingMissingOrDelayed="41",e.VivaLearning="42",e.MeetingsPowerPointLive="43",e.MeetingsChat="44",e.MeetingsRecording="45",e.MeetingsBreakoutRooms="46",e.MeetingsJoinExperience="47",e.MeetingsGalleryViews="48",e.CallingAudio="49",e.CallingVideoOrScreenSharing="50",e.VirtualAppointments="51",e.MeetingsSpeakerCoach="52",e.NotificationToasts="53",e.WebinarsVirtualEvents="54",e.MessagingVideo="55",e.MeetingsExcelLive="56",e.MeetingsWordLive="57",e.Avatars="58",e.ImmersiveSpace="59",e.MessagingLoopComponents="60",e.Discover="61",e.MeetingsMeetApp="62",e.Communities="63",e.Dashboard="64",e.Photos="65",e.Groups="66",e.InvitingJoiningTeams="67",e.Gaming="68",e.MessagingMessageCompose="70",e.MessagingMessagePaneScrolling="71",e.MessagingReactionsEmojisGIFsStickers="72",e.TeamsChannelsApp="73",e.UpdatesApp="74",e.MeetingsAttendanceReport="75",e.Devices="76",e.VideoFilters="77",e.AuthenticationOrSignIn="78",e.PerformanceMemory="79",e.DesktopAppLaunch="80",e.DesktopAppUpdate="81",e.TaskbarOrSystrayExperiences="82",e.Settings="83",e.AppSwitcherPreview="84",e.MeetingsRecap="86",e.FlyoutAndMinimode="87",e.MultiTenantMultiAccount="88",e.CallingCallNotifications="89",e.TagsChatMentions="90",e.TagsManagement="91",e.MeetingsCopilot="92",e.MessagingSMSIntegration="93",e.PlatformWorkflowsAndConnectors="94",e.MessagingThreading="121",e.QueuesApp="122",e.AIProjectAgent="140",e.Video="118",e.VideoFrozen="118_4"}(i||(i={}))},953307:(e,t,n)=>{var a,i;n.d(t,{x:()=>a,k:()=>i}),function(e){e.Default="Default",e.Regular="Regular"}(a||(a={})),function(e){e.ChannelListHeaderContextMenu="ChannelListHeaderContextMenu",e.TeamContextMenu="TeamContextMenu",e.ChannelContextMenuLeftRail="ChannelContextMenuLeftRail",e.ManageTeam="ManageTeam",e.ManageChannel="ManageChannel",e.ChannelHeader="ChannelHeader",e.TrinityLeftRail="TrinityLeftRail",e.OnboardTeam="OnboardTeam",e.TrinityChannelsTab="TrinityChannelsTab"}(i||(i={}))},254075:(e,t,n)=>{n.d(t,{Km:()=>a,tu:()=>i,Xg:()=>r,_A:()=>s});const a={Safari:11.1},i=11,r=11.1,s={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},419315:(e,t,n)=>{n.d(t,{hl:()=>s,OS:()=>o,oW:()=>l,bR:()=>d});var a=n(737035),i=n(254075),r=n(825429);function s(e=i._A){return!!e&&!!c().satisfies(e)}function o(){return!p("ie")}function l(){return!!c().satisfies({safari:`>=${i.Km.Safari}`})}function d(){return p("safari")&&void 0===c().getBrowserVersion()}function c(){return a.getParser((0,r.z)().navigator.userAgent)}function p(e){return c().isBrowser(e,!0)}},615381:(e,t,n)=>{n.d(t,{g:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query DataClientChatSmartReplyFileSuggestionQuery($convId:String!) {smartReplyFileSuggestion(convId:$convId) @client {fileName,url}}");return delete this.definitions,this.definitions=e.definitions}}},123356:(e,t,n)=>{n.d(t,{$6:()=>c,Ss:()=>p,rY:()=>u,l:()=>m,oC:()=>g,Sk:()=>h,E2:()=>v,qb:()=>f,iV:()=>E,zr:()=>I,Nh:()=>y,I0:()=>C,rt:()=>_,RI:()=>T,Vj:()=>S,Zk:()=>P,hI:()=>w,rz:()=>b,Q6:()=>D,FO:()=>R,e6:()=>k,pj:()=>N,jU:()=>L,gK:()=>O,O:()=>M,v6:()=>U,Y6:()=>B,n$:()=>V,ab:()=>F,PW:()=>G,OF:()=>$,tP:()=>H,NX:()=>W,Dt:()=>j,fK:()=>Y,UK:()=>z,gl:()=>K,xs:()=>J,yy:()=>Q});var a=n(401368),i=n(859460),r=n(800250),s=n(274785),o=n(975887),l=n(850640),d=n(776407);const c="acceptStreamPermissionsDebug",p={__typename:"PrejoinState",id:"",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,withByod:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{id:"",__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1,wasByodConnectedDeviceRoomSelected:!1,byodRoomSpeakerId:null,byodRoomMicrophoneId:null,byodRoomCameraId:null,byodRoomName:null,roomType:null,shouldSuggestRoomAudioForByod:!1,wasByodMoveToRoomAudioTriggered:!1,adhocMeetingSpace:null},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1,timestamp:1};function u(e){e.writeQuery({query:l.U,data:{shouldShowVideoApp:!1}})}const m={__typename:"ByodState",isToggleEnabled:!1,isPoppedOut:!1,byodScreenBounds:null,targetMonitorId:null,sourceMonitorId:null,displayModeBeforeByod:null},g={__typename:"DebugRttStatusEvent",realTimeTextStatus:"None"},h={__typename:"DebugRttEntryEvent",id:"id",text:"",isFinal:!1,userId:"1",userDisplayName:"RTT tester"},v=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogRendered:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,isRosterVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isTogetherModeAssignSeatsDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,interpretationDialogInfo:{isInterpretationDialogVisible:!1,interpretationJoinDialogEntryPoint:null},isMeetingLevelSpokenLanguageDialogVisible:!1,isUserLevelSpokenLanguageDialogVisible:!1,spokenLanguageDialogEntryPoint:null,isPinConfirmDialogVisible:!1}),f=e=>{const t=e.get(a.w.Calling).defaultLayoutSelection||"MixedGridView";return{__typename:"CallingScreenLayout",currentLayout:t,meetingRoomLayoutSelection:"ContentAndPeople",lastSelectedLayout:t,initialLayoutBeforeContentPopout:t,meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInMeetingRoom:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeWithContentActive:!1,shouldDisableAutoNarrowMode:!1,isMeetingRoomPrioritizeVideoActive:!1,isLayoutFlipped:!1,isContentPoppedOut:!1,shouldMeBeInOverlay:!1,isPresenterHostModeWithContent:!1,isGalleryInCentralSegment:!0,isMyselfInBarSegment:!1,isFrontRowUnifiedBackgroundActivated:!0,isPanoramicAudienceViewActivated:!1,isPrioritizeVideoViewUnsupported:!1,isColocatedViewActive:!1}},E=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),I=e=>({__typename:"VideoScanTypeResponse",videoScanType:"none",id:e}),A="microsoft_none",y={__typename:"BackgroundsInfo",imageId:A,imagePath:"",imageStatus:"",imageProvider:"default",imageName:"",imageSrc:""},C={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:A},_=e=>({__typename:"MyselfSettings",isMyselfHidden:!1,id:e}),T={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},S={__typename:"ClosedCaptionsLanguageInfoForMultilingual",id:"",shouldSpokenLanguageFallback:!1,shouldTranslatedLanguageFallback:!1,hasErrorBannerBeenDismissed:!1},P={__typename:"ImmersiveViewModeAppAvailabilityInfo",isAppAvailable:null,timestamp:null},w={__typename:"ImmersiveEventAppAvailabilityInfo",isAppAvailable:null,timestamp:null},b={__typename:"AudioVideoFrameworkInfo",id:"",isInFlyoutAvatarTab:!1,dismissedComponentIds:[]},D={__typename:"AiInterpretationInfo",id:"",isFirstExpOfAiInterpretation:!1},R={__typename:"MultiVbssCoachmarkState",state:!0},k={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},N={__typename:"ActiveVideoEffects",first:k,second:k,third:k},L={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},O={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:L,isShowingAppPageVideoEffect:k,isAppliedVideoEffect:k,isUnderApplyingProcessVideoEffect:k,allVideoApps:[]},M={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},U={__typename:"AvatarPayload",avatarItems:[]},B=(e,t)=>t.readQuery({query:r.W,variables:{id:e}})?.callParticipants||[],V=(e,t)=>t.readFragment({id:x(e),fragment:d.bs,fragmentName:"participantFields"})||null,F=(e,t,n)=>{const a=V(e,n);a&&n.writeFragment({id:x(e),fragment:d.bs,data:{...a,...t},fragmentName:"participantFields"})},x=e=>`Participant:{"participantId":"${e}"}`,G=(e,t)=>{e.writeQuery({query:s.t,data:{callingAlerts:t}})},$=e=>`No call found with id ${e}`,H=(e,t)=>{const n=e.coordinates;return{conversationId:(0,i.KX)(n)&&n.conversationId||null,isOneOnOne:"OneToOneCall"===e.type,isMeetup:"Meeting"===e.type,isBroadcast:(0,i.KX)(n)&&"LegacyMeetingCoordinates"===n.__typename&&!!n.broadcast,broadcastRole:(0,i.KX)(n)&&"LegacyMeetingCoordinates"===n.__typename?(0,i.KX)(n)&&n.broadcast?.role:null,withVideo:t&&t.outgoingVideo,withAudio:t&&t.outgoingAudio}},W=e=>({tenantId:"tenantId",organizerId:e??"31eedce6-db0e-44e3-9a76-56d1fa5f010a",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),j=()=>{return{__typename:"BreakoutRoom",coordinates:{__typename:"RoomCoordinates",...W(),additionalMessageId:"additionalMessage"},roomName:"Room 1",participants:[(e="9342492d-d51e-4317-bbf6-8341bf69f07a",{__typename:"BreakoutRoomParticipant",mri:e,role:null,objectId:null,upn:null})],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null};var e},q=(e,t)=>e?{...e,__typename:"VideoEffectInfo"}:t,Y=e=>({__typename:"ActiveVideoEffects",first:q(e.activeVideoEffects.first,k),second:q(e.activeVideoEffects.second,k),third:q(e.activeVideoEffects.third,k)}),z=(e,t)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:t&&t.allVideoApps&&t.allVideoApps.length>0&&t.allVideoApps.map((e=>({...e,__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:t.isInstallingVideoEffectInfo?{...t.isInstallingVideoEffectInfo,__typename:"InstallingVideoEffectInfo"}:e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:q(t.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:q(t.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:q(t.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),K=()=>"None",J=(e,t)=>{const n=t.filter((e=>"TM bot"!==e.displayName)).length+1,a=t.filter((e=>e.state===o.ParticipantState.InLobby)).length;return{__typename:"CallParticipantsCounts",teamsCallId:e,participantCounts:{__typename:"ParticipantCounts",id:"id",totalParticipants:n,totalConnectedTflParticipants:0,lobbyParticipants:a,totalPresenters:n-a,totalAttendees:0,requestingAttentionPresenters:0,requestingAttentionAttendees:0,overflowAttendees:0,streamingAttendees:0,hasParticipantsInLobby:a>0}}},Q=e=>JSON.stringify(e,((e,t)=>{if("object"!=typeof t||""===e)return t}))},800250:(e,t,n)=>{n.d(t,{W:()=>r});var a=n(650656),i=n(776407);const r={kind:"Document",get definitions(){const e=(0,a.G)("query callParticipants($id:ID!) {callParticipants(id:$id) {...participantFields}}");return delete this.definitions,this.definitions=[...e.definitions,...i.bs.definitions]}}},274785:(e,t,n)=>{n.d(t,{t:()=>r});var a=n(650656),i=n(658766);const r={kind:"Document",get definitions(){const e=(0,a.G)("query callingAlerts {callingAlerts {...callingAlert}}");return delete this.definitions,this.definitions=[...e.definitions,...i.l.definitions]}}},488371:(e,t,n)=>{n.d(t,{F:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery {shouldKeepPreviewWindowInSidePanelOpen @client}");return delete this.definitions,this.definitions=e.definitions}}},850640:(e,t,n)=>{n.d(t,{U:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query shouldShowVideoApp {shouldShowVideoApp @client}");return delete this.definitions,this.definitions=e.definitions}}},878948:(e,t,n)=>{n.d(t,{F:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query shouldShowVideoEffectsPreview {shouldShowVideoEffectsPreview @client}");return delete this.definitions,this.definitions=e.definitions}}},354463:(e,t,n)=>{n.d(t,{FL:()=>d,Lf:()=>p,xx:()=>u,UA:()=>m,dg:()=>g,K6:()=>h});var a=n(480354),i=n(425235),r=n.n(i),s=n(804437),o=n(850189),l=n(407104);const d="user-experience-preferences-key",c="user-experience-preferences-id",p="coach-settings-id",u="streaming-settings-id",m="audience-view-settings-id",g="stage-settings-id",h={Query:{allClientPreferences:(e,t,{clientPreferences:n})=>_(n.getAllPreferences()),clientPreferences:(e,{category:t},{clientPreferences:n})=>C(n.getPreferences(t),t),userExperiencePreferences(e,t,{localStorage:n}){const a=n.get(d,"UserAndExperience");return a?T(JSON.parse(a)):{id:c}}},Mutation:{updateClientPreferences:(e,{value:t},{clientPreferences:n})=>(n.updatePreferences(t),_(n.getAllPreferences())),updateUserExperiencePreferences(e,{value:t},{localStorage:n}){const i=y(n),r=(0,a.merge)({},i,{...t,tflMeetingChicletPrivacyNoticeSettings:{...t.tflMeetingChicletPrivacyNoticeSettings},prejoinSettings:{...t.prejoinSettings},coachSettings:{...t.coachSettings},streamingSettings:{...t.streamingSettings},chatInfoPaneSettings:{...t.chatInfoPaneSettings},channelInfoPaneSettings:{...t.channelInfoPaneSettings},audienceViewSettings:{...t.audienceViewSettings},newChatDraft:{...t.newChatDraft},mtmaAppBannerSettings:{...t.mtmaAppBannerSettings,dismissedApps:(0,a.union)(i.mtmaAppBannerSettings?.dismissedApps??[],t.mtmaAppBannerSettings?.dismissedApps??[])},stageSettings:{...t.stageSettings},tacoSettings:{...t.tacoSettings},tflOnboardingSettings:{...t.tflOnboardingSettings}}),o=n.trySet(d,(0,s.hR)(r),"Settings","UserAndExperience");return T(o?r:i)},clearUserExperiencePreferences(e,t,{localStorage:n}){try{return n.remove(d,"UserAndExperience"),!0}catch{return!1}},clearUserExperiencePreferencesByCategory(e,{category:t},{localStorage:n}){const a=y(n);return delete a[t],n.trySet(d,(0,s.hR)(a),"Settings","UserAndExperience")}},Subscription:{clientPreferencesChangedEvent:{async subscribe(e,{category:t},{clientPreferences:n}){let a;const i=new(r())((e=>{const i=n.getPreferenceObservable(t);return a=i.subscribe(e),()=>a?.unsubscribe()}));return(0,o.VQ)((0,l.V)(i,void 0,void 0,"clientPreferencesChangedEvent"),(e=>({clientPreferencesChangedEvent:C(e,t)})))}}},ClientPreferenceCategoryTypes:{__resolveType(e){switch(!0){case e.hasOwnProperty("mode"):return"PerformancePreferences";case e.hasOwnProperty("optimizedPerfPolicy"):return"OptimizedPerfPreferences";case e.hasOwnProperty("disableAnimations"):return"AnimationPreferences";case e.hasOwnProperty("badgeActionComplete")||e.hasOwnProperty("labelActionComplete")||e.hasOwnProperty("teamsInsiderLabelActionComplete")||e.hasOwnProperty("teamsInsiderBadgeActionComplete")||e.hasOwnProperty("desktopLabelActionComplete")||e.hasOwnProperty("desktopBadgeActionComplete"):return"PromoBadgePreferences";case e.hasOwnProperty("chatDensity"):return"DensityPreferences";case e.hasOwnProperty("messagePreviewsSetting"):return"MessagePreviewsPreferences";case e.hasOwnProperty("persistentPeopleAppColumns"):return"PeopleAppColumnsPreferences";case e.hasOwnProperty("peopleAppNavigation"):return"PeopleAppNavigationPreferences";case e.hasOwnProperty("simpleCollabViewType")||e.hasOwnProperty("hasUserEnabledShowTimeStamps")||e.hasOwnProperty("hasUserEnabledShowTimeStampsForSplitApp")||e.hasOwnProperty("hasUserEnabledMessagePreviews")||e.hasOwnProperty("hasUserEnabledMessagePreviewsForSplitApp")||e.hasOwnProperty("enableSinglePointReordering"):return"SimpleCollabPreferences";case e.hasOwnProperty("checkboxChecked")||e.hasOwnProperty("multipleTabsCheckboxChecked"):return"AppSwitcherPreferences";case E(e):return"ThemePreferences";case e.hasOwnProperty("lastUsedBackgroundEffect"):return"BackgroundEffectPreferences";case e.hasOwnProperty("isAppBarPinned"):return"ReflowPreferences";case e.hasOwnProperty("lastUsedBackgroundImage")||e.hasOwnProperty("lastUsedVideoFilter"):return"VideoEffectPreferences";case e.hasOwnProperty("unifiedViewFilter")||e.hasOwnProperty("chatsViewFilter")||e.hasOwnProperty("channelsViewFilter"):return"SimpleCollabStickyFilterPreferences";case f(e):return"AvatarPreferences";case e.hasOwnProperty("currentLayout"):return"TeamLayoutPreferences";case v(e):return"InfoPanePreferences";case e.hasOwnProperty("sidePaneOpenState"):return"SidePanePreferences";case e.hasOwnProperty("cameraState"):return"FlyoutCameraPreferences";case e.hasOwnProperty("shouldPersistLogsIntoIDB"):return"DiagnosticsLogsPreferences";case e.hasOwnProperty("shouldOpenContentInNewWindow"):return"WindowingPreferences";case e.hasOwnProperty("shouldShowStatusBarItem"):return"StatusBarItemPreferences";case e.hasOwnProperty("turnOffMediaOnDeviceLock"):return"LockScreenInCallPreferences";case e.hasOwnProperty("disableDefaultSpellcheck"):return"ComposeSpellcheckPreferences";case e.hasOwnProperty("dismissedStaticNowCards"):return"StaticNowCardsPreferences";case I(e):return"PromoBadgePreferences";case e.hasOwnProperty("allowOutOfTabNotifications"):return"OutOfTabNotificationPreferences";case e.hasOwnProperty("isSuperResolutionEnabled"):return"SuperResolutionPreferences";case A(e):return"EditorSdkPreferences";case e.hasOwnProperty("pushToRoomAudio"):return"ByodPreferences";case e.hasOwnProperty("enableLeaveConfirmationDialog"):return"MeetingPreferences"}return null}},UserExperiencePreferences:{stageSettings:e=>S(e.stageSettings,"stageSettings")}},v=e=>e.hasOwnProperty("chats")||e.hasOwnProperty("chatsInfoView")||e.hasOwnProperty("channels")||e.hasOwnProperty("chatContextualSearch")||e.hasOwnProperty("channelContextualSearch")||e.hasOwnProperty("channelL2ContextualSearch")||e.hasOwnProperty("chatHighlightsDetails")||e.hasOwnProperty("chatFluidThread")||e.hasOwnProperty("chatcopilotsynthesis")||e.hasOwnProperty("currentOpenChatInfoPaneDetails"),f=e=>e.hasOwnProperty("lastUsedAvatarFilter")||e.hasOwnProperty("hasUsedInMeeting"),E=e=>e.hasOwnProperty("userTheme")||e.hasOwnProperty("followOsTheme")||e.hasOwnProperty("isClassicTheme")||e.hasOwnProperty("isCallingWindowDarkTheme"),I=e=>e.hasOwnProperty("badgeActionComplete")||e.hasOwnProperty("labelActionComplete")||e.hasOwnProperty("teamsInsiderLabelActionComplete")||e.hasOwnProperty("teamsInsiderBadgeActionComplete")||e.hasOwnProperty("desktopLabelActionComplete")||e.hasOwnProperty("desktopBadgeActionComplete"),A=e=>e.hasOwnProperty("critiqueSettings")||e.hasOwnProperty("autoCorrectEnabledLanguages")||e.hasOwnProperty("codeBlockCurrentLanguage"),y=e=>{const t=e.get(d,"UserAndExperience");return t?JSON.parse(t):{}},C=(e,t)=>{let n="";switch(t){case"theme":n="theme-preferences-id";break;case"animation":n="animation-preferences-id";break;case"promo":n="promo-preferences-id";break;case"density":n="density-preferences-id";break;case"messagePreviews":n="message-previews-preferences-id";break;case"peopleAppColumns":n="people-app-columns-preferences-id";break;case"peopleAppNavigation":n="people-app-navigation-preferences-id";break;case"simpleCollab":n="simple-collab-preferences-id";break;case"flyoutCamera":n="flyoutpane-preferences-id";break;case"infoPane":n="infopane-preferences-id";break;case"sidePane":n="sidepane-preferences-id";break;case"performance":n="perf-preferences-id";break;case"optimizedPerf":n="optimized-perf-preferences-id";break;case"reflow":n="reflow-preferences-id";break;case"appSwitcher":n="app-switcher-preferences-id";break;case"videoEffect":n="videoeffect-preferences-id";break;case"simpleCollabStickyFilter":n="simple-collab-sticky-filter-id";break;case"backgroundEffect":n="background-effect-preferences-id";break;case"avatar":n="avatar-preferences-id";break;case"teamLayout":n="team-layout-id";break;case"diagnosticsLogs":n="diagnostics-logs-preferences-id";break;case"windowing":n="windowing-preferences-id";break;case"statusBarItem":n="status-bar-item-id";break;case"lockScreenInCall":n="lock-screen-in-call-preferences-id";break;case"composeSpellcheck":n="compose-spellcheck-preferences-id";break;case"staticNowCards":n="static-now-cards-preferences-id";break;case"outOfTabNotifications":n="out-of-tab-toasts-setting-id";break;case"superResolution":n="super-resolution-preferences-id";break;case"editorSdk":n="editor-sdk-preferences-id";break;case"byod":n="byod-push-to-room-audio-id";break;case"meeting":n="meeting-preferences-id"}return{id:n,...e}},_=e=>({id:"client-preferences-id",outOfTabNotifications:{...C(e.outOfTabNotifications,"outOfTabNotifications")},theme:{...C(e.theme,"theme")},animation:{...C(e.animation,"animation")},promo:{...C(e.promo,"promo")},density:{...C(e.density,"density")},messagePreviews:{...C(e.messagePreviews,"messagePreviews")},peopleAppColumns:{...C(e.peopleAppColumns,"peopleAppColumns")},peopleAppNavigation:{...C(e.peopleAppNavigation,"peopleAppNavigation")},simpleCollab:{...C(e.simpleCollab,"simpleCollab")},flyoutCamera:{...C(e.flyoutCamera,"flyoutCamera")},infoPane:{...C(e.infoPane,"infoPane")},sidePane:{...C(e.sidePane,"sidePane")},performance:{...C(e.performance,"performance")},optimizedPerf:{...C(e.optimizedPerf,"optimizedPerf")},reflow:{...C(e.reflow,"reflow")},appSwitcher:{...C(e.appSwitcher,"appSwitcher")},videoEffect:{...C(e.videoEffect,"videoEffect")},backgroundEffect:{...C(e.backgroundEffect,"backgroundEffect")},avatar:{...C(e.avatar,"avatar")},teamLayout:{...C(e.teamLayout,"teamLayout")},diagnosticsLogs:{...C(e.diagnosticsLogs,"diagnosticsLogs")},windowing:{...C(e.windowing,"windowing")},lockScreenInCall:{...C(e.lockScreenInCall,"lockScreenInCall")},composeSpellcheck:{...C(e.composeSpellcheck,"composeSpellcheck")},statusBarItem:{...C(e.statusBarItem,"statusBarItem")},simpleCollabStickyFilter:{...C(e.simpleCollabStickyFilter,"simpleCollabStickyFilter")},staticNowCards:{...C(e.staticNowCards,"staticNowCards")},superResolution:{...C(e.superResolution,"superResolution")},editorSdk:{...C(e.editorSdk,"editorSdk")},byod:{...C(e.byod,"byod")},meeting:{...C(e.meeting,"meeting")}}),T=e=>({id:c,tflMeetingChicletPrivacyNoticeSettings:S(e.tflMeetingChicletPrivacyNoticeSettings,"tflMeetingChicletPrivacyNoticeSettings"),prejoinSettings:S(e.prejoinSettings,"prejoinSettings"),coachSettings:S(e.coachSettings,"coachSettings"),streamingSettings:S(e.streamingSettings,"streamingSettings"),chatInfoPaneSettings:S(e.chatInfoPaneSettings,"chatInfoPaneSettings"),channelInfoPaneSettings:S(e.channelInfoPaneSettings,"channelInfoPaneSettings"),audienceViewSettings:S(e.audienceViewSettings,"audienceViewSettings"),newChatDraft:S(e.newChatDraft,"newChatDraft"),mtmaAppBannerSettings:S(e.mtmaAppBannerSettings,"mtmaAppBannerSettings"),stageSettings:e.stageSettings,tacoSettings:S(e.tacoSettings,"tacoSettings"),tflOnboardingSettings:S(e.tflOnboardingSettings,"tflOnboardingSettings")}),S=(e,t)=>{let n="";switch(t){case"tflMeetingChicletPrivacyNoticeSettings":n="tfl-meeting-chiclet-privacy-notice-settings-id";break;case"prejoinSettings":n="prejoin-settings";break;case"coachSettings":n=p;break;case"streamingSettings":n=u;break;case"chatInfoPaneSettings":n="chat-info-pane-settings-id";break;case"channelInfoPaneSettings":n="channel-info-pane-settings-id";break;case"audienceViewSettings":n=m;break;case"newChatDraft":n="new-chat-draft-id";break;case"mtmaAppBannerSettings":n="mtma-app-banner-settings-id";break;case"stageSettings":n=g;break;case"tacoSettings":n="taco-settings-id";break;case"tflOnboardingSettings":n="tfl-onboarding-settings-id"}return{...e,id:n}}},959756:(e,t,n)=>{n.d(t,{Nv:()=>a,mu:()=>i,y8:()=>r,fL:()=>s,k8:()=>o,AZ:()=>l});const a="BroadcastSchedulingEvents",i={closeViewBroadcastEvent:"closeViewBroadcastEvent",createBroadcastEvent:"createBroadcastEvent",editBroadcastEvent:"editBroadcastEvent",viewBroadcastEvent:"viewBroadcastEvent",cancelBroadcastEvent:"cancelBroadcastEvent",showBroadcastEventError:"showBroadcastEventError",discardBroadcastEvent:"discardBroadcastEvent",viewCalendarApp:"viewCalendarApp",policyChangeEvent:"policyChangeEvent"},r=e=>"object"==typeof e&&!!e&&"eventId"in e,s=e=>"object"==typeof e&&!!e&&"eventId"in e,o=e=>"object"==typeof e&&!!e&&"eventId"in e,l={closeViewBroadcastEvent:()=>({originator:a,type:i.closeViewBroadcastEvent}),createBroadcastEvent:()=>({originator:a,type:i.createBroadcastEvent}),editBroadcastEvent:e=>({originator:a,type:i.editBroadcastEvent,data:e}),viewBroadcastEvent:e=>({originator:a,type:i.viewBroadcastEvent,data:e}),cancelBroadcastEvent:e=>({originator:a,type:i.cancelBroadcastEvent,data:e}),showBroadcastEventError:()=>({originator:a,type:i.showBroadcastEventError}),discardBroadcastEvent:()=>({originator:a,type:i.discardBroadcastEvent}),viewCalendarApp:()=>({originator:a,type:i.viewCalendarApp}),policyChangeEvent:()=>({originator:a,type:i.policyChangeEvent})}},884468:(e,t,n)=>{var a;n.d(t,{V5:()=>a,Mi:()=>i,we:()=>r,E:()=>s,Wr:()=>o}),function(e){e.ChannelCard="ChannelCard",e.Channels="Channels",e.ManageTeams="ManageTeams"}(a||(a={}));const i={getLinkToChannel:"getLinkToChannel",viewChannelEmail:"viewChannelEmail",manageChannelMembers:"manageChannelMembers",manageTeamMembers:"manageTeamMembers",manageTeamChannels:"manageTeamChannels",leaveChannel:"leaveChannel",manageChannel:"manageChannel",channelAddMembers:"channelAddMembers",shareChannelWithUser:"shareChannelWithUser",shareChannelWithTeam:"shareChannelWithTeam",channelNotificationSettings:"channelNotificationSettings",toggleInfoPane:"toggleInfoPane",channelHeaderBackAction:"channelHeaderBackAction"},r={teamAddMember:"teamAddMember",teamAddChannel:"teamAddChannel",manageTags:"manageTags",leaveTeam:"leaveTeam",hideAllChannelsDialog:"hideAllChannelsDialog",getLinkToTeam:"getLinkToTeam",deleteTeam:"deleteTeam",manageTeam:"manageTeam",archiveTeam:"archiveTeam",toastMessageTeam:"toastMessageTeam"},s={getLinkToChannel:(e,t)=>({data:t,originator:e,type:i.getLinkToChannel}),viewChannelEmail:(e,t)=>({data:t,originator:e,type:i.viewChannelEmail}),manageChannelMembers:(e,t)=>({data:t,originator:e,type:i.manageChannelMembers}),manageTeamMembers:(e,t)=>({data:t,originator:e,type:i.manageTeamMembers}),manageTeamChannels:(e,t)=>({data:t,originator:e,type:i.manageTeamChannels}),leaveChannel:(e,t)=>({data:t,originator:e,type:i.leaveChannel}),manageChannel:(e,t)=>({data:t,originator:e,type:i.manageChannel}),channelAddMembers:(e,t)=>({data:t,originator:e,type:i.channelAddMembers}),shareChannelWithUser:(e,t)=>({data:t,originator:e,type:i.shareChannelWithUser}),shareChannelWithTeam:(e,t)=>({data:t,originator:e,type:i.shareChannelWithTeam}),channelNotificationSettings:(e,t)=>({data:t,originator:e,type:i.channelNotificationSettings}),toggleInfoPane:e=>({data:e,originator:a.Channels,type:i.toggleInfoPane}),channelHeaderBackAction:()=>({originator:a.Channels,type:i.channelHeaderBackAction})},o={teamAddMember:(e,t)=>({data:t,originator:e,type:r.teamAddMember}),teamAddChannel:(e,t)=>({data:t,originator:e,type:r.teamAddChannel}),manageTags:(e,t)=>({data:t,originator:e,type:r.manageTags}),leaveTeam:(e,t)=>({data:t,originator:e,type:r.leaveTeam}),hideAllChannelsDialog:(e,t)=>({data:t,originator:e,type:r.hideAllChannelsDialog}),getLinkToTeam:(e,t)=>({data:t,originator:e,type:r.getLinkToTeam}),deleteTeam:(e,t)=>({data:t,originator:e,type:r.deleteTeam}),archiveTeam:(e,t)=>({data:t,originator:e,type:r.archiveTeam}),toastMessageTeam:(e,t)=>({data:t,originator:e,type:r.toastMessageTeam}),manageTeam:(e,t)=>({data:t,originator:e,type:r.manageTeam})}},355186:(e,t,n)=>{n.d(t,{Nv:()=>a,AZ:()=>r,v0:()=>s});const a="Messaging",i="messageById",r={messageById:e=>({originator:a,type:i,data:()=>e})},s={isMessageByIdEvent:e=>e.type===i}},672964:(e,t,n)=>{n.d(t,{Pj:()=>a,X1:()=>i,$v:()=>r,Os:()=>s,Lm:()=>o,xD:()=>l,UV:()=>d,bH:()=>c,Pf:()=>p,iz:()=>u,EF:()=>m});const a="aria-label",i="card",r="itemid",s="data-itemprops",o="itemscope",l="animated-emoticon-50-",d=50,c=20,p="readonly",u="mention",m=/[\u200B]/},459073:(e,t,n)=>{n.d(t,{C:()=>h,j:()=>v});var a=n(971510),i=n(480354),r=n(401368),s=n(424794),o=n(396588),l=n(672964),d=n(324226),c=n(305755),p=n(988137),u=n(400510),m=n(5640),g=n(527353);const h="~~~~###@@TACOCAT@@###~~~~";let v=class{async transform(e,t){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer","services-io-browser-compose-serializer-extensions"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,i.unescape)(u.L.DomUtils.getAttributeValue(e,l.Os)),a=u.L.DomUtils.getAttributeValue(e,l.$v),[r]=u.L.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!r)return this._logger.error("The code snippet was missing"),null;if(!a)return this._logger.error("The id of the card was missing"),null;try{await this._uploadAndUpdateCard(a,JSON.parse(n),r,t);const e=(0,m.VZ)("span",{content:a,itemprop:"cardId"}),i=(0,m.VZ)("span",{class:"inline-compose-card",itemid:a,itemscope:"",itemtype:p.A.inputExtension});return u.L.DomUtils.appendChild(i,e),this._logger.debug("Uploaded code snippet",a),i}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}async _uploadCodeSnippet(e,t,n){const{source:a}=e,i=u.L.DomUtils.getInnerHTML(t),s=`${a}${h}${i}`,l=this._scenarioFactory?.newScenario(o.Cu.CodeSnippetUpload);try{const{objectId:e}=await this._uploadToAMS(s,n,this._logger);return l?.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),l?.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(r.w.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=await this._uploadToCache(s,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{l?.stop()}}async _uploadToAMS(e,t,n){n.log("Uploading to code snippet to ams");const{objectId:a}=await t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT",s.Y.CodeSnippetsSerializer,void 0,c.vV.Attached,!1,t.correlationId);return{objectId:a}}async _uploadToCache(e,t,n){try{n.log("uploading inline image to offline cache storage");const[a,i]=await t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${i} objectId: ${a}`),{objectId:a}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}async _uploadAndUpdateCard(e,t,n,a){const{amsReferenceId:i}=t,{name:r,language:s,wrap:o}=t,l=a.messageProperties.cards||[];let d={objectId:i,uploadType:"AMS"};if(i||(d=await this._uploadCodeSnippet(t,n,a)),"AMS"===d.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,d.objectId]}else if("OfflineCache"===d.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,d.objectId]}a.messageProperties.cards=[...l.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:g.b.CodeSnippet,content:JSON.stringify({type:g.b.CodeSnippet,editable:!0,id:e,name:r,language:s,wrap:o,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:d.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}};v=(0,a.__decorate)([(0,d.hY)({name:"CodeSnippets",filter:{[l.Lm]:"CodeSnippetCard"}})],v)},181561:(e,t,n)=>{n.d(t,{C:()=>g});var a=n(971510),i=n(480354),r=n(324226),s=n(988137),o=n(400510);const l=new RegExp(/animated-emoticon.*?/),d=/img|table/,c=e=>!!e&&o.L.DomUtils.getAttributeValue(e,"itemtype")===s.A.customEmoji,p=e=>!!e&&(o.L.DomUtils.getAttributeValue(e,"itemtype")===s.A.emoji||l.test(o.L.DomUtils.getAttributeValue(e,"class")||"")),u=(e,t)=>!t.containsPotentiallyIncludedWhitespace&&e<m&&e+1,m=3;let g=class{preTransform(e,t){const n=(0,i.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;(p(e)||c(e))&&(t.isSingleImageMessage=!1),(t.files?.length??0)>0||(t.cards?.length??0)>0?t.superSizeEmoticons=!1:"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:"img"===e.name?(c(e)||p(e)||(t.superSizeEmoticons=!1),(0,i.isNumber)(n)&&c(e)?t.superSizeEmoticons=u(n,t):(0,i.isUndefined)(t.superSizeEmoticons)&&(t.superSizeEmoticons=!1)):(0,i.isNumber)(n)&&p(e)?t.superSizeEmoticons=u(n,t):t.superSizeEmoticons=!(e=>e&&!p(e.parent)&&!c(e.parent)&&!(e.parent&&p(e.parent.parent))&&(d.test(e.name||"")||!(!e.data||!e.data.replace(" ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n}};g=(0,a.__decorate)([(0,r.dL)({name:"BigEmoticonPreprocessor",filter:"*"})],g)},527801:(e,t,n)=>{n.d(t,{TQ:()=>m,Td:()=>g,YG:()=>h});var a=n(971510),i=n(480354),r=n(401368),s=n(183111),o=n(396588),l=n(324226),d=n(677227),c=n(803060),p=n(313285),u=n(400510);const m="app-preview-card",g="app-preview-card-ps";let h=class{async transform(e,t){const n=t.coreSettings.get(r.w.Extensibility).postSendTimeoutInMs||2e3,{enableAppBasedLinkUnfurlingPostSend:a}=t.coreSettings.get(r.w.Extensibility),{areUrlPreviewsAllowed:i}=t.coreSettings.get(r.w.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||t.isForwardedMessage||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!u.L.DomUtils.hasAttrib(e,"href"))return;const s=t.loggerFactory.newLogger("UrlPreviewSerializer","services-io-browser-compose-serializer-extensions"),o=e.attribs.href||"",l=[this.getLinkUnfurlingPreviewFromAppTimed(o,n,t,s),this.getUrlPreviewTimed(o,n,t,s)],[d,p]=await Promise.all(l),m=d?.urlPreview??(p&&f(p));return m?(t.messageProperties.urlPreview=m,t.messageProperties.cards=d?.cards&&a?[...d.cards.map((e=>({...(0,c.h)({...e,cardClientId:`${g}${e?.cardClientId}`},"__typename")}))),...t.messageProperties.cards||[]]:t.messageProperties.cards,e):void 0}async getLinkUnfurlingPreviewFromAppTimed(e,t,n,a){const{enableAppBasedLink:i}=n.coreSettings.get(r.w.Extensibility),{enableGetRichLinkToTeamOrChannel:l}=n.coreSettings.get(r.w.TeamsAndChannels),{deepLinkDomains:c}=n.coreSettings.get(r.w.Messaging);if(!i)return Promise.resolve(void 0);const u={enableDomainLinks:l,currentDomainLinks:c};if((0,d.c)(e,u))return;const m=n.scenarioFactory.newScenario(o.Cu.ExtGetAppPreviewPostSend),g="post send app preview timed out";try{let a;return n.linkUnfurlingAppDetails&&(a=await(0,p.a)(n.appBasedLinkService.getLinkUnfurlingPreviewFromApp(e,n.linkUnfurlingAppDetails,m,n.i18n,n.convId),t,g)),m.stop(),a}catch(e){return v(e)&&e.code===s.O4.TimedOut&&e.context===s.Ir.Timed?m.incomplete({errors:g}):m.fail(),void a.warn(`fetching app preview for url failed with error: ${e}`)}}async getUrlPreviewTimed(e,t,n,a){const{enableGetRichLinkToTeamOrChannel:i}=n.coreSettings.get(r.w.TeamsAndChannels),{deepLinkDomains:s}=n.coreSettings.get(r.w.Messaging),o={enableDomainLinks:i,currentDomainLinks:s};if(!(0,d.c)(e,o))try{return await(0,p.a)(n.urlPreviewService.getPreview(e,n.correlationId),t,"url preview timed out")}catch(e){return void a.warn(`fetching url preview for url failed with error: ${e}`)}}};h=(0,a.__decorate)([(0,l.hY)({name:"URLPreviewSerializer",filter:"a",transient:!0})],h);const v=e=>!!(e&&((0,i.get)(e,"code")&&(0,i.get)(e,"context")||(0,i.get)(e,"reason"))),f=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta})},677227:(e,t,n)=>{n.d(t,{C:()=>T,c:()=>y});var a=n(480354),i=n(845097),r=n(2979);var s=n(663823),o=n(259521),l=n(912435),d=n(183111),c=n(420384),p=n(388771),u=n(579659),m=n(582950),g=n(214568),h=n(438e3),v=n(401368),f=n(396588),E=n(159097);const I=["teams","/l/message/","chat"],A=["teams","/l/meetingrecap","threadId"],y=(e,t)=>{if(t?.enableDomainLinks){const n=t.currentDomainLinks;return!!n&&n.some((t=>C(e,t)))}return I.every((t=>e.includes(t)))||A.every((t=>e.includes(t)))||e.startsWith("mailto")||_(e)},C=(e,t)=>{try{const n=new URL(e),a=new URL(t),i=n.hostname===a.hostname&&n.pathname&&(n.pathname.includes("/l/message")||n.pathname.includes("/l/channel")||n.pathname.includes("/l/chat")),r=n.hostname===a.hostname&&n.pathname&&n.pathname.includes("/l/meetingrecap");return i||r}catch(e){return!0}},_=e=>{try{if(!e.startsWith(m.kN))return!1;const t=e.split("nav=");if(t.length<2)return!1;const n=t[t.length-1];return decodeURIComponent(atob(n)).includes(m.ZP)}catch(e){return!1}};class T{constructor(e,t,n,a,i){this.botsPlatformService=t,this.scenarioFactory=n,this.queryLinkRequestsInProgress={},this.logTelemetryForACv2CardInResponse=(e,t,n,a)=>{if(!e)return;const i=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:g.Od.auto,actionOutcome:n,actionScenario:a,actionScenarioType:g.DB.sendMsgs,moduleName:g.Sn.linkUnfurl,moduleType:g.nR.link,panelRegion:g.rP.main,panelType:g.HP.AppBasedLink,extensibilityData:i})},this.logTelemetryForLinkUnfurlingCardViewPostSend=(e,t)=>{if(!e)return;const n=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:g.Od.auto,actionOutcome:g.nd.appBasedLinkUnfurlingCardPreviewPostSend,actionScenario:this.getPreviewActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1),actionScenarioType:g.DB.sendMsgs,moduleName:g.Sn.linkUnfurl,moduleType:g.nR.link,panelRegion:g.rP.main,panelType:g.HP.AppBasedLink,extensibilityData:n})},this.logTelemetryForLinkUnfurlingInvokePostSend=(e,t,n=!0)=>{if(!e)return;const a=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:g.Od.asyncStateChange,actionOutcome:g.nd.invoke,actionScenario:this.getInvokeActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1,n),actionScenarioType:g.DB.sendMsgs,moduleName:g.Sn.linkUnfurl,moduleType:g.nR.link,panelRegion:g.rP.main,panelType:g.HP.AppBasedLink,extensibilityData:a})},this.getExtensibilityData=(e,t)=>({id:e?.appId||"",botId:e?.botId||"",scenarioCapability:h.n3.messaging,name:e?.appName||"",threadId:t||"",externalId:e?.externalId||"",installationState:e.installationState}),this.getInvokeActionScenarioName=(e,t)=>e&&t?g.vB.linkUnfurlingAnonymousInvokePostSend:e&&!t?g.vB.linkUnfurlingAnonymousInvokePostSendNoResult:!e&&t?g.vB.linkUnfurlingInvokePostSend:g.vB.linkUnfurlingInvokePostSendNoResult,this.getPreviewActionScenarioName=e=>e?g.vB.linkUnfurlingPostSendAnonymousCardPreview:g.vB.linkUnfurlingPostSendCardPreview,this.enableAppBasedLinkSsoAuth=e.get(v.w.Extensibility).enableAppBasedLinkSsoAuth,this.tokenPrefetchBots=e.get(v.w.Extensibility).tokenPrefetchBots,this.ssoForBotsDefaultWebResourceEnabledBotIds=e.get(v.w.Extensibility).ssoForBotsDefaultWebResourceEnabledBotIds,this.enableAnonymousAppBasedLink=e.get(v.w.Extensibility).enableAnonymousAppBasedLink,this.enableACv2LinkUnfurlingPostSendv1=e.get(v.w.Extensibility).enableACv2LinkUnfurlingPostSendv1,this.enableACv2LinkUnfurlingPostSendv2=e.get(v.w.Extensibility).enableACv2LinkUnfurlingPostSendv2,this.anonymousAppBasedLinkApps=e.get(v.w.Extensibility).anonymousAppBasedLinkApps,this.enablePreAuthCard=e.get(v.w.Extensibility).enablePreAuthCard,this.logger=a.newLogger("AppBasedLinkService","services-io-app-based-link"),this.enableGetRichLinkToTeamOrChannel=e.get(v.w.TeamsAndChannels).enableGetRichLinkToTeamOrChannel,this.deepLinkDomains=e.get(v.w.Messaging).deepLinkDomains,this.userBiService=i}async getLinkUnfurlingPreviewFromApp(e,t,n,a,i){const r={enableDomainLinks:this.enableGetRichLinkToTeamOrChannel,currentDomainLinks:this.deepLinkDomains};if(m.$Q===i||y(e,r))return void this.logger.log(`${m.Bt} getLinkUnfurlingPreviewFromApp: url is a chat url and no link preview is needed for url`);let s,o,l;try{s=this.toAppDefinition(t),s&&(o=(0,c.jN)(s?.definition))}catch{return this.logger.error("Ran into an error trying to create the linkUnfurlingAppDetails object"),void n.incomplete({errors:"Could not fetch app details for link unfurling app"})}if(o){"NotInstalled"===t?.installationState&&(0,c.rv)(o,this.enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps)?(this.logTelemetryForLinkUnfurlingInvokePostSend(t,i),n.mark(f.BQ.ExtAppBasedLinkUnfurlingPostSendAnonymousInvoke),l=await this.getAnonymousAppPreview(e,o,i),this.logger.log(`${m.Bt} Fetching anonymous app preview for url`)):"Installed"===t?.installationState&&(this.logTelemetryForLinkUnfurlingInvokePostSend(t,i),n.mark(f.BQ.ExtAppBasedLinkUnfurlingPostSendInvoke),l=await this.getAppPreview(e,o,i),this.logger.log(`${m.Bt} Fetching app preview for url`))}if("HasResult"===l?.type&&l.messageExtensionItem){const{card:n,previewCard:r}=l.messageExtensionItem,s=this.processResponseCard(n,t,i,a,this.enableACv2LinkUnfurlingPostSendv1||!1,this.enableACv2LinkUnfurlingPostSendv2||!1);return s&&this.logTelemetryForLinkUnfurlingCardViewPostSend(t,i),{cards:s,urlPreview:(0,u.w)(e,r)}}this.logger.log("LinkUnfurling: No app preview found for url (async)")}async getAnonymousAppPreview(e,t,n){try{const a=this.getQueryLinkVariables(e,t,n);if(!a)throw(0,l.$5)("AppBasedLinkService",d.O4.InvalidInput,"getAnonymousAppPreview",void 0,this.getErrorMessage("Invalid message extension passed to invoke",t));this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(a,t,f.Cu.ExtGetAnonymousAppPreview,void 0,"composeExtension/anonymousQueryLink"));const i=await this.queryLinkRequestsInProgress[e];return delete this.queryLinkRequestsInProgress[e],!i||this.isEmptyResult(i)?null:this.matchedAnonymousResult(e,t,i)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}async getAppPreview(e,t,n,a,i){if(!t)return null;try{const r=await this.tryPrefetchingToken(t,i,this.logger),s={},o=i??r,l=!!o,d=await this.getMessageExtensionResult(e,t,n,a,o,s);return delete this.queryLinkRequestsInProgress[e],!d||this.isEmptyResult(d)?null:this.matchedResult(e,t,d,l,n,a,s)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}async matchedAnonymousResult(e,t,n){switch(n.type){case"result":return this.logger.log(`${m.Bt} Initiating result type response for url`),this.handleResultResponse(e,n,t);case"auth":return this.logger.log(`${m.Bt} Initiating anonymous auth for url`),this.handleAnonymousAuthConfigResponse(e,n,t);default:return this.logger.error(this.getErrorMessage(`${m.Bt} Invalid value ${n.type} for field 'type' in invoke response`,t)),null}}async matchedResult(e,t,n,a,i,r,s){switch(n.type){case"result":return this.logger.log(`${m.Bt} Initiating result type response for url`),this.handleResultResponse(e,n,t);case"auth":case"config":return"config"===n.type?this.logger.log(`${m.Bt} Initiating config type response for url`):this.logger.log(`${m.Bt} Initiating auth type response for url`),this.handleAuthConfigResponse(e,n,t);case"silentAuth":if(a)return this.logger.error(this.getErrorMessage(`${m.Bt} Result type ${n.type} not allowed for duplicate request`,t)),null;if(this.enableAppBasedLinkSsoAuth){if(s?.consentOverride)return this.handleSsoAuthResponse({isFailure:!1,isConsentRequired:!0,token:void 0},n,e,t,i,r);const a=await this.tryGetAuthToken(t);return this.handleSsoAuthResponse(a,n,e,t,i,r)}default:return this.logger.error(this.getErrorMessage(`Invalid value ${n.type} for field 'type' in invoke response`,t)),null}}isEmptyResult(e){const t=Object.keys(e);return 1===t.length&&"__typename"===t[0]}processResponseCard(e,t,n,a,s,o){if(!(e=>{let t=!1;return(0,E.KQ)(JSON.parse(e),{type:"Action.Execute"},(()=>{t=!0})),t})(e.content))return[e];if(t.isAppInstalledToConversation&&s)return this.logTelemetryForACv2CardInResponse(t,n,g.nd.AsyncUnfurlACv2CardInAsyncLUResponseShown,g.vB.LinkUnfurlingPostSendCardPreviewACv2CardInResponseShown),[e];if(!t.isAppInstalledToConversation&&o){this.logTelemetryForACv2CardInResponse(t,n,g.nd.AsyncUnfurlACv2InstallerCardPreview,g.vB.LinkUnfurlingPostSendCardPreviewACv2InstallerCardPreview);const s=((e,t,n)=>{if(!n)return;const a=e.appName||n.stringTranslate("extensibility","app_based_link_install_to_conversation_title_placeholder"),s=e.appId||"",o=e.privacyUrl||"",l=e.termsOfUseUrl||"",d=`https://teams.microsoft.com/l/app/${encodeURIComponent(s)}`,c={appId:s,appName:e.appName||"",privacyUrl:e.privacyUrl||"",termsOfUseUrl:e.termsOfUseUrl||"",largeImageUrl:e.appIcon||""},p=n.stringTranslate("extensibility","app_based_link_install_to_conversation_title",{appName:a}),u=n.stringTranslate("extensibility","app_based_link_install_to_conversation_consent_string",{privacyUrl:o,termsOfUseUrl:l,permissionsUrl:d}),m=n.stringTranslate("extensibility","app_based_link_install_to_conversation_add_button_text"),g={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.5",body:[{type:"ColumnSet",spacing:"Medium",columns:[{type:"Column",width:"auto",items:[{type:"Image",url:e.appIcon,size:"Small",style:"Person"}],verticalContentAlignment:"Center"},{type:"Column",width:"stretch",items:[{type:"TextBlock",text:p,wrap:!0,weight:"Bolder"},{type:"TextBlock",text:u,wrap:!0,spacing:"Small",isSubtle:!0}]},{type:"Column",width:"auto",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:m,style:"positive",data:{msteams:{type:"appInstallToConversation/addAppToConversation",appInstallToConversationCardExtended:{appDefinition:c,conversationId:t||"",teamId:e.teamId||""}}}}]}],verticalContentAlignment:"Center"}]}]};return{contentType:r.s.Adaptive,content:JSON.stringify(g),appId:e.appId,appName:e.appName,appIcon:e.appIcon,sourceType:r.c.APP_INSTALL_TO_CONVERSATION,cardClientId:(0,i.v4)()}})(t,n,a);return s?[s,e]:void 0}this.logTelemetryForACv2CardInResponse(t,n,g.nd.AsyncUnfurlACv2CardInAsyncLUResponseDropped,g.vB.LinkUnfurlingPostSendCardPreviewACv2CardInResponseDropped)}async handleSsoAuthResponse(e,t,n,a,i,r){const{isFailure:s,isConsentRequired:o,token:l}=e;if(s)return null;if(l&&!o){return await this.getAppPreview(n,a,i,r,{token:l})}return this.handleAuthConfigResponse(n,t,a)}toAppDefinition(e){return e&&e.appId?{installationState:e.installationState,id:e.appId||"",definition:{id:e.appId,name:e.appName||"",messageExtensions:[{type:"BotBased",botId:e.botId||"",fetchCommands:!1,commands:[],canUpdateConfiguration:!0,messageHandlers:[{type:"link",value:{domains:[],supportsAnonymousAccess:e.supportsAnonymousAccess||!1}}],scopes:[]}],largeImageUrl:e.appIcon||"",externalId:e.externalId||"",tenantId:e.tenantId||"",validDomains:e.validDomains||[]}}:null}getWebApplicationInfo(e){const t=e.messageExtensions&&e.messageExtensions[0].botId;return t&&this.ssoForBotsDefaultWebResourceEnabledBotIds&&this.ssoForBotsDefaultWebResourceEnabledBotIds?.indexOf(t)>=0?{botId:t,resource:`api://botid-${t}`}:{botId:t,resource:e.resource}}async tryPrefetchingToken(e,t,n){const{botId:a,resource:i}=this.getWebApplicationInfo(e);if(t||!this.enableAppBasedLinkSsoAuth||!a||!i||!this.tokenPrefetchBots||-1===this.tokenPrefetchBots.indexOf(a))return null;const r=this.scenarioFactory.newScenario(f.Cu.AppBasedLinkAadAuth);r.appendEventData({"Bot.Id":a,context:"tokenPrefetch"});try{const e=await this.botsPlatformService.getAuthTokenForBot(a,i,!0,n);return r.stop(),{token:e}}catch(e){r.incomplete({errors:"tryPrefetchingToken: Token failed to acquire"})}return null}async tryGetAuthToken(e){const{botId:t,resource:n}=this.getWebApplicationInfo(e);if(!t||!n)return{isFailure:!0,isConsentRequired:!1,token:void 0};const a=this.scenarioFactory.newScenario(f.Cu.AppBasedLinkAadAuth);a.appendEventData({"Bot.Id":t,context:"silent:true"});try{const e=await this.botsPlatformService.getAuthTokenForBot(t,n,!0,this.logger);return a.stop(),{isFailure:!1,isConsentRequired:!1,token:e}}catch(e){return e.code===d.O4.UserConsentRequired?(a.incomplete(),{isFailure:!1,isConsentRequired:!0,token:void 0}):e.code===d.O4.InvalidInput?(a.stop(),{isFailure:!0,isConsentRequired:!1,token:void 0}):(a.fail({errorCode:e.code}),{isFailure:!0,isConsentRequired:!1,token:void 0})}}async getMessageExtensionResult(e,t,n,a,i,r){const s=this.getQueryLinkVariables(e,t,n,a,i);return s?(this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(s,t,f.Cu.GetAppPreviewResult,r)),this.queryLinkRequestsInProgress[e]):(this.logger.error(this.getErrorMessage("Invalid message extension passed to invoke",t)),Promise.resolve(null))}queryLink(e,t,n,r,o){const l=(0,i.v4)(),d=this.scenarioFactory.newScenario(n);return d.appendEventData({"Bot.Id":e.botInvokeParams.botMri,"App.Id":t.id,"Thread.Id":e.botInvokeParams.threadId??"",appType:(0,a.isEmpty)(t.externalId)?"GlobalApp":(0,a.isEmpty)(t.tenantId)?"CustomApp":"TenantApp",correlationId:l}),this.botsPlatformService.executeBotInvoke(e.botInvokeParams,e.invokeValue,s.gp,this.logger,l,o||"composeExtension/queryLink",void 0,void 0,d).then((e=>(d.stop(),e))).catch((t=>{if(this.logger.warn(`Invoke failed with error: ${t} and args: ${JSON.stringify(e)}`),this.handleInvokeFailure(d,t,r),r?.consentOverride)return{type:"silentAuth"};throw t}))}handleInvokeFailure(e,t,n){if(t)if((e=>!!e&&!!(0,a.get)(e,"code")&&!!(0,a.get)(e,"message"))(t))switch(t.code){case d.O4.BotError:case d.O4.BotDisabledByAdmin:case d.O4.Forbidden:case d.O4.InvalidRequestFormat:e.cancel({errorCode:t.code,errors:JSON.stringify([t.message])});break;case d.O4.UserConsentRequired:e.incomplete({errorCode:t.code,errors:JSON.stringify([t.message])}),n&&(n.consentOverride=!0);break;default:e.fail({errorCode:t.code,errors:JSON.stringify([t.message])})}else e.fail({errorCode:d.O4.Unknown});else e.fail({errorCode:d.O4.Empty,errors:"Error message is empty"})}handleResultResponse(e,t,n){const r=(0,a.first)(t.items),s=r?.card,{defaultPreviewType:o,cachePolicyType:l}=this.processSuggestedActions(t.suggestedActions);if(s){const t=(0,i.v4)().replace(new RegExp("-","g"),""),d=(0,a.cloneDeep)(s),c=r?.previewCard||this.isSupportedPreviewCardType(d)&&d;return c?{__typename:"AppPreviewResult",id:e,type:"HasResult",messageExtensionItem:{__typename:"MessageExtensionItem",previewCard:c,card:{__typename:"Card",contentType:s.contentType,content:s.content,cardClientId:t,appId:n.id,appName:n.name,appIcon:n.largeImageUrl}},...o&&{defaultPreviewType:o},...l&&{cachePolicyType:l}}:(this.logger.error(this.getErrorMessage(`Could not use card with content type: ${s.contentType} as a preview card`,n)),null)}return null}handleAnonymousAuthConfigResponse(e,t,n){let a;return this.enablePreAuthCard&&t.items?.length&&(a=t.items[0]?.card),t.suggestedActions?.actions&&this.logger.warn("Suggested actions are not supported for anonymous query link invoke!"),{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,card:a,isAnonymous:!0}}}handleAuthConfigResponse(e,t,n){const i=t.suggestedActions?.actions?.[0];let r;if(this.enablePreAuthCard&&t.items?.length&&(r=t.items[0]?.card),i&&n.validDomains&&(0,p.F6)(i.value,(0,a.compact)(n.validDomains)))return{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,card:r,openUrlResult:{__typename:"AppBasedLinkOpenUrlResult",title:i.title,url:i.value,isAuth:"auth"===t.type||"silentAuth"===t.type}}};const{resource:s}=this.getWebApplicationInfo(n);return"silentAuth"===t.type&&!i&&s?{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,aadAuthResult:{__typename:"AppBasedLinkAadAuthResult",resource:s}}}:(this.logger.error(this.getErrorMessage("Invalid auth/config result from bot",n)),null)}isSupportedPreviewCardType(e){const t=e.contentType.toLowerCase();return"application/vnd.microsoft.card.hero"===t||"application/vnd.microsoft.card.thumbnail"===t}getQueryLinkVariables(e,t,n,a,i){const r=t.messageExtensions?.[0];if(r){return{botInvokeParams:{appId:t.id,threadId:n??"",botMri:`${o.gN.BotPrefix}${r.botId??""}`},invokeValue:JSON.stringify({url:e,...a&&{state:a},...i&&{authentication:i}})}}}getErrorMessage(e,t){return`${e} for app id: ${t.id}`}processSuggestedActions(e){let t,n;return e?(e.actions?.forEach((e=>{switch(e.type){case"setDefaultUrlPreviewType":t=this.getPreviewType(e.value),t||this.logger.error(`Invalid invoke response: invalid setDefaultUrlPreviewType ${e.value}`);break;case"setCachePolicy":try{const t=JSON.parse(e.value);n=this.getCachePolicy(t.type)}catch(t){this.logger.error(`Invalid invoke response: setCachePolicy requires stringified JSON payload, but got ${e.value}`);break}n||this.logger.error("Invalid invoke response: invalid cache policy type");break;default:this.logger.error(`Invalid invoke response: unsupported suggestedAction type: ${e.type}`)}})),{defaultPreviewType:t,cachePolicyType:n}):{defaultPreviewType:t,cachePolicyType:n}}getPreviewType(e){switch(e){case"Thumbnail":return"Thumbnail";case"Card":return"Card";default:return}}getCachePolicy(e){if("no-cache"===e)return"NoCache"}}},582950:(e,t,n)=>{n.d(t,{$Q:()=>a,Bt:()=>i,kN:()=>r,ZP:()=>s});const a="48:notes",i="LinkUnfurlingService:",r="https://1drv.ms/",s="loop-page-container"},995574:(e,t,n)=>{n.d(t,{wy:()=>a,sm:()=>i,Bc:()=>r,Ue:()=>s,rR:()=>p,Mn:()=>m,w1:()=>g,dY:()=>h,zo:()=>v,kF:()=>f,f9:()=>C});var a,i,r,s,o=n(912435),l=n(183111);!function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidMessageResponse=3]="InvalidMessageResponse",e[e.BothCardAndUrl=4]="BothCardAndUrl",e[e.MissingCardAndUrl=5]="MissingCardAndUrl",e[e.InvalidAdaptiveCard=6]="InvalidAdaptiveCard",e[e.InvalidUrl=7]="InvalidUrl"}(a||(a={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(i||(i={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(r||(r={})),function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidAdaptiveCards=3]="InvalidAdaptiveCards",e[e.InvalidSubmitTaskResponse=4]="InvalidSubmitTaskResponse"}(s||(s={}));const d="BotsPlatformResolvers",c="retry-after",p=async e=>{const t=await E(e),n=I(t.errorCode),a=A(t);return n?(0,o.$5)(d,l.O4.BotError,"executeBotInvoke",void 0,a,void 0):u(e,a)},u=(e,t)=>412===e.status?(0,o.$5)(d,l.O4.UserConsentRequired,"executeBotInvoke",void 0,t,void 0):429===e.status?(0,o.$5)(d,l.O4.Throttled,"executeBotInvoke",void 0,t,{status:e.status,headers:{[c]:e.headers[c]},body:{},url:""}):403===e.status&&t.toLowerCase().includes("BotDisabledByAdmin".toLowerCase())?(0,o.$5)(d,l.O4.Forbidden,"executeBotInvoke",void 0,t,void 0):400===e.status?(0,o.$5)(d,l.O4.InvalidRequestFormat,"executeBotInvoke",void 0,t,void 0):(0,o.$5)(d,l.O4.RemoteOperationFailed,"executeBotInvoke",void 0,t,void 0),m=e=>{const t=e&&a[e]||void 0;return(0,o.$5)(d,l.O4.InvalidResponse,"executeTaskModuleInvoke",void 0,t,void 0)},g=e=>{const t=e&&s[e]||void 0;return(0,o.$5)(d,l.O4.InvalidResponse,"executeAdaptiveCardTabInvoke",void 0,t,void 0)},h=()=>(0,o.$5)(d,l.O4.Unauthorized,"getCurrentUserName",void 0,void 0,void 0),v=e=>{const t=e&&r[e]||void 0;return(0,o.$5)(d,l.O4.InvalidResponse,"executeMessageExtensionInvoke",void 0,t,void 0)},f=e=>{const t=e&&i[e]||void 0;return(0,o.$5)(d,l.O4.InvalidResponse,"executeBotConfigInvoke",void 0,t,void 0)},E=async e=>{const t=await e.body.text();return t&&t.length>0?JSON.parse(t):{}},I=e=>null!=e&&(1008===e||209===e),A=e=>`Error code: ${e.errorCode} message: ${y(e.message)}`,y=e=>{const t=e&&e.match(/<[^>]*>/g);return t&&t.length>0?t[0]:""},C=(e,t)=>{const n="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",t);return new RegExp(n,"i").test(e)}},594323:(e,t,n)=>{n.d(t,{l:()=>s,Z:()=>g});var a=n(988137),i=n(159097),r=n(396588);const s=(e,t)=>{const n=(0,i.a9)(e),a=e.body;a&&n&&o(a,n,t)},o=(e,t,n)=>{const a=n?.newScenario(r.Cu.ExtCardMentionsInvoke),i={hasMentions:!1};e.forEach((e=>l(e,t,i))),a&&(i.hasMentions?a.mark(r.BQ.ExtCardMentionsInvokeComplete):a.mark(r.BQ.ExtCardMentionsInvokeMissing),a.stop())},l=(e,t,n)=>{(0,i.KQ)(e,{type:"TextBlock"},(e=>{d(t,n)(e)})),(0,i.KQ)(e,{type:"FactSet"},(e=>{c(t,n)(e)}))},d=(e,t)=>n=>{e.forEach(((e,a)=>{n.text=p(n.text,a,e,t)}))},c=(e,t)=>n=>{n.facts.forEach((n=>{e.forEach(((e,a)=>{n.title=p(n.title,a,e,t),n.value=p(n.value,a,e,t)}))}))},p=(e,t,n,i)=>{const{mentionsText:r,isMentionsApplied:s}=u(e,t,n,a.A.mention);return i.hasMentions=i.hasMentions||s,r},u=(e,t,n,a)=>{let i=!1;if(-1!==e.indexOf(t)){const r=`<span contenteditable="false" itemscope="" itemtype="${a}" itemid="${n.itemId}">${g(m(t))}</span>`;e=e.replace(new RegExp(t,"g"),r),i=!0}return{mentionsText:e,isMentionsApplied:i}},m=e=>e.substring(4,e.length-5),g=e=>e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;"):""},663823:(e,t,n)=>{n.d(t,{gp:()=>l,fh:()=>d,CH:()=>c});var a=n(480354),i=n(898197),r=n(995574),s=n(594323),o=n(2979);const l=(e,t)=>{const n={__typename:"MessageExtensionResult"},a=e?.composeExtension;if(!a)return n;const i=a.type,r=a.text,l=a.attachments,d=a.suggestedActions;if(!l){const e=p(a.activityPreview);return{...n,...i&&{type:i},...r&&{text:r},...d&&{suggestedActions:d},...e&&{activityPreview:e}}}const c=a.attachmentLayout;l.forEach((e=>{e.contentType.toLowerCase()===o.s.Adaptive&&(0,s.l)(e.content,t)}));const u={items:Array.from(l,(e=>({card:{content:JSON.stringify(e.content),contentType:e.contentType},previewCard:e.preview?{content:JSON.stringify(e.preview.content),contentType:e.preview.contentType}:void 0}))),...i&&{type:i},...c&&{attachmentLayout:c},...d&&{suggestedActions:d},...r&&{text:r}};return{...n,...u}},d=e=>{if((0,a.isEmpty)(e))return(0,i.Lp)(e);switch(e.responseType){case"composeExtension":return l(e);case"task":return(0,i.Lp)(e);default:throw(0,r.zo)(r.Bc.InvalidInvokeResponseType)}},c=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,a.first)(e?.attachments);return{type:e?.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.parse(t.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(t)?void 0:t},p=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,a.first)(e?.attachments);return{type:e?.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.stringify(t.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(t)?void 0:t}},898197:(e,t,n)=>{n.d(t,{Lp:()=>r,wL:()=>s,KA:()=>p});var a=n(480354),i=n(995574);const r=e=>{if((0,a.isEmpty)(e))return p();if(o(e))return d(e.task);if(l(e))return c(e.task);throw(0,i.Mn)(i.wy.Unknown)},s=e=>{const t=e.value,n=(0,a.get)(t,"url"),r=(0,a.get)(t,"card");let s;if(!r&&!n)throw(0,i.Mn)(i.wy.MissingCardAndUrl);if(r&&n)throw(0,i.Mn)(i.wy.BothCardAndUrl);if(r)s=m(e);else if(!(0,a.isString)(n))throw(0,i.Mn)(i.wy.InvalidUrl);const{title:o,fallbackUrl:l,completionBotId:d,height:c,width:p}=t;return{title:o,fallbackUrl:l,completionBotId:d,url:n,card:s,height:u(c),width:u(p)}},o=e=>e.task&&"continue"===e.task.type&&(0,a.isObject)(e.task.value),l=e=>e.task&&"message"===e.task.type&&(0,a.isString)(e.task.value),d=e=>{const t=s(e);return{__typename:"TaskModuleTaskContinue",type:e.type,value:t}},c=({type:e,value:t})=>({__typename:"TaskModuleTaskMessage",type:e,value:t}),p=()=>({__typename:"TaskModuleTaskDone",text:"Done"}),u=e=>{if((0,a.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,a.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},m=e=>{const t=e.value.card;try{if(t&&g(t)){const e=(0,a.get)(t,"content")||{};return{__typename:"Card",contentType:(0,a.get)(t,"contentType"),content:JSON.stringify(e)}}throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}catch{throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}},g=e=>{const t=(0,a.get)(e,"contentType");return(0,a.isString)(t)&&t.toLowerCase()==="application/vnd.microsoft.card.adaptive".toLowerCase()}},607550:(e,t,n)=>{n.d(t,{gX:()=>a,t6:()=>i,ou:()=>r,C4:()=>s,Rv:()=>o,Tc:()=>l,Ib:()=>d,C5:()=>c,kP:()=>p,hm:()=>u,ER:()=>m,sb:()=>g,LX:()=>h,JA:()=>v,xv:()=>f});const a="remote-brb-participants-banner",i=" ",r="79",s="2",o="50",l="118",d="119",c="11",p="120",u="132",m="18",g={appInitiatedTags:["AppInitiated"],descriptionText:"[AutoBRB]",disclaimer:'NOTE: Data sent in feedback submissions will be "Support Data" under your agreement for Microsoft 365, including any information that would otherwise be considered "Customer Data" or "Personal Data". Please do not submit feedback that may include data you do not wish to provide to Microsoft as "Support Data".',minGzipSize:2e3,scenarioBrbTimeoutMilliseconds:36e5,scenarioBrbUploadLogsTimeoutMilliseconds:12e4,titleText:"System Encountered Issue for :",throttleTimeInDays:7},h={reportedEventsCount:"reportedEventsCount",reportedEvents:"reportedEvents"},v=new Set(["1","2","3","49","50","76","11","118","119"]),f={source:"brb"}},255164:(e,t,n)=>{n.d(t,{Kw:()=>a,A$:()=>i,_7:()=>r,_3:()=>s});const a={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_EXTENDED_PROPERTY_ID:"Extended property ID cannot be empty",INVALID_EXTENDED_PROPERTY_VALUE:"Extended property value must be a non-empty string",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call",REQUEST_TIMEOUT_MESSAGE:"Request timeout"},i={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",GET_MEETING_FROM_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/{tenantId}/{organizerId}/{threadId}/{messageId}",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false"}},V2:{Unified:{GET_CALENDAR_EVENTS:"v2.0/unified/calendarEvents?startDate={startDate}&endDate={endDate}",GET_CALENDAR_VIEWS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",GET_CALENDAR_EVENT_FROM_JOIN_URL:"v2.0/unified/calendarEvent/joinUrl?joinUrl={joinUrl}"},Private:{GET_OUTLOOK_CALENDAR_SETTINGS:"v1/calendarSettings?settingName={outlookCalendarSettings}",GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_ATTACHMENTS:"v2.0/me/events/{eventId}/attachments/{attachmentId}"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW_V2_1:"v2.1/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}},Outlook:{V2:{Private:{GET_ATTACHMENT_BY_ID:"/v2.0/me/events/{eventId}/attachments/{attachmentId}",PATCH_EVENT:"/v2.0/me/events/{eventId}"}}}},r="Personal",s={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover",NOTIFICATIONS_FLYOUT:"notifications-flyout",DRAG_DROP_EDIT_DIALOG:"drag-and-drop-edit-dialog",CHANNEL_PRE_STATE_SCHEDULE_MEETING_DETAILS_MENU_CONTEXT:"channel-pre-state-schedule-meeting-details-menu-context"}},305755:(e,t,n)=>{var a;n.d(t,{CK:()=>a,e:()=>i,eu:()=>r,vV:()=>s,Y2:()=>o}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(a||(a={}));const i="Thumbnails";var r,s,o;!function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort",e.RichFilePreviewFromChatsAndChannels="Thumbnails_RichFilePreviewFromChatsAndChannels",e.RichFilePreviewFromSearchFileCards="Thumbnails_RichFilePreviewFromSearchFileCards",e.RichFilePreviewFromShareTray="Thumbnails_RichFilePreviewFromShareTray"}(r||(r={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(s||(s={})),function(e){e.manualRedirect="manualRedirect"}(o||(o={}))},579659:(e,t,n)=>{n.d(t,{w:()=>r});var a=n(170709),i=n(475959);const r=(e,t)=>{try{if(!t)return;const n=JSON.parse(t.content);return{url:e,title:n.title&&s(n.title),description:n.text&&s(n.text),thumbnail:n.images&&n.images[0]?.url}}catch(e){throw new Error(`parsing preview content failed with error: ${(0,i.y)(e.message||"")}`)}},s=e=>(new a.J).stripHtml(e)||""},836547:(e,t,n)=>{n.d(t,{yr:()=>i,OE:()=>r,wr:()=>s,Ru:()=>o,Si:()=>l,Ls:()=>d,iH:()=>c,q2:()=>p,x$:()=>u,B6:()=>m});const a="__",i=(e,t,n,a,i)=>{if(!(e&&t&&n&&a))return"";return(i?[e,t,n,a,i]:[e,t,n,a]).join("__")},r=e=>{const[t,n,a,i]=e.split("__");return{tenantId:t,organizerId:n,conversationId:a,messageId:i}},s=e=>e.split(a)[0],o=e=>e.split(a)[1],l=e=>e.split(a)[2],d=e=>e.split(a)[3],c=e=>e.split(a)[4],p=(e,t,n)=>{const a=s(e),i=l(e),r={IsBroadcastMeeting:!0,role:"a",Tid:a,Oid:o(e)},d=`/l/meetup-join/${i}/0?context=${encodeURIComponent(JSON.stringify(r))}`;let c=t.replace("/{broadcastId}/join",`?url=${encodeURIComponent(d)}`);return n&&(c+=`&isanonymous=true&tenantId=${a}`),c},u=e=>{if(e){const t=e.stream,n=t?.wamsStreamingUrl,a=!!t?.decryptionToken,i=e.altStream,r=i?.wamsStreamingUrl;return!!(n&&a||r&&!!i?.decryptionToken)}return!1},m=(e,t,n,a,i)=>{const r=new URL(`/l/meetup-join/${encodeURIComponent(a)}/0`,`${e}`),s={Tid:t,Oid:n,...i?{IsBroadcastMeeting:!0,role:"a"}:{}},o=new URLSearchParams({context:JSON.stringify(s),...i?{btype:"a",role:"a"}:{}});return r.search=o.toString(),r.toString()}},2979:(e,t,n)=>{var a,i;n.d(t,{s:()=>a,c:()=>i}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.OAuthCard="application/vnd.microsoft.card.oauth",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard"}(a||(a={})),function(e){e.ZeroInstallAppInstalledAppLinkUnfurl="ZeroInstallAppInstalledAppLinkUnfurl",e.NonZeroInstallAppInstalledAppLinkUnfurl="NonZeroInstallAppInstalledAppLinkUnfurl",e.ZeroInstallAppNotInstalledAppLinkUnfurl="ZeroInstallAppNotInstalledAppLinkUnfurl",e.URLP="URLP",e.URLPRichInfo="URLPRichInfo",e.NonLinkUnfurling="NonLinkUnfurling",e.APP_INSTALL_TO_CONVERSATION="APP_INSTALL_TO_CONVERSATION",e.APP_DETAILS_DIALOG="APP_DETAILS_DIALOG",e.APP_DETAILS_DIALOG_META_OS="APP_DETAILS_DIALOG_META_OS",e.M365_APP_DETAILS_DIALOG="M365_APP_DETAILS_DIALOG",e.COPILOT_STUDIO="COPILOT_STUDIO",e.BIZ_CHAT="BIZ_CHAT",e.EMBEDDED_BUILDER="EMBEDDED_BUILDER",e.SHARE_APP_DIALOG="SHARE_APP_DIALOG",e.APP_HEADER_SHARE_ENTRYPOINT="APP_HEADER_SHARE_ENTRYPOINT",e.APP_BAR_SHARE_ENTRYPOINT="APP_BAR_SHARE_ENTRYPOINT",e.MANAGE_APPS_COPY_LINK="MANAGE_APPS_COPY_LINK",e.BOT_HEADER_SHARE_ENTRYPOINT="BOT_HEADER_SHARE_ENTRYPOINT",e.UNIFIED_APP_ENTRY_PANEL="UNIFIED_APP_ENTRY_PANEL",e.APP_PROFILE_CARD="APP_PROFILE_CARD",e.SHAREPOINT="SHAREPOINT",e.CTA_FOOTER_APP_LINK_PREVIEW="CTA_FOOTER_APP_LINK_PREVIEW"}(i||(i={}))},167960:(e,t,n)=>{n.d(t,{l:()=>s});const a=22,i=255,r=16;function s(){return`${btoa(String.fromCharCode.apply(void 0,Array.from(Array(r),(e=>i*Math.random())))).substring(0,a)}.0`}},799156:(e,t,n)=>{function a(){return new Date}n.d(t,{AV:()=>a,Hs:()=>i,Ae:()=>d,iB:()=>c});const i=9999,r=59,s=59,o=23,l=999,d=new Date(i,11,31,0,0,0);function c(){const e=a();return e.setHours(o,s,r,l),e}},949579:(e,t,n)=>{n.d(t,{Gu:()=>a,nC:()=>i,Yl:()=>r,RJ:()=>s});class a{constructor(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class i extends a{constructor(e,t,n){super(n,e,((e,n)=>e*Math.pow(t,n-1)))}}class r extends a{constructor(e){super(e,e,(()=>e))}}class s extends a{constructor(e,t){super(t,e,((e,t)=>{const n=Math.random()*Math.pow(2,t-1);return Math.floor((.5*Math.pow(4,t-1)+n)*e)}))}}},850189:(e,t,n)=>{n.d(t,{IN:()=>a,sP:()=>i,VQ:()=>r});const a=Symbol("ForEachAsyncIteratorContinue"),i=Symbol("ForEachAsyncIteratorBreak");function r(e,t){let n,r=!1,o=e=>Promise.reject(e);"function"==typeof e.return&&(n=e.return,o=t=>{const a=()=>Promise.reject(t);return n.call(e).then(a,a)});const l=function(e,t){return function(n){return n.done?Promise.resolve(n):function(e,t){return new Promise((n=>n(t(e))))}(n.value,e).then(s,t)}}(t,o);return{async next(){if(r)return this.return();{let t=await e.next(),n=await l(t);for(;!n.done&&n.value===a;)t=await e.next(),n=await l(t);return n.value===i||n.value===a?this.return():n}},return:()=>(r=!0,n?n.call(e).then(l):Promise.resolve({value:void 0,done:!0})),throw:t=>(r=!0,"function"==typeof e.throw?e.throw(t).then(l):Promise.reject(t).catch(o)),[Symbol.asyncIterator](){return this}}}function s(e){return{value:e,done:!1}}},407104:(e,t,n)=>{var a;n.d(t,{V:()=>o,C:()=>l}),function(e){e[e.Value=0]="Value",e[e.Error=1]="Error"}(a||(a={}));var i=n(396588),r=n(480354);class s{constructor(e=100,t,n,a,i){if(this.newScenario=t,this.logger=a,this.getDroppedEventMetadataFn=i,e<0)throw new TypeError(`BufferLimit has to be > 0. OperationName ${this._operationName}`);this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e,this._overflowScenario=null,this._droppedEvents=0,this._operationName=n,this._droppedEventMetadataToCount=new Map}next(e){this._push({type:a.Value,value:e})}error(e){this._push({type:a.Error,error:e})}complete(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;)this._promiseResolutionFunctions.shift().resolve({done:!0})}onUnsubscribe(){this.complete(),this._promiseResolutionFunctions=[],this._values=[]}nextPromise(){if(this._overflowScenario&&this._values.length<this._bufferLimit){let e=`AsyncIterableObserver buffer is no longer full for operation ${this._operationName}. Dropped ${this._droppedEvents} events.`;if(this.getDroppedEventMetadataFn){const t=(0,r.maxBy)(Array.from(this._droppedEventMetadataToCount.keys()),(e=>this._droppedEventMetadataToCount.get(e)));e=`${e} Max dropped event metadata: ${t}.`,this._overflowScenario.appendEventData({context:JSON.stringify(Array.from(this._droppedEventMetadataToCount.entries())),reason:t})}this.logger&&this.logger.warn(e),this._overflowScenario.stop({size:this._droppedEvents}),this._overflowScenario=null,this._droppedEvents=0,this._droppedEventMetadataToCount=new Map}if(this._values.length>0){const{type:e,value:t,error:n}=this._values.shift();return e===a.Error?Promise.reject(n):Promise.resolve({done:!1,value:t})}return this._isComplete?Promise.resolve({done:!0}):new Promise(((e,t)=>{this._promiseResolutionFunctions.push({resolve:e,reject:t})}))}_push(e){if(this._promiseResolutionFunctions.length>0){const{resolve:t,reject:n}=this._promiseResolutionFunctions.shift();e.type===a.Error?n(e.error):t({done:!1,value:e.value})}else{if(this._values.length>this._bufferLimit-1){if(this._droppedEvents+=1,this.getDroppedEventMetadataFn&&e.value){const t=this.getDroppedEventMetadataFn(e.value),n=this._droppedEventMetadataToCount.get(t);this._droppedEventMetadataToCount.set(t,n?n+1:1)}throw!this._overflowScenario&&this.newScenario&&(this._overflowScenario=this.newScenario(i.Cu.OnAsyncIterableObserverOverflow),this._overflowScenario.appendEventData({operationName:this._operationName})),new Error(`AsyncIterableObserver buffer is full, all future events will be dropped for OperationName: ${this._operationName}`)}this._values.push(e)}}}function o(e,t,n,a,i,r,s){return new d(e,a,s,i,t,n,r)}function l(e,t,n,a,i,r,s){return new d(e,t,n,a,i,r,s)}class d{constructor(e,t,n,a,i,r,o){this.error=null;try{this.observer=new s(i,r,t,a,o),this.subscription=e.subscribe(this.observer),this.running=!0,this.cancellationListenerSubscription=n?.subscribe((()=>{this.onCancelledSubscription()}))}catch(e){this.running=!1,this.error=e}}[Symbol.asyncIterator](){return this}async next(){if(this.running&&this.observer)try{const e=await this.observer.nextPromise();if(this.running&&!e.done)return e}catch(e){return this.throw(e)}return this.error?this.throw(this.error):this.return()}return(e){return this.onCancelledSubscription(),Promise.resolve({done:!0,value:void 0})}throw(e){return this.onCancelledSubscription(),Promise.reject(e)}onCancelledSubscription(){this.running=!1,this.subscription?.unsubscribe(),this.observer?.onUnsubscribe(),this.cancellationListenerSubscription?.unsubscribe()}}},803060:(e,t,n)=>{n.d(t,{h:()=>i});var a=n(480354);function i(e,t){function n(e){if(!(0,a.isArray)(e)&&!(0,a.isObject)(e)||(0,a.isDate)(e))return e;const n={};(0,a.forOwn)(e,((e,a)=>{n[a]=i(e,t)}));const{[t]:r,...s}=n;return s}return(0,a.isArray)(e)?e.map(n):n(e)}},23315:(e,t,n)=>{var a,i;n.d(t,{Y:()=>a,u:()=>i}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.THIRTY=30]="THIRTY",e[e.ONE_HUNDRED=100]="ONE_HUNDRED",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(a||(a={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_CACHE_TTL_IN_MS=6e4]="DEFAULT_SKYPE_CACHE_TTL_IN_MS",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR",e[e.DEFAULT_REGION_GTM_MIN_LENGTH=10]="DEFAULT_REGION_GTM_MIN_LENGTH"}(i||(i={}))},459576:(e,t,n)=>{n.d(t,{fr:()=>a,ZB:()=>i,Dj:()=>r});const a=";",i=/^[0-9].+?_/,r=/([>]?[:;=XI8B]['-]?[\)/\|\]\(\\XPSODI\*#\?\>&])+(?![A-Z])|<3/},188604:(e,t,n)=>{n.d(t,{eO:()=>i,zb:()=>r,N9:()=>s,tb:()=>o});var a=n(459576);const i=e=>e.split(a.fr)[0],r=e=>2===e.split(a.fr).length,s=e=>{if(r(e))return i(e);if(a.ZB.test(e)){const[t,...n]=e.split("_");return n.join("")??e}return e},o=e=>e&&!a.Dj.test(e)},117937:(e,t,n)=>{n.d(t,{$:()=>o});var a=n(920246),i=n(191980),r=n(461167),s=n(912435);const o=(e,t,n)=>{const o=d(e),c=(0,s.xZ)(e,a.b.internalErrorCode),p=(0,s.xZ)(e,a.b.httpCode,e?.code||c||""),u={errorMessage:o,serverRequestId:(0,s.xZ)(e,a.b.correlationId)};t(o),(0,i.m)(parseInt(p||"",10))&&!l(parseInt(p||"",10),c)?n&&n.fail({errors:JSON.stringify(u),errorCode:`${p}`}):n&&n.incomplete({errors:JSON.stringify(u),errorCode:`${p||r.rA.Unhandled}`})},l=(e,t)=>e&&e===r.jL.badRequest&&t&&t===r.rA.InvalidRequest,d=e=>{let t=(0,s.xZ)(e,a.b.logErrorMessage,e?.message||"");const n=(0,s.xZ)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const i={context:e?.context,subContext:e?.subContext};return t=`${t}. ${JSON.stringify(i)}`,t}},119249:(e,t,n)=>{var a;n.d(t,{G:()=>a,w:()=>i}),function(e){e.About="about",e.Accounts="accounts",e.Appearance="appearance",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.ChatsAndChannels="chats_and_channels",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices",e.Recognition="recognition",e.FilesAndLinks="files_and_links",e.PhoneLink="phonelink",e.AppDevicePermission="app_permissions",e.Insiders="teams_insider",e.Localization="localization",e.TeamsLabs="teams_labs"}(a||(a={}));const i={AutoFollowThreadsSettings:"auto-follow-threads-settings",RepliesToThreadsAndPostsSettings:"replies-to-threads-and-posts-settings"}},295079:(e,t,n)=>{n.d(t,{Bg:()=>s,kF:()=>o,eq:()=>l,Vb:()=>d,q8:()=>c,pc:()=>p,Mw:()=>u,$A:()=>m,bV:()=>g,cN:()=>h,gm:()=>v,eV:()=>E});var a=n(825429),i=n(708193);const r=/[a-z]+-[a-z]+/gi,s=e=>{const t=e.match(/\/objects\/(.*)\/views\/video/);return t?.[1]},o=e=>`${e}.mpd`,l=(e,t,n)=>e.replace(new RegExp("/video$"),`/${n}/videoSegment/${t}`),d=e=>e.includes("canary")?"canary":"prod",c=e=>e?"2":"1",p=e=>e.replace("views/video","views/transcript"),u=(e,t,n)=>{if(!n||!e||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")},m=e=>o(e),g=(e,t)=>({...e&&{authorization:`skype_token ${e}`},...t&&{"ms-cv":t}}),h=()=>{const{document:e}=(0,a.z)(),t=e?.defaultView?.navigator.userAgent;return void 0!==t&&-1!==t.indexOf("Electron")},v=()=>{const{document:e}=(0,a.z)(),t=e?.defaultView?.navigator.userAgent;return void 0!==t&&-1!==t.indexOf("Firefox")},f=e=>(0,i.zU)(e).locale??e,E=(e,t,n)=>{const a=new Set;e&&a.add(f(e.toLowerCase())),t&&!a.has(t)&&a.add(f(t.toLowerCase()));const i=n.map((e=>f(e))).filter((e=>e.match(r)));if(i)for(const e of i){if(a.size>=4)break;a.has(e.toLowerCase())||a.add(e.toLowerCase())}return[...a].slice(0,4).join(";")}},645027:(e,t,n)=>{n.d(t,{Ow:()=>a,YZ:()=>i,IQ:()=>r,cg:()=>s,sY:()=>o,Vy:()=>l,Qw:()=>d,gM:()=>c,pK:()=>p});const a="video-message",i="video-message-gc",r="Creation-Epoch",s=(e,t)=>{const n=parseInt(t||"",10);return isNaN(n)||e-n>144e5},o=(e,t)=>e-t>2592e5,l=e=>c(e,"videoBlob"),d=e=>c(e,"thumbnailBlob"),c=(e,t)=>`${a}?cacheId=${e}&type=${t}`,p=e=>{try{const t=new URL(e);if(t.pathname.slice(Math.max(0,t.pathname.length-a.length))!==a)return;const n=t.searchParams.get("cacheId"),i=t.searchParams.get("type"),r="videoBlob"===i||"thumbnailBlob"===i?i:void 0;return n&&r?{cacheId:n,type:r}:void 0}catch{return}}},122322:(e,t,n)=>{n.d(t,{w:()=>i});var a=n(478955);const i=(e,t,n)=>{if(n?.objectId){if(e.objectId===n.objectId)return-1;if(t.objectId===n.objectId)return 1}const i=(0,a.Ql)(t.startTime,e.startTime,"milliseconds");if(0!==i)return i;const s=r(e.showAs)-r(t.showAs);if(0!==s)return s;const o=(0,a.Ql)(e.endTime,t.endTime,"milliseconds");if(0!==o)return o;const l=(e.subject||"").localeCompare(t.subject||"");if(0!==l)return l;const d=(e.eventType||"").localeCompare(t.eventType||"");return 0!==d?d:0},r=e=>{const t=["Oof","Busy","Tentative","WorkingElsewhere","Free"];if(!e)return t.length;const n=t.indexOf(e);return-1!==n?n:t.length}},961516:(e,t,n)=>{n.d(t,{Gm:()=>i,UR:()=>r,bu:()=>h});var a=n(737565);const i=(e,t,n)=>e?g(e,t,n):void 0;var r,s,o,l,d;!function(e){e.none="none",e.webrtc="webrtc",e.slimcore="slimcore"}(r||(r={})),function(e){e.none="none",e.windows365="Windows365"}(s||(s={})),function(e){e[e.Optimizing=0]="Optimizing",e[e.SwitchingStack=1]="SwitchingStack",e[e.VDIModeConfirmed=2]="VDIModeConfirmed",e[e.Disconnected=3]="Disconnected",e[e.SwitchingStackCompleted=4]="SwitchingStackCompleted"}(o||(o={})),function(e){e.none="None",e.citrix="Citrix",e.vmware="VMware",e.avd="AVD",e.aws="AWS",e.citrixSlimCore="CitrixSlimCore",e.vmwareSlimCore="VMwareSlimCore",e.avdSlimCore="AVDSlimCore",e.awsSlimCore="AWSSlimcore"}(l||(l={})),function(e){e.none="none",e.windows365="Windows365",e.windows365SlimCore="Windows365SlimCore"}(d||(d={}));const c={[l.none]:"None",[l.citrix]:"Citrix HDX",[l.vmware]:"Omnissa Media",[l.avd]:"AVD Media",[l.aws]:"Amazon WorkSpaces Media",[l.citrixSlimCore]:"Citrix SlimCore Media",[l.vmwareSlimCore]:"Omnissa SlimCore Media",[l.avdSlimCore]:"AVD SlimCore Media",[l.awsSlimCore]:"Amazon WorkSpaces SlimCore Media"},p={[d.windows365]:"Windows 365 Media",[d.windows365SlimCore]:"Windows 365 SlimCore Media"},u={None:l.none,CitrixXenDesktop:l.citrixSlimCore,CitrixXenApp:l.citrixSlimCore,VMWare:l.vmwareSlimCore,WVD:l.avdSlimCore,AWS:l.awsSlimCore},m={None:l.none,CitrixXenDesktop:l.citrix,CitrixXenApp:l.citrix,VMWare:l.vmware,WVD:l.avd,AWS:l.aws},g=(e,t,n)=>{const a=n===s.windows365;return t?a?p[d.windows365SlimCore]??l.none:c[u[e]]??l.none:a?p[d.windows365]??l.none:c[m[e]]??l.none},h=(e,t,n,a,r,s,o)=>{const l=i(r,n,s);return v(t,n,a,o)?e.stringTranslate("framework","vdi_about_optimized_information_t",{providerName:l}):e.stringTranslate("framework","vdi_about_optimized_notconnected_information_t",{providerName:l})},v=(e,t,n,i)=>t?i===a.c.Connected:!!n&&e===a.c.Connected},64024:(e,t,n)=>{n.d(t,{H:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query ComponentsChatQueriesUserPreferencesQuery {userPreferences {controllerConnectedServicesEnabled,readReceiptsEnabled}}");return delete this.definitions,this.definitions=e.definitions}}},182017:(e,t,n)=>{n.d(t,{H:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsConnectedCalendarConnectedCalendarSettingFragment on ConnectedCalendarSetting {source,accountAddress,accountId,isSyncAllowed,eTag}");return delete this.definitions,this.definitions=e.definitions}}},546020:(e,t,n)=>{n.d(t,{V:()=>r});var a=n(650656),i=n(182017);const r={kind:"Document",get definitions(){const e=(0,a.G)("query syncConnectedCalendarSettings($callerInfo:String!) {syncConnectedCalendarSettings(callerInfo:$callerInfo) {...ComponentsConnectedCalendarConnectedCalendarSettingFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...i.H.definitions]}}},670308:(e,t,n)=>{var a,i;n.d(t,{DG:()=>a,Mv:()=>i,qh:()=>r}),function(e){e.CreateTeam="CreateTeam",e.CreateChannel="CreateChannel",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.MarkAllChannelsAsRead="MarkAllChannelsAsRead",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(a||(a={})),function(e){e.None="None",e.PinChannel="PinChannel",e.UnpinChannel="UnpinChannel",e.ShowChannel="ShowChannel",e.HideChannel="HideChannel",e.ShowTeam="ShowTeam",e.HideTeam="HideTeam",e.ExpandTeam="ExpandTeam",e.CollapseTeam="CollapseTeam",e.ReorderTeam="ReorderTeam",e.ReorderPinnedChannels="ReorderPinnedChannels",e.ForceHideTeam="ForceHideTeam",e.SetChannelRecommendation="SetChannelRecommendation",e.StopChannelRecommendation="StopChannelRecommendation"}(i||(i={}));const r={forceSync:!1}},838764:(e,t,n)=>{n.d(t,{a:()=>a});const a={}},489737:(e,t,n)=>{n.d(t,{GT:()=>p,Ep:()=>u,Cd:()=>v,us:()=>f,RR:()=>E,V2:()=>I,yt:()=>A,vf:()=>y,Wo:()=>C,WG:()=>_,ii:()=>T});var a=n(183111),i=n(912435),r=n(342171),s=n(953307),o=n(446154),l=n(315560),d=n(625270),c=n(670308);const p=(e,t)=>e.isGeneral?"OwnersPost"!==t||"Admin"===e.memberRole:"Admin"===e.memberRole||e.isModerator||"Everyone"===e.channelSettings?.channelPostPermissions||"EveryoneButGuests"===e.channelSettings?.channelPostPermissions&&"Guest"!==e.memberRole&&"Undefined"!==e.memberRole,u=(e,t)=>{const n=m(e,t);let a=n.channelId;const i=n.replyChainId,r=n.teamId,s="string"==typeof a,o="string"==typeof i||null==i,l="string"==typeof r||null==r;return s&&(a=a.includes("login")?a.substring(0,a.indexOf("/?login")):a),(s||r)&&o&&l||h("extractChannelMessageCompoundId",e,t),{channelId:a,replyChainId:i,teamId:r}},m=(e,t)=>{const n=decodeURIComponent(e);return g(n,t)},g=(e,t)=>{try{const n=["channelId","replyChainId","teamId"],a=JSON.parse(e);return Object.keys(a).some((e=>!n.includes(e)))&&t?.error("Invalid compoundId. Should only contain channelId, replyChainId and teamId. Returned by filtering out other properties."),{channelId:a.channelId??a.teamId,teamId:a.teamId,replyChainId:a.replyChainId}}catch(n){return t?.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},h=(e,t,n)=>{const r=`TeamsAndChannelsHelper::${e}::${a.O4.InvalidInput}::${t}`;throw n?.error(r),(0,i.$5)("TeamsAndChannelsHelper",a.O4.InvalidInput,e,{compoundId:t},r)},v=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:t,channelId:n}=JSON.parse(e);return{teamId:t,channelId:n}}catch{return{channelId:e}}},f=(e,t,n,a,i,l,d,p,u,m,g,h,v,f)=>{switch(e){case c.DG.CreateTeam:i&&f?t.teamsAndChannels.createTeamV2({entryPoint:r.qF.teamsAndChannels}):a?t.teamsAndChannels.createTeamOnMainView({source:r.$D.template,canUserCreateTeam:!!f,entryPoint:r.qF.teamsAndChannels},p):t.teamsAndChannels.createTeam();break;case c.DG.CreateChannel:h&&g&&t.teamsAndChannels.createChannelOnLeftRail({entryPoint:s.k.ChannelListHeaderContextMenu});break;case c.DG.JoinTeamByCode:p===o.p.SchoolTeams?t.school.gridTeamDiscover():t.teamsAndChannels.teamDiscover();break;case c.DG.JoinTeam:l?t.teamsGallery.launchTeamsGallery():t.teamsAndChannels.teamDiscover();break;case c.DG.AddChannel:n&&g?t.teamsAndChannels.createChannel({teamId:n.id,groupId:n.groupId||"",teamType:n.teamType}):n&&t.teamsAndChannels.addChannel(n.id);break;case c.DG.AddMember:n&&(d?t.teamsAndChannels.addMemberToTeamDialog(n.id):t.teamsAndChannels.addMember(n.id));break;case c.DG.MarkAllChannelsAsRead:u?.();break;case c.DG.ManageTeamsList:t.teamsAndChannels.manageTeamsList(o.p.ChannelList,v?{entityCommand:v}:void 0,m?.()),u?.();break;case c.DG.ManageTeamsInvites:t.teamsAndChannels.manageSharedChannelsPendingInvites(o.p.ChannelList,void 0,m?.()),u?.();break;case c.DG.CrossTeamAnalytics:t.teamsAndChannels.crossTeamAnalytics(o.p.ChannelList,void 0,m?.()),u?.()}},E=e=>{const t=e,n=t.graphQLErrors?.find((e=>"CDLResolver"===e.extensions?.source)),a=n?.extensions?.prevError,i=a?.extraInfo;return i},I=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const t=decodeURIComponent(e),{teamId:n,channelId:a,replyChainId:i}=JSON.parse(t);return{teamId:n,channelId:a,replyChainId:i}}catch{return{channelId:e}}},A=e=>`overflow-${e}`,y=e=>{if("options"in e&&e.options)return(0,d.j)(e.options||"")},C=e=>{const t=e?.id;return t?u(t):JSON.parse("{}")},_=l.ck?[l.ck.teammanage,l.ck.teammembers,l.ck.teamchannels,l.ck.teampendingrequests,l.ck.teammanagetags]:[],T=l.ck?[l.ck.channelapps,l.ck.channelmanage,l.ck.channelmembers,l.ck.channelinvitations]:[]}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/589544-3d16d60bc60b1ef0.js.map