"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[504987],{279027:(t,n,e)=>{e.d(n,{Q:()=>i});var r=e(807733);function i(){return{warn:[],sanitize:[r.B.SPOPassword,r.B.KnownString,r.B.QueryParam,r.B.SitePath,r.B.URL,r.B.JWT,r.B.Email],parseJsonStrings:!0}}},863121:(t,n,e)=>{e.d(n,{I:()=>Q});var r=e(971510),i=e(600986),a=e(807733),s=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.KnownString,n._targets=["accesstoken:","password=",".files.1drv.com/",".s2s-files.1drv.com/",".livefilestore.com/","shares/u!","shares/b!","shares('u!","shares('b!","shares(u!","shares(b!","shares(@","shares(%40"],n}return(0,r.__extends)(n,t),n.prototype.scan=function(t){var n=t.toLowerCase();return this._targets.some((function(t){return-1!==n.indexOf(t)}))},n}(i.E),o=function(t){function n(){var n=t.call(this)||this;n.identifier=a.B.QueryParam,n._params=["access_token=","accesstoken=","auth_key=","authkey=","auth_token=","authtoken=","challengetoken=","email=","guestaccesstoken=","jwt=","login_hint=","originalpath=","password=","pageinfo=","patqp=","prooftoken=","querytemplate=","querytemplatepropertiesurl=","querytext=","redeem=","rwurl=","selectproperties=","share=","sig=","tempauth=","username=","wd="],n._delimiters=["&","?"],n._targets=[];for(var e=0,r=n._params;e<r.length;e++)for(var i=r[e],s=0,o=n._delimiters;s<o.length;s++){var u=o[s];n._targets.push("".concat(u).concat(i))}return n}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),this._delimiters.some((function(t){return n.includes(t)}))},n.prototype.scan=function(t){var n=t.toLowerCase();return this._targets.some((function(t){return-1!==n.indexOf(t)}))},n}(i.E),u=/(?:^|[^A-Za-z0-9_-])[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{3,}\.[A-Za-z0-9_-]{20,}/,c=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.JWT,n}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),-1!==n.toLowerCase().indexOf("ey")},n.prototype.scan=function(t){return function(t){return u.test(t)}(t)},n}(i.E),d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],f="/",l=128,h=["Mozilla","AppleWebKit","Gecko","Safari","Chrome","Edg"],p=/\d+\.\d+(\.\d+)?(\.\d+)?/,_=/\b\d{1,2}\/\d{1,2}\/(\d{4}|\d{2})\b/,v=/^\/\d+\/\d+\/\d+\/?$/,S=new Array(l).fill(!1);function y(t,n,e){if(n>0&&t[n-1]===f||" "===t[n+1]||e<t.length-1&&" "===t[e+1])return!1;for(var r=n+1;r<e;r++){var i=t.charCodeAt(r);if(!(i>=l)&&!S[i])return!1}return e>n+1}function w(t){if(t.includes("W3SVC")||function(t){return h.some((function(n){return t.includes(n)}))||p.test(t)}(t)||_.test(t)||v.test(t))return!1;for(var n=t.length,e=0;e<n;e++)if(t[e]===f){var r=e,i=t.indexOf(f,r+1);if(-1===i)continue;if(i-r<=1)continue;if(!y(t,r,i))continue;var a=t.indexOf(f,i+1);if(-1===a)return!0;if(a-i<=1)continue;if(y(t,i,a))return!0}return!1}(0,r.__spreadArray)((0,r.__spreadArray)([],d,!0),["%","-",".","_","~",":","?","#","[","]","@","!","$","&","(",")","*","+",";"," ","=","'"],!1).forEach((function(t){S[t.charCodeAt(0)]=!0}));var g=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.SitePath,n}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),n.indexOf(f)>-1},n.prototype.scan=function(t){return w(t)},n.prototype.warn=function(t){return"WARNING: aka.ms/ODSPSanitizerSitePath - ".concat(t)},n}(i.E),m=/<soap:Envelope/i,x=/%[0-9A-Fa-f]{2}/;var O=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.Soap,n}return(0,r.__extends)(n,t),n.prototype.scan=function(t){return function(t){if(m.test(t))return!0;if(x.test(t))try{var n=decodeURIComponent(t);return m.test(n)}catch(t){return!1}return!1}(t)},n}(i.E),A=/_sp0[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/i,C=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.SPOPassword,n}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),-1!==n.toLowerCase().indexOf("_sp0")},n.prototype.scan=function(t){var n=t.match(A);return!!n&&0!==n.length},n}(i.E),z=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.URLOld,n}return(0,r.__extends)(n,t),n.prototype.scan=function(t){for(var n=0,e=["https://","http://"];n<e.length;n++){var r=e[n],i=t.indexOf(r);if(-1!==i){var a=i+r.length;if(" "!==t[a])return!t.substring(a).includes("{ length:")}}return!1},n.prototype.warn=function(t){return"WARNING: aka.ms/ODSPSanitizerURL - ".concat(t)},n}(i.E),b=new Set(["/"," ","\t","\n","\r","{","}"]),E="http://",P="https://",k=function(t){function n(n){var e,r=t.call(this,n)||this;r.identifier=a.B.URL;var i=(null===(e=n.trustedDomains)||void 0===e?void 0:e.map((function(t){return t.toLowerCase()})))||[];return r._trustedDomainsSet=new Set(i),r._wwwTrustedDomainsSet=new Set(i.map((function(t){return"www.".concat(t)}))),r}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),n.includes(E)||n.includes(P)},n.prototype.scan=function(t){for(var n,e=this._findUrls(t),r=!1,i=e.next();!i.done;){if(n=i.value,!t.includes("{ length:",n)){var a=this._extractDomain(t,n);if(a&&!this._trustedDomainsSet.has(a)&&!this._wwwTrustedDomainsSet.has(a)){r=!0;break}}i=e.next()}return r},n.prototype._findUrls=function(t){var n,e,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<t.length?(e=-1,-1!==(i=t.indexOf("https://",n))?e=i+8:-1!==(a=t.indexOf("http://",n))&&(e=a+7),-1===e?[3,3]:[4,e]):[3,3];case 2:return r.sent(),n=e,[3,1];case 3:return[2]}}))},n.prototype._extractDomain=function(t,n){for(var e=t.length,r=n;r<t.length;r++)if(b.has(t[r])){e=r;break}return t.substring(n,e).toLowerCase()},n}(z),D=new Set((0,r.__spreadArray)((0,r.__spreadArray)([],d,!0),[".","-","_","#"],!1)),L=new Set((0,r.__spreadArray)((0,r.__spreadArray)([],d,!0),[".","-"],!1)),B=new Set(d),J=["@","%40","_at_"],U=function(t){function n(n){var e;void 0===n&&(n={});var r=t.call(this)||this;r.identifier="Email";var i=(null===(e=n.trustedDomains)||void 0===e?void 0:e.map((function(t){return t.toLowerCase()})))||[];return r._trustedDomainsSet=new Set(i),r}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),null!==this._findAtCharacter(n.toLowerCase(),0)},n.prototype.scan=function(t){for(var n=t.toLowerCase(),e=this._findEmails(n),r=!1,i=e.next();!i.done;){var a=i.value,s=this._isUserPartValid(n,a),o=this._extractDomain(n,a);if(s&&void 0!==o&&!this._trustedDomainsSet.has(o.toLowerCase())){r=!0;break}i=e.next()}return r},n.prototype.warn=function(t){return"WARNING: aka.ms/ODSPSanitizerEmail - ".concat(t)},n.prototype._findAtCharacter=function(t,n){for(var e=null,r=0,i=J;r<i.length;r++){var a=i[r],s=t.indexOf(a,n);-1!==s&&(null===e||s<e.index)&&(e={index:s,variant:a})}return e},n.prototype._findEmails=function(t){var n,e;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<t.length?null===(e=this._findAtCharacter(t,n))?[3,3]:[4,e]:[3,3];case 2:return r.sent(),n=e.index+e.variant.length,[3,1];case 3:return[2]}}))},n.prototype._isUserPartValid=function(t,n){var e=n.index;if(e<3)return!1;for(var r=3;r>0;r--){var i=t.charCodeAt(e-r);if(!(i>=128)&&!D.has(String.fromCharCode(i)))return!1}return!0},n.prototype._extractDomain=function(t,n){var e=n.index+n.variant.length;if(!(n.index<0||e>=t.length)){var r=t.indexOf(".",e);if(-1!==r)if(!(r-e>255)&&"-"!==t[e]){for(var i=e;i<r;i++){var a=t.charCodeAt(i);if(!(a>=128)&&!B.has(String.fromCharCode(a)))return}for(var s=r+1,o=s;o<t.length&&t.charCodeAt(o)<128&&L.has(t[o]);)o++;if(!(o-s<2))return t.substring(e,o).toLowerCase()}}},n}(i.E),W=new Set((0,r.__spreadArray)((0,r.__spreadArray)([],d,!0),[".","-","_","#"],!1)),j=new Set((0,r.__spreadArray)((0,r.__spreadArray)([],d,!0),[".","-"],!1)),R=new Set(d),T=function(t){function n(n){var e;void 0===n&&(n={});var r=t.call(this)||this;r.identifier="EmailOld";var i=(null===(e=n.trustedDomains)||void 0===e?void 0:e.map((function(t){return t.toLowerCase()})))||[];return r._trustedDomainsSet=new Set(i),r}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),-1!==n.indexOf("@")},n.prototype.scan=function(t){for(var n,e=this._findEmails(t),r=!1,i=e.next();!i.done;){n=i.value;var a=this._isUserPartValid(t,n),s=this._extractDomain(t,n);if(a&&void 0!==s&&!this._trustedDomainsSet.has(s.toLowerCase())){r=!0;break}i=e.next()}return r},n.prototype.warn=function(t){return"WARNING: aka.ms/ODSPSanitizerEmail - ".concat(t)},n.prototype._findEmails=function(t){var n,e;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<t.length?-1===(e=t.indexOf("@",n))?[3,3]:[4,e]:[3,3];case 2:return r.sent(),n=e+1,[3,1];case 3:return[2]}}))},n.prototype._isUserPartValid=function(t,n){if(n<3)return!1;for(var e=3;e>0;e--){var r=t.charCodeAt(n-e);if(!(r>=128)&&!W.has(String.fromCharCode(r)))return!1}return!0},n.prototype._extractDomain=function(t,n){if(!(n<0||n>=t.length-1)){var e=t.indexOf(".",n);if(-1!==e)if(!(e-n-1>255)&&"-"!==t[n+1]){for(var r=n+1;r<e;r++){var i=t.charCodeAt(r);if(!(i>=128)&&!R.has(String.fromCharCode(i)))return}for(var a=e+1,s=a;s<t.length&&t.charCodeAt(s)<128&&j.has(t[s]);)s++;if(!(s-a<2))return t.substring(n+1,s).toLowerCase()}}},n}(i.E),N=/(?:^|[^A-Za-z0-9_-])[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{3,}\.[A-Za-z0-9_-]{20,}/,I=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.JWTOld,n}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),-1!==n.toLowerCase().indexOf("eyj0exaioijkv1qilc")},n.prototype.scan=function(t){return function(t){return N.test(t)}(t)},n}(i.E),Z=/\bey[A-Za-z0-9_-]{18,}\.(?:[A-Za-z0-9_-]*)\.[A-Za-z0-9_-]{43,}\b/g,V=/ey[A-Za-z0-9_-]{18,}\./i,K={SPOPassword:C,Soap:O,KnownString:s,QueryParam:o,SitePath:g,JWT:c,JWTOld:I,JWTInDepth:function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.identifier=a.B.JWTInDepth,n}return(0,r.__extends)(n,t),n.prototype.shouldScan=function(n){return t.prototype.shouldScan.call(this,n),V.test(n)},n.prototype.scan=function(t){var n,e;try{n=decodeURIComponent(t)}catch(e){n=t}for(Z.lastIndex=0;null!==(e=Z.exec(n));)if(this._isValidJWT(e[0]))return!0;return!1},n.prototype._isValidJWT=function(t){var n=t.split(".");if(3!==n.length)return!1;var e=n[0],r=n[1],i=n[2];return this._isValidBase64Url(e)&&(0===r.length||this._isValidBase64Url(r))&&this._isValidBase64Url(i)},n.prototype._isValidBase64Url=function(t){try{var n=t.replace(/-/g,"+").replace(/_/g,"/");if(n.length%4==1)return!1;var e=(4-n.length%4)%4,r=n+"=".repeat(e);return atob(r),!0}catch(t){return!1}},n}(i.E),URL:k,URLOld:z,Email:U,EmailOld:T},F={};function G(t,n){for(var e=new Map,r=0,i=t;r<i.length;r++){var a=i[r];if("function"==typeof a){var s=a();e.set(s.identifier,s)}else{var o=a,u=K;e.set(o,new u[o]((null==n?void 0:n[o])||F))}}return e}var Q=function(){function t(t){var n,e=this;if(this._excludedPaths=new Set,this._warningScanners=new Set,this._sanitizeScanners=new Set,this._fieldScanners=new Map,this._viewedObjectCount=0,this._sanitizedObjectCount=0,this._excludedPaths=new Set(t.excludedPaths||[]),this._traversalContext={excludedPaths:this._excludedPaths,parseJsonStrings:t.parseJsonStrings||!1,parseArrayStrings:null!==(n=t.parseArrayStrings)&&void 0!==n?n:t.parseJsonStrings||!1,skipObjectKeys:t.skipObjectKeys||!1},t.isExternalScannerSupportKSActive){var i=(0,r.__spreadArray)((0,r.__spreadArray)([],t.warn||[],!0),t.sanitize||[],!0);return this._fieldScanners=G(i,t.scannerOptions),this._warningScanners=new Set(t.warn||[]),void(this._sanitizeScanners=new Set(t.sanitize||[]))}var a=G(t.sanitize||[],t.scannerOptions),s=G(t.warn||[],t.scannerOptions);a.forEach((function(t){e._fieldScanners.set(t.identifier,t),e._sanitizeScanners.add(t.identifier)})),s.forEach((function(t){e._fieldScanners.set(t.identifier,t),e._warningScanners.add(t.identifier)}))}return t.prototype.addExclusion=function(t){this._excludedPaths.add(t)},t.prototype.flushSummary=function(){var t={sanitizedObjectCount:this._sanitizedObjectCount,viewedObjectCount:this._viewedObjectCount};return this._sanitizedObjectCount=0,this._viewedObjectCount=0,this._fieldScanners.forEach((function(n){t[n.identifier]=n.flushSummary()})),t},t.prototype.sanitizeOld=function(t,n,e){var i=this,a=!1;return this._fieldScanners.forEach((function(s){t=q(t,(function(t,e){try{if(i._shouldSanitize(s,e,t)){null==n||n(s.identifier,e),a=!0;var r=t;return i._warningScanners.has(s.identifier)&&(r=s.warn(r)),i._sanitizeScanners.has(s.identifier)&&(r=s.sanitize(r)),r}return t}catch(r){return null==n||n(s.identifier,"".concat(e,"!SanitizerError!")),t}}),(0,r.__assign)((0,r.__assign)({},i._traversalContext),e))})),this._viewedObjectCount++,a&&this._sanitizedObjectCount++,t},t.prototype.sanitize=function(t,n,e){var a=this;if(null==t)return this._viewedObjectCount++,t;var s=!1,o=q(t,(function(t,e){if(!(0,i.f)(t))return t;var r=t,o=!1;return a._fieldScanners.forEach((function(t,i){try{if(o||!t.shouldScan(r)||!t.scan(r))return;if(null==n||n(i,e),s=!0,a._sanitizeScanners.has(i))return r=t.sanitize(r),void(o=!0);a._warningScanners.has(i)&&(r=t.warn(r))}catch(t){null==n||n(i,"".concat(e,"!SanitizerError!"))}})),r}),(0,r.__assign)((0,r.__assign)({},this._traversalContext),e));return this._viewedObjectCount++,s&&this._sanitizedObjectCount++,o},t.prototype._shouldSanitize=function(t,n,e){return(0,i.f)(e)&&t.shouldScan(e)&&t.scan(e)},t}();function q(t,n,e){var i=e||{},a=i.excludedPaths,s=i.parseJsonStrings,o=i.parseArrayStrings,u=i.skipObjectKeys,c=(null==e?void 0:e.currentPath)||"";if(null==a?void 0:a.has(c))return t;if(Array.isArray(t))return t.map((function(t,i){return q(t,n,(0,r.__assign)((0,r.__assign)({},e),{currentPath:"".concat(c,"[").concat(i,"]")}))}));if("object"==typeof t&&null!==t){for(var d={},f=0,l=Object.keys(t);f<l.length;f++){var h=l[f],p="".concat(c,"#");u||(null==a?void 0:a.has(p))||(h=n(h,p)),d[h]=q(t[h],n,(0,r.__assign)((0,r.__assign)({},e),{currentPath:c?"".concat(c,".").concat(h):h}))}return d}if("string"!=typeof t||!s||!("{"===t.charAt(0)||o&&"["===t.charAt(0)))return n(t,c);try{var _=q(JSON.parse(t),n,(0,r.__assign)((0,r.__assign)({},e),{currentPath:"".concat(c,"$")}));return JSON.stringify(_)}catch(e){return n(t,c)}}},600986:(t,n,e)=>{e.d(n,{f:()=>i,E:()=>a});var r=" - ";function i(t){try{return"string"==typeof t&&0!==t.length&&isNaN(Number(t))&&"true"!==t&&"false"!==t}catch(t){return!1}}var a=function(){function t(t){this._scanned=0,this._sanitized=0}return t.prototype.shouldScan=function(t){return this._scanned++,!0},t.prototype.sanitize=function(t){return this._sanitized++,"".concat("SANITIZED").concat(r).concat(this.identifier)},t.prototype.warn=function(t){return"".concat("WARNING").concat(r).concat(this.identifier).concat(r).concat(t)},t.prototype.flushSummary=function(){var t={scanned:this._scanned,sanitized:this._sanitized,sanitizedRatio:0===this._scanned?0:this._sanitized/this._scanned};return this._scanned=0,this._sanitized=0,t},t}()},807733:(t,n,e)=>{e.d(n,{B:()=>r});var r={SPOPassword:"SPOPassword",SitePath:"SitePath",URL:"URL",URLOld:"URLOld",Soap:"Soap",KnownString:"KnownString",QueryParam:"QueryParam",JWT:"JWT",JWTOld:"JWTOld",JWTInDepth:"JWTInDepth",Email:"Email",EmailOld:"EmailOld"}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/504987-7af14d47f4e3e281.js.map