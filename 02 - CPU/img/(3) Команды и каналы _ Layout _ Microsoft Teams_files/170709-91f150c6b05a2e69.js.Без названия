(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[170709],{95425:(e,t,i)=>{const a=i(520250),s=i(737078),{isPlainObject:r}=i(16209),n=i(712647),o=i(8831),{parse:l}=i(976266),d=["img","audio","video","picture","svg","object","map","iframe","embed"],c=["script","style"];function m(e,t){e&&Object.keys(e).forEach((function(i){t(e[i],i)}))}function p(e,t){return{}.hasOwnProperty.call(e,t)}function u(e,t){const i=[];return m(e,(function(e){t(e)&&i.push(e)})),i}e.exports=g,e.exports.default=g,Object.defineProperty(e.exports,"__esModule",{value:!0});const h=/^[^\0\t\n\f\r /<=>]+$/;function g(e,t,i){if(null==e)return"";let b="",_="";function y(e,t){const i=this;this.tag=e,this.attribs=t||{},this.tagPosition=b.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(H.length){H[H.length-1].text+=i.text}},this.updateParentNodeMediaChildren=function(){if(H.length&&d.includes(this.tag)){H[H.length-1].mediaChildren.push(this.tag)}}}(t=Object.assign({},g.defaults,t)).parser=Object.assign({},f,t.parser),c.forEach((function(e){!1!==t.allowedTags&&(t.allowedTags||[]).indexOf(e)>-1&&!t.allowVulnerableTags&&console.warn(`\n\nâš ï¸ Your \`allowedTags\` option includes, \`${e}\`, which is inherently\nvulnerable to XSS attacks. Please remove it from \`allowedTags\`.\nOr, to disable this warning, add the \`allowVulnerableTags\` option\nand ensure you are accounting for this risk.\n\n`)}));const w=t.nonTextTags||["script","style","textarea","option"];let v,k;t.allowedAttributes&&(v={},k={},m(t.allowedAttributes,(function(e,t){v[t]=[];const i=[];e.forEach((function(e){"string"==typeof e&&e.indexOf("*")>=0?i.push(s(e).replace(/\\\*/g,".*")):v[t].push(e)})),i.length&&(k[t]=new RegExp("^("+i.join("|")+")$"))})));const x={},T={},C={};m(t.allowedClasses,(function(e,t){v&&(p(v,t)||(v[t]=[]),v[t].push("class")),x[t]=[],C[t]=[];const i=[];e.forEach((function(e){"string"==typeof e&&e.indexOf("*")>=0?i.push(s(e).replace(/\\\*/g,".*")):e instanceof RegExp?C[t].push(e):x[t].push(e)})),i.length&&(T[t]=new RegExp("^("+i.join("|")+")$"))}));const S={};let A,z,H,E,N,O,P;m(t.transformTags,(function(e,t){let i;"function"==typeof e?i=e:"string"==typeof e&&(i=g.simpleTransform(e)),"*"===t?A=i:S[t]=i}));let j=!1;F();const I=new a.Parser({onopentag:function(e,i){if(t.enforceHtmlBoundary&&"html"===e&&F(),O)return void P++;const a=new y(e,i);H.push(a);let s=!1;const d=!!a.text;let c;if(p(S,e)&&(c=S[e](e,i),a.attribs=i=c.attribs,void 0!==c.text&&(a.innerText=c.text),e!==c.tagName&&(a.name=e=c.tagName,N[z]=c.tagName)),A&&(c=A(e,i),a.attribs=i=c.attribs,e!==c.tagName&&(a.name=e=c.tagName,N[z]=c.tagName)),(!1!==t.allowedTags&&-1===(t.allowedTags||[]).indexOf(e)||"recursiveEscape"===t.disallowedTagsMode&&!function(e){for(const t in e)if(p(e,t))return!1;return!0}(E)||null!=t.nestingLimit&&z>=t.nestingLimit)&&(s=!0,E[z]=!0,"discard"===t.disallowedTagsMode&&-1!==w.indexOf(e)&&(O=!0,P=1),E[z]=!0),z++,s){if("discard"===t.disallowedTagsMode)return;_=b,b=""}b+="<"+e,"script"===e&&(t.allowedScriptHostnames||t.allowedScriptDomains)&&(a.innerText=""),(!v||p(v,e)||v["*"])&&m(i,(function(i,s){if(!h.test(s))return void delete a.attribs[s];let d=!1;if(!v||p(v,e)&&-1!==v[e].indexOf(s)||v["*"]&&-1!==v["*"].indexOf(s)||p(k,e)&&k[e].test(s)||k["*"]&&k["*"].test(s))d=!0;else if(v&&v[e])for(const t of v[e])if(r(t)&&t.name&&t.name===s){d=!0;let e="";if(!0===t.multiple){const a=i.split(" ");for(const i of a)-1!==t.values.indexOf(i)&&(""===e?e=i:e+=" "+i)}else t.values.indexOf(i)>=0&&(e=i);i=e}if(d){if(-1!==t.allowedSchemesAppliedToAttributes.indexOf(s)&&$(e,i))return void delete a.attribs[s];if("script"===e&&"src"===s){let e=!0;try{const a=L(i);if(t.allowedScriptHostnames||t.allowedScriptDomains){const i=(t.allowedScriptHostnames||[]).find((function(e){return e===a.url.hostname})),s=(t.allowedScriptDomains||[]).find((function(e){return a.url.hostname===e||a.url.hostname.endsWith(`.${e}`)}));e=i||s}}catch(t){e=!1}if(!e)return void delete a.attribs[s]}if("iframe"===e&&"src"===s){let e=!0;try{const a=L(i);if(a.isRelativeUrl)e=p(t,"allowIframeRelativeUrls")?t.allowIframeRelativeUrls:!t.allowedIframeHostnames&&!t.allowedIframeDomains;else if(t.allowedIframeHostnames||t.allowedIframeDomains){const i=(t.allowedIframeHostnames||[]).find((function(e){return e===a.url.hostname})),s=(t.allowedIframeDomains||[]).find((function(e){return a.url.hostname===e||a.url.hostname.endsWith(`.${e}`)}));e=i||s}}catch(t){e=!1}if(!e)return void delete a.attribs[s]}if("srcset"===s)try{let e=o(i);if(e.forEach((function(e){$("srcset",e.url)&&(e.evil=!0)})),e=u(e,(function(e){return!e.evil})),!e.length)return void delete a.attribs[s];i=u(e,(function(e){return!e.evil})).map((function(e){if(!e.url)throw new Error("URL missing");return e.url+(e.w?` ${e.w}w`:"")+(e.h?` ${e.h}h`:"")+(e.d?` ${e.d}x`:"")})).join(", "),a.attribs[s]=i}catch(e){return void delete a.attribs[s]}if("class"===s){const t=x[e],r=x["*"],o=T[e],l=C[e],d=[o,T["*"]].concat(l).filter((function(e){return e}));if(!(i=R(i,t&&r?n(t,r):t||r,d)).length)return void delete a.attribs[s]}if("style"===s)try{const r=function(e,t){if(!t)return e;const i=e.nodes[0];let a;a=t[i.selector]&&t["*"]?n(t[i.selector],t["*"]):t[i.selector]||t["*"];a&&(e.nodes[0].nodes=i.nodes.reduce(function(e){return function(t,i){if(p(e,i.prop)){e[i.prop].some((function(e){return e.test(i.value)}))&&t.push(i)}return t}}(a),[]));return e}(l(e+" {"+i+"}"),t.allowedStyles);if(i=function(e){return e.nodes[0].nodes.reduce((function(e,t){return e.push(`${t.prop}:${t.value}${t.important?" !important":""}`),e}),[]).join(";")}(r),0===i.length)return void delete a.attribs[s]}catch(e){return void delete a.attribs[s]}b+=" "+s,i&&i.length&&(b+='="'+M(i,!0)+'"')}else delete a.attribs[s]})),-1!==t.selfClosing.indexOf(e)?b+=" />":(b+=">",!a.innerText||d||t.textFilter||(b+=M(a.innerText),j=!0)),s&&(b=_+M(b),_="")},ontext:function(e){if(O)return;const i=H[H.length-1];let a;if(i&&(a=i.tag,e=void 0!==i.innerText?i.innerText:e),"discard"!==t.disallowedTagsMode||"script"!==a&&"style"!==a){const i=M(e,!1);t.textFilter&&!j?b+=t.textFilter(i,a):j||(b+=i)}else b+=e;if(H.length){H[H.length-1].text+=e}},onclosetag:function(e){if(O){if(P--,P)return;O=!1}const i=H.pop();if(!i)return;if(i.tag!==e)return void H.push(i);O=!!t.enforceHtmlBoundary&&"html"===e,z--;const a=E[z];if(a){if(delete E[z],"discard"===t.disallowedTagsMode)return void i.updateParentNodeText();_=b,b=""}N[z]&&(e=N[z],delete N[z]),t.exclusiveFilter&&t.exclusiveFilter(i)?b=b.substr(0,i.tagPosition):(i.updateParentNodeMediaChildren(),i.updateParentNodeText(),-1===t.selfClosing.indexOf(e)?(b+="</"+e+">",a&&(b=_+M(b),_=""),j=!1):a&&(b=_,_=""))}},t.parser);return I.write(e),I.end(),b;function F(){b="",z=0,H=[],E={},N={},O=!1,P=0}function M(e,i){return"string"!=typeof e&&(e+=""),t.parser.decodeEntities&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i&&(e=e.replace(/"/g,"&quot;"))),e=e.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i&&(e=e.replace(/"/g,"&quot;")),e}function $(e,i){for(i=i.replace(/[\x00-\x20]+/g,"");;){const e=i.indexOf("\x3c!--");if(-1===e)break;const t=i.indexOf("--\x3e",e+4);if(-1===t)break;i=i.substring(0,e)+i.substring(t+3)}const a=i.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!a)return!!i.match(/^[/\\]{2}/)&&!t.allowProtocolRelative;const s=a[1].toLowerCase();return p(t.allowedSchemesByTag,e)?-1===t.allowedSchemesByTag[e].indexOf(s):!t.allowedSchemes||-1===t.allowedSchemes.indexOf(s)}function L(e){if((e=e.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//")).startsWith("relative:"))throw new Error("relative: exploit attempt");let t="relative://relative-site";for(let e=0;e<100;e++)t+=`/${e}`;const i=new URL(e,t);return{isRelativeUrl:i&&"relative-site"===i.hostname&&"relative:"===i.protocol,url:i}}function R(e,t,i){return t?(e=e.split(/\s+/)).filter((function(e){return-1!==t.indexOf(e)||i.some((function(t){return t.test(e)}))})).join(" "):e}}const f={decodeEntities:!0};g.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1},g.simpleTransform=function(e,t,i){return i=void 0===i||i,t=t||{},function(a,s){let r;if(i)for(r in t)s[r]=t[r];else s=t;return{tagName:e,attribs:s}}}},737078:e=>{"use strict";e.exports=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},511756:(e,t,i)=>{"use strict";var a;i.d(t,{eS:()=>a,IA:()=>r,tv:()=>n,_s:()=>o}),function(e){e.appid="appid",e.color="color",e.bgColor="background-color",e.background="background",e.itemProps="data-itemprops",e.itemtype="itemtype",e.mentionId="data-mention-id",e.height="height",e.itemid="itemid",e.itemscope="itemscope",e.src="src",e.style="style",e.width="width",e.alt="alt",e.mri="mri",e.stale="stale",e.type="type",e.originalSrc="originalsrc",e.cacheKey="data-cache-key",e.duration="data-duration",e.uploadProgress="data-upload-progress",e.thumbnailUploadProgress="data-thumbnail-upload-progress",e.transcriptUploadStatus="transcript-upload-status",e.dataProcessedUrl="data-processed-url"}(a||(a={}));const s=[a.mri,a.type,a.originalSrc,a.stale,a.cacheKey],r=["authorname","timestamp","author","messageid","conversation","url_thumbnail","doc_id","duration_ms","type","uri","id","height","itemtype","width","itemid","v","b64","originalName","href","t","s","f","utf","latitude","longitude","alt"],n=["abbr","align","alt","axis","aria-label","bgcolor","border","cellpadding","cellspacing","class","clear","color","cols","colspan","compact","content","contenteditable","coords","data-ams-src","data-duration","data-encodingformat","data-excerpt","data-icon","data-inline-image","data-itemprops","data-preview-src","data-source-name","data-source-time","data-source-action","data-sensitivity-title","data-sensitivity-description","data-src","data-title","data-ts-imgid","data-ts-imglen","dir","face","fluid-url","headers","height","href","hreflang","hspace","id","ismap","itemid","itemprop","itemscope","itemtype","lang","language","nohref","nowrap","rel","rev","rows","rowspan","rules","scope","scrolling","shape","size","span","src","start","style","summary","target","title","type","usemap","valign","value","vspace","width",...s],o="data-ignore-semantic-link"},128452:(e,t,i)=>{"use strict";var a;i.d(t,{S8:()=>a,FL:()=>r,tO:()=>n}),function(e){e.span="span",e.mention="mention",e.sematicObject="semantic-object",e.card="card",e.readonly="readonly",e.spacer="spacer",e.video="video",e.topic="topic"}(a||(a={}));const s=[a.mention,a.sematicObject,a.card,a.readonly,a.spacer,a.video,a.topic],r=["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","img","ins","kbd","label","li","map","map","mark","menu","nav","ol","p","pre","q","rp","rp","rt","rt","ruby","s","samp","section","small",a.span,"strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","wbr",...s],n=["a","b","blockquote","br","cite","code","em","figure","h1","h2","h3","h4","hr","i","img","li","ol","p","pre","s","span","strong","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","video",...s]},763133:(e,t,i)=>{"use strict";i.d(t,{P:()=>a,o:()=>s});const a=["at","quote","legacyquote","ss","URIObject","OriginalName","FileSize","meta","i","b","s","pre","ul","ol","li","Swift","location","contacts","c","br","Title"],s=["a",...a]},170709:(e,t,i)=>{"use strict";i.d(t,{J:()=>w});var a=i(480354),s=i(95425),r=i.n(s),n=i(449778),o=i(182635),l=i(428479),d=i(511756),c=i(128452);const m=["@font-face","@font-feature-values","@keyframes","align-content","align-items","align-self","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","animation","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","background","border-bottom-color","border-bottom-left","border-bottom-right","border-bottom-style","border-bottom-width","border-bottom","border-collapse","border-color","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-image","border-left-color","border-left-style","border-left-width","border-left","border-radius","border-right-color","border-right-style","border-right-width","border-right","border-spacing","border-style","border-top-color","border-top-left","border-top-right","border-top-style","border-top-width","border-top","border-width","border","box-decoration-break","box-shadow","break-after","break-before","break-inside","caption-side","clear","clip","color","column-count","column-fill","column-gap","column-rule-color","column-rule-style","column-rule-width","column-rule","column-span","column-width","columns","counter-increment","counter-reset","direction","display","empty-cells","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","flex","float","font-family","font-feature-settings","font-kerning","font-language-override","font-size-adjust","font-size","font-stretch","font-style","font-synthesis","font-variant-alternates","font-variant-caps","font-variant-east","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variant","font-weight","font","hanging-punctuation","height","hyphens","image-orientation","image-rendering","image-resolution","justify-content","letter-spacing","line-break","line-height","list-style-image","list-style-position","list-style-type","list-style","margin-bottom","margin-left","margin-right","margin-top","margin","marquee-direction","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","object-fit","object-position","opacity","order","overflow-wrap","overflow-x","overflow-y","overflow","padding-bottom","padding-left","padding-right","padding-top","padding","tab-size","table-layout","text-align-last","text-align","text-combine-upright","text-combine-upright","text-decoration-color","text-decoration-line","text-decoration-style","text-decoration","text-indent","text-justify","text-orientation","text-shadow","text-transform","text-underline-position","unicode-bidi","user-select","vertical-align","visibility","white-space","widows","width","word-break","word-spacing","word-wrap","writing-mode"],p=["color","background-color","font-size","margin-left","margin-right"],u={img:["height","width"],video:["height","width"]};var h=i(988137),g=i(794566),f=i(763133);const b="mailto",_=/<br\s*\/?>/g,y=/\n/g;class w{constructor(e,t=!1,i){this.enableStrictMessageSanitization=!1,this.allowedClassNamesRegex=/^[_a-zA-Z0-9-]*$/,this._validUrlRegex=/^(ht|f)tp(s?):\/\//i,this.inlineStylesBlacklistRegex=/(url|attr)\([^)]*\)?/gi,this.defaultAllowedTags=[],this.defaultAllowedAttributes=[],this.addTags=[],this.addAttributes=[],this._allowedSrcProtocols=["data","cid","blob","http","https","ftp","ftps"],this._allowedHrefProtocols=["http","https","mailto","onenote","tel","ftp","ftps","vscode","vscode-insiders","vsls"],this.sanitizeHtml=(e,t,i=!1)=>{if(!e)return e;let a=this.sanitizeHtmlConfig;t?a=this.sanitizeHtmlConfigWithClasses:i&&(a=this.messagePreviewSanitizeHtmlConfig);let s=r()(e,a);if(i){const e=["img","video"];s=this.stripHtml(s,e)}return s},this.sanitizeSkypeMessageContent=(e,t)=>{if(!e)return e;e=t?e.replace(_,"\n"):e.replace(y,"<br/>");const i=t?this.skypeMessagePreviewSanitizeConfig:this.sanitizeSkypeMessageConfig,a=r()(e,i);return t?this.stripHtml(a):a},this.sanitizeHrefUrl=(e,t=!1)=>(0,o.Jf)(e,t?[b]:this._allowedHrefProtocols),this.makeValidUrl=(e,t=!1)=>{const i=t?e.startsWith(`${b}:`)?e:`${b}:${e}`:this._validUrlRegex.test(e)?e:`https://${e}`;return this.sanitizeHrefUrl(i,t).replace(/\s/g,"%20")},this._transformATag=(e,t={})=>(t.href&&(t.href=this.sanitizeHrefUrl(t.href),t.title=this._getIdnSafeTitle(t.href)),{tagName:e,attribs:t=this._addTargetAndRelAttributes(t)}),this._transformAreaTag=(e,t={})=>{if(t.style){const e=t.style.replace(/position\s*:\s*(\\61|a)\s*(\\62|b)\s*(\\73|s)\s*(\\6F|o)\s*(\\6C|l)\s*(\\75|u)\s*(\\74|t)\s*(\\65|e)\s*/gi,"");t.style=e}return{tagName:e,attribs:Object.keys(t).filter((e=>"href"!==e)).reduce(((e,i)=>(e[i]=t[i],e)),{})}},this._transformLineBreakTags=(e,t={})=>({tagName:"div",attribs:{},text:" "}),this._transformImg=(e,t={})=>{const i=t.src||"";if(this.isGiphyImageElement(i))return{tagName:"div",attribs:{},text:"ðŸ“· GIF"};const a=t.alt;if(a){const e=t.itemtype;if(e===h.A.emoji)return{tagName:"div",attribs:{},text:a};if(e===h.A.customEmoji)return{tagName:"div",attribs:{},text:`(${a})`}}return{tagName:e,attribs:t}},this._transformVideoTag=(e,t={})=>{const i=(0,l.bD)(t),{width:a,height:s}=(0,l.wF)(i.width,i.height);return t.width=a.toString(),t.height=s.toString(),delete t.style,(0,n.N7)(t.src)||delete t.src,{tagName:e,attribs:t}},this._transformAllTags=(e,t)=>(t&&t.style&&(t.style=this._sanitizeStyle(e,t.style)),{tagName:e,attribs:t}),this.enableStrictMessageSanitization=t,this.semanticObjectSchemas=Object.values(h.A),this._initCustomData(t,e,i),this.sanitizeHtmlConfig=this._buildSanitizeHtmlConfig(),this.sanitizeSkypeMessageConfig=(0,g.f2)(),this.skypeMessagePreviewSanitizeConfig=(0,g.XU)(),this.messagePreviewSanitizeHtmlConfig=this._buildSanitizeHtmlConfigForMessagePreview(),this.sanitizeHtmlConfigWithClasses=this._getAllowedClassesConfig()}stripHtml(e,t=[],i={}){return e?r()(e,{allowedTags:t,allowedAttributes:i}):e}stripAnchorLinks(e){if(!e)return e;const t=r().defaults.allowedTags,i=t.indexOf("a");return i>-1&&t.splice(i,1),r()(e,{allowedTags:t})}stripAnchorLinksForTFL(e){if(!e)return e;const t=this.sanitizeHtmlConfig?.allowedTags&&this.sanitizeHtmlConfig?.allowedTags.filter((e=>"a"!==e));return r()(e,{...this.sanitizeHtmlConfig,allowedTags:t})}stripAnchorLinksForSkype(e){if(!e)return e;const t=f.P,i={...this.sanitizeSkypeMessageConfig,allowedTags:t};return r()(e,i)}sanitizeHyperlinkProperties(e,t,i=!1){const a=t||e;return e=this.makeValidUrl(e,i),i&&!e.startsWith(`${b}:`)&&(e=`${b}:${e}`),{href:e,title:e,textContent:a}}buildHyperlink(e,t,i="",a=!1){const s=this._buildHyperlinkElement(e,t,a);return this.sanitizeHtml(s+i)}_addTargetAndRelAttributes(e){return(0,a.find)(this.semanticObjectSchemas,(t=>t===e[d.eS.itemtype]))||(e.target="_blank",e.rel="noreferrer noopener"),e}_buildHyperlinkElement(e,t,i=!1){const{href:a,title:s,textContent:r}=this.sanitizeHyperlinkProperties(e,t,i);return`<a href="${a}" title="${s}">${r}</a>`}_getIdnSafeTitle(e){let t=e;if(!e||e.startsWith("/"))return t;const i=(0,o.mH)(void 0,(e=>e),e);return i&&i.hostname&&(i.hostname.startsWith("xn--")||i.hostname.indexOf(".xn--"))&&(t=i.href),t.toLowerCase()}_stripComments(e){let t="code";return(0,a.reduce)(e.split(""),((e,i,a,s)=>{switch(t){case"code":return"/"===i&&"*"===s[a+1]?(t="comment",e):`${e}${i}`;case"comment":return"/"===i&&"*"===s[a-1]&&(t="code"),e}}),"")}_sanitizeStyle(e,t){const i=this._stripComments(t).replace(this.inlineStylesBlacklistRegex,";").split(";").reduce(((t,i)=>{const[a,s]=i.split(":").map((e=>e.trim()));if(this.enableStrictMessageSanitization?p.includes(a)||u[e]?.includes(a):m.includes(a)){const e=this.enableStrictMessageSanitization&&"font-size"===a?this._normalizeOutrangeLargeFontSize(s):s;"font-size"===a&&e.startsWith("0")||t.push(`${a}:${e}`)}return t}),[]);return(0,a.join)(i,";")}_initCustomData(e,t,i){this.defaultAllowedTags=e?c.tO:c.FL,this.defaultAllowedAttributes=d.tv,this.addTags=["URIObject","Title","Swift","Description","ended","partlist","part","name","duration","OriginalName","Identifiers","Id","RecordingContent","item","RecordingStatus","AddCustomApp","DeleteCustomApp","UpgradeCustomAppV2","eventtime","initiator","target","targetName","DeprecatedTargetName","UpdateFavDefault","isDefault","value","consentinvites","friendlynames"],t&&(this.addTags=this.addTags.concat(t)),this.addAttributes=[d._s,"url_thumbnail","b64","identity","uri","v"],i&&(this.addAttributes=this.addAttributes.concat(i))}isGiphyImageElement(e){try{return/(?:^|.*\.)giphy\.com$/.test(new URL(e).hostname)}catch(e){return!1}}_buildSanitizeHtmlConfigForMessagePreview(){const e=this._buildSanitizeHtmlConfig();return e.allowedTags=["div","img","video"],e.allowedStyles={},e.nonTextTags=["blockquote"],e.transformTags={br:this._transformLineBreakTags,img:this._transformImg,video:this._transformVideoTag},e}_buildSanitizeHtmlConfig(){return{allowedTags:this.defaultAllowedTags.concat(this.addTags),allowedAttributes:{"*":this.defaultAllowedAttributes.concat(this.addAttributes)},allowedSchemes:this._allowedHrefProtocols,allowedSchemesByTag:{img:this._allowedSrcProtocols},parser:{lowerCaseTags:!1},nonTextTags:["style","script","textarea","ts-hint"],transformTags:{a:this._transformATag,area:this._transformAreaTag,video:this._transformVideoTag,...this.enableStrictMessageSanitization&&{div:"p"},"*":this._transformAllTags}}}_getAllowedClassesConfig(){const e=this.defaultAllowedTags.reduce(((e,t)=>(e[t]=[this.allowedClassNamesRegex],e)),{});return{...this.sanitizeHtmlConfig,allowedClasses:e}}_normalizeOutrangeLargeFontSize(e){let t=NaN;return e.endsWith("px")?t=parseFloat(e):e.endsWith("pt")?t=parseFloat(e)/.75:e.endsWith("rem")&&(t=10*parseFloat(e)),!isNaN(t)&&t>48?"xxx-large":e}}},988137:(e,t,i)=>{"use strict";var a;i.d(t,{A:()=>a}),function(e){e.mention="http://schema.skype.com/Mention",e.inputExtension="http://schema.skype.com/InputExtension",e.amsVideo="http://schema.skype.com/AMSVideo",e.amsImage="http://schema.skype.com/AMSImage",e.emoji="http://schema.skype.com/Emoji",e.customEmoji="http://schema.skype.com/CustomEmoji",e.live="http://schema.skype.com/Live",e.giphy="http://schema.skype.com/Giphy",e.filesHyperlink="http://schema.skype.com/HyperLink/Files",e.hyperLink="http://schema.skype.com/HyperLink",e.reply="http://schema.skype.com/Reply",e.fluidLink="http://schema.skype.com/FluidLink",e.fluidEmbedLink="http://schema.skype.com/FluidEmbedLink",e.fluidEmbedCard="http://schema.skype.com/FluidEmbedCard",e.fluidAutoEmbedLink="http://schema.skype.com/FluidAutoEmbedLink",e.forward="http://schema.skype.com/Forward",e.cachedImage="http://schema.skype.com/CachedImage",e.scheduledMeetingCreated="http://schema.skype.com/ScheduledMeetingCreated",e.scheduledMeetingUpdated="http://schema.skype.com/ScheduledMeetingUpdated",e.scheduledMeetingCancelled="http://schema.skype.com/ScheduledMeetingCancelled",e.topic="http://schema.skype.com/Topic",e.sticker="http://schema.skype.com/Sticker",e.inlineImageCard="http://schema.skype.com/InlineImageCard",e.inlineImage="http://schema.skype.com/InlineImage",e.virtualEventsPersonalizationToken="http://schema.skype.com/VirtualEventsPersonalizationToken",e.editorCiqFile="http://schema.skype.com/EditorCiqFile",e.editorCiqPeople="http://schema.skype.com/EditorCiqPeople",e.editorCiqMeeting="http://schema.skype.com/EditorCiqMeeting",e.editorCiqEmail="http://schema.skype.com/EditorCiqEmail",e.editorCiqChat="http://schema.skype.com/EditorCiqChat",e.codeBlockEditor="http://schema.skype.com/CodeBlockEditor",e.citation="http://schema.skype.com/Citation"}(a||(a={}))},794566:(e,t,i)=>{"use strict";i.d(t,{cd:()=>n,F1:()=>o,eE:()=>l,xV:()=>d,Zl:()=>m,YN:()=>p,XU:()=>u,f2:()=>h});var a=i(423636),s=i(763133),r=i(511756);const n={skype_message_preview_sent_an_image:"skype_message_preview_sent_an_image",skype_message_preview_sent_a_gif:"skype_message_preview_sent_a_gif",skype_message_preview_sent_an_audio:"skype_message_preview_sent_an_audio",skype_message_preview_sent_a_file:"skype_message_preview_sent_a_file",skype_message_preview_sent_a_video:"skype_message_preview_sent_a_video",skype_message_preview_sent_a_poll:"skype_message_preview_sent_a_poll",skype_message_preview_scheduled_call:"skype_message_preview_scheduled_call",skype_message_preview_sent_a_location:"skype_message_preview_sent_a_location",skype_message_preview_sent_a_contact:"skype_message_preview_sent_a_contact",lobby_chat_everyone_tab_label:"lobby_chat_everyone_tab_label",skype_message_preview_emoji_fallback:"skype_message_preview_emoji_fallback"},o=(e,t={})=>{const i=t.type,s=t.utf||t.alt,r=n.skype_message_preview_emoji_fallback;return s?{tagName:"div",attribs:{},text:s}:i?{tagName:"div",attribs:{},text:(0,a.t)(i)||r}:{tagName:"div",attribs:{},text:r}},l=(e,t={})=>({tagName:"div",attribs:{},text:t?.latitude&&t?.longitude?n.skype_message_preview_sent_a_location:""}),d=(e,t={})=>({tagName:"div",attribs:{},text:n.skype_message_preview_sent_a_contact}),c=(e,t={})=>({tagName:"div",attribs:{},text:" "}),m=(e,t={},i)=>"*"===t?.id||"_*_"===t?.id?{tagName:e,attribs:t,text:n.lobby_chat_everyone_tab_label}:{tagName:e,attribs:t,text:i},p=(e,t={})=>{let i="";switch(t.type?.split("/")[0]){case"Picture.1":case"Sticker.1":i=n.skype_message_preview_sent_an_image;break;case"SWIFT.1":i=n.skype_message_preview_sent_a_gif;break;case"Audio.1":i=n.skype_message_preview_sent_an_audio;break;case"File.1":i=n.skype_message_preview_sent_a_file;break;case"Video.1":i=n.skype_message_preview_sent_a_video;break;case"Poll":i=n.skype_message_preview_sent_a_poll;break;case"ScheduledCallInvite.1":i=n.skype_message_preview_scheduled_call}return{tagName:"div",attribs:{},text:i}};function u(){const e=h();return e.allowedTags=["div","ss","p","URIObject","contacts","location","at","br"],e.allowedStyles={},e.nonTextTags=["quote"],e.transformTags={ss:o,URIObject:p,location:l,contacts:d,at:m,br:c},e}function h(){return{allowedTags:s.o,allowedAttributes:{"*":r.IA},parser:{lowerCaseTags:!1}}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/170709-91f150c6b05a2e69.js.map