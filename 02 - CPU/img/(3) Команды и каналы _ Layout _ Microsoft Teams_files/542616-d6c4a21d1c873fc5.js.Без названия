"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[542616],{875004:(e,t,r)=>{var o;r.d(t,{k:()=>o}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary",e.minimode="minimode",e.immersive="immersive",e.notification="notification"}(o||(o={}))},450850:(e,t,r)=>{var o;r.d(t,{z:()=>o}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(o||(o={}))},533234:(e,t,r)=>{var o,n,i,s;r.d(t,{GM:()=>o,zl:()=>n,bG:()=>s}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(o||(o={})),function(e){e.flyout="flyout",e.main="main",e.minimode="mini",e.notifications="notifications"}(n||(n={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsBlackBoard="BlackBoard",e.lmsCanvas="Canvas",e.lmsMoodle="Moodle",e.lmsBrightspace="Brightspace",e.lmsOther="OtherLMS",e.lmsOpenLMS="OpenLMS",e.lmsSchoology="Schoology",e.unknown="unknown",e.thirdParty="ThirdParty",e.dynamics="Dynamics",e.onePlayer="OnePlayer",e.devHost="DevHost",e.edge="Edge",e.purview="Purview",e.mesh="Mesh"}(i||(i={})),function(e){e.userInitiated="userInitiated"}(s||(s={}))},528008:(e,t,r)=>{r.d(t,{J:()=>o,C:()=>i});var o,n=r(755713);!function(e){e.UnsupportedOS="unsupported_os"}(o||(o={}));class i extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:r,originSlotName:o,originAppId:n,prevError:i,userContextId:s}){super(r),this.type=e,this.code=t,this.originSlotName=o,this.originAppId=n,this.prevError=i,this.userContextId=s;const a=(c=i?.stack??this.stack,c?.split("\n").slice(1)??[]);var c;this.stack=[`${t} Error: ${r}`,...a].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){let e=this.toTelemetryCode(),t=this.prevError;for(;t;)t instanceof i&&i.isFunction(t.toTelemetryEntry)?(e+=t.toTelemetryEntry(),t=void 0):(0,n.C)(t)?(e+=`[IError::${t.code}]`,t=t.innerError??t.reason?.innerError):(e+=`[Error::${t.message}]`,t=void 0);return e}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},683922:(e,t,r)=>{r.d(t,{D:()=>o,a:()=>l});var o,n=r(528008),i=r(265284),s=r(755713);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TAB_DISABLED="TAB_DISABLED",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_LAYOUT_SERVICE_MISSING_FOR_WINDOW_ID="WINDOW_LAYOUT_SERVICE_MISSING_FOR_WINDOW_ID",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED",e.REDUCED_CAPABILITIES_CHATS="REDUCED_CAPABILITIES_CHATS",e.REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS="REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS",e.REDUCED_CAPABILITIES_COMMUNITIES="REDUCED_CAPABILITIES_COMMUNITIES",e.MAGLEV_UPDATE_REQUIRED_WIN="MAGLEV_UPDATE_REQUIRED_WIN",e.MAGLEV_UPDATE_REQUIRED_WIN_VDI="MAGLEV_UPDATE_REQUIRED_WIN_VDI",e.MAGLEV_UPDATE_REQUIRED_MAC="MAGLEV_UPDATE_REQUIRED_MAC",e.UNSUPPORTED_OS_VERSION_WIN="UNSUPPORTED_OS_VERSION_WIN",e.UNSUPPORTED_OS_VERSION_MAC="UNSUPPORTED_OS_VERSION_MAC",e.PERSISTED_APP_CONTENT_ID_MISSING="PERSISTED_APP_CONTENT_ID_MISSING",e.PERSISTED_APP_CONTENT_NOT_FOUND="PERSISTED_APP_CONTENT_NOT_FOUND",e.PERSISTED_APP_CONTENT_IS_NULL="PERSISTED_APP_CONTENT_IS_NULL",e.PERSISTED_APP_CONTENT_INVALID_PROPS="PERSISTED_APP_CONTENT_INVALID_PROPS"}(o||(o={}));const a={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TAB_DISABLED:"Youâ€™ve reached the limit of open tabs running Teams.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker",REDUCED_CAPABILITIES_CHATS:"Chats are temporarily unavailable. You should still be able to use other parts of Teams.",REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS:"Teams and channels are temporarily unavailable. You should still be able to use other parts of Teams.",REDUCED_CAPABILITIES_COMMUNITIES:"Communities are temporarily unavailable. You should still be able to use other parts of Teams.",MAGLEV_UPDATE_REQUIRED_WIN:"You are using an old version of Teams. Update Teams for a secure and reliable experience.",MAGLEV_UPDATE_REQUIRED_MAC:"You are using an old version of Teams. Update Teams for a secure and reliable experience.",UNSUPPORTED_OS_VERSION_WIN:"Teams is no longer supported on this version of OS. Update your OS, or contact your IT department. For now, you could try using Teams on the web.",UNSUPPORTED_OS_VERSION_MAC:"Teams is no longer supported on this version of OS. Update your OS, or contact your IT department. For now, you could try using Teams on the web."},c={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:i.I.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:i.I.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:["RESTART","SIGN_OUT"]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},TAB_DISABLED:{title:"default_tab_disabled_title",description:"default_tab_disabled_description",actions:["RESTART"],icon:i.I.FullNoSpace,hideDownloadLogs:!0,hideDetailsOnErrorPage:!0,showDownloadDesktopApp:!0},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},REDUCED_CAPABILITIES_CHATS:{title:"reduced_capabilities_chats_error_title",description:"reduced_capabilities_chats_error_description",hideDownloadLogs:!0,icon:i.I.ReducedCapabilities,actions:[]},REDUCED_CAPABILITIES_TEAMS_AND_CHANNELS:{title:"reduced_capabilities_teams_and_channels_error_title",description:"reduced_capabilities_teams_and_channels_error_description",hideDownloadLogs:!0,icon:i.I.ReducedCapabilities,actions:[]},REDUCED_CAPABILITIES_COMMUNITIES:{title:"reduced_capabilities_communities_error_title",description:"reduced_capabilities_communities_error_description",hideDownloadLogs:!0,icon:i.I.ReducedCapabilities,actions:[]},MAGLEV_UPDATE_REQUIRED_WIN:{title:"desktopapp_update_requried_page_title",description:"desktopapp_update_requried_page_description",hideDownloadLogs:!0,icon:i.I.AppUpdateRequired,actions:["DOWNLOAD_AND_REINSTALL_WIN"],showUseWebApp:!0,hideDetailsOnErrorPage:!0},MAGLEV_UPDATE_REQUIRED_WIN_VDI:{title:"desktopapp_update_requried_page_title",description:"desktopapp_update_requried_page_description",hideDownloadLogs:!0,icon:i.I.AppUpdateRequired,showUseWebApp:!0,hideDetailsOnErrorPage:!0},MAGLEV_UPDATE_REQUIRED_MAC:{title:"desktopapp_update_requried_page_title",description:"desktopapp_update_requried_page_description",hideDownloadLogs:!0,icon:i.I.AppUpdateRequired,actions:["DOWNLOAD_AND_REINSTALL_MAC"],showUseWebApp:!0,hideDetailsOnErrorPage:!0},UNSUPPORTED_OS_VERSION_WIN:{title:"unsupported_os_blocking_page_title_win",description:"unsupported_os_blocking_page_description_win",hideDownloadLogs:!0,icon:i.I.UnsupportedOs,actions:["USE_TEAMS_ON_WEB"],linkText:"unsupported_os_blocking_page_view_minimum_requirements",linkType:n.J.UnsupportedOS},UNSUPPORTED_OS_VERSION_MAC:{title:"unsupported_os_blocking_page_title_mac",description:"unsupported_os_blocking_page_description_mac",hideDownloadLogs:!0,icon:i.I.UnsupportedOs,actions:["USE_TEAMS_ON_WEB"],linkText:"unsupported_os_blocking_page_view_minimum_requirements",linkType:n.J.UnsupportedOS}};class l extends n.C{constructor(e,t,r,o){super({type:"CoreError",code:e,message:a[e]??((0,s.C)(t)?t.innerError?.message??t.reason?.innerError?.message:t?.message),originSlotName:o,prevError:t,userContextId:r})}getBoundaryProps(){return c[this.code]??{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==e?.type)return null;const t=new l(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},642127:(e,t,r)=>{r.d(t,{a:()=>n});var o=r(528008);class n extends o.C{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},265284:(e,t,r)=>{var o;r.d(t,{I:()=>o,t:()=>n}),function(e){e.DefaultDark="defaultDark",e.Default="default",e.FullNoSpace="fullNoSpace",e.NoLongerAllowed="noLongerAllowed",e.ReducedCapabilities="reducedCapabilities",e.UnsupportedOs="unsupportedOs",e.AppUpdateRequired="appUpdateRequired"}(o||(o={}));const n={[o.DefaultDark]:"/evergreen-assets/illustrations/error/something-went-wrong-v2-dark.svg",[o.Default]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[o.FullNoSpace]:"/evergreen-assets/illustrations/error/full-no-space.svg  ",[o.NoLongerAllowed]:"/evergreen-assets/illustrations/error/license-error-no-longer-allowed-hero.svg",[o.ReducedCapabilities]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[o.UnsupportedOs]:"/evergreen-assets/illustrations/error/webpage-authentication.svg",[o.AppUpdateRequired]:"/evergreen-assets/illustrations/error/webpage-authentication.svg"}},755713:(e,t,r)=>{function o(e){return!(!e||"object"!=typeof e)&&("code"in e&&"string"==typeof e.code)}r.d(t,{C:()=>o})},870798:(e,t,r)=>{r.d(t,{o:()=>h});var o=r(911293);var n=r(743659);class i{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,r=t.get(e);if(r)return r;const o=new n.B;return t.set(e,o),o},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,r=this.observableCache.get(t);r&&r.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const s="multi-window-manager-channel";var a=r(931328),c=r(853116),l=r(480354);const d=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function u(e,t){return t.some((t=>{if(t.startsWith("regex:")){const r=t.replace("regex:","");return new RegExp(r).test(e)}return t===e}))}function _(e){return"null"!==e&&d.test(new URL(e).origin)}const p=(e,t,r,o)=>{const n=a.c.create((n=>{e.addEventListener("message",(e=>{const{eventId:i,channel:a}=e.data;e&&i&&a===s&&function(e,t,r){const o=r.newLogger("PostMessage origin validation","services-io-browser-shell-message-passing-browser"),n=e.origin;return t?!("*"!==t&&!_(n)&&((0,l.isArray)(t)?0===t.length?(o.errorToTelemetry?.(`PostMessage is disabled for this experience. (case 5) ${n}`,"core_origin_validation_failed",void 0,!0),1):!u(n,t)&&(o.errorToTelemetry?.(`Event origin is not in allow-list. Event was dropped. (case 4) ${n}`,"core_origin_validation_failed",void 0,!0),1):(o.errorToTelemetry?.(`Could not match the event origin. Event was dropped. (case 6) ${n}`,"core_origin_validation_failed",void 0,!0),1))):(o.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,r.postMessageConfig,o)&&(t.debug("Incoming message from post messages"),n.next(e.data))}))})).pipe((0,c.u)());return n};class h{constructor(e,t,r,n){this.opt=n,this.postMessage=e=>{if((0,l.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void this.logger.errorToTelemetry?.("postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0);this.logger.log("Sending targeted message to host browser only");const t=null!==e.payload&&"object"==typeof e.payload?{...e.payload}:{payload:e.payload};this.windowReference.parent.postMessage({channel:s,payload:{...t,channel:e.channel}},((e,t,r)=>{const o=new URL(e.location.href).origin;let n;if(!t||"*"===t)return"*";if(e.document.referrer)try{n=new URL(e.document.referrer).origin}catch(t){r.error(`Invalid referrer: ${e.document.referrer}`)}return!n&&t.includes("null")?"*":n?n===o||_(n)||u(n,t)?n:(r.error(`Invalid target origin (${n}). Source origin (${o}) was returned as target origin.`),o):(r.log(`Could not determine target origin. Falling back to source origin: ${o}`),o)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,o.T)((e=>(e=>({channel:e.metaData.destination.channel,payload:"object"==typeof e.payload?{correlationId:e.metaData.correlationId,...e.payload}:e.payload}))(e)))),this.createShellChannelCache=(e,t,r,o)=>{t.debug("Creating Shell Channel cache");const n=p(e,t,r,o);return new i(n,t)},this.logger=r.newLogger("RndrShComm","services-io-browser-shell-message-passing-browser"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,r)}}},850098:(e,t,r)=>{r.d(t,{y:()=>A});var o=r(450850),n=r(533234),i=r(875004),s=r(845097),a=r(912435),c=r(183111);class l{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const r={eventId:e,payload:t,correlationId:(0,s.v4)()};this.shellComms.postMessage(r)}requestMessage(e,t,r=this.defaultRequestTimeoutMs){let o;const n=(0,s.v4)(),i=(t?.timeout||r)+this.bufferInTimeout;return new Promise(((r,s)=>{const l=t=>{this.globalWindow.clearTimeout(o),t&&!t.error?r(t.payload):s((0,a.$5)(c.Ir.ShellService,c.O4.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:n},"Received an error from IPC"))};o=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,l),s((0,a.$5)(c.Ir.ShellService,c.O4.TimedOut,"requestMessage",{eventName:e,correlationId:n}))}),i),this.shellComms.once(e,l,n);const d={eventId:e,correlationId:n,payload:t};this.shellComms.postMessage(d)}))}addEventListener(e,t,r){r&&r.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,r){const o={openType:e,openHandler:t,handlerParams:r};this.postMessage("requestShellToOpen",o)}}class d{constructor(e,t,r){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:o,isInIframe:s}=r;let a=n.GM.standAlone;if(this.viewportContext=i.k.primary,s&&!o)a=n.GM.iframe,this.viewportContext=i.k.iFrame;else if(null!==this._globalWindow.opener)try{this._globalWindow.opener.location?.host===this._globalWindow.location.host&&(a=n.GM.secondary,this.viewportContext=i.k.secondary)}catch(e){a=n.GM.standAlone,this.viewportContext=i.k.primary}this._hostedWindowContext={...r,panelContext:a,startReason:n.bG.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__},this.opener=new l(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var u=r(305119),_=r(870798);const p="main_process";var h=r(911293),g=r(654290);class E{constructor(e,t,r){if(3!==arguments.length||e.trim().length<=0)throw(0,a.$5)("Invalid constructor arguments",c.O4.InvalidInput,typeof E);this.logger=r,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const r=this.metaData,o=this.messagePassingService,n=t&&t.length>0?t:this.messagePassingService.processId!==p?[p]:["main_renderer"],i={channel:r.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(n)}.`),o.postMessage(i,n)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,h.T)((e=>e.payload)),(0,g.M)((()=>{this.logger.debug("Handling stream event.")})))}}class m{constructor(e,t){if(this.getStream=e=>new E(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`,"services-io-browser-shell-communication-provider")),!e||!t)throw(0,a.$5)(`sc: ${e}, lf: ${t}`,c.O4.Undefined,typeof m);this.messagePassingService=e,this.loggerFactory=t}}var I=r(743659),w=r(660548),S=r(59650),C=r(787313);class f{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,a.$5)(c.Ir.ShellService,c.O4.Undefined,"constructor");const r={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},o={newLogger:()=>r},n=new _.o("browserWindow",this.windowReference,o,this.opt);this.shellComms=new m(n,o),this.subscriptionManager=new I.B}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,r=""){this.createSubscription(e,t,!1,r)}once(e,t,r=""){this.createSubscription(e,t,!0,r)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,r,o){const n=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{const t=e?.correlationId||e?.payload?.correlationId;return!e||!t||t===o}))),i=this.registerForUnsubscription(e,t);(r?n.pipe((0,w.s)(1),(0,S.Q)(i)):n.pipe((0,S.Q)(i))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,a.$5)(c.Ir.ShellService,c.O4.RemoteOperationFailed,"createSubscription",{errorMsg:(0,a.BA)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((r=>r.channel===e&&(void 0===r.listener||r.listener===t))))}filterWrapper(e){return(0,C.p)(e)}}class R{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,r=this.createShellCommService(this.globalWindow,this.opt),o=new d(this.globalWindow,r,e);return{hostedWindowContext:o.getHostedWindowContext(),window:(0,u.rz)(t,o,!1)}}createShellCommService(e,t){return new f(e,t)}}class T{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:v(this.windowEnvironment),isInIframe:b(this.windowEnvironment)};return new R(this.windowEnvironment,e).configureShell(t)}}function v(e){try{let t=!!e.Cypress;if(!t){const r=e.top||e.parent;t=!!r?.Cypress}return t}catch(e){return!1}}function b(e){try{return e.self!==e.top}catch(e){return!0}}class A{constructor(){this._opt={};const e=new T(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(o.z.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return A.instance||(A.instance=new A),A.instance}get window(){return this.config.window}}},305119:(e,t,r)=>{r.d(t,{$6:()=>R,Q7:()=>C,W3:()=>w,rz:()=>I});var o=r(401368),n=r(242340),i=r(875004),s=r(683922);function a(e){return e.ResizeObserver?e.ResizeObserver:function(t){const r=new Map;let o,n=!1;function i(){if(n||!r.size)return void(o=void 0);const s=[];r.forEach(((e,t)=>{const o=t.getBoundingClientRect();e.height!==o.height&&(r.set(t,o),s.push({target:t,contentRect:o,borderBoxSize:[{inlineSize:o.width,blockSize:o.height}],contentBoxSize:[{inlineSize:o.width,blockSize:o.height}],devicePixelContentBoxSize:[]}))})),s.length&&t(s),o=e.requestAnimationFrame(i)}return{observe(t){r.has(t)||(r.set(t,t.getBoundingClientRect()),o||(o=e.requestAnimationFrame(i)))},unobserve(e){r.has(e)&&r.delete(e)},disconnect(){r.clear(),o=void 0,n=!0}}}}var c=r(642127),l=r(393988);class d{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,l.Z)(((e,t)=>new Promise(((r,o)=>{if(!e)return r();const n=this._document.createElement("script");if(n.onload=()=>r(),n.onerror=o,n.async=!0,n.id=`${t}-script`,n.charset="utf-8",!this._coreSecurityService)throw new c.a("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,n.baseURI);n.src=t}catch(e){throw e}this._document.body.appendChild(n)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,l.Z)(((e,t)=>new Promise(((r,o)=>{if(!e)return r();const n=this._document.createElement("link");n.onload=()=>r(),n.onerror=o,n.type="text/css",n.rel="stylesheet",n.id=`${t}-style`,n.charset="utf-8",n.href=e,this._document.head.appendChild(n)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=async(e,t=!1)=>{if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const r=e.reduce(((e,r)=>{const o=this._chunkConfig&&this._chunkConfig[r];if(!o)return e.push(Promise.reject(new Error(`No chunk information found for ${o}.`))),e;const n=o.endsWith(".css")?this._loadStyle:this._loadScript,i=this._loadedItems.get(o)||n(o,r).catch((e=>{throw t&&this._loadedItems.delete(o),e}));return this._loadedItems.has(o)||this._loadedItems.set(o,i),e.push(i),e}),[]);await Promise.all(r)}}configureCoreSecurityService(e){if(this._coreSecurityService)throw new c.a("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}var u=r(415171),_=r(844462),p=r(888591),h=r(607401);const g=(e,t,r)=>{const{coreSettings:n}=r;if(n.get(o.w.Core,["enableHostFullscreenSubscription"]).enableHostFullscreenSubscription)return t.pipe((0,p.F)());const i=e,s=new u.t(E(i)),a=new i.ResizeObserver((()=>{i.requestAnimationFrame((()=>{s.next(E(i))}))}));return a.observe(i.document.documentElement),s.pipe((0,h.j)((()=>a.disconnect())),(0,p.F)())},E=e=>!!(e.matchMedia("(display-mode: fullscreen)").matches||e.document.fullscreenElement||e.document.mozFullScreenElement||e.document.webkitFullscreenElement);class m{constructor(e){this.isEnabled=!1,e.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),this.installEvent=e,this.installEvent?.prompt&&(this.isEnabled=!0)}))}prompt(){this.installEvent?.prompt?.()}}const I=(e,t,r)=>{let o;try{o={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,get caches(){return e.caches},crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:a(e),WeakRef:e.WeakRef,chunkLoader:new d(e.document,e.__experienceWindowChunks__),screen:e.screen?.orientation?e.screen:{...e.screen,orientation:{type:"landscape-primary"}},viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),getLoadingWindow:e.loader?.getLoadingWindow&&e.loader.getLoadingWindow.bind(e.loader),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),scheduler:e.scheduler,setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:e.onpagehide?.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,pwaInstallTrigger:f(e)?void 0:new m(e),proxyPostMessage:(t,r,o,n)=>{e.proxyPostMessage&&e.proxyPostMessage(t,r,o,n)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>e.navigator?.mediaDevices?.getUserMedia?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available")),enumerateDevices:()=>t.navigator?.mediaDevices?.enumerateDevices?t.navigator.mediaDevices.enumerateDevices():Promise.reject(new Error("Not available")),AudioContext:e.AudioContext,handleGlobalWindowError:e.handleGlobalWindowError?.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get SlimCore(){return e.SlimCore},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,r=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!r)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new u.t(!1),unsubscribeFullscreenEvents:()=>{},exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>e.clearCache?.(),getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:e.zoomFactors??_.w,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve(),updateWindowLeakInfo:t=>{e.windowLeakInfo&&(e.windowLeakInfo.windowLeakInfoEntityType=t),o.windowLeakInfo&&(o.windowLeakInfo.windowLeakInfoEntityType=t)},destroy:async n=>(o.unsubscribeFullscreenEvents?.(),r?new Promise(((r,i)=>{const s=t.setTimeout((()=>{try{t.clearTimeout(s);for(const e of Reflect.ownKeys(o)){if("windowLeakInfo"===e||"isDestroyed"===e)continue;let t,r=!1;try{r="function"==typeof o[e]}catch(e){}delete o[e];const n=(...r)=>{try{t=r.map((e=>`${e}`)).join(", ")}catch(e){}t&&(t=` with args: (${t})`);const o=new Error(`wrapWindow: Accessing window.${e} after destroy${t}`);throw o.message=`${o.message} at\n${o.stack}`,o};Reflect.defineProperty(o,e,{get:r?()=>n:n,set:n})}e.document.documentElement.innerText="",r()}catch(e){i(e)}finally{e=void 0,t=void 0,o.isDestroyed=!0}}),n+1)})):void 0),isDestroyed:!1}}catch(e){throw new s.a(s.D.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||t?.getHostedWindowContext()?.__webpack_public_path__||""}ckeditor/4.15.1-msft-11/`||"";const n=new Proxy(o,{deleteProperty:(t,r)=>delete e[r]});return o.__lpcWindowProxy=n,o};function w(e,t,r,n,i){const{coreSecurityService:s,hostCommunicationService:a,windowProvider:c,coreSettings:l,loggerFactory:_}=t,p=e,{enableDisconnectWindowWrapper:h,enableHostFullscreenSubscription:E}=l.get(o.w.Core),m=_.newLogger("WindowUtilities","services-io-browser-shell"),w=I(p,c,h??!1),f=C(n,i),R=new d(p.document,c.__experienceWindowChunks__);let T,v;R.configureCoreSecurityService(s);const b={chunkLoader:R,parent:c,viewportContext:f,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>S("exitFullscreen",e,m),focus:()=>S("focus",e,m),maximize:()=>S("maximize",e,m),minimize:()=>S("minimize",e,m),requestFullscreen:()=>S("requestFullscreen",e,m),windowTitleDblClick:()=>S("windowTitleDblClick",e,m),onFullscreen:()=>(T||(T=new u.t(!1),E&&a.loadModule("windowcontrols").then((e=>{m.log(`Subscribing to hostComms fullscreen events for window: ${r}`),v=e?.registerForWindowFullScreenChanged?.((e=>{e.windowId===r&&T?.next(e.fullscreen)}))}))),g(e,T,t)),unsubscribeFullscreenEvents:()=>v?.()};return Object.assign(w,b)}function S(e,t,r){r.log(`Performing action ${e}`);const o=t;switch(e){case"exitFullscreen":o.document.exitFullscreen().catch((t=>{r.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":o.document.documentElement.requestFullscreen().catch((t=>{r.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{o[e]()}catch(t){r.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}function C(e,t,r=!1){let o;if(e)switch(t){case n.Rm.minimal:o=i.k.flyout;break;case n.Rm.minimode:o=i.k.minimode;break;default:o=i.k.primary}else if(r)o=i.k.notification;else if(t===n.Rm.immersive)o=i.k.immersive;else o=i.k.secondary;return o}const f=e=>{const t=e.loader?.getProperties();return!!t?.isMaglev};function R(e,t){const{heightToWidthRatio:r,minHeight:o=0,minWidth:n=0,widthToScreenWidthRatio:i}=t||{};if(!e||!r||!i)return{};const s=i*e.screen.availWidth;return{height:Math.max(s*r,o),width:Math.max(s,n)}}},825429:(e,t,r)=>{r.d(t,{z:()=>n});var o=r(850098);function n(){return o.y.getInstance().window}},393988:(e,t,r)=>{r.d(t,{L:()=>c,Z:()=>l});var o=r(642127),n=r(768490),i=r(912435),s=r(183111),a=r(45685);const c=(e,t)=>async(...r)=>{for(;;)try{return await e(...r)}catch(e){await t(e,...r)}},l=(e,t)=>{const{maxRetries:r,retryWindow:c,backoffTime:l,shouldRetry:d}=t,u=e=>c-(Date.now()-e);return async(...t)=>{const c=Date.now();let _=0,p=u(c);for(;_++<=r&&p>0;)try{return await Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof o.a)throw e;const t=await(0,n.Fg)(e);if(d&&!d(t)&&!d(e))throw t?(0,i.$5)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,i.$5)("RetryWithBackoff",s.O4.MaxLimitReached,"elapsed",e.message,`All retries elapsed or retryWindow expired, RetryCount: ${_}, RemainingTime: ${p}`);if(_>=r||u(c)<=0)break;await(0,a.y)(l),p=u(c)}throw(0,i.$5)("RetryWithBackoff",s.O4.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${_}, RemainingTime: ${p}`)}}},768490:(e,t,r)=>{r.d(t,{qD:()=>i,b_:()=>s,oz:()=>a,b4:()=>c,Fg:()=>l});var o=r(183111),n=r(912435);const i=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,n.J4)(t[0].originalError,o.Ir.Apollo,o.O4.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},s=e=>{const t=e.graphQLErrors?.[0]?.extensions;return t?!t.prevError||"UNKNOWN"!==t.code&&"NONE"!==t.code?(0,n.J4)(new Error(e.graphQLErrors[0].message),t.context,t.code,t.subContext,t.reason):(0,n.J4)(new Error(e.graphQLErrors[0].message),t.prevError.context,t.prevError.code,t.prevError.subContext,t.prevError.reason):null},a=e=>{const t=c(e);return!!t&&!(!(0,n.WZ)(t)&&!(0,n.ej)(t.reason,t.context))},c=e=>e?.graphQLErrors?.[0]?.extensions?.prevError,l=async e=>{if(!e)return null;let t=null;const{graphQLErrors:r,networkError:i}=e;return i&&(t=d(i)),!t&&r&&r.length>0&&r[0].originalError&&(t=await(async e=>{let t=null;try{if(t=e.originalError,!t?.serverResponse?.body)return t;const r=t?.serverResponse?.status,o=await(t?.serverResponse?.body.json());if(!h(o))return t;t.reason={status:r,errorCode:o.errorCode,errorSubCode:o.errorSubCode}}catch(e){}return t})(r[0])),t||(t=r&&r.length>0&&r[0]&&r[0].originalError?(0,n.J4)(r[0].originalError,o.Ir.Apollo,o.O4.ApolloError,"getOriginalError",{status:r[0].originalError.code}):null),t},d=e=>{let t=null;try{const r=JSON.parse(e.message);if(r){const o=JSON.parse(r.message);if(o){const r=JSON.parse(o.reason);r&&(t={...e,reason:{status:p(r)?r.status:void 0,errorCode:h(r)?r.errorCode:void 0}})}}}catch(r){t=u(e)}return t},u=e=>{if(!e.serverResponse)return null;const t={...e?.reason};return(0,n.$5)(e.context,e.code,e.subContext?e.subContext:"",{status:e.serverResponse.status,errorCode:t.errorCode??void 0,reason:e.reason,...t},e.message,e.serverResponse)},_=e=>"number"==typeof e,p=e=>!!e&&void 0!==e.status&&_(e.status),h=e=>!!e&&void 0!==e.errorCode&&_(e.errorCode)},596164:(e,t,r)=>{r.d(t,{U:()=>i});var o=r(513432),n=r(879749);const i=e=>{const{loggerFactory:t}=(0,n.ur)();return o.useMemo((()=>t.newLogger(e,"components-core-context")),[t,e])}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/542616-d6c4a21d1c873fc5.js.map