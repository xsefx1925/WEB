(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[429658],{366749:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});var a=n(700331);class i{constructor(e,t){this.value=e,this.piiKind=t}static isPIIValue(e){return!!e&&"string"!=typeof e&&void 0!==e.scrub}scrub(){return(0,a.sha256)(JSON.stringify(this.value))}}},16945:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var a=n(183111);function i(e){if(!e||"object"!=typeof e)return!1;if("RegionGtmNotFoundInRespone"===e.errorCode)return!0;const t=e;return t.code===a.O4.InvalidResponse&&"Discover"===t.context&&"regionGtm"===t.subContext}},93314:(e,t,n)=>{"use strict";n.d(t,{YE:()=>i,o4:()=>r,Hs:()=>o,NO:()=>s,nt:()=>d,__:()=>c,bD:()=>l,bc:()=>u,DG:()=>p});var a=n(692753);class i{static GetBytes(e){for(var t=[],n=0;n<e.length;++n){var a=e.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|63&a):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|63&a):(a=65536+((1023&a)<<10|1023&e.charCodeAt(++n)),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a))}return t}}class r{static GetString(e){var t,n,a,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],s=e.length%3;for(t=0,a=e.length-s;t<a;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push([r.charAt((i=n)>>18&63),r.charAt(i>>12&63),r.charAt(i>>6&63),r.charAt(63&i)].join(""));switch(s){case 1:n=e[e.length-1],o.push(r.charAt(n>>2)),o.push(r.charAt(n<<4&63)),o.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],o.push(r.charAt(n>>10)),o.push(r.charAt(n>>4&63)),o.push(r.charAt(n<<2&63)),o.push("=")}return o.join("")}}class o{static GetBytes(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t}}class s{static GetBytes(e){for(var t=e.low,n=e.high,a=[];n||4294967168&t;)a.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return a.push(127&t),a}}class d{static GetBytes(e){if(a.Aw.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(4));t.setFloat32(0,e,!0);for(var n=[],i=0;i<4;++i)n.push(t.getUint8(i));return n}return h.ConvertNumberToArray(e,!1)}}class c{static GetBytes(e){if(a.Aw.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],i=0;i<8;++i)n.push(t.getUint8(i));return n}return h.ConvertNumberToArray(e,!0)}}class l{static EncodeZigzag16(e){return(e=a.wN.ToInt16(e))<<1^e>>15}static EncodeZigzag32(e){return(e=a.wN.ToInt32(e))<<1^e>>31}static EncodeZigzag64(e){var t=e.low,n=e.high,i=n<<1|t>>>31,r=t<<1;2147483648&n&&(i=~i,r=~r);var o=new a.DA("0");return o.low=r,o.high=i,o}}class u{static GetString(e){for(var t=[],n=0;n<e.length;++n){var a=e[n];if(a<=191)t.push(String.fromCharCode(a));else if(a<=223){var i=e[++n];t.push(String.fromCharCode((31&a)<<6|63&i))}else if(a<=239){i=e[++n];var r=e[++n];t.push(String.fromCharCode((15&a)<<12|(63&i)<<6|63&r))}else{a=(7&a)<<18|(63&(i=e[++n]))<<12|(63&(r=e[++n]))<<6|63&e[++n],a-=65536,t.push(String.fromCharCode(55296|a>>10&1023)),t.push(String.fromCharCode(56320|1023&a))}}return t.join("")}}class p{static GetBytes(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],a=0;a<e.length;++a){var i=t.indexOf(e.charAt(a++)),r=t.indexOf(e.charAt(a++)),o=t.indexOf(e.charAt(a++)),s=t.indexOf(e.charAt(a));n.push(i<<2|r>>4),o>=0&&(n.push(r<<4&240|o>>2),s>=0&&n.push(o<<6&192|s))}return n}}class h{static ConvertNumberToArray(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,a=(1<<(t?11:8)-1)-1,i=1-a,r=a,o=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),d=e-s,c=2*(a+2)+n,l=new Array(c),u=0;u<c;)l[u++]=0;for(u=a+2;u&&s;)l[--u]=s%2,s=Math.floor(s/2);for(u=a+1;u<c-1&&d>0;)(d*=2)>=1?(l[++u]=1,--d):l[++u]=0;for(var p=0;p<c&&!l[p];++p);var h=a+1-p,m=p+n;if(l[m+1]){for(u=m;u>p&&!(l[u]=1-l[u]);--u);u==p&&++h}if(h>r||s)return o?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(h<i)return t?this._doubleZero:this._floatZero;if(t){var g=0;for(u=0;u<20;++u)g=g<<1|l[++p];for(var f=0;u<52;++u)f=f<<1|l[++p];return[255&f,f>>8&255,f>>16&255,f>>>24,255&(g=o<<31|2147483647&(g|=h+a<<20)),g>>8&255,g>>16&255,g>>>24]}var y=0;for(u=0;u<23;++u)y=y<<1|l[++p];return[255&(y=o<<31|2147483647&(y|=h+a<<23)),y>>8&255,y>>16&255,y>>>24]}static ConvertArrayToNumber(e,t){var n=(1<<(t?11:8)-1)-1,i=0!=(128&e[t?7:3]),r=t?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==r)throw new a.WJ("Not a valid float/double buffer.");var o=1,s=1;if(t){var d=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,c=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!r&&!d&&!c)return 0;for(var l=0;l<20;++l)s/=2,d<0&&(o+=s),d<<=1;for(l=0;l<32;++l)s/=2,c<0&&(o+=s),c<<=1}else{var u=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!r&&!u)return 0;for(l=0;l<23;++l)s/=2,u<0&&(o+=s),u<<=1}return o*=Math.pow(2,r-n),i?0-o:o}}h._floatZero=[0,0,0,0],h._doubleZero=[0,0,0,0,0,0,0,0],h._floatInifinity=[0,0,128,127],h._floatNegInifinity=[0,0,128,255],h._doubleInifinity=[0,0,0,0,0,0,240,127],h._doubleNegInifinity=[0,0,0,0,0,0,240,255]},844113:(e,t,n)=>{"use strict";var a;n.d(t,{b:()=>a}),function(e){e.Chat="chat",e.Community="community",e.EngageCommunity="engagecommunity",e.Meeting="meeting",e.OneOnOne="1on1",e.PhoneChat="phonechat",e.Phonelink1on1Chat="phonelink1on1chat",e.PhonelinkGroupChat="phonelinkgroupchat",e.SfbInteropChat="sfbinteropchat",e.Team="space",e.Topic="topic",e.StreamOfNotifications="streamofnotifications",e.StreamOfCalllogs="streamofcalllogs",e.StreamOfSharedCalllogs="streamofsharedcalllogs",e.StreamOfBookmarks="streamofbookmarks",e.StreamOfNotes="streamofnotes",e.StreamOfDrafts="streamofdrafts",e.StreamOfAnnotations="streamofannotations",e.SubCommunity="subcommunity"}(a||(a={}))},259521:(e,t,n)=>{"use strict";var a;n.d(t,{gN:()=>a,Bd:()=>i,Es:()=>r,e9:()=>o,W0:()=>s,Ih:()=>d,br:()=>c,XD:()=>l,fE:()=>u,qc:()=>p,If:()=>h,Sq:()=>m,cA:()=>g,ar:()=>f,Ne:()=>y,Bh:()=>S,JP:()=>C,PD:()=>T,js:()=>v,j6:()=>b,sU:()=>A,uM:()=>M,Nk:()=>I,xW:()=>U,s8:()=>P,L:()=>w,SE:()=>R,FG:()=>N,O:()=>D,gI:()=>k,m2:()=>F,_I:()=>L,QX:()=>E,zl:()=>x,Fq:()=>B,pK:()=>O,LH:()=>W,bY:()=>H,hh:()=>G,OE:()=>_,OU:()=>V,kG:()=>$,Vb:()=>z,lo:()=>j,K:()=>J,v:()=>q,wx:()=>Q,vf:()=>X,LE:()=>Y,zD:()=>Z,OD:()=>K,m8:()=>ee,Wg:()=>te,jQ:()=>ne,$H:()=>ae,w5:()=>ie,AP:()=>re,J3:()=>oe,xF:()=>se,mH:()=>de,kv:()=>ce,nd:()=>le,og:()=>ue,z3:()=>pe,VP:()=>he,OH:()=>me,b6:()=>ge,wf:()=>fe,r3:()=>ye,lC:()=>Se,_b:()=>Ce,wX:()=>Te,SF:()=>ve,Cl:()=>be,I8:()=>Ae,WY:()=>Me,u2:()=>Ie,gD:()=>Ue,pM:()=>Pe,fw:()=>we,yP:()=>Re,Z:()=>Ne,hB:()=>De,wP:()=>ke,z7:()=>Fe,Vy:()=>Le,j5:()=>xe,yp:()=>Oe,SG:()=>We,Vn:()=>He,h4:()=>Ge,cB:()=>_e,xv:()=>Ve,ae:()=>$e,Vg:()=>ze,Y3:()=>je,CI:()=>Je,SU:()=>qe,xr:()=>Qe,Si:()=>Xe,CT:()=>Ye,S0:()=>Ze,kA:()=>Ke,xi:()=>et,Rq:()=>tt,Ux:()=>nt,_7:()=>at,Th:()=>it,v3:()=>rt,Al:()=>ot,te:()=>st,ji:()=>dt,L5:()=>ct,eg:()=>lt,iB:()=>ut,hd:()=>pt,iy:()=>ht,rH:()=>mt,q4:()=>gt,Cr:()=>ft,Wf:()=>yt,$y:()=>St,YH:()=>Ct,H0:()=>Tt,L6:()=>vt,UO:()=>bt,Go:()=>At,KA:()=>Mt,St:()=>It,rF:()=>Ut,Bx:()=>Pt,ds:()=>wt,mz:()=>Nt,bA:()=>Dt,pi:()=>kt,o1:()=>Ft,B6:()=>Lt,O9:()=>Et,nu:()=>xt,XR:()=>Bt,uN:()=>Ot,_m:()=>Wt,QK:()=>Ht,QT:()=>Gt,_M:()=>_t,vU:()=>Vt,Ol:()=>$t,G2:()=>zt}),function(e){e.SkypeSpacesThread="19:",e.PrivateFeed="48:",e.SkypeSpacesUser="8:",e.Lync="2:",e.Pstn="4:",e.BotPrefix="28:",e.TFLSmsPrefix="50:sms:",e.RootResourceGroupIdPrefix="92:",e.PhonelinkSmsPrefix="phonelink:",e.TeamsAppPrefix="28:teamsapp:"}(a||(a={}));const i=864e13,r=2,o=/^[\d]+\:/,s="unq.gbl.spaces",d="@encrypted.skype",c="messageid=",l="replyChainId=",u=`;${c}`,p=Date.UTC(2e3,0,1),h=new Date("2016-07-01").getTime(),m="ag08:",g="ag08-sfb:",f="ag08",y="ag09:",S="ag09-sfb:",C="ag09",T="4:anonymous",v="teamsvisitor:",b="clientId",A="blah/",M="dod:",I="dod-sfb:",U="dod",P="@sfbonprem.unq.gbl.spaces",w="@fed.unq.gbl.spaces",R="@thread.v2",N="@EngageCommunity",D="fed:",k="gal:",F="gal-sfb:",L="gal",E="gcch:",x="gcch-sfb:",B="gcch",O="preview-",W="tfl:preview-",H="newchat",G="nativefed:",_="mto:",V="tflfed:",$="tfl:",z="orgid:",j="@sfb.unq.gbl.spaces",J="sfb:",q="sip:",Q="@sfc.unq.gbl.spaces",X="sfc:",Y="orgid:",Z="8:",K="28:30005246-e706-444f-ba61-8647ef09db75",ee="imBack",te="custom",ne="suggestion",ae=`:${_}`,ie=`:${G}`,re=`:${D}`,oe=`:${$}`,se=":tfloffnetwork:",de=`:${X}`,ce=a.SkypeSpacesUser+Y,le=a.SkypeSpacesUser+v,ue=a.SkypeSpacesUser+"anon:",pe=a.SkypeSpacesUser+"guest:",he=a.SkypeSpacesUser+"spool:",me=a.SkypeSpacesUser+"acs:",ge=a.SkypeSpacesUser+"gcch-acs:",fe=a.SkypeSpacesUser+J,ye=Z+"guest:",Se="50:sms:",Ce="50:smsunverified:",Te=["live","sip_profile","myspace","c2c","sms","facebook","fb"],ve="8:tfloffnetwork:",be=`${ve}email:`,Ae=`${ve}phone:`,Me="19:meeting",Ie="19:gcch:meeting",Ue="19:dod:meeting",Pe="19:gal:meeting",we="19:ag08:meeting",Re="19:ag09:meeting",Ne=":nativefed:preview",De=".cid.",ke=":fed:preview",Fe={SfBGatewayChat:j,OnPremFederatedGatewayChat:P,FederatedGatewayChat:w},Le="Message";var Ee,xe;!function(e){e.PSTN="PSTN",e.Thread="thread",e.User="user",e.Bot="bot",e.Unknown="unknown"}(Ee||(Ee={})),function(e){e.Accept="Accept",e.Block="Block",e.Unblock="Unblock"}(xe||(xe={}));new Map([[a.Pstn,Ee.PSTN],[a.SkypeSpacesThread,Ee.Thread],[a.PrivateFeed,Ee.Thread],[a.SkypeSpacesUser,Ee.User],[a.BotPrefix,Ee.Bot]]);const Be="calllogs",Oe="drafts",We=`${a.PrivateFeed}${Be}`,He=`${a.PrivateFeed}shared${Be}`,Ge=`${a.PrivateFeed}starred`,_e=`${a.PrivateFeed}notes`,Ve=`${a.BotPrefix}e7a9407c-2467-4a04-9546-70081f4ea80d`,$e=`${a.PrivateFeed}${Oe}`,ze=`${a.BotPrefix}integration:`,je=`${a.BotPrefix}app`,Je=`${a.PrivateFeed}notifications`,qe="streamof",Qe="notifications",Xe=a.BotPrefix+Y,Ye=(a.SkypeSpacesUser,a.BotPrefix,`${a.SkypeSpacesThread}sfb:`),Ze="0;0;0",Ke={VoiceAppPrefix:`${a.BotPrefix}orgid:`,BotPrefixOld:a.SkypeSpacesUser+a.BotPrefix},et=`<detailedtargetinfo><id>${a.BotPrefix}`,tt=(a.SkypeSpacesThread,a.SkypeSpacesThread+X),nt=a.SkypeSpacesUser+z,at="unknown_email_address@invalid.teams.ms",it={InterceptorBotMris:["28:22e50a9b-80cc-4eab-a092-ce64796d28d7","28:aee3af68-f70b-4f3d-a98e-28acc47ac522","28:6d2635c7-5f7b-4274-b0b5-e44d64e20dd9","28:f7206cef-8727-438b-9724-e1c508e3e54b"]},rt="application/vnd.microsoft.card.adaptive";var ot,st,dt,ct,lt;!function(e){e.NORMAL="normal",e.HIGH="high",e.URGENT="urgent"}(ot||(ot={})),function(e){e[e.NoAccess=209]="NoAccess",e[e.InvalidToken=230]="InvalidToken",e[e.ThreadNotFound=732]="ThreadNotFound",e[e.ChatPermissionAndIBRejection=206]="ChatPermissionAndIBRejection"}(st||(st={})),function(e){e[e.IBRejection=40318]="IBRejection",e[e.DisallowedByInitiatorPolicy=40311]="DisallowedByInitiatorPolicy",e[e.DisallowedByRemoteParty=40312]="DisallowedByRemoteParty",e[e.BilateralRejection=40362]="BilateralRejection",e[e.InitiatorBilateralRejection=40361]="InitiatorBilateralRejection"}(dt||(dt={})),function(e){e.PostReply="PostReply",e.Conversational="Conversational",e.Unthreaded="Unthreaded"}(ct||(ct={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled"}(lt||(lt={}));const ut=a.SkypeSpacesThread+D,pt=a.SkypeSpacesThread+G;var ht,mt;!function(e){e.ArchivalLevel="archivalLevel",e.ThemeId="themeId",e.CallableChannel="callableChannel",e.ChannelDefaultSectionId="channelDefaultNotesSectionId",e.ChannelSettings="channelSettings",e.Classification="classification",e.CreatedAt="createdat",e.CreatingFromTemplate="creatingFromTemplate",e.Creator="creator",e.DocumentLibraryId="channelDocsDocumentLibraryId",e.DynamicMembership="dynamicMembership",e.EngageCommunityId="engageCommunityId",e.FavDefault="favDefault",e.FolderRelativeUrl="channelDocsFolderRelativeUrl",e.GapDetectionEnabled="gapDetectionEnabled",e.GroupId="groupId",e.GuestUsers="guestUsersCategory",e.DisabledReason="disabledReason",e.GuardianChatInfo="guardianChatInfo",e.HasTranscript="hasTranscript",e.WebinarId="webinarId",e.CoOrganizers="coOrganizers",e.MeetingObjectsConfig="meetingObjectsConfig",e.RecentAttendanceReport="recentAttendanceReport",e.MeetingContent="meetingContent",e.ImportMetadata="importMetadata",e.ImportState="importState",e.ImmutableRoster="immutableRoster",e.Integration="integration:",e.IsAllCompanyEngageCommunity="isAllCompanyEngageCommunity",e.IsDeleted="isdeleted",e.IsDynamicMembershipEngageCommunity="isDynamicMembershipEngageCommunity",e.IsEngageCommunityAdmin="isEngageCommunityAdmin",e.IsFederated="isFederated",e.IsOfficialEngageCommunity="isOfficialEngageCommunity",e.IsStickyThread="isStickyThread",e.IsSmsThread="isSmsThread",e.Cfet="cfet",e.JoiningEnabled="joiningenabled",e.ConsumerGroupId="consumerGroupId",e.ShareJoinLink="shareJoinLink",e.SearchVisible="searchVisible",e.IsTeamLocked="isTeamLocked",e.IsUnlockMembershipSyncRequired="isUnlockMembershipSyncRequired",e.IsThreadDisabled="isDisabled",e.MeetingChatPolicy="meetingChatPolicy",e.MeetingChatType="meetingChatType",e.LastJoinAt="lastjoinat",e.LastLeaveAt="lastleaveat",e.LastSyncTime="lastSyncTime",e.Meeting="meeting",e.MemberLimitExceeded="isMaxMemberLimitExceeded",e.MessagingDisabled="messagingdisabled",e.NotebookId="notebookId",e.NotesSectionInfo="notesSectionInfo",e.ParentSpaces="parentSpaces",e.Picture="picture",e.PictureETag="pictureETag",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.RosterVersion="rosterVersion",e.SharepointRootLibrary="sharepointRootLibrary",e.SensitivityLabelDisplayName="sensitivityLabelDisplayName",e.SensitivityLabelId="sensitivityLabelId",e.SensitivityLabelName="sensitivityLabelName",e.SensitivityLabelParentDisplayName="sensitivityLabelParentDisplayName",e.SensitivityLabelParentName="sensitivityLabelParentName",e.SensitivityLabelParentTooltip="sensitivityLabelParentTooltip",e.SensitivityLabelTooltip="sensitivityLabelToolTip",e.SensitivityLabelIsCopyBlocked="sensitivityLabelIsCopyBlocked",e.SensitivityDefaultLabelId="sensitivityDefaultLabelId",e.SensitivityDefaultLabelIsCopyBlocked="sensitivityDefaultLabelIsCopyBlocked",e.ShareHistoryTime="sharehistorytime",e.SiteUrl="sharepointSiteUrl",e.SpaceId="spaceId",e.SpaceThreadTopic="spaceThreadTopic",e.SpaceThreadVersion="spaceThreadVersion",e.SpaceType="spaceType",e.SpaceType_Class="class",e.SpaceType_Edu="edu",e.SpaceType_HealthcareCareCoordination="healthcareCareCoordination",e.SpaceType_Plc="plc",e.SpaceType_Staff="staff",e.SpaceType_Standard="standard",e.SpaceType_Community="community",e.SpaceTypes="spaceTypes",e.SubstrateGroupId="substrateGroupId",e.SharedInSpaces="sharedInSpaces",e.TabType="tab::",e.TeamAdminSettings="spaceAdminSettings",e.TeamSmtpAddress="teamSmtpAddress",e.TeamStatus="teamStatus",e.TemplateType="templateType",e.TemplateInformation="templateInformation",e.TenantId="tenantid",e.ThreadSubType="threadSubType",e.ThreadType="threadType",e.TopicDescription="description",e.TopicThreadTopic="topicThreadTopic",e.TopicThreadVersion="topicThreadVersion",e.Version="version",e.Visibility="visibility",e.Topics="topics",e.Liveness="awareness_conversationLiveState",e.TopicName="topic",e.XTeamName="spaceThreadTopic",e.ExtensionDefinitionContainer="extensionDefinitionContainer",e.Hidden="hidden",e.P2PChatDefaultNotesInfo="groupDefaultNotesInfo",e.P2PChatFilesIndexId="chatFilesIndexId",e.P2PChatFilesIndexId_Value="2",e.P2PChatFixedRosters="fixedRoster",e.P2PChatUniqueRosterThread="uniquerosterthread",e.P2PMessagingDisabled="messagingdisabled",e.ChatModalityType="chatModalityType",e.ThreadingMode="threadingMode",e.CSAV1="csav1",e.isRgBackedThread="isRgBackedThread",e.CommunityCoverImage="communityCoverImage",e.WebsiteText="websiteText",e.WebsiteUrl="websiteUrl",e.ProductContext="productContext",e.ModeratedThread="moderatedthread",e.IsMigrated="isMigrated",e.BilateralTenantsList="bilateralTenantsList"}(ht||(ht={})),function(e){e.IsNewConversation="isNewConversation"}(mt||(mt={}));const gt=[ht.IsDeleted,ht.LastJoinAt,ht.LastLeaveAt,ht.MessagingDisabled,ht.ShareHistoryTime,ht.SpaceId,ht.ThreadType,ht.Picture];var ft,yt,St,Ct,Tt,vt,bt,At;!function(e){e.Chat="Chat",e.Conversation="Conversation",e.EngageCommunity="EngageCommunity",e.Meeting="Meeting",e.OneOnOne="1on1",e.PhoneChat="PhoneChat",e.Phonelink1on1Chat="Phonelink1on1Chat",e.PhonelinkGroupChat="PhonelinkGroupChat",e.ReplyChain="ReplyChain",e.Team="Space",e.StreamOfNotes="StreamOfNotes",e.Thread="Thread",e.Topic="Topic",e.RCC="RCC"}(ft||(ft={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast",e.Adhoc="Adhoc",e.Recurring="Recurring",e.MeetNow="MeetNow"}(yt||(yt={})),function(e){e.AcceptPending="AcceptPending",e.ExtendedDirectoryAcceptPending="ExtendedDirectoryAcceptPending",e.Accepted="Accepted",e.Blocked="Blocked",e.Quarantined="Quarantined",e.None="None"}(St||(St={})),function(e){e.AcceptPendingRecipient="AcceptPendingRecipient",e.Accepted="Accepted",e.AcceptPendingSender="AcceptPendingSender"}(Ct||(Ct={})),function(e){e.AddedBy="addedBy",e.AddedByTenantId="addedByTenantId",e.Alerts="alerts",e.BlockedAtTime="conversationblockedat",e.ClearHistoryTime="clearHistoryTime",e.ChatHistoryHiddenTime="historyHiddenTime",e.Collapsed="collapsed",e.ConsumptionHorizon="consumptionhorizon",e.ConsumptionHorizonBookmark="consumptionHorizonBookmark",e.ReplyChainListConsumptionHorizon="rclch",e.ReplyChainListConsumptionHorizonBookmark="rclchBookmark",e.DraftVersion="draftVersion",e.Favorite="favorite",e.ShouldFetchThreadOnXtapFailure="shouldFetchThreadOnXtapFailure",e.LastTimeFavorited="lastTimeFavorited",e.Followed="isfollowed",e.Hidden="hidden",e.HiddenTime="unpinnedTime",e.InteropConversationStatus="interopconversationstatus",e.isDeleted="isDeleted",e.isPinned="ispinned",e.LastImportantImTime="lastimportantimreceivedtime",e.LastUrgentImTime="lasturgentimreceivedtime",e.Loud="loud",e.Muted="muted",e.Normal="normal",e.PinnedConsumptionHorizon="consumptionHorizonForPinnedMessages",e.PinnedItems="pinnedItems",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.SmartReplies="quickReplyAugmentation",e.Subscription="subscription",e.SuggestedActions="augmentation",e.Version="spaceConversationVersion",e.GeneralChannelFavorite="isGeneralChannelFavorite",e.MeetingInfo="meetingInfo",e.ConversationStatus="conversationstatus",e.ConversationBlocked="conversationblocked",e.ConversationStatusProperties="conversationstatusproperties",e.LastMeetingUnhideTime="lastMeetingUnhideTime",e.OnetooneV2ThreadId="onetoonev2threadid",e.OnetooneV1ThreadId="onetoonev1threadid",e.IsEmptyConversation="isemptyconversation",e.FollowAllRc="followAllRc",e.NotifyAllRc="notifyAllRc",e.HasImpersonation="hasImpersonation"}(Tt||(Tt={})),function(e){e.None="none",e.Space="space",e.Topic="topic"}(vt||(vt={})),function(e){e.ChannelOnlyMember="channelOnlyMember",e.ExpirationTime="memberExpirationTime",e.ExplicitlyAdded="explicitlyAdded",e.Following="isFollowing",e.IsFavorite="isFavorite",e.IsModerator="isModerator",e.IsPinned="isPinned",e.Reader="isReader",e.Role="role",e.RelationshipState="relationshipState",e.MemberMaskId="memberMaskId"}(bt||(bt={})),function(e){e.AddCustomApp="ThreadActivity/AddCustomApp",e.AddMember="ThreadActivity/AddMember",e.BotMessageBack="BotMessageBack",e.BotSsoEvent="TargetedMessage/SsoAuth",e.Call="Event/Call",e.CallPushNotification="Signal/Flamingo",e.CallRecording="RichText/Media_CallRecording",e.CallLocalRecording="RichText/Media_LocalRecording",e.CallLogRecording="RichText/Media_CallLogRecording",e.CallTranscript="RichText/Media_CallTranscript",e.CallLogTranscript="RichText/Media_CallLogTranscript",e.MeetingObjects="RichText/Media_MeetingObjects",e.ClearTyping="Control/ClearTyping",e.Collaborate="Collaborate",e.ConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.Contacts="RichText/Contacts",e.Custom="Custom",e.DeleteCustomApp="ThreadActivity/DeleteCustomApp",e.DeleteMember="ThreadActivity/DeleteMember",e.Embed="Embed",e.FileAdd="ThreadActivity/FileAdd",e.Files="RichText/Files",e.FlikMessage="RichText/Media_FlikMsg",e.HistoryDisclosedUpdate="ThreadActivity/HistoryDisclosedUpdate",e.HTML="RichText/Html",e.IsReaderUpdated="ThreadActivity/MemberFeatureFlagUpdate",e.JoiningEnabledUpdate="ThreadActivity/JoiningEnabledUpdate",e.LegacyMemberAdded="ThreadActivity/LegacyMemberAdded",e.LegacyMemberUpgraded="ThreadActivity/LegacyMemberUpgraded",e.Location="RichText/Location",e.MediaCard="RichText/Media_Card",e.Meeting="Meeting",e.MeetingPolicyUpdated="ThreadActivity/MeetingPolicyUpdated",e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.MemberJoined="ThreadActivity/MemberJoined",e.MemberLeft="ThreadActivity/MemberLeft",e.MemberRenamed="ThreadActivity/MemberRenamed",e.MemberNamesRestored="ThreadActivity/OriginalDisplayNamesRestored",e.ModalityUpdate="ThreadActivity/ModalityUpdate",e.Moji="RichText/Media_FlikMsg",e.PictureUpdate="ThreadActivity/PictureUpdate",e.PhonelinkSms="Phonelink/Sms",e.PhonelinkMms="Phonelink/Mms",e.RetentionDeleted="ThreadActivity/RetentionDeleted",e.RichText="RichText",e.RoleUpdate="ThreadActivity/RoleUpdate",e.RoomSuggestion="ThreadActivity/RoomSuggestion",e.ScreenShare="ScreenShare",e.Sms="RichText/Sms",e.SpaceDescriptionUpdated="ThreadActivity/SpaceDescriptionUpdated",e.SpaceThreadChannelAdded="ThreadActivity/SpaceThreadChannelAdded",e.SpaceThreadChannelDeleted="ThreadActivity/SpaceThreadChannelDeleted",e.SpaceThreadChannelRenamed="ThreadActivity/SpaceThreadChannelRenamed",e.SharedInSpacesUpdated="ThreadActivity/SharedInSpacesUpdated",e.SpaceTopicUpdated="ThreadActivity/SpaceTopicUpdated",e.TabUpdated="ThreadActivity/TabUpdated",e.Text="Text",e.ThreadActivityMessageTypePrefix="ThreadActivity/",e.EventMessageTypePrefix="Event/",e.ThreadArchivalUpdate="ThreadActivity/ThreadArchivalUpdate",e.ReplyChainCreated="ThreadActivity/ReplyChainCreated",e.TopicDeleted="ThreadActivity/TopicDeleted",e.TopicDescriptionUpdated="ThreadActivity/TopicDescriptionUpdated",e.TopicTopicUpdated="ThreadActivity/TopicTopicUpdated",e.TopicUpdated="ThreadActivity/TopicUpdate",e.ThreadShared="ThreadActivity/ThreadShared",e.Typing="Control/Typing",e.UpdateFavDefault="ThreadActivity/UpdateFavDefault",e.UpgradeCustomApp="ThreadActivity/UpgradeCustomApp",e.URIObject="RichText/UriObject",e.Video="Event/SkypeVideoMessage",e.ShowHiddenChatHistory="ThreadActivity/ShowChatHistory",e.PinnedItemsUpdate="ThreadActivity/PinnedItemsUpdate",e.ConsentInvites="ThreadActivity/ConsentInvites",e.ImmersiveStarted="ThreadActivity/ImmersiveStarted",e.URIAudioObject="RichText/Media_AudioMsg",e.MediaGenericFile="RichText/Media_GenericFile",e.UriVideoObject="RichText/Media_Video",e.SkypePollObject="Poll",e.SkypeScheduledCallInvite="RichText/ScheduledCallInvite",e.SkypeLocation="RichText/Location",e.SkypeContactCard="RichText/Contacts",e.SkypeCopilotToggle="Event/BingBot",e.SkypeTranslation="Translation",e.SkypeTranslationSettings="TranslationSettings",e.SkypeMediaAlbum="RichText/Media_Album"}(At||(At={}));const Mt=[At.AddMember,At.DeleteMember,At.RoleUpdate,At.ThreadShared,At.TopicTopicUpdated,At.TopicUpdated,At.TopicDeleted,At.SpaceTopicUpdated,At.SpaceThreadChannelAdded,At.SpaceThreadChannelDeleted,At.SpaceThreadChannelRenamed,At.SpaceDescriptionUpdated,At.TopicDescriptionUpdated,At.SharedInSpacesUpdated,At.PictureUpdate,At.HistoryDisclosedUpdate,At.JoiningEnabledUpdate,At.LegacyMemberAdded,At.LegacyMemberUpgraded,At.AddCustomApp,At.FileAdd,At.DeleteCustomApp,At.UpgradeCustomApp,At.UpdateFavDefault,At.MemberJoined,At.MemberLeft,At.ThreadArchivalUpdate,At.RetentionDeleted,At.TabUpdated,At.MeetingPolicyUpdated,At.PinnedItemsUpdate],It=[At.AddMember,At.Call,At.CallRecording,At.CallLocalRecording,At.CallTranscript];var Ut,Pt,wt,Rt,Nt,Dt,kt,Ft,Lt,Et;!function(e){e.Activity="activity",e.AdminDelete="adminDelete",e.Blurhash="blurHash",e.CallLog="call-log",e.CallUpdateLogs="call-update-logs",e.Cards="cards",e.CrossPostId="crossPostId",e.CustomCopilotLicenseStatus="customCopilotLicenseStatus",e.DeleteTime="deletetime",e.DeliveryState="deliveryState",e.DraftId="draftId",e.EditTime="edittime",e.EmailDetails="emaildetails",e.Emotions="emotions",e.Files="files",e.ForwardTemplateId="forwardTemplateId",e.FromAppMetaData="fromAppMetadata",e.GenericStreamMetadata="genericStreamMetadata",e.HardDeleteReason="hardDeleteReason",e.HardDeleteTime="hardDeleteTime",e.Importance="importance",e.InnerThreadId="innerThreadId",e.InteropType="interopType",e.IsRead="isread",e.IsSharedInMain="isSharedInMain",e.LinkedRootMessageId="linkedRootMessageId",e.Links="links",e.Meeting="meeting",e.MeetingScheduledInfo="scheduledmeetinginfo",e.MeetingTitle="meetingtitle",e.MeetingType="@type",e.Mentions="mentions",e.Meta="meta",e.OnBehalfOf="onbehalfof",e.StreamingMetadata="streamingMetadata",e.OriginalMessageContext="originalMessageContext",e.ParentsAnnouncementsStatus="parentsAnnouncementsStatus",e.Pinned="pinned",e.PolicyViolation="policyViolation",e.ReplyPermissions="replyPermission",e.SendAt="sendAt",e.SkipFanoutToBots="skipfanouttobots",e.BotDeliveryReport="toBotDeliveryReport",e.SoftDeleteReason="softDeleteReason",e.Starred="starred",e.Subject="subject",e.SystemDelete="systemdelete",e.Title="title",e.UserMetaData="userMetaData",e.VivaTopicsAnnotations="vivaTopicsAnnotations",e.crossDeviceAttachType="crossDeviceAttachType",e.formatVariant="formatVariant",e.QuotedMessages="qtdMsgs",e.forwardMetadata="forwardMetaData",e.sharedInfo="sharedInfo",e.l2MessageId="l2MessageId",e.l2ReplyChainId="l2ReplyChainId"}(Ut||(Ut={})),function(e){e.ConversationUpdate="ConversationUpdate",e.CustomUserProperties="CustomUserProperties",e.PartialMessageUpdate="PartialMessageUpdate",e.MessageUpdate="MessageUpdate",e.NewMessage="NewMessage",e.ThreadPropertyUpdate="ThreadPropertyUpdate",e.ThreadUpdate="ThreadUpdate",e.ResolveConversationLie="ResolveConversationLie",e.NewDraft="NewDraft",e.NewLiveMessages="NewLiveMessages",e.LiveMessageUpdates="LiveMessageUpdates",e.UpdateDraft="UpdateDraft",e.DeleteDraft="DeleteDraft",e.RcMetadata="RcMetadataUpdate",e.CommentStreamLie="CommentStreamLie",e.ReplyChainPropertiesUpdate="ReplyChainPropertiesUpdate",e.ResyncRequiredEvent="ResyncRequiredEvent"}(Pt||(Pt={})),function(e){e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate"}(wt||(wt={})),function(e){e[e.None=0]="None",e[e.Network=1]="Network",e[e.Local=2]="Local"}(Rt||(Rt={})),function(e){e.Admin="Admin",e.User="User",e.Guest="Guest",e.Shadow="Shadow",e.None="None"}(Nt||(Nt={})),function(e){e.MeetingsUserParticipatesIn="participated",e.MeetingsUserIsInvitedTo="all",e.MeetingsManuallyUnmuted="none"}(Dt||(Dt={})),function(e){e.Unknown="Unknown",e.Enabled="Enabled",e.Disabled="Disabled"}(kt||(kt={})),function(e){e.Peripheral="Peripheral",e.Hotdesk="Hotdesk",e.Room="Room",e.Wifi="Wifi"}(Ft||(Ft={})),function(e){e.Unknown="0",e.Available="1",e.NotAvailable="2"}(Lt||(Lt={})),function(e){e[e.AddUserWithRestrictedPolicyNotAllowed=40312]="AddUserWithRestrictedPolicyNotAllowed",e[e.UserChatDisabled=40321]="UserChatDisabled",e[e.ChatWithRestrictedUserNotAllowed=40323]="ChatWithRestrictedUserNotAllowed",e[e.ChatWithLimitedUserNotAllowed=40324]="ChatWithLimitedUserNotAllowed",e[e.GroupChatNotAllowed=40325]="GroupChatNotAllowed",e[e.AddUserToChatNotAllowed=40326]="AddUserToChatNotAllowed",e[e.AddRestrictedUserInvalidOwnerNotAllowed=40327]="AddRestrictedUserInvalidOwnerNotAllowed",e[e.AddRestrictedUserNoOwnerNotAllowed=40328]="AddRestrictedUserNoOwnerNotAllowed",e[e.RemoveChatOwnerNotAllowed=40329]="RemoveChatOwnerNotAllowed",e[e.RemoveUserFromChatNotAllowed=40330]="RemoveUserFromChatNotAllowed",e[e.LeaveChatNotAllowed=40331]="LeaveChatNotAllowed",e[e.ChatWithExternalNotAllowed=40332]="ChatWithExternalNotAllowed",e[e.AddRestrictedUserExternalNotAllowed=40333]="AddRestrictedUserExternalNotAllowed",e[e.RemoveFullUserNotAllowed=40334]="RemoveFullUserNotAllowed",e[e.AddRestrictedUserFederatedChatNotAllowed=40335]="AddRestrictedUserFederatedChatNotAllowed",e[e.RemoveUserFromFederatedChatNotAllowed=40336]="RemoveUserFromFederatedChatNotAllowed",e[e.AddUserToChatFailed=5e4]="AddUserToChatFailed"}(Et||(Et={}));const xt="meeting";var Bt;!function(e){e[e.Sender=1]="Sender",e[e.All=2]="All"}(Bt||(Bt={}));const Ot=2534023008e5,Wt=2,Ht=1e4,Gt=3e5;var _t;!function(e){e.AdHocMeeting="adHocMeeting",e.Cast="cast",e.EmergencyGroupCall="emergencyGroupCall",e.GoLiveGroupCall="goLiveGroupCall",e.GroupCall="groupCall",e.HuddleGroupCall="huddleGroupCall",e.ScheduledMeeting="scheduledMeeting",e.ScreenSharingCall="screenSharingCall"}(_t||(_t={}));const Vt={ACCEPTED:"Accepted",TENTATIVE:"Tentative",FOLLOW:"Follow",DECLINED:"Declined",NONE:"None"},$t="shared-audio-group";var zt;!function(e){e.Saved="48:saved"}(zt||(zt={}))},809121:(e,t,n)=>{"use strict";n.d(t,{vg:()=>F,M8:()=>L,Nh:()=>x,ye:()=>B,Uw:()=>O,JO:()=>W,EV:()=>H,lQ:()=>G,Mg:()=>_,Tu:()=>V,fT:()=>$,W4:()=>z,$l:()=>j,T1:()=>J,LN:()=>q,rR:()=>Q,m9:()=>X,AF:()=>Y,fl:()=>Z,Bv:()=>K,LW:()=>ee,Pi:()=>te,iq:()=>ne,lm:()=>ae,aR:()=>ie,FL:()=>re,Xb:()=>oe,dk:()=>se,Mq:()=>de,Ku:()=>le,PS:()=>ue,mD:()=>pe,Tg:()=>he,aH:()=>me,q2:()=>ge,Hv:()=>fe,no:()=>ye,gB:()=>Se,e6:()=>Ce,in:()=>ve,VW:()=>be,W5:()=>Ae,Yo:()=>Me,tC:()=>Ie,VU:()=>Ue,bw:()=>Pe,gv:()=>we,Iz:()=>Re,MX:()=>Ne,dc:()=>De,QC:()=>ke,Te:()=>Fe,uD:()=>Le,js:()=>Ee,a3:()=>xe,WY:()=>Be,GX:()=>Oe,rV:()=>We,aL:()=>He,vd:()=>Ge,gZ:()=>_e,eu:()=>Ve,DR:()=>$e,l0:()=>ze,_S:()=>je,Y$:()=>Je,v3:()=>qe,oG:()=>Qe,BG:()=>Xe,zh:()=>Ye,my:()=>Ze,m7:()=>Ke,hT:()=>tt,o2:()=>nt,o3:()=>at,bf:()=>it,N$:()=>rt,fY:()=>ot,H1:()=>st,$w:()=>dt,p3:()=>ct,_5:()=>lt,jB:()=>ut,m5:()=>pt,HT:()=>ht,N1:()=>mt,Qi:()=>gt,dU:()=>ft,Gu:()=>yt,bH:()=>St,Xd:()=>Ct,A$:()=>vt,oZ:()=>bt,si:()=>At,wD:()=>Mt,Ay:()=>It,sW:()=>Ut,CM:()=>Pt,nH:()=>Rt,kF:()=>Nt});var a=n(823704),i=n(442424),r=n(366749),o=n(480354),s=n(921638),d=n(259521),c=n(844113),l=n(405826),u=n(401368),p=n(167090);const h=400,m=500,g=3,f="unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com",y=d.gN.SkypeSpacesUser+d.LE,S=d.gN.SkypeSpacesUser+d.K,C=d.gN.SkypeSpacesUser+d.QX,T=d.gN.SkypeSpacesUser+d.zl,v=d.gN.SkypeSpacesUser+d.uM,b=d.gN.SkypeSpacesUser+d.Nk,A=d.gN.SkypeSpacesUser+d.Sq,M=d.gN.SkypeSpacesUser+d.cA,I=d.gN.SkypeSpacesUser+d.Ne,U=d.gN.SkypeSpacesUser+d.Bh,P=d.gN.SkypeSpacesUser+d.gI,w=d.gN.SkypeSpacesUser+d.m2,R="tfl:",N=d.gN.SkypeSpacesUser+R,D="sfc:",k=d.gN.SkypeSpacesUser+D,F="receiverSfB",L="Text";function E(e,t){return!!e&&e.startsWith(t)}function x(e){return e>=h&&e<m}function B(e,t){return E(e,d.gN.SkypeSpacesThread)||E(e,d.gN.PhonelinkSmsPrefix)||H(e,t)}function O(e){return E(e,d.gN.SkypeSpacesThread)||"newTflUser"===e}function W(e){return E(e,d.gN.PrivateFeed)}function H(e,t){return W(e)||E(t,d.SU)}function G(e=""){const t=/syncState=([^&]+)/;let n;return e&&t.test(e)&&(n=e.match(t)[1]),n}function _(e){return-1!==d.wX.indexOf(e)}function V(e){const{teamsUserPhoneNumbers:t}=e.get(u.w.Messaging);return!!t?.phoneNumbers?.find((e=>"Primary"===e?.assignmentCategory&&e?.acquiredCapabilities?.includes("InboundA2PSms")&&e?.acquiredCapabilities?.includes("OutboundA2PSms")))}function $(e,t,n){const{userLocale:a,phoneNumberUtil:i}=t,r=i.getInstance(),o=r.parseAndKeepRawInput(e,a),s=r.getRegionCodeForNumber(o);return n?.includes(s)}function z(e){if(!e||!e.startsWith(d.zD))return!1;const t=e.split(":");return!!(2===t.length||3===t.length&&_(t[1]))}function j(e){return!!e&&e.startsWith(N)}function J(e){return!!e&&e.startsWith(k)}function q(e){return e&&j(e)?e.replace(R,""):e}function Q(e){return e&&J(e)?e.replace(D,""):e}function X(e){if(!Y(e)&&!Re(e))return"";if(!e.includes(":"))return"";const t=e.match(/^8:[\w-]+:[\w-]+_([\w-]+)$/);if(t)return t[1];const n=new RegExp(`^8:[\\w-]+:(?:${d.hB})?([\\w-]+)$`),a=e.match(n);if(a)return a[1];const i=e.match(/^28:([\w-]+)$/);return i?i[1]:""}function Y(e){return!!e&&(K(e)||re(e)||z(e)||e.startsWith(N)||ee(e)||te(e)||ne(e)||ae(e)||ie(e))}function Z(e){return!!e&&e.startsWith(S)}function K(e){return!!e&&(e.startsWith(y)||e.startsWith(S))}function ee(e){return!!e&&(e.startsWith(C)||e.startsWith(T))}function te(e){return!!e&&(e.startsWith(v)||e.startsWith(b))}function ne(e){return!!e&&(e.startsWith(A)||e.startsWith(M))}function ae(e){return!!e&&(e.startsWith(I)||e.startsWith(U))}function ie(e){return!!e&&(e.startsWith(P)||e.startsWith(w))}function re(e){return!!e&&(e.startsWith(d.nd)||e.startsWith(d.og)||e.startsWith(d.r3))}function oe(e){return e?K(e)?"":ee(e)?d.Fq:te(e)?d.xW:ne(e)?d.ar:ae(e)?d.JP:ie(e)?d._I:"":""}function se(e){return!!e&&(K(e)||ee(e)||te(e)||ne(e)||ae(e)||ie(e))}function de(e){if((0,o.isString)(e)&&!(0,o.isEmpty)(e)){if(le(e))return ce("PSTN",e,i.f0.PhoneNumber);if(z(e)||pe(e))return ce("SfC",e,i.f0.Identity);if(function(e){return!!e&&e.startsWith(d.gN.Lync)}(e))return ce("Lync",e,i.f0.Identity)}return e}const ce=(e,t,n)=>`${e}-${new r.w(t,n).scrub()}`;function le(e){return!!e&&0===e.indexOf(d.gN.Pstn)}function ue(e){return!!e&&(e.startsWith(d.OH)||e.startsWith(d.VP)||e.startsWith(d.b6))}function pe(e){return!!e&&e.startsWith(d.SF)}function he(e){return Boolean(e===f||e===d._7)}function me(e,t){let n=e;return t&&(n=[e,d.fE,t].join("")),n}function ge(e){if(!e.threadProperties)return!1;const t=e.threadProperties[d.iy.LastJoinAt],n=e.threadProperties[d.iy.LastLeaveAt];return n&&t?t>n:!!t}function fe(e){return Ze((0,s.$)(e.conversationLink)).conversationId}function ye(e){if(!e||!e.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");return Se(e.conversationLink,e.id)}function Se(e,t){if((0,o.isEmpty)(e))return t;const n=Ze((0,o.last)(e.split("/"))||"");return n.isValid?n.itemId:t}function Ce(e){const t=ye(e);return!!t&&t!==e.id}function Te(e){const t=Number(e);return!t||t<d.qc}function ve(e){const{properties:t}=e;if(!t)return;const n=t[d.rF.EditTime];return n?Number(n):void 0}function be(e){const{properties:t}=e;if(!t)return;const n=t[d.rF.DeleteTime];return n?Number(n):void 0}function Ae(e){const{properties:t}=e;if(!t)return;const n=t[d.rF.HardDeleteTime];return n?Number(n):void 0}function Me(e,t,n,a,i){const r=e;if(Pt(t)?r&&r.length>2:t?.[d.iy.ExtensionDefinitionContainer]){const{members:t,botMembers:i}=function(e,t,n){const a=2;if(n?.get(u.w.Sync).disableBotSplitForSoloGroupChats?e&&e.length>a:e){const n=(0,o.partition)(e,(e=>!Re(e.id)||t&&t.indexOf(e.id)>-1));return{members:n[0],botMembers:n[1]}}return{members:e,botMembers:[]}}(e,n,a);return{members:t,botMembers:i}}if(i&&a?.get(u.w.Messaging).enableExcludeCopilotFromNewChat){const t=(0,o.partition)(e,(e=>!Re(e.id)||!Ne(e.id,a)));return{members:t[0],botMembers:t[1]}}return{members:r,botMembers:[]}}const Ie=e=>!!e&&e.startsWith(d.PD),Ue=e=>!!e&&(e.startsWith(d.nd)||e.startsWith(d.og)||e.startsWith(d.PD)||e.startsWith(d.z3)||e.startsWith(d.VP)||e.startsWith(d.OH)||e.startsWith(d.b6)),Pe=(e,t)=>{if(!e)return!1;const n=re(e);if(n)return n;const a=e.startsWith(d.r3);return!t&&a};function we(e){return e.startsWith(d.gN.BotPrefix)}function Re(e){return!!e&&(!e.startsWith(d.kA.VoiceAppPrefix)&&(e.startsWith(d.gN.BotPrefix)||e.startsWith(d.kA.BotPrefixOld)))}const Ne=(e,t)=>{if(!e)return!1;const{copilotAppsIds:n}=t.get(u.w.Messaging),a=e.replace(new RegExp(`^${d.gN.BotPrefix}`),"");return!!n?.some((e=>e===a))},De=(e,t)=>{if(!e)return!1;const{projectAgentBotIds:n}=t.get(u.w.Messaging,["projectAgentBotIds"]),a=e.replace(new RegExp(`^${d.gN.BotPrefix}`),"");return!!n?.some((e=>e===a))},ke=(e,t)=>{if(!e)return!1;const{odspCustomCopilotBotIds:n}=t.get(u.w.CustomCopilot),a=e.replace(new RegExp(`^${d.gN.BotPrefix}`),"");return!!n?.some((e=>e===a))},Fe=(e,t)=>{if(!t)return!1;const{m365ChatBotIds:n}=e.get(u.w.Messaging);return!(!Re(t)||!n?.includes(t))},Le=(e,t)=>{if(!t)return!1;const{m365ChatBotIds:n}=e.get(u.w.Messaging);return!!t.some((e=>n?.includes(e)))},Ee=e=>e===`${d.gN.BotPrefix}186ce823-1149-4bc0-8b59-bcd122121e26`,xe=(e,t)=>{const{enableM365ChatBot:n}=e.get(u.w.Messaging);return!n&&Le(e,t)},Be=e=>{const{m365ChatBotIds:t}=e.get(u.w.Messaging);if(t)return t.find((e=>"28:914d3be7-0ff0-4da7-ac61-4dab62e6e076"===e))},Oe=e=>!!e&&e.startsWith(d.Vg),We=e=>e&&e.split(":")[3]||"",He=e=>e&&e.startsWith(d.I8)||!1,Ge=e=>!!e&&e.startsWith(d.lC),_e=e=>e&&e.startsWith(d._b)||!1,Ve=e=>e&&e.split(":")[2]||"",$e=e=>z(e)&&!e.startsWith(N)?e.replace(d.gN.SkypeSpacesUser,d.gN.SkypeSpacesUser+R):e,ze=e=>z(e)&&!e.startsWith(k)?e.replace(d.gN.SkypeSpacesUser,d.gN.SkypeSpacesUser+D):e,je=(e,t=d.Vb)=>Y(e)||Re(e)||le(e)||Qe(e,t)||Ge(e)||_e(e),Je=e=>Y(e)&&!Ue(e),qe=e=>{const t=Number(e),n=Date.now()+30*p.ND;return 0!==t&&!isNaN(t)&&t<n},Qe=(e,t)=>{if(!e)return!1;const n=d.gN.BotPrefix+t;return e.startsWith(n)};function Xe(e){return!!Re(e)&&d.Th.InterceptorBotMris.some((t=>t===e))}function Ye(e,t=!1){return t?!!e&&(e.includes(d.br)||e.includes(d.XD)):!!e&&e.includes(d.br)}function Ze(e){if(!e)return{isValid:!1,conversationId:"",itemId:""};const t=e.split(";");if(1===t.length)return{isValid:!1,conversationId:t[0],itemId:""};if(2!==t.length||0!==t[1].indexOf(d.br)&&0!==t[1].indexOf(d.XD)||t[1].indexOf(d.j6)>-1)return{isValid:!1,conversationId:"",itemId:""};if(t[1].includes(d.XD)){const e=t[1].slice(d.XD.length);return{isValid:!0,conversationId:t[0],itemId:e}}const n=t[1].substr(d.br.length);return{isValid:!Te(n),conversationId:t[0],itemId:n}}function Ke(e){switch(e){case c.b.Team:case c.b.Community:return d.Cr.Team;case c.b.Topic:case c.b.SubCommunity:return d.Cr.Topic;case c.b.SfbInteropChat:case c.b.Chat:return d.Cr.Chat;case c.b.Meeting:return d.Cr.Meeting;case c.b.PhoneChat:return d.Cr.PhoneChat;case c.b.Phonelink1on1Chat:return d.Cr.Phonelink1on1Chat;case c.b.PhonelinkGroupChat:return d.Cr.PhonelinkGroupChat;case c.b.EngageCommunity:return d.Cr.EngageCommunity;default:return d.Cr.Thread}}function et(e){const{properties:t}=e;return t&&t[d.rF.Importance]?t[d.rF.Importance]:d.Al.NORMAL}function tt(e){return et(e)===d.Al.HIGH}function nt(e){return et(e)===d.Al.URGENT}function at(e){return(0,o.includes)(d.KA,e.messagetype)}function it(e){return(0,o.includes)(d.St,e)}function rt(e){switch(e){case l.b_.Admin:return d.mz.Admin;case l.b_.Guest:return d.mz.Guest;case l.b_.User:return d.mz.User;case l.b_.Shadow:return d.mz.Shadow;case l.b_.Undefined:default:return d.mz.None}}const ot=(e,t)=>{if(e){const n=e[d.rF.Emotions],a=n&&(0,o.find)(n,{key:"star"}),i=a&&a.users;if(i)return!!(0,o.some)(i,{mri:t})}return!1},st=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":case d.Bx.PartialMessageUpdate:return t.conversationid||fe(t);case"ThreadUpdate":case"ConversationUpdate":return t.id;case d.Bx.CommentStreamLie:case d.Bx.NewLiveMessages:case d.Bx.LiveMessageUpdates:return t.conversationId;default:return}},dt=({resourceType:e,resource:t})=>{switch(e){case"NewMessage":case"MessageUpdate":case d.Bx.PartialMessageUpdate:return ye(t);default:return}},ct=e=>e===c.b.StreamOfNotifications,lt=e=>e===c.b.StreamOfCalllogs||e===c.b.StreamOfSharedCalllogs,ut=e=>e===c.b.StreamOfDrafts,pt=e=>e===c.b.StreamOfNotes,ht=e=>e===c.b.StreamOfAnnotations,mt=e=>{if(!e)return"";if((0,o.isString)(e)){const t=e;return 0===t.lastIndexOf(d.zD,0)||0===t.lastIndexOf(d.gN.BotPrefix,0)||le(t)||Ge(t)||_e(t)?t:d.zD+t}return(0,o.first)(e.mris)??""},gt=e=>e?.startsWith(d.WY)||e?.startsWith(d.u2)||e?.startsWith(d.gD)||e?.startsWith(d.pM)||e?.startsWith(d.fw)||e?.startsWith(d.yP);function ft(e){if(!e)return!1;if(!e.startsWith(d.zD))return!1;return(e.startsWith(y)||e.startsWith(C)||e.startsWith(v)||e.startsWith(I)||e.startsWith(A)||e.startsWith(P))&&e.split(":").length===g}const yt=e=>{const{enableTfwTflFederation:t}=e.get(u.w.Messaging),{enableGuardiansChat:n}=e.get(u.w.Guardians),{licenseType:a}=e.get(u.w.UserResources);return!!(t||n&&Tt(a))},St=e=>{const{enablePhonelinkSms:t}=e.get(u.w.PhonelinkSms),{phoneLinkingBlocked:n}=e.get(u.w.HostCapabilities);return!!t&&!n},Ct=e=>{let t,n="",a="";const i=e.match(/\/message\/(48|19):([^\/]+)\/([^\/\?]+)/);if(i){n=`${i[1]}:${i[2]}`,a=i[3];try{const n=new URL(e);t=new URLSearchParams(n.search).get("parentMessageId")??void 0}catch{return{conversationId:n,messageId:a}}}return{conversationId:n,messageId:a,parentMessageId:t}},Tt=e=>"Teacher"===e,vt=e=>{if(!e?.sendAt)return;const t=Number(e.sendAt);return isNaN(t)?new Date(e.sendAt).getTime():t},bt=e=>!!e&&(e.includes(d.wP)||e.endsWith(d.z7.FederatedGatewayChat)||e.endsWith(d.z7.OnPremFederatedGatewayChat)),At=e=>!!e&&e.endsWith(d.z7.OnPremFederatedGatewayChat),Mt=(e,t,n,a,i)=>{const r=e&&e.includes(d.Z),o=i?.some((e=>z(e)));return r||!(t||!n||!a||o)},It=(e,t)=>t?`${e};messageid=${t}`:e,Ut=(e,t,n)=>({...n?{draftDetails:{sendAt:new Date(n).getTime().toString()},draftType:a.C.ScheduledDraft}:{draftType:a.C.RoamedDraft},innerThreadId:It(e,t)}),Pt=e=>!(0,o.isNil)(e)&&("true"===e[d.iy.P2PChatUniqueRosterThread]?.toString()?.toLowerCase()||wt(e)),wt=e=>e[d.iy.TemplateType]===d.iy.ImmutableRoster||"true"===e[d.iy.IsStickyThread]?.toString()?.toLowerCase();function Rt(e){return!!e&&e.indexOf(d.Ol)>-1}const Nt=(e,t)=>{const{enableWorkflowBotUserAttribution:n,workflowAppBotIds:a}=e.get(u.w.Extensibility),i=t?.startsWith("28:")?t:"28:".concat(t||"");return n&&a?.some((e=>e===i))}},823704:(e,t,n)=>{"use strict";n.d(t,{C:()=>a,Du:()=>i,gz:()=>r,N4:()=>o,kI:()=>s,oO:()=>d,Xd:()=>c,rI:()=>l,z_:()=>p,To:()=>h,lD:()=>S,Z6:()=>g,gm:()=>C,sQ:()=>T});var a,i,r,o,s,d,c,l,u,p,h,m,g,f,y=n(259521);!function(e){e.ScheduledDraft="ScheduledDraft",e.RoamedDraft="RegularDraft"}(a||(a={})),function(e){e.TemplateId="basic_forward_message_template",e.ForwardedContentStart='<blockquote itemtype="http://schema.skype.com/Forward">',e.ForwardedContentEnd="</blockquote>"}(i||(i={})),function(e){e.Start="Start",e.Informative="Informative",e.Streaming="Streaming",e.Final="Final"}(r||(r={})),function(e){e.Completed="Completed",e.Expired="Expired",e.Cancelled="Cancelled"}(o||(o={})),function(e){e.Teams="TEAMS",e.Sfl="SFL"}(s||(s={})),function(e){e.PRE_MEETING="PRE_MEETING",e.IN_MEETING="IN_MEETING",e.POST_MEETING="POST_MEETING"}(d||(d={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync",e[e.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",e[e.AdHocPropertyUpdate=9]="AdHocPropertyUpdate",e[e.CSAPost=10]="CSAPost",e[e.CSAThread=11]="CSAThread",e[e.RCMUpdate=12]="RCMUpdate"}(c||(c={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted",e[e.Retrying=5]="Retrying"}(l||(l={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(u||(u={})),function(e){e.SFL="SFL",e.TFL="TFL"}(p||(p={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob",e[e.GroupChatsStartupJob=10]="GroupChatsStartupJob",e[e.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",e[e.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",e[e.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob",e[e.TeamUnjoinedChannelsSyncJob=14]="TeamUnjoinedChannelsSyncJob",e[e.UnjoinedChannelSyncJob=15]="UnjoinedChannelSyncJob",e[e.LocalUpdateForRedDot=16]="LocalUpdateForRedDot",e[e.ChatsAndChannelsSyncJob=17]="ChatsAndChannelsSyncJob",e[e.UnjoinedChannelThreadDetailsUpdate=18]="UnjoinedChannelThreadDetailsUpdate",e[e.FileReferenceSyncJob=19]="FileReferenceSyncJob",e[e.LieEvent=20]="LieEvent",e[e.BotEmptyMessageUpdate=21]="BotEmptyMessageUpdate"}(h||(h={})),function(e){e[e.Success=0]="Success",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(m||(m={}));class S{}S.NotificationConversationId=`${y.gN.PrivateFeed}notifications`,S.DraftsConversationId=`${y.gN.PrivateFeed}drafts`,S.StarredConversationId=`${y.gN.PrivateFeed}starred`,S.CallLogConversationId=`${y.gN.PrivateFeed}calllogs`,S.SharedCallLogConversationId=`${y.gN.PrivateFeed}sharedcalllogs`,S.AnnotationsConversationId=`${y.gN.PrivateFeed}annotations`,S.ThreadsConversationId=`${y.gN.PrivateFeed}threads`,S.SavedConversationId=`${y.gN.PrivateFeed}saved`,S.MentionsConversationId=`${y.gN.PrivateFeed}mentions`,function(e){e.SIGNER="SIGNER",e.INTERPRETER="INTERPRETER"}(g||(g={})),function(e){e[e.Message=0]="Message"}(f||(f={}));const C="x-ms-request-priority";var T;!function(e){e[e.RealTimeSync=0]="RealTimeSync",e[e.ForegroundSync=10]="ForegroundSync",e[e.BackgroundSync=20]="BackgroundSync"}(T||(T={}))},405826:(e,t,n)=>{"use strict";n.d(t,{Tg:()=>d,H4:()=>c,R8:()=>l,C8:()=>u,OB:()=>p,E:()=>h,_m:()=>m,K5:()=>g,hs:()=>f,aK:()=>y,h3:()=>S,hO:()=>C,f4:()=>T,k6:()=>v,m4:()=>A,uS:()=>M,Wz:()=>I,bh:()=>P,aY:()=>w,gV:()=>R,an:()=>N,Vm:()=>D,Fw:()=>k,YV:()=>F,Yp:()=>L,S5:()=>E,QU:()=>B,sB:()=>O,fU:()=>W,uT:()=>H,Mb:()=>G,b_:()=>_,Q8:()=>V,ef:()=>$,N1:()=>z,nP:()=>j,Cu:()=>J,YY:()=>q,Wf:()=>Q,nC:()=>X,$3:()=>Y,fF:()=>Z,ob:()=>K,l8:()=>ee,iF:()=>te,vW:()=>ne,Uf:()=>ae,IN:()=>ie,p7:()=>re,jZ:()=>oe,lp:()=>ce,ne:()=>le,uf:()=>ue});var a=n(401368),i=n(16945),r=n(400695),o=n(313285),s=n(182635);const d=1,c=200,l=1,u=2,p=0;var h,m,g;!function(e){e.HighlightOverview1Day="HighlightOverview1Day",e.HighlightOverview7days="HighlightOverview7Days",e.HighlightOverview30Days="HighlightOverview30Days",e.HighlightCatchUp="HighlightCatchUp",e.ActionItems="ActionItems",e.Decision="Decision",e.OpenItems="OpenItems",e.MainTopics="MainTopics",e.SuggestedQuestions="SuggestedQuestions",e.FreeText="Q&A",e.Questions="Questions",e.Summary="Summary"}(h||(h={})),function(e){e[e.UserFilter=0]="UserFilter",e[e.ActionItems=4]="ActionItems",e[e.Decision=5]="Decision",e[e.OpenItems=6]="OpenItems",e[e.MainTopics=7]="MainTopics",e[e.SuggestedQuestions=8]="SuggestedQuestions"}(m||(m={})),function(e){e[e.OneDay=1]="OneDay",e[e.SevenDays=7]="SevenDays",e[e.ThirtyDays=30]="ThirtyDays"}(g||(g={}));const f="api/v1/",y="api/v2/",S="api/v3/",C=12e4,T=12e4,v="https://chatsvcagg.teams.microsoft.com",b="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation",A="https://teams.microsoft.com/api/csa",M={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupgroupchats:"teams/users/me/groupchats",startupnonrecentchats:"teams/users/me/nonrecentchats",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"},I="xx",U=12e4,P=100,w=50,R=50,N=50,D=6e5,k=12e4;var F,L;!function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff",e[e.HealthcareCareCoordination=5]="HealthcareCareCoordination",e[e.Community=6]="Community"}(F||(F={})),function(e){e.None="none",e.Owners="owners",e.Members="members",e.OwnersAndMembers="ownersAndMembers"}(L||(L={}));const E={None:0,0:"None",Private:1,1:"Private",Secret:2,2:"Secret",Public:3,3:"Public",HiddenMembership:4,4:"HiddenMembership",Unknown:5,5:"Unknown",All:6,6:"All"};var x,B,O,W,H,G,_,V,$,z,j,J;!function(e){e[e.InProgress=0]="InProgress",e[e.Success=1]="Success",e[e.Error=2]="Error"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.TenantWide=2]="TenantWide",e[e.Shared=4]="Shared",e[e.Standalone=9]="Standalone"}(B||(B={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(O||(O={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators"}(W||(W={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(H||(H={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed"}(G||(G={})),function(e){e[e.Undefined=0]="Undefined",e[e.User=1]="User",e[e.Admin=2]="Admin",e[e.Guest=3]="Guest",e[e.Shadow=4]="Shadow"}(_||(_={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators",e[e.EveryoneButGuests=2]="EveryoneButGuests"}(V||(V={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Private=1]="Private",e[e.Channel=2]="Channel"}($||($={})),function(e){e[e.AnyonePost=0]="AnyonePost",e[e.AnyoneWithWarning=1]="AnyoneWithWarning",e[e.OwnersPost=2]="OwnersPost"}(z||(z={})),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction"}(j||(j={})),function(e){e[e.Standard=0]="Standard",e[e.Private=1]="Private",e[e.Shared=4]="Shared",e[e.Standalone=9]="Standalone"}(J||(J={}));const q={Single:0,0:"Single",Occurrence:1,1:"Occurrence",Exception:2,2:"Exception",RecurringMaster:3,3:"RecurringMaster"};var Q,X,Y,Z,K,ee,te;!function(e){e[e.None=0]="None",e[e.Adhoc=1]="Adhoc",e[e.Scheduled=2]="Scheduled",e[e.Recurring=3]="Recurring",e[e.Broadcast=4]="Broadcast",e[e.MeetNow=5]="MeetNow"}(Q||(Q={})),function(e){e[e.None=0]="None",e[e.Daily=1]="Daily",e[e.Weekly=2]="Weekly",e[e.Monthly=3]="Monthly",e[e.RelativeMonthly=4]="RelativeMonthly",e[e.Yearly=5]="Yearly",e[e.RelativeYearly=6]="RelativeYearly"}(X||(X={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(Y||(Y={})),function(e){e[e.January=1]="January",e[e.February=2]="February",e[e.March=3]="March",e[e.April=4]="April",e[e.May=5]="May",e[e.June=6]="June",e[e.July=7]="July",e[e.August=8]="August",e[e.September=9]="September",e[e.October=10]="October",e[e.November=11]="November",e[e.December=12]="December"}(Z||(Z={})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(K||(K={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last"}(ee||(ee={})),function(e){e[e.None=0]="None",e[e.Sfb=1]="Sfb"}(te||(te={}));const ne={Meeting:1,1:"Meeting",None:0,0:"None",Channel:2,2:"Channel"};var ae,ie,re,oe,se;!function(e){e[e.Success=0]="Success",e[e.TranslationFailed=1]="TranslationFailed",e[e.MessageNotFound=2]="MessageNotFound",e[e.VersionNotFound=3]="VersionNotFound",e[e.SkipTranslation=4]="SkipTranslation",e[e.ContentIsEmpty=5]="ContentIsEmpty",e[e.LanguageDetectionFailed=6]="LanguageDetectionFailed",e[e.UnsupportedSourceLanguage=7]="UnsupportedSourceLanguage",e[e.UnknownError=10]="UnknownError"}(ae||(ae={})),function(e){e.CallHistory="callhistory",e.Chat="chat",e.ChatMessages="chatmessages",e.ChatMessage="chatmessage",e.Chats="chats",e.ChatsV2="chats_v2",e.ChatsV3="chats_v3",e.ChatsByTitle="chatsByTitle",e.ChatSummarization="chatSummarization",e.ChatSummarizationV2="chatSummarizationV2",e.ChatSmartNavigator="chatSmartNavigator",e.ChatWithUser="chatwithuser",e.ChatsAndChannelsByIds="chatsAndChannelsByIds",e.ConversationFolders="conversationFolders",e.CrossPost="crosspost",e.GetPost="getPost",e.GetSupportedTranslationLanguages="getSupportedTranslationLanguages",e.PostAuthors="postAuthors",e.ReplyChain="replychain",e.ReplyChains="replychains",e.ReplyChainsV2="replychains_v2",e.RecentPosts="recentposts",e.RecentThreads="recentthreads",e.RepliesInChain="repliesInChain",e.StartupGroupChats="startupgroupchats",e.StartupNonRecentChats="startupnonrecentchats",e.ScheduleMessage="schedulemessage",e.SystemMessages="systemmessages",e.Teams="teams",e.TranslateMessages="translatemessages",e.Phonelink="phonelink",e.PinnedChannels="pinnedChannels",e.PinnedPost="pins",e.PinPost="pinPost",e.UnpinPost="unpinPost",e.Parents="parents",e.TeamChannels="teamChannels",e.Channel="channel",e.PivotMessagesPosts="pivotMessagesPost",e.DeeplinkPosts="deeplinkPosts"}(ie||(ie={})),function(e){e.ContentType="content-type",e.XChatserviceEndpoint="x-csendpoint",e.XClientUiLanguage="x-client-ui-language",e.XDbFastFailed="x-ms-db-fast-failed"}(re||(re={})),function(e){e.SharedChannel="sharedchannel",e.PrivateChannel="privatechannel",e.Unknown=""}(oe||(oe={})),function(e){e[e.Embed=4]="Embed"}(se||(se={}));const de=async(e,t,n)=>{const a=e.regionGtm("chatSvcAggAfd");return(0,o.a)(a,t,r.B.BaseUrlTimeout).catch((e=>{const t=(0,i.$)(e),a=(0,o.W)(e),r=n.newLogger("getCSAHostFromGtm","core-cdl-worker-services");r.errorToTelemetry?.(`Failed to resolve CSA host from Gtm. isMissingFromGtm:${t}, isTimedOut:${a}. message:'${e?.message}'`,"cdl_sync_csa_host_resolution_failed_from_gtm",void 0,!0)}))};function ce(e){const{apiConstants:t}=e.get(a.w.CsaService),{resource:n=v,version:i=f,endpoints:r=M}=t||{};return{resource:n,version:i,endpoints:r}}function le(e){const{phonelinkSmsApiResource:t}=e.get(a.w.CsaService);return{resource:t||b}}async function ue(e,t,n){const{csaHostOverrideUrl:i}=e.get(a.w.Test),r=`${A}/`;if(i)return(0,s.M4)(i)||r;const{host:o}=e.get(a.w.CsaService).apiConstants||{},{host:d}=e.get(a.w.CsaService).apiConstantsGCC||{};let c=!!e.get(a.w.CsaService).useHostFromGtmTable;if(o?.includes("csa-int")&&(c=!1),c){const i=e.get(a.w.Core).endpointsManagerBaseUrlResolutionTimeoutInMs||U,c=await de(t,i,n)||d||o||r;return(0,s.M4)(c)}{const e=d||o||r;return(0,s.M4)(e)}}},556742:(e,t,n)=>{"use strict";function a(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}n.d(t,{v:()=>a})},921638:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var a=n(182635);function i(e){const t=(0,a.mH)(e,(e=>e.pathname),e,"https://example.com");return decodeURIComponent(t.slice(t.lastIndexOf("/")+1))}},313285:(e,t,n)=>{"use strict";n.d(t,{a:()=>s,W:()=>d});var a=n(45685),i=n(183111),r=n(912435);const o=20;function s(e,t,n,i){return Promise.race([e,(0,a.y)(t).then((()=>{throw i?.abort(),c(t,n)}))]).catch((e=>{if(e instanceof DOMException&&"AbortError"===e.name&&e.code===o)throw c(t,n);throw e}))}const d=e=>e&&e.context===i.Ir.Timed&&e.code===i.O4.TimedOut,c=(e,t)=>(0,r.$5)(i.Ir.Timed,i.O4.TimedOut,i.Ir.Timed,{ms:e},t)},917753:()=>{},612552:()=>{}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/429658-eaf8f745ffc974f3.js.map