"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[247070],{110669:(e,t,n)=>{n.d(t,{hT:()=>i});n(480354);const i={chat:0,channel:0}},394784:(e,t,n)=>{var i,r,a;n.d(t,{t7:()=>i,ne:()=>r,j4:()=>a,ZM:()=>s}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp",e[e.Workflows=9]="Workflows",e[e.VirtualEvent=10]="VirtualEvent",e[e.BotFeedback=11]="BotFeedback",e[e.DeclarativeCopilot=12]="DeclarativeCopilot"}(i||(i={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(r||(r={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(a||(a={}));const s={message:"message",compose:"compose",commandBox:"commandBox",copilot:"copilot",thirdParty:"thirdParty",filesOnedrive:"filesOnedrive",filesSharepoint:"filesSharepoint"}},777047:(e,t,n)=>{var i;n.d(t,{m:()=>i}),function(e){e.APP_SWITCHER_CONFIRMATION_RENDERED="app-switcher-confirmation-renderer",e.AUDIO_DEVICE_SETTINGS_RENDERED="audio-device-settings-rendered",e.CALENDAR_HEADER_RENDERED="calendar-header-rendered",e.CALENDAR_VIEW_RENDERED="calendar-view-rendered",e.CALENDAR_SF_HEADER_RENDERED="calendar-sf-header-rendered",e.CALENDAR_SF_VIEW_RENDERED="calendar-sf-view-rendered",e.CALENDAR_SF_TRACKING_VIEW_RENDERED="calendar-sf-tracking-view-rendered",e.CALL_FORWARDING_SETTINGS_RENDERED="call-forwarding-settings-rendered",e.CALL_GROUP_OWNERS_RENDERED="call-group-owners-rendered",e.CALL_HISTORY_RENDERED="call-history-rendered",e.CALLS_APP_HEADER_RENDERED="calls-app-header-rendered",e.CALLS_APP_HISTORY_FETCH_STARTED="calls-app-history-fetch-started",e.CALLS_APP_HISTORY_FETCH_COMPLETED="calls-app-history-fetch-completed",e.CALLS_APP_SPEED_DIAL_FETCH_STARTED="calls-app-speed-dial-fetch-started",e.CALLS_APP_SPEED_DIAL_FETCH_COMPLETED="calls-app-speed-dial-fetch-completed",e.CALLING_SCREEN_RENDERED="calling-screen-rendered",e.CALLS_APP_RENDERED="calls-app-rendered",e.CAMPAIGN_VIEW_RENDERED="campaign-view-rendered",e.CHANNEL_DASHBOARD_HEADER_RENDERED="channel-dashboard-header-rendered",e.CHANNEL_DASHBOARD_VIEW_RENDERED="channel-dashboard-view-rendered",e.CHANNEL_HEADER_RENDERED="channel-header-rendered",e.CHANNEL_RIGHT_PANE_HEADER_RENDERED="channel-right-pane-header-rendered",e.CHANNEL_LIST_ITEMS_RENDERED="channel-list-items-rendered",e.COMMUNITIES_LIST_DATA_LOADED="communities-list-data-loaded",e.CHAT_HEADER_BUTTONS_RENDERED="chat-header-buttons-rendered",e.CHAT_HEADER_TITLE_RENDERED="chat-header-title-rendered",e.CHAT_LIST_ITEMS_RENDERED="chat-list-items-rendered",e.COMPOSE_LAYOUT_LOADED="compose-layout-loaded",e.COMPOSE_LOADED="compose-loaded",e.COMMUNITIES_HEADER_RENDERED="communities-header-rendered",e.COMMUNITIES_DATA_FETCHED_V2="communities-data-fetched-v2",e.COMMUNITIES_MANAGE_VIEW_RENDERED="communities-manage-view-rendered",e.COMMUNITIES_JOIN_INVITE_VIEW_RENDERED="communities-join-invite-view-rendered",e.COLLAB_STAGE_HEADER_TITLE_RENDERED="collab-stage-header-title-rendered",e.CONNECT_WITH_ANYONE_SHOWN="connect-with-anyone-shown",e.CONTACTS_APP_RENDERED="contacts-app-rendered",e.COURSE_TEAMS_MAIN_PANE_RENDERED="course-teams-main-pane-rendered",e.DIALPAD_RENDERED="dialpad-rendered",e.DISCOVER_SURFACE_FEED_RENDERED="discover-surface-feed-rendered",e.DISCOVER_SURFACE_HEADER_RENDERED="discover-surface-header-rendered",e.DISCOVER_SURFACE_VIEW_RENDERED="discover-surface-view-rendered",e.NO_FEED_GRAPHICS_RENDERED="no-feed-graphics-rendered",e.FEED_ITEM_NAVIGATION="feed-item-navigation",e.FEED_LIST_ITEMS_RENDERED="feed-list-items-rendered",e.FEED_SLICE_LIST_RENDERED="feed-slice-list-rendered",e.HELP_APP_RENDERED="help-app-rendered",e.GUARDIANS_APP_RENDERED="guardians-app-rendered",e.GATHER_APP_RENDERED="gather-app-rendered",e.LOB_NOTIFICATIONS_RENDERED="lob_notifications_rendered",e.MEET_APP_RENDERED="meet-app-rendered",e.MEETING_ROOM_FRONT_OF_ROOM_RENDERED="meeting-room-front-of-room-rendered",e.MEETING_ROOM_MAIN_SCREEN_RENDERED="meeting-room-main_screen-rendered",e.MEETING_ROOM_CONSOLE_UBAR_RENDERED="meeting-room-console-ubar-rendered",e.MEETING_ROOM_CONSOLE_ROSTER_RENDERED="meeting-room-console-roster-rendered",e.MEETING_ROOM_CONSOLE_MEETING_INFO_RENDERED="meeting-room-console-meeting-info-rendered",e.MEETING_ROOM_INCOMING_CALL_RENDERED="meeting-room-incoming-call-rendered",e.MESSAGE_REACTIONS_RENDERED="message-reactions-rendered",e.MESSAGES_RENDERED="messages-rendered",e.ONEUP_HEADER_RENDERED="oneup-header-rendered",e.ONEUP_RENDERED="oneup-rendered",e.PEOPLE_APP_RENDERED="people-app-rendered",e.PLATFORM_APP_CONTAINER_RENDERED="platform_app_container_rendered",e.PLATFORM_APP_FRAME_RENDERED="platform_app_frame_rendered",e.PLATFORM_APP_FRAME_CONTENT_RENDERED="platform_app_frame_content_rendered",e.P2P_FILES_LIST_VIEW_RENDERED="p2p_files_list_view_rendered",e.P2P_SHARED_LIST_VIEW_RENDERED="p2p_shared_list_view_rendered",e.PRESENCES_RENDERED="presences-rendered",e.QUEUES_APP_HEADER_STARTED="queues-app-header-started",e.QUEUES_APP_LEFT_STARTED="queues-app-left-started",e.QUEUES_APP_CENTER_STARTED="queues-app-center-started",e.QUEUES_APP_HEADER_DATA_LOADED="queues-app-header-data-loaded",e.QUEUES_APP_HEADER_RENDERED="queues-app-header-rendered",e.QUEUES_APP_CENTER_RENDERED="queues-app-center-rendered",e.QUEUES_APP_LEFT_RENDERED="queues-app-left-rendered",e.SEARCH_RESULTS_RENDERED="search-results-rendered",e.SETTINGS_RENDERED="settings-rendered",e.SHARE_PAGE_RENDERED="share-page-rendered",e.SHELL_APP_BAR_RENDERED="shell_app_bar_rendered",e.SHELL_TITLE_BAR_RENDERED="shell_title_bar_rendered",e.SINGLE_TEAM_VIEW_LEFT_RAIL_LOADED="single-team-view-left-rail-loaded",e.SIMPLE_COLLAB_ADAPTIVE_LEFT_RAIL_LOADED="simple-collab-adaptive-left-rail-loaded",e.SIMPLE_COLLAB_SLICE_FEED_RENDERED="simple-collab-slice-feed-rendered",e.SIMPLE_COLLAB_SLICE_LIST_RENDERED="simple-collab-slice-list-rendered",e.SIMPLE_COLLAB_SLICE_UNSELECTED_GRAPHIC_RENDERED="simple-collab-slice-unselected-graphic-rendered",e.SIMPLE_COLLAB_ZERO_STATE_RENDERED="simple-collab-zero-state-rendered",e.COACH_REPORT_VIEW_RENDERED="coach-report-view-rendered",e.SPEED_DIAL_RENDERED="speed-dial-rendered",e.TEAM_DASHBOARD_HEADER_RENDERED="team-dashboard-header-rendered",e.TEAM_DASHBOARD_VIEW_RENDERED="team-dashboard-view-rendered",e.TEAMS_DASHBOARD_HEADER_RENDERED="teams-dashboard-header-rendered",e.TEAMS_DASHBOARD_VIEW_RENDERED="teams-dashboard-view-rendered",e.TEAMS_GRID_VIEW_HEADER_RENDERED="teams-grid-view-header-rendered",e.TEAMS_GRID_VIEW_RENDERED="teams-grid-view-rendered",e.TFL_ONBOARDING_APP_RENDERED="tfl-onboarding-rendered",e.VIRTUAL_LIST_RENDER_BUFFER_FILLED="virtual-list-render-buffer-filled",e.USER_ONBOARDING_TO_TEAM_VIEW_RENDERED="user-onboarding-to-team-view-rendered",e.USER_ONBOARDING_HEADER_RENDERED="user-onboarding-header-rendered",e.MEETING_LINK_CARD_RENDERED="meeting-link-card-rendered",e.UPCOMING_EVENT_CARD_RENDERED="upcoming-event-card-rendered"}(i||(i={}))},535565:(e,t,n)=>{n.d(t,{J:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("mutation setPlatformAppsFetchPolicy($input:[PlatformAppsFetchPolicyInput!]!) {setPlatformAppsFetchPolicy(input:$input) @client}");return delete this.definitions,this.definitions=e.definitions}}},549112:(e,t,n)=>{n.d(t,{h:()=>a});var i=n(650656),r=n(383626);const a={kind:"Document",get definitions(){const e=(0,i.G)("fragment appDefinition on AppDefinition {id,name,developerName,developerUrl,privacyUrl,termsOfUseUrl,version,shortDescription,longDescription,profileCardDescription {isAIGenerated,actionSection {actionTitle,actionDescription}},smallImageUrl,largeImageUrl,accentColor,categories,validDomains,externalId,tenantId,isBlocked,isFullScreenApp,isFullTrustApp,isMicrosoftOwned,showTabLoadingIndicator,templatedAppId,bots {...botDefinition},customBots {endpointUrl,secret},connectors {connectorId,scopes,configurationUrl},galleryTabs {configurationUrl,canUpdateConfiguration,canHaveTabConversation,scopes,meetingSurfaces,context},staticTabs {entityId,name,order,contentUrl,contentBotId,websiteUrl,scopes,context,containerAppIds},meetingExtensionDefinition {isAnonymousAccessAllowed,supportsStreaming,supportsCustomShareToStage,scenes {id,name,file,preview,maxAudience,seatsReservedForOrganizersOrPresenters},filters {id,name,thumbnail},videoAppContentUrl},authorization {permissions {orgWide {name,type},resourceSpecific {name,type}}},messageExtensions {type,botId,canUpdateConfiguration,fetchCommands,scopes,commands {id,title,context,description,initialRun,type,parameters {name,title,description,inputType,value,isRequired,choices {title,value}},appKey,fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}},messageHandlers {type,value {domains,supportsAnonymousAccess}},authorization {authType,microsoftEntraConfiguration {supportsSingleSignOn}}},webApplicationInfo {id,appKey,resource,applicationPermissions},metaCapabilities {copilotPlugins {scopes},copilotExtensions {scopes},declarativeCopilots {scopes},customEngineCopilots {scopes}},screenshotUrls,officeAssetId,videoUrl,devicePermissions,securityComplianceInfo {mcasId,status,csaId,csaName},defaultInstallScope,defaultGroupCapability {team,groupchat,meetings},subscriptionOffer {offerId},manifestVersion,blockedConfigurations,backgroundLoadConfiguration {tabConfiguration {contentUrl}},copilotExtensions {customEngineCopilots {type,id},declarativeCopilots {id,isBlocked}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.x.definitions]}}},386143:(e,t,n)=>{n.d(t,{j:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment appsUsageFields on AppsUsage {appIds,appActions {appId,actionId},appCommands {appId,commandType,commandId},appScenes {appId,sceneId},appsMru {appId,lastUsedTimeStamp}}");return delete this.definitions,this.definitions=e.definitions}}},383626:(e,t,n)=>{n.d(t,{x:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment botDefinition on BotDefinition {id,scopes,capabilities {isNotificationOnly,supportsFiles,supportsCalling,supportsVideo},commandLists {commands {title,description},scopes},configuration {groupChat {fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}},team {fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}}},registrationInfo {source,environment}}");return delete this.definitions,this.definitions=e.definitions}}},420065:(e,t,n)=>{n.d(t,{q:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment consumptionHorizonBookmarkFields on ConsumptionHorizonBookmark {id,originalArrivalTime,timeStamp,clientMessageId}");return delete this.definitions,this.definitions=e.definitions}}},538112:(e,t,n)=>{n.d(t,{U:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment consumptionHorizonFields on ConsumptionHorizon {id,originalArrivalTime,timeStamp,clientMessageId,isExpired}");return delete this.definitions,this.definitions=e.definitions}}},681677:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonActiveCallFragment on ActiveCallOfConversation {id,callType}");return delete this.definitions,this.definitions=e.definitions}}},753648:(e,t,n)=>{n.d(t,{h:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatAddMembersFragment on Conversation {id,cfet,chatSubType,guardianChatInfo,hasFederatedUser,hasTflConsumerUser,hasTflSmsUnverifiedUser,hasTflSmsVerifiedUser,isMeeting,isOneOnOne,isOneOnOneBotChat,isUserMember,memberIds,tflOffNetworkUserLength,tenantId,title,interopConversationStatus,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant},membersLimited {id,isFederated},botMembers {id},meetingChatType}");return delete this.definitions,this.definitions=e.definitions}}},831051:(e,t,n)=>{n.d(t,{Y:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatMtoTelemetryFragment on Conversation {id,hasFederatedMTOUser}");return delete this.definitions,this.definitions=e.definitions}}},610238:(e,t,n)=>{n.d(t,{F:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatPaneLayoutFragment on Conversation {id,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant}}");return delete this.definitions,this.definitions=e.definitions}}},593697:(e,t,n)=>{n.d(t,{Y:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatPinnedMessageFragment on Message {id,content,from,imDisplayName,messageType,originalArrivalTime,deleteTime,isSkypeMessage,files {id,itemId,type,title},cards {name,content,contentType,appId}}");return delete this.definitions,this.definitions=e.definitions}}},371466:(e,t,n)=>{n.d(t,{W:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatRecapFragment on Conversation {id,hasRecap}");return delete this.definitions,this.definitions=e.definitions}}},430704:(e,t,n)=>{n.d(t,{_:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatSmartCardInfoFragment on Conversation {id,smartCardInfo {id,summaryStartTime,unreadMessageCount,unreadMessagesContentLength},notes {id,isSynthesisAvailable,showConvergedUx},isMeeting,meetingInformation {id,iCalUid,meetingType,endTime,organizerId,tenantId},activeCall {id}}");return delete this.definitions,this.definitions=e.definitions}}},12183:(e,t,n)=>{n.d(t,{I:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonChatWithMtoUserBannerFragment on Conversation {id,firstMtoMember {id,homeMri,displayName},mtoHomeUserInfo {shouldChatWithFederatedIdentities,areAllChatMembersReachableInTheirHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}}},944366:(e,t,n)=>{n.d(t,{I:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonHeaderWithChatDataFragment on Conversation {id,trustworthy {trustLevel,trustReason,trustLabel}}");return delete this.definitions,this.definitions=e.definitions}}},208976:(e,t,n)=>{n.d(t,{x:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonRecordingMessageMiFragment on MeetingInformation {id,meetingType,startTime,templateDetails {id}}");return delete this.definitions,this.definitions=e.definitions}}},989990:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonUseExternalTagFragment on Conversation {id,cfet,creator,hasFederatedUser,hasTflConsumerUser,isFederated,isExternal,isMeeting,isOneOnOne,tflOffNetworkUserLength,memberIds,membersLimited {id,displayName,givenName,isFederated}}");return delete this.definitions,this.definitions=e.definitions}}},96065:(e,t,n)=>{n.d(t,{P:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonUseMtoUserBannerFragment on Conversation {id,shortTitle,mtoShadowUserInfo {shouldChatInHomeTenant,areAllChatMembersReachableInHomeTenant,memberHomeTenantMris}}");return delete this.definitions,this.definitions=e.definitions}}},479054:(e,t,n)=>{n.d(t,{B:()=>d});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment DataFragmentsCommonInstallerIdentityFragment on InstallerIdentity {installerType,userId,azureAdAppId}");return delete this.definitions,this.definitions=e.definitions}};var a=n(458782),s=n(549112);const o={kind:"Document",get definitions(){const e=(0,i.G)("fragment appPermissions on AppPermissions {orgWide {name,type},resourceSpecific {name,type}}");return delete this.definitions,this.definitions=e.definitions}},d={kind:"Document",get definitions(){const e=(0,i.G)("fragment installedAppFields on InstalledApp {installedScope,id,installationState,installedAppProps {isUninstallable,isAdminPreInstalled,isNewGlobalPreInstalled,isNewAdminPreInstalled,isUnlicensed},conversationId,installedVersion,installerIdentity {...DataFragmentsCommonInstallerIdentityFragment},messageExtensionStates {...messageExtensionState},definition {...appDefinition},permissions {...appPermissions},statusInfo {status},botMetadata {registrationInfo {sourceAppId}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions,...a.O.definitions,...s.h.definitions,...o.definitions]}}},697615:(e,t,n)=>{n.d(t,{L:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment lastMessageFields on LastMessage {content,originalArrivalTime,imDisplayName,id,clientMessageId,from,messageType,deleteTime,mentions {id,itemId,userId,displayName,mentionType,appId},importance,files {id},cards {appIcon,appId,appName,cardClientId,content,contentType,locale,sourceType}}");return delete this.definitions,this.definitions=e.definitions}}},458782:(e,t,n)=>{n.d(t,{O:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment messageExtensionState on MessageExtensionState {botId,isPinned,pinOrder}");return delete this.definitions,this.definitions=e.definitions}}},253793:(e,t,n)=>{n.d(t,{M:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment pinnedMessageItemFields on Message {id}");return delete this.definitions,this.definitions=e.definitions}}},350556:(e,t,n)=>{n.d(t,{z:()=>r,x:()=>a});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment featureSettingsFields on UserFeatureSettingsInfo {coExistenceMode,isPrivateChatEnabled}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("fragment userFields on User {id,objectId,displayName,decoratedDisplayName,givenName,surname,email,emailsInfo {address,isPrimary},tenantId,tenantName,isFederated,jobTitle,department,featureSettings {...featureSettingsFields},type,profileType,userType,trustworthy {trustLevel,trustReason,trustLabel}}");return delete this.definitions,this.definitions=[...e.definitions,...r.definitions]}}},557830:(e,t,n)=>{n.d(t,{p:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("fragment userProperties on ConversationUserProperties {isMutedInChannel,role,maskId}");return delete this.definitions,this.definitions=e.definitions}}},137914:(e,t,n)=>{n.d(t,{lu:()=>i,fO:()=>r});const i=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},r=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e))},813135:(e,t,n)=>{n.d(t,{NX:()=>V,Lm:()=>W,PN:()=>K,Kj:()=>j,OZ:()=>Q,oq:()=>J,Dc:()=>dt,vc:()=>Le,Lv:()=>Ne,f4:()=>Ce,jI:()=>Ie,qU:()=>fe,KH:()=>rt,QM:()=>me,UL:()=>Re,Wk:()=>Me,of:()=>ot,PH:()=>st,__:()=>it,ic:()=>gt,wD:()=>tt,fc:()=>at,Rx:()=>ht,S3:()=>ue,XO:()=>ye,Xq:()=>Ae,OB:()=>We,FC:()=>He,hE:()=>Ve,fO:()=>_e,jp:()=>ge,qQ:()=>Be,dM:()=>le,bo:()=>ne,nT:()=>qe,RE:()=>ze,_u:()=>he,TH:()=>Ee});var i=n(401368),r=n(214568),a=n(315560),s=n(388771),o=n(14471),d=n(607087),l=n(259521),c=n(872313),p=n(809121),u=n(827534),m=n(453755),h=n(405826),g=n(313577),f=n(800467),I=n(300545),A=n(639738),E=n(215982),C=n(921638),y=n(182635),T=n(625270),S=n(847887),v=n(48520),D=n(480354),_=n(111438),P=n(941269),b=n(852199),N=n(597204),M=n(912435),R=n(183111);const F=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let n=U(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:i,eventRecurrencePattern:r}=e;return n=[...n,...O(i,t),...w(r,t)],n},O=(e,t)=>U(e,["startDate"],`${t}.eventRecurrenceRange`),w=(e,t)=>{let n=[];if(e){const{daily:i,weekly:r,monthly:a,yearly:s,relativeMonthly:o,relativeYearly:d}=e;n=[...U(e,["patternType"],`${t}.eventRecurrencePattern`),...U(i,["interval"],`${t}.eventRecurrencePattern.daily`),...U(r,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...U(a,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...U(s,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...U(o,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...U(d,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],r&&r.daysOfTheWeek&&r.daysOfTheWeek.some((e=>(0,D.isNil)(e)))&&n.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return n},U=(e,t,n)=>{const i=[];return(0,D.isNil)(e)||t.forEach((t=>{(0,D.isNil)(e[t])&&i.push(`${n}.${String(t)}`)})),i};var L=n(264642),k=n(258471),G=n(137914),x=n(188377);const B=e=>e&&e.vivaTopicsAnnotations?(e=>{try{return(e=>{const{ApiVersion:t,EntityAnnotation:n,TraceId:i,ClientRequestId:r}=e,{SectionMatches:a}=n;return{apiVersion:t,entityAnnotation:{sectionMatches:a.map((e=>{const{EntityMatches:t,SectionId:n}=e;return{entityMatches:t.map((e=>{const{Entities:t,HighlightedName:n,Length:i,StartPos:r,OccurrenceIndex:a,TotalOccurrences:s,Relevance:o}=e;return{entities:t.map((e=>{const{DisplayName:t,Id:n,RelevanceScore:i,Source:r,Type:a}=e;return{displayName:t,id:n,relevanceScore:i,source:r,type:a}})),highlightedName:n,length:i,startPos:r,occurrenceIndex:a,totalOccurrences:s,relevance:{annotationScore:o.AnnotationScore}}})),sectionId:n}}))},traceId:i,clientRequestId:r}})((0,x.n)(e))}catch(e){return}})(e.vivaTopicsAnnotations)??null:null,$="http://schema.skype.com",H=`${$}/Mention`,W=`${$}/File`,V=2,q=C.$,z=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]),J="welcomePage",Q="48:notes",j="bizChatMetaOSChatListEntryPoint",K="holisticRecapChatListEntryPoint",Y=(e,t,n,i=!1)=>{if(!e?.emotions)return null;const r=e.emotions.map((({key:e,users:n})=>({key:e,users:n.map((({mri:n,time:i,value:r})=>({id:(0,v.zJ)(q(n),t,e),time:i,value:r,userId:q(n)}))).sort(((e,t)=>e.time-t.time))})));return i&&r.sort(((e,t)=>(n?.emotions?.[t.key]??t.users.length??0)-(n?.emotions?.[e.key]??e.users.length??0))),r},X=(e,t)=>{if(!t||!t.emotions)return null;const n=t.emotions;return Object.keys(n).map((t=>({id:(0,v.io)(e,t),key:t,count:n[t]})))},Z=(e,t,n)=>e&&e.onbehalfof?(0,d.F)(e.onbehalfof,t,n):null,ee=(e,t)=>{if(!t||!t.atp)return null;const n=t.atp;try{return"string"==typeof n?JSON.parse(n):n}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${t}`),null}},te=(e,t,n,i)=>{if(!t||!t.files)return null;const r=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(t?.files),a=0;return e=e.filter((e=>"deeplink"===e.type)),a=e.length,e=e.filter((e=>e)),a!==e.length&&(r?.errorToTelemetry?.(`toDeepLinks::Files contains falsy value. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),a=e.length),e=e.filter((e=>e.id)),a!==e.length&&r?.errorToTelemetry?.(`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),e.map((({id:e,title:t,fileInfo:n,channelId:r,state:a})=>({id:e,title:t,state:a,serverRelativeUrl:n.serverRelativeUrl,channelId:r||i,siteUrl:n.siteUrl,objectUrl:n.fileUrl})))}catch(e){return r?.errorToTelemetry?.(`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${n}::conversationId=${i}`,"process_deeplink_parse_error"),null}},ne=e=>e&&JSON.stringify((0,D.map)(e,(({content:e,...t})=>({...t,content:JSON.parse(e)})))),ie=(e,t,n,i)=>{const r=i||!!e?.urlpreviews;if(!e||!e.links&&!e.urlpreviews)return{urlPreview:null,embeddedLinks:null};try{const t=["http","https"],i=r?JSON.parse(e.urlpreviews):JSON.parse(e.links),a=[],s=[];return i.forEach((e=>{re(e,a,t),r?se(e,s,t):ae(e,s,[...t,"blob"],n)})),{urlPreview:s.length>0?s[0]:null,embeddedLinks:a}}catch(e){return t.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},re=(e,t,n)=>{const{url:i,fileShareUrlMeta:r,title:a,description:s}=e,o=(0,y.Jf)(i,n);r&&t.push({objectUrl:o,title:a,description:s,fileShareUrlMeta:r})},ae=(e,t,n,i)=>{const{url:r,preview:a,previewenabled:s}=e,{previewurl:o,previewmeta:d,title:l,description:c}=a||{},p=(0,y.Jf)(r,n,i),u=d&&"object"==typeof d&&"number"==typeof d.width&&"number"==typeof d.height;t.push({url:p,thumbnail:(0,y.Jf)(o,n,i),title:l,description:c,previewEnabled:s,thumbnailMeta:u?{width:d.width,height:d.height}:null})},se=(e,t,n)=>{const{url:i="",title:r,description:a,thumbnail:s="",thumbnail_meta:o}=e.value||{},d=(0,y.Jf)(i,n);t.push({url:d,thumbnail:(0,y.Jf)(s,n),title:r,description:a,previewEnabled:!!s,thumbnailMeta:o?{width:o.width||0,height:o.height||0}:null})},oe=(e,t,n,i)=>{let r=i&&i.policyViolation;const a=i&&i.genericStreamMetadata;if(!r&&!a)return null;const s={};if("string"==typeof r)try{r=JSON.parse(r)}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${t}. Error: ${n}`)}r&&(s.policyViolation=r);let o=a&&a.policyTip;if("string"==typeof a)try{o=JSON.parse(a).policyTip}catch(n){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${t}. Error: ${n}`)}if(o){const e=i&&i.subject;s.dlpData={id:t,content:n,policyTip:o,subject:e}}return s},de=e=>{if(!e.scheduledmeetinginfo||(0,D.isNil)(e.scheduledmeetinginfo.eventType))return null;const{iCalUid:t,...n}=e.scheduledmeetinginfo;return{iCalUID:t,...n}},le=(e,t)=>{if(!t||!t.meeting)return null;try{const e=JSON.parse(t.meeting),{organizerId:n,tenantId:i,meetingJoinUrl:r,location:a,itemid:s,meetingtitle:o,rsvpTo:d,body:c}=e;return(e=>{const{scheduledMeetingInfo:t}=e,n=F(t);if(n.length)throw(0,M.$5)(R.Ir.DataLayerClient,R.O4.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${n.join(", ")}`);return e})({meetingActionType:e[l.rF.MeetingType],organizerId:n,tenantId:i,meetingJoinUrl:r,location:a,itemId:s,meetingTitle:o,rsvpTo:d,body:c,scheduledMeetingInfo:de(e)})}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${t}`),null}},ce=(e,t,n,i)=>{const r=t||n;if(r)return r;if(i&&z.has(e)){const e=i.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},pe=(e,t)=>"-1"===e?t??"":e,ue=(e,t)=>{if(e.length<=1)return e;const n=(0,d.BO)(t),i=[...e];return i.sort(((e,t)=>n.compare(e.displayName||"",t.displayName||""))),i},me=(e,t,n)=>{const i=ue(e,n),r=[],a=[];return(0,D.forEach)(i,(e=>{const{id:n,displayName:i}=e;if(n!==t&&!N.af.isTFLOffNetworkUser(n)&&i){if(a.push(i),20===a.length)return!1;r.length<3&&r.push(e)}return!0})),{membersLimited:r,memberDisplayNamesLimited:a}},he=(e,t,n,i,r,a,o,d,l,u,m,h)=>{if(!e?.id)return;const{id:g,messagetype:f,properties:I,callId:A,skypeguid:E,composetime:C,content:y,contentHash:T,conversationid:S,crossPostData:v}=e,D=(0,c.io)(I,e.originalarrivaltime,(0,p.Hv)({conversationLink:e.conversationLink}),n),_=ge(e,t,r,a,i,!!o,h,D),P=(0,k.UM)(t,I?.languageStamp,d?.targetLanguageCode,y,u),b=(0,k.qt)(d,P,_.translatedContent,_.translationStatus),N=B(I),M=(0,k.rl)(g,P?.code,l);return{..._,__typename:"Message",__model:e,contentHash:T,interopDeliveryState:pt(I?.deliveryState),smsDeliveryReports:I&&I.smsDeliveryReports?I.smsDeliveryReports:null,announcement:ye(I),notifications:ct(t,I),meeting:le(t,I),onBehalfOf:Z(I,g,t),callId:ce(f,A,E||I&&I.skypeguid,y),skypeguid:E,composeTime:C,isCallStartedMessage:(0,s.dG)(y,f),replyPermission:I?.replyPermission??null,atpSharepointData:ee(t,I),isDeletedByAdmin:I?.adminDelete||!1,conversationId:S,vivaTopicsAnnotations:N,crossPostStatus:v?(0,G.lu)(v.status):void 0,crossPostFailedChannels:v?.failedChannels,isWrittenInPreferredLanguage:!b,languageSeenBefore:M,sourceLanguageCode:P?.code??null,repliesSummary:m,parentMessageId:(0,p.gB)(e.conversationLink,_.id||"")}},ge=({id:e,content:t,originalarrivaltime:n,from:i,messagetype:r,annotationsSummary:a,userHasStarred:s,properties:o,clientmessageid:l,version:c,prioritizeimdisplayname:h,imdisplayname:g,translation:f,conversationid:A,conversationLink:E,sendPipelineStatus:C,draftDetails:y},T,S,v,D,P=!1,b,N=!1)=>{let M=t;S&&(M=S);const R=(0,I.LA)(T,o,v),F=(0,u.e)(f),O="Done"===F?.translationStatus?(0,L.yT)()[0].toString():c,w=(0,k.UM)(T,o?.languageStamp),U=(0,p.A$)(y);return{id:pe(e,l),content:M,originalArrivalTime:n,from:q(i),messageType:(0,m.h)(T,r,o),isImportant:(0,_.IA)(o?.importance),importance:(0,_.mJ)(o?.importance),emotionsSummary:X(e,a),emotions:Y(o,e,a,P),mentions:(0,d.fi)(o,e,T),cards:R,files:(0,I.Fx)(T,o),deeplinks:te(T,o,e,A||E),...ie(o,T,b,N),deleteTime:o?.deletetime,editTime:o?.edittime,scheduledSendTime:U?new Date(U).toISOString():null,draftId:o?.draftId||(U?e:null),version:O,userHasSaved:s,renamedDisplayName:h?g:null,imDisplayName:g,clientMessageId:l,dlpContext:oe(T,e,t,o),atpSharepointData:ee(T,o),status:D||"Delivered",hardDeleteReason:o?.hardDeleteReason,hardDeleteTime:o?.hardDeleteTime,onBehalfOf:Z(o,e,T),sourceLanguageCode:w?.code??null,...F,sendPipelineStatus:C}};function fe(e,t){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:t,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,importance:null,mentions:null,clientMessageId:e,isSystemMessage:!1,isStreamOngoing:!1,canShowEveryoneMentionBadge:!1,formattedArrivalTime:null,hasMention:null,blurhash:null}}function Ie(e,t){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:t,timeStamp:t,clientMessageId:(0,b.sN)(),isExpired:!1}}function Ae(e){const t=new Date,n=t.toISOString();return{__typename:"Conversation",id:e,activeCall:null,ariaLabelledBy:null,arrivalTimeAriaLabel:null,avatarUrl:null,cfet:!1,chatHistoryHiddenTime:null,clearHistoryTime:null,clientArrivalTime:null,creator:null,extendedDirectoryRedemptionRequired:null,guardianChatInfo:null,hasFederatedUser:!1,hasGuestUser:!1,hasMissedCall:null,hasMissedMention:null,hasMissedReaction:null,hasTflConsumerUser:!1,hasTflSmsUser:null,hasTflSmsVerifiedUser:!1,hasTypingUsers:null,hasUnknownEnterpriseUser:!1,interopConversationStatus:null,isBotBlocked:null,isBotMember:null,isDisabled:!1,isExternal:null,isFederated:!1,isHidden:null,isMeeting:!1,isMuted:null,isOneOnOne:!1,isOneOnOneBotChat:!1,isPhonelinkSmsChat:null,isRead:!0,isSfB:!1,isSmsOnly:null,isTFWSmsChat:null,isUserMember:!0,lastContentMessageTime:null,lastMessage:fe(t.getTime().toString(),n),lastUpdate:null,localClientId:null,me:null,meetingChatType:null,memberCount:null,membersLimited:[],oneOnOneOtherMemberId:null,picture:null,quarantineCounter:null,sensitivityLabel:null,shortTitle:null,tenantId:null,tflOffNetworkUser:null,tflOffNetworkUserLength:null,title:"",userConsumptionHorizon:null}}const Ee=(e,t,n,i,r=!1,a)=>{const{annotationsSummary:s,id:o,from:l,messageType:p,properties:u,version:h,...g}=e;if(!o)return null;const f=(0,c.io)(u,g.originalArrivalTime,t,i);try{const e=B(u);return{__typename:"Message",__model:null,id:o,from:l,messageType:(0,m.h)(n,p,u),version:(0,D.isNumber)(h)?h.toString():void 0,isImportant:(0,_.IA)(u&&u.importance),importance:(0,_.mJ)(u&&u.importance),interopDeliveryState:pt(u?.deliveryState),smsDeliveryReports:u?.smsDeliveryReports||null,emotions:Y(u,o,s,r),emotionsSummary:X(o,s),announcement:ye(u),mentions:(0,d.fi)(u,o,n),onBehalfOf:Z(u,o,n),cards:(0,I.LA)(n,u),files:(0,I.Fx)(n,u),deeplinks:te(n,u,o,t),...ie(u,n,a,f),deleteTime:u&&u.deletetime,editTime:u&&u.edittime,isDeletedByAdmin:u&&u.adminDelete,scheduledSendTime:u?.sendAt||null,draftId:u?.draftId||null,hardDeleteTime:u&&u.hardDeleteTime,hardDeleteReason:u&&u.hardDeleteReason,status:"Delivered",dlpContext:oe(n,o,g.content,u),meeting:le(n,u),callId:u&&u.skypeguid,sourceLanguageCode:(0,k.UM)(n,u?.languageStamp)?.code??null,vivaTopicsAnnotations:e,...g}}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{__model:null,id:o,from:l,messageType:(0,m.h)(n,p,u),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null,...g}}},Ce=(e,t,n,i)=>(0,A.FQ)({id:e,properties:{[l.H0.ConsumptionHorizon]:(0,E.cc)(i)},threadProperties:n,type:t}),ye=e=>{const t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e?.cards)return t;const n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;const i=n.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!i)return t;const r=Te(i);return{title:e.title?e.title:"",originalImageUrl:r.originalImageUrl,croppedImageUrl:r.croppedImageUrl,colorTheme:r.colorTheme,croppedImageHeight:r.croppedImageHeight,croppedImageWidth:r.croppedImageWidth,croppedImageAltText:r.croppedImageAltText,isTeamsIllustration:r.isTeamsIllustration}},Te=e=>{let t=(0,D.get)(e,"content.imageData.origImage.src",null),n=(0,D.get)(e,"content.imageData.croppedImage.src",null);const i=(0,D.get)(e,"content.imageData.croppedImage.imageHeight",null),r=(0,D.get)(e,"content.imageData.croppedImage.imageWidth",null),a=(0,D.get)(e,"content.imageData.croppedImage.imageAltText",null),s=(0,D.get)(e,"content.imageData.isTeamsIllustration",null);let o=(0,D.get)(e,"content.imageData.colorTheme",null)||(0,D.get)(e,"content.colorTheme",null);return t=void 0===t?null:t,n=void 0===n?null:n,o=void 0===o?null:o,{originalImageUrl:t,croppedImageUrl:n,croppedImageHeight:i,croppedImageWidth:r,croppedImageAltText:a,colorTheme:o,isTeamsIllustration:s}},Se=(e,t,n)=>{try{const n=ve(t),i=n?.map((t=>({activityReplyToId:t.replyToId,activityTimestamp:t.timestamp,convId:e,suggestedReplies:t.suggestedActions.actions.filter((e=>e?.channelData?.id&&e?.channelData?.utcTime)).map((e=>{const n={targetMessageId:e?.channelData?.targetMessageId||t.replyToId,type:e?.channelData?.type||"reply"};return{suggestionChannelData:{...e?.channelData,...n},value:e.value||e.title,title:e.title,whisperId:t.id}}))})));return i&&0!==i.length?{suggestedRepliesCollections:i}:null}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},ve=e=>{const t=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>e?.type===l.jQ&&e?.from?.id===l.OD&&e?.timestamp&&e?.suggestedActions?.actions?.some((e=>e.type===l.m8||e.type===l.Wg))));return t&&0!==t.length?t:null},De=e=>{switch(e){case h.Wf.None:return"Unknown";case h.Wf.Adhoc:return"Adhoc";case h.Wf.Scheduled:return"Scheduled";case h.Wf.Recurring:return"Recurring";case h.Wf.Broadcast:return"Broadcast";case h.Wf.MeetNow:return"MeetNow"}},_e=e=>{if(!e)return null;const t=[];return e?.forEach((e=>{e.messageVisibilityTime&&t.push({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})})),t};function Pe(e,t){if(!e||!t)return!1;return(0,g.CF)(e,t,!t.get(i.w.Messaging).disableIgnoreRetentionHorizon)>0}function be(e,t,n,i,r,a=!1,s=!1,o,d,l=!1){const c=(0,I.vu)(e,n),u=e.find((({id:e})=>e===t))||null,m=nt(e),h=(0,p.Yo)(e,r,[],o).members||[];return{memberIds:h.map((({id:e})=>e)),...me(h,t,i),...Ne(c),...Le(t,h),me:u,isUserMember:!!u,tflOffNetworkUser:(0,D.first)(m),tflOffNetworkUserLength:m.length,hasBotMember:h.some((({id:e})=>(0,p.Iz)(e))),hasFederatedUser:!!c.length||a,hasTflConsumerUser:Re(h)||s,hasEnterpriseUser:Ue(h),hasUnknownEnterpriseUser:we(h),hasUnknownConsumerUser:Oe(h),hasUnresolvedFederatedUser:c.some(N.af.isUnknownUser),hasTflSmsUnverifiedUser:Me(h),hasTflSmsVerifiedUser:Fe(h),isRetentionHorizonSet:Pe(d,o),hasExtendedDirectoryUsers:ut(h),pendingBots:mt(d),hasGuestUser:l}}const Ne=e=>{const t=e.filter((e=>!N.af.isUnknownUser(e)&&e.featureSettings?.coExistenceMode!==o.bi.TeamsOnly&&!!e.displayName));return{nonTeamsFederatedUserLimitedNames:t.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:t.length}},Me=e=>e.some((({id:e})=>(0,p.gZ)(e))),Re=e=>e.some((e=>N.af.isTFLConsumerUser(e))),Fe=e=>e.some((e=>N.af.isTFLSmsVerifiedMri(e?.id))),Oe=e=>e.some((e=>(0,p.W4)(e.id)&&N.af.isUnknownUser(e))),we=e=>e.some((e=>N.af.isEnterpriseUserMri(e.id)&&N.af.isUnknownUser(e))),Ue=e=>e.some((e=>N.af.isEnterpriseUserMri(e.id))),Le=(e,t)=>{let n=!0;const i=t&&t.some((t=>{if(!t.isFederated&&!(0,p.oG)(t.id,l.LE)&&t.id!==e&&t.featureSettings){const e=t.featureSettings.isPrivateChatEnabled;return null==e?(n=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:n,isChatDisabledForRecipients:i}},ke={opted_out:"OptedOut",claimed:"Claimed",deprovisioned:"Deprovisioned"},Ge=e=>{if(!e)return;const t=(0,T.j)(e);return{newlyCreatedUserId:t.userId,code:ke[t.code]}},xe=e=>{if(e)return(0,S.K)()("Importing","Completed").find((t=>t===e))},Be=(e,t)=>({...t,preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__model:e||null,__typename:"LastMessage"}),$e=e=>e?`${e}`:null,He=({id:e,members:t,consumptionHorizon:n,userConsumptionHorizon:i,lastMessage:r,creator:a,meetingInformation:s,isDisabled:o,disabledReason:d,importState:c,isMuted:p,isLastMessageFromMe:u,isRead:m,isOneOnOne:h,isOneOnOneBotChat:g,isSticky:f,isExternal:I,consumerGroupId:A,templateType:E,chatType:C,historyHiddenTime:y,createdAt:T,interopConversationStatus:S,quickReplyAugmentation:v,meetingPolicy:_,addedBy:N,addedByTenantId:M,sensitivityLabel:R,meetingChatType:F,lastL2MessageIdNFS:O,hasImpersonation:w,...U},L,k,G,x,B)=>{try{const y=(0,D.map)(t,(e=>(0,P.qK)(e))),T=r&&Be(r,Ee(r,e,L,G)),$=s&&{id:e,subject:s.subject,startTime:s.startTime,scenario:s.scenario,endTime:s.endTime,iCalUid:s.iCalUid,location:s.location,exchangeId:s.exchangeId,meetingType:s.meetingType?De(s.meetingType):"Unknown",resolvedSensitivityLabelId:s.resolvedSensitivityLabelId,isCopyRestrictionEnforced:s.isCopyRestrictionEnforced,templateDetails:s.templateDetails,meetingJoinUrl:s.meetingJoinUrl,messagingPolicy:s.messagingPolicy,exchangeDetails:s.exchangeDetails,lobbyThreadId:s.lobbyThreadId},H=!(!h&&!f&&E!==l.iy.ImmutableRoster),W=R&&R.id?{id:R.id,isCopyBlocked:R.protectTeamsLabelAction?.isCopyRestrictionEnforced||!1}:void 0,V=$e(O);return{__typename:"Conversation",...be(y,x?.id||"",k,B),...U,id:e,consumptionHorizon:n&&{__typename:"ConsumptionHorizon",...Ce(e,l.Cr.Chat,{lastjoinat:U.lastJoinAt},n)},consumptionHorizonBookmark:i&&{__typename:"ConsumptionHorizonBookmark",...Ce(e,l.Cr.Chat,{lastjoinat:U.lastJoinAt},i)},userConsumptionHorizon:i&&{__typename:"ConsumptionHorizonBookmark",...Ce(e,l.Cr.Chat,{lastjoinat:U.lastJoinAt},i)},lastL2MessageIdNotFromSelf:V,lastMessage:T,members:[],creator:a,meetingInformation:$,isDisabled:!!o,disabledReason:Ge(d),importState:xe(c),importMetadata:(0,b.Cq)(U.importMetadata),isMuted:p,isLastMessageFromMe:!!u,isRead:m,isOneOnOne:H,cfet:I,consumerGroupId:A,isOneOnOneBotChat:!!g,chatType:Qe(C),interopConversationStatus:Ke(S),quickReplyAugmentation:v&&Se(e,v,L),addedBy:N,addedByTenantId:M,meetingChatPolicy:Xe(_),sensitivityLabel:W,meetingChatType:et(F),hasImpersonation:ft(w)}}catch(t){L.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{...U,id:e,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:y,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,importMetadata:null,chatType:null,hasImpersonation:null}}},We=({id:e,members:t,tenantId:n,meetingInformation:i},r)=>{try{const r=(0,D.map)(t,(e=>(0,P.qK)(e)));return{__typename:"ConversationMembers",id:e,tenantId:n=n??"",meetingJoinUrl:i?.meetingJoinUrl??"",members:r}}catch(t){r.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${t}`);return{id:e,members:[]}}},Ve=(e,t,n,i,r,a)=>({node:He(e,t,n,i,r,a),cursor:e.createdAt||e.id});function qe(e){return JSON.stringify((0,D.map)(e,(e=>{const t=e.mentionType,n=e.displayName;return{"@type":H,itemid:e.itemId,mri:e.userId,appId:e.appId,mentionType:t,displayName:n}})))}function ze(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const t=e.mentionType,n=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n}})))}const Je=new Map([["chat","Chat"],["phonechat","PhoneChat"],["phonelink1on1chat","Phonelink1on1Chat"],["phonelinkgroupchat","PhonelinkGroupChat"],["meeting","Meeting"],["sfbinteropchat","SfBInteropChat"]]),Qe=e=>{let t=null;return null==e||(t=Je.get(e),void 0===t&&(t=null)),t},je=new Map([["AcceptPending","AcceptPending"],["ExtendedDirectoryAcceptPending","ExtendedDirectoryAcceptPending"],["Accepted","Accepted"],["Blocked","Blocked"],["Quarantined","Quarantined"],["AcceptPendingRecipient","AcceptPending"]]),Ke=e=>e&&je.get(e)||null,Ye=new Map([["ChatEnabled","ChatEnabled"],["ChatDisabled","ChatDisabled"],["InMeeting","InMeeting"],["ChatEnabledAnonymousDisabled","ChatEnabledAnonymousDisabled"],["InMeetingAnonymousDisabled","InMeetingAnonymousDisabled"],["InMeetingRestrictOrganizer","InMeetingRestrictOrganizer"],["InMeetingAnonymousDisabledRestrictOrganizer","InMeetingAnonymousDisabledRestrictOrganizer"]]),Xe=e=>e&&Ye.get(e)||null,Ze=new Map([["backroom","Backroom"],["lobby","Lobby"]]),et=e=>e&&Ze.get(e)||null,tt=e=>!!e&&"PhoneChat"===e,nt=e=>e.filter((e=>N.af.isTFLOffNetworkUser(e.id))),it=e=>(0,f.t0)(e)||(0,p.oZ)(e)||(0,g.xl)(e),rt=(e,t)=>(0,D.filter)(e,(0,D.omit)(t,"__typename")),at=e=>!!e?.startsWith("tfl:preview-"),st=e=>!!e&&(-1!==e.indexOf(l.iB)||-1!==e.indexOf(l.hd)),ot=e=>"AcceptPending"===e,dt=(e,t,n,i,a,s,o,d,l)=>{if(!e)return;const c="Phonelink1on1Chat"===t,p="PhonelinkGroupChat"===t,u=n?r.bF.Meeting:i?a?r.bF.Botchat:tt(t)?r.bF.SMSOneOnOneChat:(0,g.xl)(e)?r.bF.SfcInteropChat:(0,f.t0)(e)?r.bF.SfbInteropChat:s?r.bF.NativeFederatedChat:o?r.bF.FederatedChat:(0,g.qL)(e)&&c?r.bF.Phonelink1on1Chat:r.bF.OneOnOneChat:(0,g.L5)(e)?r.bF.StreamOfNotes:(0,g.qL)(e)&&p?r.bF.PhonelinkGroupChat:l||(e=>!!e&&e===h.vW.Channel)(d)?r.bF.Channel:r.bF.GroupChat;return u},lt=e=>{if((0,D.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,D.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},ct=(e,t)=>{if(!t||!t.notifications)return null;try{const e="string"==typeof t.notifications?JSON.parse(t.notifications):t.notifications;return e&&e.map((({surface:e,contentType:t,content:n})=>({surface:e,contentType:t,content:{value:{height:lt(n.value?.height)??void 0,width:lt(n.value?.width)??void 0,title:n.value?.title??"",url:n.value?.url??""},actions:n.actions??[]}})))}catch(t){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${t}`),null}};function pt(e){if(e)return"string"==typeof e?e:e.state}const ut=e=>e.some((e=>N.af.isExtendedDirectoryUser(e))),mt=e=>{if(e&&(0,d.Fz)(e.id)){const t=e.properties.pendingBotMembers;if(t){return(0,T.j)(t)}}},ht=e=>{const t=e.split(";");return{conversationId:t[0],replyChainId:t.find((e=>e.startsWith("replyChainId=")))?.split("=")[1]||null,messageId:t.find((e=>e.startsWith("messageId=")))?.split("=")[1]||null}},gt=e=>{const{replyChainId:t}=ht(e.id||"");return e.type===a.ck.chats&&!!t},ft=e=>null==e?null:"true"===e.toLowerCase()||"false"!==e.toLowerCase()&&null},852199:(e,t,n)=>{n.d(t,{sN:()=>r,ZI:()=>a,Cq:()=>o});var i=n(264642);function r(){const[e,t]=(0,i.yT)(2);return`${e}${t}`.substr(0,19)}const a=e=>void 0!==e?.pinnedTime&&e.pinnedTime>0,s=new Map([["Importing","IMPORTING"],["Completed","COMPLETED"],["RosterRestricted","ROSTER_RESTRICTED"],["None","NONE"]]),o=e=>{var t;if(e)return{importState:(t=e.importState,s.get(t)??"NONE")}}},111438:(e,t,n)=>{var i,r;n.d(t,{aY:()=>r,IA:()=>a,zS:()=>s,mJ:()=>o}),function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(i||(i={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(r||(r={}));const a=e=>"Important"===o(e),s=e=>r[e]||r.Standard,o=e=>{switch(e){case r.Important:case i.Important:return"Important";case r.Urgent:case i.Urgent:return"Urgent";case r.Standard:case i.Standard:default:return"Standard"}}},258471:(e,t,n)=>{n.d(t,{wJ:()=>d,KN:()=>c,bX:()=>p,W3:()=>h,fj:()=>g,UM:()=>f,qt:()=>A,rl:()=>E});var i,r=n(28430),a=n(845097),s=n(405826),o=n(86308);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(i||(i={}));const d=new RegExp("https?://[^\\s]+","i"),l="-",c=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let t=e.indexOf(l,1);if(-1===t)return e;let n=e.indexOf(l,t+1);return-1===n&&(n=e.length),n-t==5&&(t=n),e.substring(0,t)},p=e=>{const t=e?c(e):"",n=(0,r.get)("tcurlang")||t;return{targetLanguage:n,knownLanguages:[n]}},u=(e,t)=>(e=>{switch(e){case s.Uf.Success:return"Done";case s.Uf.MessageNotFound:return"MessageNotFound";case s.Uf.VersionNotFound:return"VersionNotFound";case s.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case s.Uf.SkipTranslation:case s.Uf.ContentIsEmpty:return"TranslationNotNeeded";default:return"UnknownError"}})(((e,t)=>{const n=s.Uf[e];return void 0!==n?n:(t?.error(`Unable to parse translation result code: ${e}`),s.Uf.UnknownError)})(e,t)),m=async(e,t,n,i,r,a,o,d,l)=>{try{return await e.translateMessages(t,n,i,r,a,o,l)}catch(e){return d.error(`Failed to translate ${o}: ${e}`),a.map((({id:e,version:t})=>({id:e,version:t||"",detectedLanguage:{languageId:"",score:0},resultCode:s.Uf[s.Uf.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}},h=async(e,t,n,i,r,s,o)=>{const{targetLanguage:d,knownLanguages:l}=n,c=(0,a.v4)(),p=r.map((({messageId:e,version:t})=>t?{id:e,version:t}:{id:e}));return{convId:i,targetLangCode:d,correlationId:c,translations:(await m(e,i,t,d,l,p,c,s,o)).map((e=>({messageId:e.id,content:e.translatedContent||"",sourceLangCode:e.detectedLanguage?.languageId||"",resultCode:u(e.resultCode,s),version:e.version})))}},g=async(e,t,n)=>{try{return(await e.getSupportedTranslationLanguages(t)).map((({languageTag:e,languageName:t})=>({languageCode:e,languageName:t})))}catch(e){return n.error(`Unable to retrieve languages: ${e}`),[]}},f=(e,t,n,r,a)=>{if("string"!=typeof t)return null;try{const e=(0,o.J)(t),s=e.languages?.split(";")?.map((e=>{const[t,n]=e.split(":");return{code:t,score:parseInt(n,10)}})),d=s[0].code;if("null"===d)return null;let l=s.length;l>0&&""===s[l-1].code&&(s.pop(),l--);const c=void 0!==e.length,p=l>0&&"length"===s[l-1].code;if(!(c||p))return{code:d,confidenceLevel:i.LOW};const u=JSON.parse(a??"{}").settingsData,m=u?.find((t=>t.detector===e.detector));if(!(m&&n&&r&&m.minConfidence))return{code:d,confidenceLevel:i.LOW};const h=((e,t)=>{const n=e.minCharMap,i=e.minCharMapOverrides,r=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return i?.[t]??n?.[r.get(t)??""]??n?.others??5})(m,d),g=m.minConfidence??70,f=s.find((e=>e.code===n))?.score;if(n!==d){let t=0;if(c&&(t=parseInt(e.length,10)||0),p&&(t=I(s)),t<h)return{code:d,confidenceLevel:i.LOW};if(f&&f>=g)return{code:n,confidenceLevel:i.LOW}}return{code:d,confidenceLevel:i.HIGH}}catch(n){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${t}.`),null}},I=e=>{const t=e.pop();return t?.score||0},A=(e,t,n,r)=>{const a=t?.code;if(!e||!a||t?.confidenceLevel===i.LOW)return!1;const s=e.knownLanguages;if(a===e.targetLanguageCode||s.includes(a))return!1;switch(e.translationMode){case"SUGGEST_TRANSLATION":return!0;case"ALWAYS_TRANSLATE":if(n&&"ShowOriginalMessage"===r)return!0}return!1},E=(e,t,n)=>{if(!n)return!1;let i=null;return n&&(i=n.find((e=>e.languageCode===t))),!(!i||i.messageId===e)}},941269:(e,t,n)=>{n.d(t,{qK:()=>r,N4:()=>a});var i=n(605145);const r=(e,t,n,r)=>(e=>({...e,__typename:"User"}))((0,i.zB)(e,t,n,r));const a=e=>{const{id:t,displayName:n,description:i,email:r,phone:a,mri:s,requestCount:o,syncSource:d}=e;return{__typename:"User",id:t,mri:s,objectId:s,displayName:n,userPrincipalName:s,givenName:n,surname:n,description:i,email:r,mobile:a,telephoneNumber:a,requestCount:o,syncSource:d}}},966984:(e,t,n)=>{n.d(t,{jr:()=>i,gM:()=>r,UB:()=>a,IN:()=>s,jq:()=>o,m7:()=>d,RS:()=>l,H$:()=>c,_N:()=>p,b5:()=>u,DU:()=>m,iV:()=>h,DP:()=>g,_e:()=>f,zK:()=>I,c3:()=>A,Pq:()=>E,Zw:()=>C,RX:()=>y,H:()=>T,ew:()=>S,Wg:()=>F,ez:()=>O,d9:()=>w,qf:()=>U,Gh:()=>L,RJ:()=>k,FG:()=>G,A1:()=>x,L2:()=>B,IT:()=>$});const i={Team:"Team",Personal:"Personal",GroupChat:"GroupChat"};var r,a,s,o;!function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(r||(r={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(a||(a={})),function(e){e.AppDefinition="AppDefinition",e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(s||(s={})),function(e){e.UserAppPin="UserAppPin",e.TenantAppPolicyChange="TenantAppPolicyChange",e.ProactiveAppRecommendations="ProactiveAppRecommendations"}(o||(o={}));const d={Tab:"Tab",Bot:"Bot",Messaging:"Messaging",Connector:"Connector",StaticTab:"StaticTab",CUSTOMBOT:"CUSTOMBOT"};var l;!function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced",e.Mutated="Mutated",e.HashUpdate="HashUpdate"}(l||(l={}));const c={Unknown:"Unknown",SidePanel:"SidePanel",Stage:"Stage"};var p;!function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(p||(p={}));const u={Unknown:"Unknown",PersonalTab:"PersonalTab",ChannelTab:"ChannelTab",PrivateChatTab:"PrivateChatTab",MeetingChatTab:"MeetingChatTab",MeetingDetailsTab:"MeetingDetailsTab",MeetingSidePanel:"MeetingSidePanel",MeetingStage:"MeetingStage",TeamLevelApp:"TeamLevelApp"};var m,h,g;!function(e){e.Application="Application",e.Delegated="Delegated"}(m||(m={})),function(e){e.Unknown="Unknown",e.Enabled="Enabled",e.Disabled="Disabled"}(h||(h={})),function(e){e.BotBased="botBased",e.ApiBased="apiBased"}(g||(g={}));const f={MRU:"MRU",AlphabeticalAsc:"AlphabeticalAsc",AlphabeticalDesc:"AlphabeticalDesc"};var I,A,E,C,y,T;!function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(I||(I={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(A||(A={})),function(e){e.User="User",e.AzureAdApp="AzureAdApp"}(E||(E={})),function(e){e.DeepLink="DeepLink"}(C||(C={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(y||(y={})),function(e){e.Federation="Federation"}(T||(T={}));const S={Unknown:"Unknown",TeamsApp:"TeamsApp",TaosSharedApp:"TaosSharedApp"};var v,D,_,P,b,N,M,R,F,O,w,U,L,k,G,x,B,$;!function(e){e.Mail="mail"}(v||(v={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(D||(D={})),function(e){e.General="general"}(_||(_={})),function(e){e.Short="short",e.Long="long"}(P||(P={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee",e.OnlineMeetingDetailsOrganizer="onlineMeetingDetailsOrganizer",e.LogEventMeetingDetailsAttendee="logEventMeetingDetailsAttendee",e.Default="default"}(b||(b={})),function(e){e.After="after",e.Before="before"}(N||(N={})),function(e){e.Button="button",e.Menu="menu"}(M||(M={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(R||(R={})),function(e){e.Bot="bot"}(F||(F={})),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra",e.OAuth2_0="oAuth2.0"}(O||(O={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings",e.Copilot="Copilot"}(w||(w={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(U||(U={})),function(e){e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.NotInstalled="NotInstalled",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(L||(L={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition",e.OpenAiPlugins="OpenAiPlugins"}(k||(k={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(G||(G={})),function(e){e.chats="chats",e.channels="channels",e.channelMeetings="meetings"}(x||(x={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned",e.AdminPrepinned="AdminPrepinned"}(B||(B={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}($||($={}))},607087:(e,t,n)=>{n.d(t,{qd:()=>m,qK:()=>h,Uv:()=>g,BO:()=>f,A:()=>I,Fz:()=>A,l7:()=>E,Sd:()=>C,H2:()=>y,zX:()=>T,gj:()=>S,F:()=>v,fi:()=>D,$U:()=>_,Ox:()=>P,Pf:()=>b,MM:()=>N});var i=n(401368),r=n(719816),a=n(809121),s=n(823704),o=n(800467),d=n(480354),l=n(767518),c=n(313577),p=n(912435),u=n(183111);const m="preview-";function h(e,t,n){if(!e.members)return!1;const i=e.members.find((e=>e.id!==n));return!!i&&((e.source===s.To.PutConversationLie||e.source===s.To.ResolverPutConversation)&&2===e.members.length&&!!t[i.id])}const g="newchat",f=(0,r.A)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),I=e=>(0,d.isString)(e)?"true"===e.toLowerCase():e||!1,A=e=>!!e&&-1!==e.indexOf(m),E=e=>e===g,C=e=>E(e)||A(e),y=e=>(0,o.t0)(e)&&C(e),T=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),S=e=>!!e&&e.includes("meeting"),v=(e,t,n)=>{try{if("string"==typeof e&&(0,a.AF)(e))return null;const n="string"==typeof e?JSON.parse(e):e;return n?.length?n.map((({itemid:e,mri:n,appId:i,displayName:r,mentionType:a})=>({id:`${t}_${e}_${n}`,userId:n,itemId:e,appId:i,displayName:r,mentionType:a}))):null}catch(e){const i=n?.newLogger("Chat Helper","data-resolvers-common");return i?.errorToTelemetry?.(`UnhandledException in messageId: ${t}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},D=(e,t,n)=>e&&e.mentions?v(e.mentions,t,n):null;function _(e,t,n,i,r){const a=i?"Parent team":"Channel";return(0,c.oy)(e)?{isDiscarded:!0,reasonToDiscard:`${a} is deleted`}:(0,l.f3)(e,t)?{isDiscarded:!0,reasonToDiscard:`${a} is deleted by conversation property`}:(0,c.F$)(e)&&!(0,c.BA)(e)&&n?{isDiscarded:!0,reasonToDiscard:`${a} is archived and not favorite`}:r&&(0,c.F$)(e)?{isDiscarded:!0,reasonToDiscard:`${a} is cross post channel selection and archived`}:i&&!(0,c.Gw)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of the parent team"}:(0,c.Zp)(e)&&!(0,c.Gw)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of private channel"}:{isDiscarded:!1,reasonToDiscard:"None"}}const P=e=>{let t;switch(e){case s.rI.Error:t="Error";break;case s.rI.Sending:t="Sending";break;case s.rI.Retrying:t="Retrying";break;default:t="Delivered"}return t},b=(e,t,n)=>{let i=[];if((0,d.isEmpty)(e)||(0,d.isEmpty)(t)){const i=`Invalid user ids when generating chat id from members: userId1=${e}, userId2=${t}`;throw n.error(i),(0,p.$5)(i,u.O4.InvalidInput,"chatIdFromMembers")}i=(0,a.Iz)(e)&&!(0,a.Iz)(t)?[(0,a.m9)(t),(0,a.m9)(e)]:!(0,a.Iz)(e)&&(0,a.Iz)(t)?[(0,a.m9)(e),(0,a.m9)(t)]:[(0,a.m9)(e),(0,a.m9)(t)].sort();const r=(0,a.Xb)(e),s=(0,a.Xb)(t);if(r||s){if(r===s)return`19:${r}:${i[0]}_${i[1]}@unq.gbl.spaces`;n.warn(`Both users are in different clouds: ${r} and ${s}. This should be a federated chat, falling back to default chat ID generation.`)}return`19:${i[0]}_${i[1]}@unq.gbl.spaces`};function N(e){const{ageGroup:t}=e.get(i.w.AgeConsent);return"MinorWithMsaParentalConsent"===t||"MinorWithoutMsaParentalConsent"===t||"MinorNoMsaParentalConsentRequired"===t||"MinorWithoutParentalConsent"===t||"MinorWithParentalConsent"===t||"MinorNoParentalConsentRequired"===t}},767518:(e,t,n)=>{n.d(t,{Rr:()=>l,zk:()=>c,YH:()=>p,UF:()=>u,wD:()=>m,Fp:()=>h,PF:()=>g,GD:()=>f,f3:()=>I,dG:()=>A,s5:()=>E});var i=n(401368),r=n(183111),a=n(259521),s=n(809121),o=n(313577),d=n(800467);const l=(e,t,n)=>{const{forceUseMemberPropertiesInMemberExpirationCheck:r,shouldTempJoinChannelIfModeratorIsNotAMember:s}=n.get(i.w.Sync),l=[],c=(0,o.IJ)(e),p=(0,o.Zl)(e)&&e.memberProperties?.[a.UO.ExplicitlyAdded],u=(0,o.Gw)(e,t),m=(0,d.Cy)(e);let h=!m;m&&s&&!u&&(h=!0);let g=!0;if((0,o.IV)(e)||(g=!1,l.push("Not a channel")),(0,o.Z9)(e)&&(g=!1,l.push("Is a chat")),c&&(g=!1,l.push("Is a general channel")),(0,o.Zp)(e)&&(g=!1,l.push("Is a private channel")),h||(g=!1,l.push(`canModeratorJoin is false, isUserModerator: ${m}`)),p&&(g=!1,l.push("Is explicitly added")),(0,o.E0)(e)&&(g=!1,l.push("Is a lie conversation")),u){const n=(0,o.Y5)(e,t,!0,!!r),i=(0,d.cR)(n);return i.shouldExtend?{shouldTempJoin:g,reasons:l}:(l.push(i.reason),{shouldTempJoin:!1,reasons:l})}return{shouldTempJoin:g,reasons:l}},c=(e,t,n,i)=>{const s=e.threadProperties[a.iy.SharedInSpaces];if(!s)return!1;{let e=[];try{e=JSON.parse(s)}catch(e){return n.error(`Error parsing ${a.iy.SharedInSpaces} property`,i,r.O4.Deserialization),!1}for(const n of e)if(n.spaceThreadId===t)return!0}return!1},p=(e,t,n,i)=>{const r=e.threadProperties[a.iy.SharedInSpaces];try{const e=r&&JSON.parse(r)||[];return e.find((e=>t.includes(e.spaceThreadId)))?.spaceThreadId||""}catch(t){return n.warn(`Couldnt get external team id for the channel ${e.id}`,i),""}},u=(e,t,n)=>{if(e){if(!(0,o.IV)(e))return;const i=e.threadProperties[a.iy.SharedInSpaces],r=[];if(i){const a=m(i,t,n,e.id);if(!a)return;for(const e of a)r.push(e.spaceThreadId);return r}}},m=(e,t,n,i)=>{let r=[];try{r=JSON.parse(e)}catch(e){return void(t.errorToTelemetry&&t.errorToTelemetry(`Error parsing ${a.iy.SharedInSpaces} property for conversationid ${i}`,"team_has_channels_get_shared_teams_failed",n,!0))}return r},h=e=>!(!(0,o.CN)(e)||!e.members?.some((e=>(0,s.Ku)(e.id)))),g=e=>h(e)&&(0,o.FA)(e)?"true"===e.threadProperties?.[a.iy.IsStickyThread]:e.id.includes(a.SE)&&"True"===e.threadProperties?.[a.iy.IsSmsThread],f=e=>{const{enablePaidSmsChat:t,teamsUserPhoneNumbers:n}=e.get(i.w.Messaging);return!(!t||!n?.phoneNumbers?.find((e=>"Primary"===e?.assignmentCategory&&e?.acquiredCapabilities?.includes("InboundA2PSms")&&e?.acquiredCapabilities?.includes("OutboundA2PSms"))))},I=(e,t)=>!!(0,o.IV)(e)&&((0,o.oy)(e)||!t.get(i.w.Sync).disableDeletedConversationPropertyCheck&&(0,o.bI)(e)),A=e=>{if(!(0,d.j7)(e.type))return!1;if((0,o.OA)(e.properties)!==a.vU.DECLINED)return!1;return!e.properties.lastMeetingUnhideTime},E=(e,t,n)=>{try{return JSON.parse(e.threadProperties?.pinnedItems||"[]")}catch(i){return t.error(`Error parsing pinnedItems for conversation ${e.id}`,n,r.O4.Deserialization),[]}}},800467:(e,t,n)=>{n.d(t,{Jy:()=>J,Ph:()=>m,rf:()=>h,CA:()=>w,IB:()=>q,FV:()=>z,oB:()=>B,BV:()=>O,IG:()=>$,_5:()=>U,oQ:()=>W,Ns:()=>x,qX:()=>N,y$:()=>E,aY:()=>I,Wq:()=>v,$b:()=>f,vQ:()=>b,GW:()=>R,n2:()=>F,RY:()=>j,CR:()=>L,j7:()=>k,Cy:()=>M,oI:()=>g,Z:()=>D,FF:()=>_,t0:()=>P,SL:()=>V,nK:()=>S,kO:()=>G,cR:()=>H,tH:()=>C});var i=n(401368),r=n(984866),a=n(259521),s=n(844113),o=n(480354),d=n(823704),l=n(809121),c=n(167090);var p=n(405826);var u=n(872313);const m=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:n,quarantineCounter:r,creator:s,currentUserMri:o},d)=>{let l=a.$y.Accepted;if(e){if(t){const e=s===o,{maxInviteFreeQuarantineCounter:t}=d.get(i.w.People),c=r>=(t||0);n&&!e?l=a.$y.AcceptPending:e&&c&&(l=a.$y.Quarantined)}}else l=a.$y.Blocked;return l},h=(e,t)=>e===a.j5.Accept?a.$y.Accepted:e===a.j5.Block?a.$y.Blocked:e===a.j5.Unblock&&t?a.$y.Accepted:a.$y.AcceptPending,g=e=>!!e?.startsWith(a.gN.PhonelinkSmsPrefix),f=e=>!!e?.endsWith(a.FG),I=(e,t)=>E(e.id,t)&&v(e,t)&&!A(e,t),A=(e,t)=>{const{enableMessagingGoldenGateCSV1:n}=t.get(i.w.Messaging);return!(!n||!(0,u.tK)(e.id)||"true"!==e?.properties?.conversationblocked?.toString().toLowerCase()&&e?.properties?.interopconversationstatus!==a.$y.Blocked)},E=(e,t)=>{if(!T(e))return!1;const{overrideThreadTypeForPrivateFeeds:n}=t.get(i.w.Sync);return(!(0,l.JO)(e)||!n)&&!g(e)},C=(e,t,n)=>{if(!e)return"";if((0,l.zh)(e,!0)){n.errorToTelemetry?.(`Reply chain ID found in conversation ID: ${e}. CallerInfo: ${t}`,"cdl_conversations_fetch",{reason:t,conversationId:e},!0);const{isValid:i,conversationId:r}=(0,l.my)(e);if(i)return r}return e},y=/^\d+[:]{1}.+/,T=e=>!(0,o.isUndefined)(e)&&e!==a.bY&&!g(e)&&!e.includes(a.pK)&&!e.includes(a.LH)&&!f(e)&&y.test(e),S=(e,t)=>e.startsWith(a.zD)||t===r.B.life?"MRI conv id":e,v=(e,t)=>!(_(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(i.w.Messaging),{isSfbCloud:n,isSipEnabled:r,isSfbCloudInBVD:a,isSipEnabledInBVD:s}=e.get(i.w.UserResources);return!!(t?s&&a:r&&n)}(t));function D(e){return((0,o.isString)(e)?e:e.id).endsWith(a.L)}function _(e){return((0,o.isString)(e)?e:e.id).endsWith(a.lo)}const P=e=>!!e&&_(e),b=e=>{const t=e.memberProperties?.[a.UO.RelationshipState];return!!t?.edRedemptionRequired},N=(e,t)=>{const n=e.memberProperties?.[a.UO.RelationshipState],i=!!t&&!!(0,u.tK)(e.id)&&"true"===e?.properties?.conversationblocked?.toString().toLowerCase();return!!n?.blockTime||i};const M=e=>!!e.memberProperties?.[a.UO.IsModerator],R=e=>e.threadProperties&&!!e.threadProperties[a.iy.ParentSpaces],F=e=>e.threadProperties&&e.threadProperties[a.iy.ThreadType]===s.b.Team&&R(e),O=e=>{if(e.threadProperties&&e.threadProperties?.[a.iy.ParentSpaces])try{const t=JSON.parse(e.threadProperties?.[a.iy.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},w=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,n=t?JSON.parse(t):void 0;return n?n.meetingType:void 0}catch{return}},U=(e,t,n)=>{if(t){const{enableStreamChatFeature:e,forceCommentStreamForConversations:r}=t.get(i.w.Calling);if(!e)return!1;if(n&&(r??[]).includes(n))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const t=e.toLowerCase();return"true"===t||"on"===t||"1"===t}return!1}(e.isLiveChatEnabled)},L=e=>k(e.type),k=e=>!!e&&e.toLowerCase&&e.toLowerCase()===a.Cr.Meeting.toLowerCase(),G=e=>{let t;if(L(e)&&e.threadProperties.meeting)try{const n=JSON.parse(e.threadProperties.meeting);n.subject&&(t=n.subject)}catch{return t}return t},x=e=>e===a.Go.Text||e===a.Go.RichText||e===a.Go.HTML,B=e=>!!e.members?.some((e=>(0,l.W4)(e.id))),$=e=>e.id===d.lD.CallLogConversationId||e.id===d.lD.SharedCallLogConversationId||(0,l._5)(e?.threadProperties?.threadType),H=e=>{if(e===a.uN)return{shouldExtend:!1,reason:"currentExpiration is the perm-join value"};const t=1209600*c.om*.5;if(!e||isNaN(e))return{shouldExtend:!0,reason:"currentExpiration is not a number"};return e-Date.now()<t?{shouldExtend:!0,reason:"remainingTime is less than membershipRenewThreshold"}:{shouldExtend:!1,reason:"remainingTime is greater than membershipRenewThreshold"}},W=e=>e?.threadProperties&&(e?.threadProperties[a.iy.ThreadType]===s.b.Community||e?.threadProperties[a.iy.SpaceType]===a.iy.SpaceType_Community),V=e=>e?.threadProperties&&e?.threadProperties[a.iy.ThreadType]===s.b.SubCommunity,q=e=>e.threadProperties&&e.threadProperties[a.iy.SubstrateGroupId]||"",z=e=>{const t=e.threadProperties?.[a.iy.ThreadSubType]?.toLowerCase();return t||p.jZ.Unknown},J=e=>{const t=e.threadProperties&&e.threadProperties[a.iy.ThreadType];return Q(t)},Q=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"},j=e=>k(e.type)&&"lobby"===e.threadProperties?.meetingChatType?.toLowerCase()},313577:(e,t,n)=>{n.d(t,{UZ:()=>h,kp:()=>g,xL:()=>f,CT:()=>I,oy:()=>A,bI:()=>E,QD:()=>C,I_:()=>y,bJ:()=>T,kW:()=>S,lz:()=>v,xH:()=>D,GK:()=>_,Yt:()=>P,FA:()=>b,PP:()=>M,j8:()=>R,E0:()=>F,IJ:()=>O,bl:()=>w,yT:()=>U,Rt:()=>L,BA:()=>G,s8:()=>x,nX:()=>B,Z9:()=>$,r0:()=>H,pB:()=>W,lE:()=>V,as:()=>q,_Y:()=>z,tf:()=>J,DQ:()=>Q,IV:()=>j,Mn:()=>K,Zl:()=>Y,xt:()=>X,SG:()=>Z,Zp:()=>ee,mT:()=>te,Vj:()=>ne,HV:()=>ie,yW:()=>re,CF:()=>ae,R6:()=>se,ZV:()=>oe,uF:()=>de,vz:()=>le,B6:()=>ce,oh:()=>pe,LK:()=>ue,Y5:()=>me,Gw:()=>he,mz:()=>ge,aJ:()=>fe,iF:()=>Ie,h1:()=>Ae,NX:()=>Ee,K$:()=>Ce,CN:()=>ye,LN:()=>Te,qL:()=>ve,je:()=>De,mv:()=>_e,sx:()=>Pe,bP:()=>be,Cy:()=>Ne,wI:()=>Re,$i:()=>we,kE:()=>Ue,d2:()=>Le,__:()=>ke,CE:()=>Ge,Yp:()=>xe,XS:()=>Be,Ce:()=>$e,rD:()=>He,xl:()=>We,L5:()=>Ve,nv:()=>qe,cQ:()=>ze,Am:()=>Je,Xv:()=>Qe,UC:()=>je,Dt:()=>Ke,kA:()=>Ye,V8:()=>Xe,$T:()=>Ze,W:()=>et,Ps:()=>tt,Vb:()=>nt,Gy:()=>it,ZT:()=>rt,WH:()=>at,rq:()=>st,OW:()=>ot,EO:()=>ct,F$:()=>pt,T4:()=>ut,MO:()=>mt,Nb:()=>ht,OK:()=>gt,n_:()=>ft,$x:()=>It,ze:()=>At,bX:()=>Et,Zn:()=>Ct,nG:()=>yt,OA:()=>Tt,AJ:()=>St,ME:()=>vt,mb:()=>Dt,f9:()=>_t,S9:()=>Pt,QP:()=>bt,Bt:()=>Nt,mp:()=>Mt,XY:()=>Ft,vn:()=>Ot,Xo:()=>wt,WS:()=>Ut});var i=n(823704),r=n(480354),a=n(401368),s=n(809121),o=n(259521),d=n(844113),l=n(405826),c=n(800467),p=n(880256),u=n(478955),m=n(872313);var h;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(h||(h={}));const g=e=>{const t=b(e);return(0,c.FF)(e)?t:t||(0,c.t0)(e)},f=(e,t)=>{const n=e.threadProperties?.[o.iy.Creator]||null;return t&&(0,m.IF)(e)&&n?n.split(";")[0]:n},I=e=>e.threadProperties&&e.threadProperties[o.iy.CreatedAt]?e.threadProperties[o.iy.CreatedAt]:null,A=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[o.iy.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},E=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[o.H0.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},C=e=>e.threadProperties[o.iy.ChatModalityType]===o.L5.Conversational,y=e=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const t=le(e);return 0!==t&&(!(0,r.isNil)(e.lastMessageTimeUtc)&&t>=e.lastMessageTimeUtc)},T=e=>!(!e.properties||!e.properties[o.H0.Followed])&&"true"===e.properties[o.H0.Followed]?.toLowerCase(),S=e=>!(!e.properties||!e.properties[o.H0.Collapsed])&&"true"===e.properties[o.H0.Collapsed]?.toLowerCase(),v=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,D=e=>-1===e.detailsVersion&&-1===e.threadVersion,_=e=>v(e)||!he(e);function P(e=""){return e.includes(o.pK)||e.includes(o.LH)||e===o.bY}const b=e=>(0,s.ye)(e.id,e?.threadProperties?.threadType)&&P(e.id),N="lwgChannelLie-",M=e=>`${N}${e}`,R=e=>e.startsWith(N),F=e=>j(e)&&e.properties&&!!e.properties.isLie,O=e=>e.threadProperties&&(e.threadProperties[o.iy.ThreadType]===d.b.Team||e.threadProperties[o.iy.ThreadType]===d.b.Community)&&!(0,c.GW)(e),w=e=>!(e.threadProperties[o.iy.ParentSpaces]||!e.threadProperties[o.iy.SubstrateGroupId]||!e.threadProperties[o.iy.GroupId]||e.threadProperties[o.iy.ThreadSubType]),U=e=>O(e)&&!w(e),L=e=>ee(e)?tt(e)||"":Ee(e)||"";function k(e){return!!e.threadProperties&&e.threadProperties[o.iy.ThreadType]===d.b.Team}const G=e=>{if(e.properties){if(e.properties[o.H0.Favorite])return"true"===e.properties[o.H0.Favorite]?.toLowerCase();if(k(e))return!0}return!1},x=e=>!e.properties||void 0===e.properties[o.H0.GeneralChannelFavorite]||null===e.properties[o.H0.GeneralChannelFavorite]||"true"===e.properties[o.H0.GeneralChannelFavorite]?.toLowerCase(),B=e=>{const t=O(e);return t&&x(e)||!t&&G(e)},$=(e,t=!1)=>H(e.type,e.id,t),H=(e,t,n=!1)=>!(0,r.isNil)(e)&&(e.toLowerCase()===o.Cr.Thread.toLowerCase()&&(0,m.x_)(t)||e.toLowerCase()===o.Cr.Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhoneChat.toLowerCase()||e.toLowerCase()===o.Cr.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===o.Cr.OneOnOne.toLowerCase()||e.toLowerCase()===o.Cr.StreamOfNotes.toLowerCase()||!n&&(0,c.j7)(e)),W=e=>e.type===o.Cr.RCC,V=e=>e.id===i.lD.NotificationConversationId||(0,s.p3)(e?.threadProperties?.threadType),q=e=>e===i.lD.AnnotationsConversationId,z=e=>e.id===i.lD.DraftsConversationId,J=e=>Q(e.type),Q=e=>e===o.Cr.EngageCommunity,j=e=>K(e.type),K=e=>e===o.Cr.Team||e===o.Cr.Topic,Y=e=>ge(e)===l.Cu.Shared,X=e=>ge(e)===l.Cu.Standard,Z=e=>[o.SG,o.Vn].includes(e.id),ee=e=>(0,c.n2)(e)&&(0,c.BV)(e)&&ge(e)===l.Cu.Private,te=e=>O(e)&&!!e.memberProperties&&!!e.memberProperties[o.UO.ChannelOnlyMember],ne=e=>{if(!(0,c.CR)(e))return!1;const t=(0,c.CA)(e);return!!t&&t===o.Wf.MeetNow},ie=e=>{if(!(0,c.CR)(e))return!1;const t=(0,c.CA)(e);return!!t&&t===o.Wf.Scheduled},re=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(o.kv)?o.kv+t:t),ae=(e,t,n=!1)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=t.get(a.w.Sync),r=i||Y(e)||n?e.threadProperties.retentionHorizonV2:0;return r&&isFinite(Number(r))?Number(r):0},se=(e,t)=>{const n=e?.historyHiddenTime?Number(e.historyHiddenTime):void 0,i=e?.unpinnedTime?Number(e.unpinnedTime):0;if(t&&t.get(a.w.Sync).enableUseMaxHiddenTimeForConversationFiltering){return Math.max(n??0,i)}return n??i},oe=(e,t)=>e?.members?.find((e=>e.id===t))?.shareHistoryTime??0,de=e=>e?.members?.some((e=>!isNaN(Number(e.shareHistoryTime))&&0!==Number(e.shareHistoryTime)))??!1,le=e=>{if(!e.properties)return 0;if(E(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const t=$(e)?e.properties.clearHistoryTime:0;return t&&isFinite(Number(t))?Number(t):0},ce=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,pe=(e,t,n)=>{const i=ae(t,n,!n.get(a.w.Sync).disableForceRetentionHorizonInSyncValidation);return!isNaN(Number(e))&&!isNaN(i)&&Number(e)<i},ue=(e,t)=>{const n=le(t),i=Number(e);return!isNaN(i)&&!isNaN(n)&&i<n},me=(e,t,n=!1,i=!1)=>{if((0,s.ye)(e.id,e?.threadProperties?.threadType)&&!v(e)){if(e.memberProperties&&!(0,r.isEmpty)(e.memberProperties)&&n)return e.memberProperties[o.UO.ExpirationTime];if(e.memberProperties&&!(0,r.isEmpty)(e.memberProperties)||!n||!i){if(e.members&&t){const n=(0,r.find)(e.members,(e=>e&&e.id===t));return n&&n.memberExpirationTime}return e.memberProperties&&e.memberProperties[o.UO.ExpirationTime]}}},he=(e,t)=>!(0,s.ye)(e.id,e?.threadProperties?.threadType)||!v(e)&&!A(e)&&((0,r.isArray)(e.members)&&t?(0,r.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&j(e)&&!e.threadProperties[o.iy.LastLeaveAt]&&!e.threadProperties[o.iy.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[o.iy.LastLeaveAt]&&(!e.threadProperties[o.iy.LastJoinAt]||e.threadProperties[o.iy.LastJoinAt]<e.threadProperties[o.iy.LastLeaveAt])));function ge(e){if(!e||!j(e))return;const t=e.threadProperties[o.iy.SpaceTypes],n=t?parseInt(t,10):0,i=!!e.threadProperties[o.iy.SubstrateGroupId],r=(0,c.FV)(e);return w(e)?l.Cu.Standalone:i?r===l.jZ.PrivateChannel?l.Cu.Private:l.Cu.Shared:(n&l.QU.Private)===l.QU.Private?l.Cu.Private:l.Cu.Standard}const fe=(e,t)=>{if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=e.lastMessage?.from;if(!n)return!1;return t===(0,r.last)(n.split("/"))},Ie=(e,t)=>(0,r.reduce)(e.members,((e,n)=>{const i=n.id;return i&&i!==t&&e.push(i),e}),[]),Ae=(e,t,n)=>{let i;const a=!e.members||!!e.members&&(0,r.some)(e.members,(e=>!e));if(n&&!a){const r=Ie(e,t);i=b(e)&&1===r.length?n[r[0]]:n[e.id]}return i},Ee=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if($(e)){const n=t?.get(a.w.Messaging).enableColonInChatTitle;let i=e.threadProperties.topic;if(i&&(n?-1!==i.indexOf("live:"):-1!==i.indexOf(":"))&&(i=void 0),!i&&(0,c.CR)(e)){const t=(0,c.kO)(e);t&&(i=t)}return i}if(k(e)&&we(e)){const t=tt(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,n=e.threadProperties[o.iy.TopicThreadTopic];if(n&&n.trim())return n;if(t&&t.trim())return t;if(U(e))return"General"}}return""},Ce=(e,t=!1)=>$(e,!0)&&!Ve(e.id)&&!ye(e,t),ye=(e,t=!1)=>{const n=e.members&&e.members.length<=2;return $(e,!0)&&n&&(Ne(e)||b(e)||Oe(e)||!t&&Fe(e)||Se(e))&&!e.members?.some((e=>(0,s.mD)(e.id)))},Te=e=>ye(e)&&e.members?.some((({id:e})=>(0,s.Iz)(e))),Se=e=>e.members&&e.members.length<=2&&Me(e)&&(e.type===o.Cr.PhoneChat||e.threadProperties&&e.threadProperties[o.iy.ThreadType]===d.b.PhoneChat),ve=e=>(0,c.oI)(e),De=e=>ve(e.id),_e=e=>!!e&&((0,s.Ku)(e)||(0,s.gZ)(e)||(0,s.aL)(e)||(0,s.vd)(e)),Pe=e=>e.type===o.Cr.PhonelinkGroupChat,be=e=>e.threadProperties?.productContext===i.z_.SFL,Ne=e=>e.type===o.Cr.Phonelink1on1Chat,Me=e=>(0,r.some)(e.members,(e=>!!e.id&&e.id.startsWith(o.gN.Pstn))),Re=(e,t)=>{const n=e?.get(a.w.Messaging)?.enableSkypeMessagesInTFL;return!!n&&(!!t&&(be(t)||(0,m.x_)(t.id)))},Fe=e=>$(e,!0)&&e.members&&2===e.members.length&&!(0,r.isNil)(e.threadProperties)&&parseInt(e.threadProperties[o.iy.CreatedAt],10)<o.If,Oe=e=>!!e.id&&e.id.indexOf(o.W0)>-1||(0,s.CM)(e.threadProperties)||!!e?.id&&(0,m.tK)(e?.id),we=e=>e.threadProperties&&e.threadProperties[o.iy.ThreadType]===d.b.Topic||ee(e)||Y(e)||(0,c.SL)(e)||F(e),Ue=e=>(0,c.t0)(e),Le=e=>We(e&&e.id),ke=e=>Ue(e)||(e=>xe(e))(e)||Le(e),Ge=e=>xe(e)||(0,c.t0)(e),xe=e=>{const t=(0,r.isString)(e)?e:e.id;return(0,r.endsWith)(t,o.L)||(0,r.endsWith)(t,o.s8)||(0,r.startsWith)(t,o.iB)},Be=e=>xe(e)||ot(e),$e=e=>xe(e)||dt(e),He=(e,t)=>ct(e)!==t,We=e=>!!e&&((0,r.endsWith)(e,o.wx)||(0,r.startsWith)(e,o.Rq)),Ve=e=>e===o.cB,qe=e=>{const t=e.members||[];return e.members&&e.members.length<=2&&t.some((e=>e.id===o.xv))&&(be(e)||(0,m.tK)(e.id))},ze=(e,t)=>!!t.get(a.w.Messaging).hideBlockedOneOnOneChat&&ye(e)&&((0,c.qX)(e,!!t.get(a.w.Messaging).enableMessagingGoldenGateCSV1)||e?.properties?.interopconversationstatus===o.$y.Blocked),Je=(e,t)=>{const n=(e.members||[]).some((e=>t?.includes(e.id))),i=ye(e)&&(be(e)||(0,m.tK)(e.id));return n&&i},Qe=e=>!(e.id!==o.cB||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),je=e=>{const t=(0,r.endsWith)(e,o.L)||(0,r.endsWith)(e,o.s8)||(0,r.startsWith)(e,o.iB),n=e.endsWith(o.lo),i=We(e);return t||n||i},Ke=e=>{const t=me(e),n=t&&t<Date.now();return he(e)&&!n},Ye=e=>{if(e.threadProperties&&e.threadProperties[o.iy.Topics]){const t=e.threadProperties[o.iy.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch{return[]}}return[]},Xe=(e,t)=>{const n=Ye(e);for(const e of n)if(e.id===t)return e.isShared??!1;return!1},Ze=(e,t)=>{const n=Ye(e);for(const e of n)if(e.id===t)return e.archivalLevel?.trim().toLowerCase()},et=e=>!!e?.some((e=>(0,s.Iz)(e))),tt=e=>{if(e.threadProperties){if(e.threadProperties[o.iy.XTeamName])return e.threadProperties[o.iy.XTeamName];if(e.type===o.Cr.Team&&e.threadProperties.topic)return e.threadProperties.topic}},nt=e=>{const t=Ye(e),n=tt(e);return t.map((t=>{const i={},r=t.name;return i[o.iy.CreatedAt]=parseInt(t.createdat,10),i[o.iy.Picture]=t.picture,i[o.iy.IsDeleted]=t.isdeleted,i[o.iy.XTeamName]=t.isShared?r:n,i.topic=r,i[o.iy.TopicThreadTopic]=r,{threadProperties:i,id:t.id,members:[],messages:"",properties:{},version:0,type:o.Cr.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},it=e=>{if(e.parentId)return e.parentId;if((0,c.GW)(e))try{const t=JSON.parse(e.threadProperties[o.iy.ParentSpaces]),n=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,r.isEmpty)(n))return n}catch{return}},rt=e=>{const t=e.threadProperties&&e.threadProperties[o.iy.SpaceId];return(O(e)?e.id:(0,c.GW)(e)?it(e):t)||e.teamId},at=e=>{const t=e?e.trim().toLowerCase():void 0;return"true"!==t&&("false"===t||void 0)},st=e=>e.threadProperties&&((0,r.isBoolean)(e.threadProperties[o.iy.GapDetectionEnabled])?e.threadProperties[o.iy.GapDetectionEnabled]:"true"===(0,r.lowerCase)(e.threadProperties[o.iy.GapDetectionEnabled])),ot=e=>!!ye(e)&&dt(e),dt=e=>{const t=ct(e);return t&&!xe(e)&&(0,r.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||lt(e.id)||lt(e.localClientId||"")},lt=e=>(0,r.startsWith)(e,o.hd),ct=e=>e.threadProperties&&e.threadProperties[o.iy.TenantId],pt=e=>{const t=e.threadProperties[o.iy.ArchivalLevel],n=O(e)&&!!t&&t.toLowerCase()===o.L6.Space.toLowerCase(),i=j(e)&&!!t&&(t.toLowerCase()===o.L6.Topic.toLowerCase()||t.toLowerCase()===o.L6.Space.toLowerCase());return n||i},ut=e=>{if(!e||!e.properties)return!1;const t=e.properties[o.H0.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},mt=e=>{const t=e.memberProperties?.[o.UO.RelationshipState],n=e.properties?.conversationstatus;return!!t?.inQuarantine||n===o.YH.AcceptPendingRecipient},ht=e=>{const t=e.properties?.conversationstatusproperties;if(t&&"string"==typeof t)try{const e=JSON.parse(t),n=e?.AcceptPendingMessageCount;return"number"==typeof n?n:0}catch(e){return 0}const n=e.memberProperties?.[o.UO.RelationshipState];return"number"==typeof n?.quarantineCounter?n?.quarantineCounter:0},gt=e=>!!e.memberProperties?.[o.UO.ExplicitlyAdded],ft=e=>e?.properties?.suppressLastMessageUpdate===o.XR.Sender,It=e=>ye(e)&&!e.usersProps?.hasFederatedUser&&(0,r.every)(e.members,(e=>e.id?.startsWith(o.kv)))||!1,At=e=>!(!O(e)||parseInt(e.threadProperties?.[o.iy.SpaceTypes],10)!==l.QU.TenantWide),Et=(e,t)=>Ct(e.threadProperties&&e.threadProperties[o.iy.TenantId]||"",t),Ct=(e,t)=>!(!t||""===t||!e||e===t),yt=(e,t)=>!(!O(e)||Et(e,t)||At(e)||A(e)||!he(e)||te(e)),Tt=e=>{if(e?.meetingInfo)try{const t=["Accepted","Declined","Follow","Tentative","None"],n=JSON.parse(e.meetingInfo)?.rsvpStatus;return n&&t.includes(n)?n:"None"}catch(e){return"None"}return"None"},St=(e,t,n,i)=>{if(i&&n?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications&&i===e.threadProperties[o.iy.Creator])return!1;const{meetingChatNotification:r=p.AP.MeetingsUserParticipatesIn,meetingChatNotificationForAcceptedMeetings:s=p.AP.MeetingsUserIsInvitedTo,meetingChatNotificationForTentativeMeetings:d=p.AP.MeetingsUserParticipatesIn}={...t},l=p.AP.MeetingsUserIsInvitedTo,c=r!==l;if(!n?.get(a.w.Chat).enableRSVPBasedMeetingChatNotifications)return c||!1;const u=s!==l,m=d!==l;try{const t=e?.properties;switch(Tt(t)){case"Declined":case"Follow":return!0;case"Accepted":return u||!1;default:return m||!1}}catch(e){return m||!1}},vt=(e,t,n,i)=>{const r=at(e?.properties?.alerts);return void 0!==r?r:!!(0,s.Qi)(e.id)&&St(e,t,n,i)};function Dt(e){if(!j(e)||U(e)||ee(e))return!1;const t=me(e);return t!==o.uN&&(!t||t<Date.now())}const _t=e=>Pt(e)&&Y(e),Pt=e=>j(e)&&!A(e)&&!pt(e)&&B(e)&&he(e),bt=(e,t)=>{const n=e.threadProperties[o.iy.CreatedAt]||"0";return Rt(n)<t},Nt=(e,t)=>e.threadProperties[o.iy.Creator]===t,Mt=e=>O(e)&&"General"!==e.threadProperties[o.iy.TopicThreadTopic],Rt=e=>(0,u.Ql)(parseInt(e,10),Date.now(),"seconds"),Ft=(e,t,n)=>!!n.get(a.w.Messaging).enableMessagingGoldenGateCSV1&&(0,m.IF)(e)&&!he(e,t),Ot=(e,t)=>!!t.get(a.w.Messaging).enableMessagingGoldenGateCSV1&&(0,m.tK)(e.id)&&y(e),wt=(e,t)=>{const n=!!t.get(a.w.ChatList)?.disableDeletedOrQuarantinedChats,i=y(e),r=mt(e);return n&&(i||r)},Ut=async e=>!!e?.threadProperties?.bilateralTenantsList?.length},872313:(e,t,n)=>{n.d(t,{Ak:()=>s,IF:()=>p,iu:()=>u,tK:()=>m,x_:()=>h,W:()=>g,EQ:()=>f,io:()=>I,B5:()=>A,uu:()=>E,FH:()=>y,Bh:()=>T,Ik:()=>S,iD:()=>v});var i=n(401368),r=n(259521),a=n(823704);const s="@thread.v2",o="@oneToOne.skype",d=/^8:(.+?):8:(.+)$/,l=1738368e6,c=1751328e6,p=e=>"True"!==e.threadProperties?.isMigrated&&h(e.id),u=e=>e.includes("@cast.skype"),m=e=>e?.startsWith(r.gN.SkypeSpacesThread)&&e?.endsWith(o),h=e=>e?.startsWith(r.gN.SkypeSpacesThread)&&(e?.includes(o)||e?.includes("@thread.skype")||e?.includes("@p2p.thread.skype")),g=e=>!!e&&d.test(e),f=e=>!(!e||!m(e.id)||!e.threadProperties?.onetoonev2threadid?.includes(s)&&!e.properties?.onetoonev2threadid?.includes(s));function I(e,t,n,r,s,o){const d=r?.get(i.w.Messaging)?.enableSkypeMessagesInTFL;if(!d)return!1;const p=new Date(r?.get(i.w.Messaging).goldenGateCutOffDate||l),u=new Date(r?.get(i.w.Messaging)?.csv2MigrationCutOffDate||c),m=t?new Date(t):null;return e?.formatVariant?e?.formatVariant===a.kI.Sfl:!!(C(o)||m&&m<p&&s===a.z_.SFL||m&&h(n)&&m<u)}function A(e){return!!e?.endsWith(r.Ih)}function E(e){return e.members?.some((e=>e.id?.startsWith(r.gN.Lync)))||!1}const C=e=>{const t=new Set([r.Go.URIAudioObject,r.Go.MediaGenericFile,r.Go.UriVideoObject]);return!!e&&t.has(e)},y=(e,t)=>{const{enableSkypeMessagesInTFL:n,skypeBotIds:a}=t?.get(i.w.Messaging)??{};if(!n)return!1;return new Set([r.Go.SkypeTranslation,r.Go.SkypeCopilotToggle,r.Go.SkypeTranslationSettings]).has(e.type)||a?.some((t=>e.from?.includes(t)))||e.type===r.Go.AddMember&&a?.some((t=>e.content?.includes(t)))},T=(e,t)=>p(e)&&!e.members?.some((({id:e})=>e===t));const S=(e,t,n,i)=>{let r="";return e&&(r=function(e,t,n,i){try{if(e)return JSON.parse(e).CounterpartyMri}catch(e){n.warn(`conversationstatusproperties parsing failed for ${t}`,i)}return""}(e?.properties?.conversationstatusproperties,e?.id,n,i),r||2!==e?.members?.length||(r=e?.members.find((({id:e})=>e!==t))?.id||"")),r||""},v=e=>{const t=new Set(e.map((e=>e.properties.onetoonev1threadid)).filter(Boolean));return t.size>0&&(e=e.filter((e=>!t.has(e.id)))),e}},453755:(e,t,n)=>{n.d(t,{h:()=>r});var i=n(259521);const r=(e,t,n)=>{if(t===i.Go.HTML){if(a(e,n))return i.Go.Collaborate;if(s(e,n))return i.Go.Embed}return t},a=(e,t)=>{const n=o(e,t);if(!n)return!1;const i=n.find((e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!i&&!!i.content.componentUrl},s=(e,t)=>{const n=o(e,t);if(!n)return!1;const i=n.find((e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!i&&!!i.content.componentUrl},o=(e,t)=>{if(t?.cards)try{return JSON.parse(t.cards)}catch(t){e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards.")}return null}},827534:(e,t,n)=>{n.d(t,{e:()=>r});var i=n(405826);const r=e=>{const{body:t,subject:n,title:i,toggled:r,detectedLanguageName:s,sourceLanguageCode:o,targetLanguageCode:d,isOnDemandTranslation:l,isInProgress:c,error:p}=e||{};if(c)return{translationStatus:"InProcess"};return(void 0!==t||void 0!==p)&&s&&o&&d?{translationStatus:a(!!r,p),translatedSubject:n,translatedContent:t,translatedTitle:i,isOnDemandTranslation:l,sourceLanguageName:s,sourceLanguageCode:o}:void 0},a=(e,t)=>{if(!e)return"ShowOriginalMessage";if(void 0===t)return"Done";switch(t){case i.Uf.Success:return"Done";case i.Uf.SkipTranslation:return"TranslationNotNeeded";case i.Uf.MessageNotFound:return"MessageNotFound";case i.Uf.VersionNotFound:return"VersionNotFound";case i.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case i.Uf.UnsupportedSourceLanguage:return"UnsupportedSourceLanguage";default:return"UnknownError"}}},880256:(e,t,n)=>{n.d(t,{AP:()=>i,nM:()=>r,$Q:()=>a,KO:()=>s,I_:()=>o,vn:()=>d});const i={MeetingsUserIsInvitedTo:"MeetingsUserIsInvitedTo",MeetingsUserParticipatesIn:"MeetingsUserParticipatesIn",MeetingsManuallyUnmuted:"MeetingsManuallyUnmuted"},r={VOICE_CALL:"VOICE_CALL",VIDEO_CALL:"VIDEO_CALL"},a={aggregatedLikeInChatAndChannel:"AggregatedLikeInChatAndChannel",aggregatedMentionsInTeamAndChannel:"AggregatedMentionsInTeamAndChannel",aggregatedPersonalMention:"AggregatedPersonalMention",aggregatedReplyAndReplyToReply:"AggregatedReplyAndReplyToReply",aggregatedRepliesToPostsAndThreads:"AggregatedRepliesToPostsAndThreads",alertSound:"alertSound",alertSoundType:"alertSoundType",alertUrgentSoundType:"alertUrgentSoundType",allowUrgentNotifications:"allowUrgentNotifications",appNotificationEnabled:"appNotificationEnabled",callTransferFailed:"CallTransferFailed",chat:"Chat",dLPNotifySender:"DLP_NotifySender",dLPWarning:"DLP_Warning",downloaded:"Download_Downloaded",downloadFailed:"Download_DownloadFailed",downloadStarted:"Download_DownloadStarted",emailDigestDelay:"EmailDigestDelay",emailNotificationDelay:"EmailNotificationDelay",error:"Error",followChannelNewMessage:"Follow_ChannelNewMessage",followChannelReplyMessage:" Follow_ChannelReplyMessage",globalMention:"Global_Mention",globalSoundAndPreview:"GlobalSoundAndPreview",hideNotificationDuringCallsAndMeetings:"HideNotificationDuringCallsAndMeetings",huddleStartedNotification:"HuddleStartedNotification",liveMeetingStatusBanner:"liveMeetingStatusBanner",incomingCallsAndMeetingStartSound:"IncomingCallsAndMeetingStartSound",inferred:"Inferred",like:"Like",likeInChat:"LikeInChat_v2",newContactOnTeamsNotification:"newContactOnTeamsNotification",meetingChatNotification:"MeetingChatNotification",meetingChatNotificationForAcceptedMeetings:"MeetingChatNotification_AcceptedMeeting",meetingChatNotificationForTentativeMeetings:"MeetingChatNotification_TentativeMeeting",meetingWentLiveNotification:"MeetingWentLiveNotification",mentionChannel:"Mention_Channel",mentionInChat_Everyone:"MentionInChat_Everyone",mentionInChat_Nearby:"MentionInChat_Nearby",mentionInChat_Person:"MentionInChat_Person_v2",mentionPerson:"Mention_Person",mentionTag:"Mention_Tag",mentionTeam:"Mention_Team",messageSendFailed:"MessageSendFailed",msGraphChannelMeetingCanceled:"channelMeetingCanceled",msGraphChannelMeetingCreated:"channelMeetingCreated",msGraphChannelMeetingForwarded:"channelMeetingForwarded",msGraphChannelMeetingForwardedWithoutOrganizer:"channelMeetingForwardedWithoutOrganizer",msGraphChannelMeetingUpdated:"channelMeetingUpdated",msGraphDelegateMeetingCanceled:"delegateMeetingCanceled",msGraphDelegateMeetingCreated:"delegateMeetingCreated",msGraphDelegateMeetingUpdated:"delegateMeetingUpdated",msGraphMeetingOrganisedByMe:"privateMeetingForwardedNotification",msGraphMeetingSentToMe:"privateMeetingCreated",msGraphPrivateMeetingCanceled:"privateMeetingCanceled",msGraphPrivateMeetingForwarded:"privateMeetingForwarded",msGraphPrivateMeetingForwardedNotificationWithAttendee:"privateMeetingForwardedNotificationWithAttendee",msGraphPrivateMeetingForwardedNotificationWithAttendeeAndTotal:"privateMeetingForwardedNotificationWithAttendeeAndTotal",msGraphPrivateMeetingForwardedNotificationWithTwoAttendee:"privateMeetingForwardedNotificationWithTwoAttendee",msGraphPrivateMeetingUpdated:"privateMeetingUpdated",muteGenericNotifications:"muteGenericNotifications",notificationStyleList:"NotificationStyleList",playNotificationSoundsForUrgentAndPriority:"PlayNotificationSoundsForUrgentAndPriority",playNotificationSoundsWhenBusyOrInMeetings:"PlayNotificationSoundsWhenBusyOrInMeetings",presenceStatus:"PresenceStatus",priority:"Priority",projectBoardAssignments:"ProjectBoardAssignments",repliesInFollowedThreads:"RepliesInFollowedThreads",reply:"Reply",replyToPolls:"ReplyToPolls",replyToReply:"ReplyToReply",resetTeamsAndChannelsSettings:"Reset_Teams_And_Channels_Settings",respectOsDnDForCustomToasts:"RespectOsDnDForCustomToasts",selectedPreset:"selectedPreset",showNotificationDuringCallsAndMeetings:"ShowNotificationDuringCallsAndMeetings",showPreviewInToasts:"ShowPreviewInToasts",showUnreadChatsRemindersInToasts:"showUnreadChatsRemindersInToasts",staffHub:"StaffHub",teamMembershipChangeAddedToSharedChannel:"TeamMembershipChange_AddedToSharedChannel",teamMembershipChangeAddedToTeam:"TeamMembershipChange_AddedToTeam",teamMembershipChangePendingOnBehalfOfJoinRequest:"TeamMembershipChange_PendingOnBehalfOfJoinRequest",teamMembershipChangePendingOnBehalfOfJoinRequestMultiple:"TeamMembershipChange_PendingOnBehalfOfJoinRequestMultiple",teamMembershipChangePendingSelfJoinRequest:"TeamMembershipChange_PendingSelfJoinRequest",teamMembershipChangePromotedToSharedChannelOwner:"TeamMembershipChange_PromotedToSharedChannelOwner",teamMembershipChangePromotedToTeamAdmin:"TeamMembershipChange_PromotedToTeamAdmin",teamMembershipChannelOwnerUnshareTeamOwnerNotify:"TeamMembershipChange_ChannelOwnerUnshareTeamOwnerNotify",teamMembershipTeamOwnerUnshareChannelOwnerNotify:"TeamMembershipChange_TeamOwnerUnshareChannelOwnerNotify",teamMembershipTeamShareTeamOwnerNotify:"TeamMembershipChange_TeamShareTeamOwnerNotify",teamsTasks:"TeamsTasks",thirdParty_Bot:"ThirdParty_Bot",trending:"Trending",useTeamsChimeForToasts:"useTeamsChimeForToasts",visibleChannelMention_v2:"Visible_ChannelMention_v2",visibleChannelNewMessage_v2:"Visible_ChannelNewMessage_v2",visibleChannelReplyMessage_v2:"Visible_ChannelReplyMessage_v2"};var s,o;!function(e){e[e.AllActivity=1]="AllActivity",e[e.MyAtMentions=2]="MyAtMentions",e[e.Custom=3]="Custom"}(s||(s={})),function(e){e.MainPage="notification_settings_text",e.GraphPage="notification_settings_graph_apps_subheader_text",e.ChatPage="notification_settings_details_chat_subheader_text",e.MeetingsPage="notification_settings_details_only_meetings_subheader_text",e.TeamsChannelCustomisedPage="notification_settings_details_teams_channel_button_custom_label",e.CallGroupPage="group_call_forwarding_notification_setting"}(o||(o={}));const d="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"},86308:(e,t,n)=>{function i(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const n={};return e.split("&").forEach((e=>{const[t,i]=e.split("=");n[t]=decodeURIComponent((i||"").replace(/^.+?(=)/,""))})),n}n.d(t,{J:()=>i})},430902:(e,t,n)=>{var i,r,a,s,o;n.d(t,{A2:()=>i,UI:()=>r,LF:()=>a,Fo:()=>s,D1:()=>o}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(i||(i={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(r||(r={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(a||(a={})),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(s||(s={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(o||(o={}))},915344:(e,t,n)=>{n.d(t,{a:()=>r});var i=n(480354);class r{constructor(){this._card={type:"AdaptiveCard",version:"1.5",body:[{type:"Container",items:[]}],actions:[]}}addLabel(e){return this.addElement({type:"TextBlock",text:e,weight:"bolder"}),this}addTextBlock(e,t,n,i,r){return this.addElement({type:"TextBlock",text:e,wrap:t,spacing:n,maxLines:i,size:r}),this}addTextInput(e,t,n,i,r,a){return this.addElement({type:"Input.Text",id:e,placeholder:t,value:n,maxLength:i,isMultiline:r,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addNumberInput(e,t,n,i){return this.addElement({type:"Input.Number",id:e,placeholder:t,value:n,label:i?.label,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addDateInput(e,t,n,i){return this.addElement({type:"Input.Date",id:e,placeholder:t,value:n,label:i?.label,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addTimeInput(e,t,n,i){return this.addElement({type:"Input.Time",id:e,placeholder:t,value:n,label:i?.label,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addToggle(e,t,n,i){return this.addElement({type:"Input.Toggle",id:e,title:t,value:n,isRequired:i?.isRequired,errorMessage:i?.errorMessage}),this}addChoiceSet(e,t,n,i,r,a,s){return this.addElement({type:"Input.ChoiceSet",id:e,title:t,isMultiSelect:n,style:i?"compact":"expanded",choices:r,value:a,label:s?.label,isRequired:s?.isRequired,errorMessage:s?.errorMessage}),this}addImageSet(e,t){return this.addElement({type:"ImageSet",id:e,images:t}),this}addSubmitAction(e,t,n,i){return this._card.actions&&this._card.actions.push({id:e,type:"Action.Submit",title:t,data:n,style:i?.style}),this}addSpeak(e){return this._card.speak=e,this}getCard(){return{content:JSON.stringify(this._card),contentType:"application/vnd.microsoft.card.adaptive"}}getRawJson(){return(0,i.cloneDeep)(this._card)}addColumnSet(e,t){return this.addElement({type:"ColumnSet",columns:e,spacing:t}),this}addSelectAction(e,t){return this._card.selectAction={type:"Action.OpenUrl",url:t,id:e},this}addElement(e){this._card.body&&this._card.body[0].items.push(e)}}},625270:(e,t,n)=>{n.d(t,{j:()=>i});const i=(e,t={},n)=>{let i;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');i=JSON.parse(e)}catch(e){i=t,n?.(e)}return i}},847887:(e,t,n)=>{function i(){return(...e)=>e}n.d(t,{K:()=>i})},639738:(e,t,n)=>{n.d(t,{FQ:()=>a});var i=n(215982);n(480354);const r=({originalArrivalTime:e,timeStamp:t,clientMessageId:n})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(t).toISOString(),clientMessageId:n}),a=e=>({id:e.id,...r((0,i.Yg)(e))})},742485:(e,t,n)=>{n.d(t,{OV:()=>o,$G:()=>l});var i=n(259521),r=n(313577),a=n(480354),s=n(167090);function o(e){const[t,n,r]=function(e){const t=3,n=e.split(";");return n&&n.length===t&&n[0]&&!isNaN(Number(n[0]))&&n[1]&&!isNaN(Number(n[1]))&&n[2]&&!(0,a.isNil)(Number(n[2]))?n:i.S0.split(";")}(e),s=Number(n)||0;return{originalArrivalTime:Number(t)||0,timeStamp:s,clientMessageId:r}}const d=(e,t)=>(0,r.r0)(t.type,t.id)?e.chat:(0,r.Mn)(t.type)?e.channel:void 0;function l(e,t){const n=o(e.properties&&e.properties[i.H0.ConsumptionHorizon]||i.S0);if(t){const i=d(t,e)||-1;if(p(e,n.originalArrivalTime,i)||u(e,n.originalArrivalTime,i))return n;n.originalArrivalTime=Math.max(n.originalArrivalTime,i)}return n}const c=e=>{e=e?.toString();return 0!==new Date(e&&"0"!==e?e:s.EJ).valueOf()},p=(e,t,n)=>(0,r.r0)(e.type,e.id)&&e.threadProperties?.lastjoinat>n&&!c(t),u=(e,t,n)=>{const a=parseInt(e.threadProperties?.[i.iy.CreatedAt]||"0",10);return(0,r.Mn)(e.type)&&a>n&&!c(t)}},215982:(e,t,n)=>{n.d(t,{cc:()=>c,Yg:()=>l});var i=n(480354),r=n(110669),a=n(804437);class s{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:r.hT,timestamp:void 0}}static get instance(){return s._instance||(s._instance=new s),s._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:t}){this._enabled=e,t.infoToTelemetry?.("Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:r.hT}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:t}){this.isEnabled?(this._currentAppConsumptionHorizon=(0,i.clone)(e),t.infoToTelemetry?.(`AppConsumptionHorizon updated to '${(0,a.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)):t.warnToTelemetry?.(`Tried updating appConsumptionHorizon while singleton was disabled '${(0,a.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var o=n(742485);function d(){return s.instance.isEnabled}const l=e=>(0,o.$G)(e,d()?s.instance.currentAppConsumptionHorizon:void 0),c=e=>{let t="";return e&&(t=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),t}},48520:(e,t,n)=>{n.d(t,{zJ:()=>i,Iq:()=>r,io:()=>a});const i=(e,t,n)=>`${e}:${t}:${n}`,r=(e,t)=>`${e}:${t}`,a=(e,t)=>`${e}:${t}`},388771:(e,t,n)=>{n.d(t,{F6:()=>s,Q2:()=>d,a9:()=>l,Uf:()=>c,l7:()=>p,dG:()=>u,sZ:()=>m,XU:()=>h,qh:()=>g});var i=n(480354),r=n(315560),a=n(259521);function s(e,t){try{const n=o(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,i.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const i=e.split(".");for(let e=0;e<i.length;e++)t+=(e>0?"[.]":"")+i[e].replace(/\*/g,"[^/^.]+");const r=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(n.match(r))return!0}}catch{return!1}return!1}const o=e=>new URL(e).href,d=e=>e?.replace(/;messageid=.*/,""),l=(e,t,n,i,a)=>{let s="";if(!e.id||p(e.id)&&!a)return s;switch(e.type){case r.ck.extensions:try{s=JSON.parse(e.id).threadId||n}catch(t){s=e.id||n||""}break;case r.ck.chats:case r.ck.chatthread:case r.ck.callingchats:s=e.id.replace("replyChainId","messageid");break;case r.ck.communities:case r.ck.channels:t=t??i;case r.ck.channelthread:let a;try{a=JSON.parse(e.id).channelId}catch{a=e.id}s=t?`${a};messageid=${t}`:a;break;case r.ck.shareformdialog:break;case r.ck.meetingcollaboration:s=e.id;break;case r.ck.agents:s=n??e.id;break;default:s=e.id}return s},c=e=>e&&e.replace(new RegExp(`^${a.gN.BotPrefix}`),""),p=e=>"newchat"===e||e?.includes("preview"),u=(e,t=a.Go.Call)=>t===a.Go.Call&&/<partlist/.test(e)&&!g(e,t),m=(e,t)=>!!h(e,t)&&g(e),h=(e,t)=>t===a.Go.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>'),g=(e,t=a.Go.Call)=>t===a.Go.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},461167:(e,t,n)=>{n.d(t,{R1:()=>i,CK:()=>r,fe:()=>a,ff:()=>s,z4:()=>o,xp:()=>d,pN:()=>l,vg:()=>c,IO:()=>p,$3:()=>u,tV:()=>m,BK:()=>h,jL:()=>g,ae:()=>f,zu:()=>I,nW:()=>A,rA:()=>E,lk:()=>C,cP:()=>y,lP:()=>T,PX:()=>S,kG:()=>v,Y2:()=>D,ro:()=>_,LA:()=>P,R6:()=>b,jH:()=>N,GU:()=>M,AY:()=>R,FV:()=>F});const i={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",fetchPreviewInfo:"/_api/v2.0/shares/{shareID}/driveItem/preview",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1=",getFileWebDavUrl:"/_api/v2.1/drives/{driveId}/items/{itemId}?$select=webDavUrl",getFileDetails:"/_api/v2.1/drives/{driveId}/items/{itemId}?$select=id,name,webDavUrl"}},r={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},a={personal:"personal",teams:"teams"},s={bim:"bim",mw:"mw",ns:"ns",rwc:"rwc"},o="3a867b4a-7429-0e1a-b02e-bf4b240ff1ce",d=["splistform"],l=["splistform"],c={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${a.personal}/[^/]*/`,sharePointFile:`.*/(${a.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/,spPageRegex:/(?:.*\/SitePages\/|.*\/:u:\/t.*)/,spFormsUrlRegex:/(.*\/:l:\/.*?nav=.*|.*\/listforms.aspx.*)/,spListUrlRegex:/(?:.*\/:l:\/|.*\/Lists\/.*)/,spListItemUrlRegex:/(?:.*\/Lists\/.*?ID=.*|.*\/:li:\/.*)/,spListItemPersonalUrlRegex:`/.*/${a.personal}/.*/Lists/.*/`},p={personal:"personal",sharePoint:"share-point"},u={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},m={type:"oneNote",extension:"one",extensionWithDot:".one"},h={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},g={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},f={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",invalidRequest:"invalidRequest",fileAccessDenied:"FileAccessDenied",accessDenied:"accessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked",authChallengeRequired:"authChallengeRequired",InteractionRequired:"InteractionRequired"};var I,A,E,C,y;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI",e.videUploadAsAttachment="VIDEO_UPLOAD_AS_ATTACHMENT",e.imageFileSizeExceeds="IMAGE_FILE_SIZE_EXCEEDS",e.imageDimensionExceeds="IMAGE_DIMENSION_EXCEEDS"}(I||(I={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(A||(A={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(E||(E={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedGuestAndAnonymousCSL="files_messages_sharelink_federated_guest_anonymous_csl",e.ShareLinkFederatedAndAnonymousCSL="files_messages_sharelink_federated_anonymous_csl",e.ShareLinkGuestAndAnonymousCSL="files_messages_sharelink_guest_anonymous_csl",e.ShareLinkAnonymousCSL="files_messages_sharelink_anonymous_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel",e.ShareLinkCSLGeneric="files_messages_sharelink_csl_generic",e.ShareLinkCSLXTenantSharedChannelGeneric="files_messages_sharelink_csl_xtenant_sharedchannel_generic",e.ShareLinkFederatedAndGuestCSLGeneric="files_messages_sharelink_federated_and_guest_csl_generic",e.ShareLinkFederatedCSLGeneric="files_messages_sharelink_federated_csl_generic",e.ShareLinkPSLWithoutFullAccessGeneric="files_messages_sharelink_psl_without_full_access_generic",e.ShareLinkPSLWithoutFullAndFutureAccessGeneric="files_messages_sharelink_psl_without_full_and_future_access_generic",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannelGeneric="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel_generic",e.ShareLinkPSLWithoutFutureAccessGeneric="files_messages_sharelink_psl_without_future_access_generic",e.ShareLinkPSLWithoutIndividualAccessGeneric="files_messages_sharelink_psl_without_individual_access_generic",e.ShareLinkAutoPSL="files_messages_sharelink_auto_psl",e.ShareLinkCSLGenericUpdated="files_messages_sharelink_csl_generic_updated"}(C||(C={})),function(e){e.StringFile="string_file",e.StringList="string_list",e.StringItem="string_item",e.StringForm="string_form",e.StringPlaylist="string_playlist"}(y||(y={}));const T=100,S=10485760,v=12e4,D=3e5,_=600;var P;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(P||(P={}));const b="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var N;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains",e.ObjectUrlMissing="ObjectUrlMissing"}(N||(N={}));const M="https://my.microsoftpersonalcontent.com",R="/v2/.default",F={file:y.StringFile,splist:y.StringList,splistitem:y.StringItem,splistplaylist:y.StringPlaylist,splistform:y.StringForm}},300545:(e,t,n)=>{n.d(t,{LA:()=>d,Fx:()=>u,vu:()=>m});var i=n(480354),r=n(847887),a=n(182635),s=n(912435),o=n(183111);const d=(e,t,n)=>{if(!t||!t.cards||"string"!=typeof t.cards&&!n)return null;try{let e=String(t.cards);n&&(e=n);return JSON.parse(e).map((({appIcon:e,appId:t,appName:n,cardClientId:i,content:r,contentType:a,locale:s,userSpecificContent:o})=>({appIcon:e,appId:t||"",appName:n,cardClientId:i,content:r?JSON.stringify(r):"",contentType:a,locale:s,...!!o&&{userSpecificContent:o}})))}catch(t){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}};var l;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(l||(l={}));const c=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const n=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(t.code);return{code:n,type:(e=>{switch(e){case l.Sharepoint:return"Sharepoint";case l.WOPI:return"WOPI";case l.Google:return"Google";case l.OneDrive:return"OneDrive";case l.Recent:return"Recent";case l.Aggregate:return"Aggregate";case l.FileSystem:return"FileSystem";case l.Search:return"Search";case l.AllFiles:return"AllFiles";case l.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}})(parseInt(t.type,10))}}catch(e){return void t.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},p=(e,t)=>{{const n=2,d=["http","https"],{filePreview:l,chicletBreadcrumbs:p,fileInfo:u,anchorFileId:m,progressComplete:h,isUploadError:g,fileChicletState:f,providerData:I}=e,{shareUrl:A,shareId:E,itemId:C}=u,y=(e=>{if(!e)return{};const t=e=>void 0!==e&&(0,i.isNumber)(e)&&isFinite(e)?Math.min(Math.max(e,0),2147483647):void 0,{previewUrl:n,previewHeight:r,previewWidth:a}=e;return{previewUrl:n,previewHeight:t(r),previewWidth:t(a)}})(l),T=f?.serviceName,{id:S,baseUrl:v,objectUrl:D,type:_,title:P,state:b}=((e,t)=>{const{version:n}=e;let{id:i,baseUrl:r,objectUrl:a,type:d,title:l,state:c}=e;if(n!==t&&(({itemid:i,fileName:l,fileType:d,fileInfo:{fileUrl:a,siteUrl:r}}=e),c=e.fileChicletState?.state),"string"!=typeof i)throw(0,s.$5)("ChatHelpers",o.O4.Undefined,"toFiles",{id:i,version:n,type:d},"File id is missing");return{id:i,baseUrl:r,objectUrl:a,type:d,title:l,state:c}})(e,n),N="active"!==b&&"hidden"!==b,M=c(I,t),R=(0,r.K)()("aggregatefiles","customspo","downloads","p2p","personal","recent","teams","teamsSdk","skype"),F=(0,r.K)()("active","deleted","reference","hidden");return{id:S,itemId:C,chicletBreadcrumbs:p,baseUrl:(0,a.Jf)(v,d),objectUrl:(0,a.Jf)(D,d),shareId:E,shareUrl:A,type:_,title:P,fileId:S,isReferencedFile:N,anchorFileId:m,progressComplete:h&&parseInt(h,10)||null,serviceName:T&&R.find((e=>e===T)),state:b&&F.find((e=>e===b)),hasUploadFailed:g,providerDataV2:M,...y}}},u=(e,t)=>{if(!t||!t.files||"string"!=typeof t.files)return null;try{let n=JSON.parse(t.files);n=n.filter((e=>"deeplink"!==e.type));return(0,i.map)(n,(t=>p(t,e)))}catch(e){return null}},m=(e,t)=>e.filter((({tenantId:e,isFederated:n})=>n||t&&e&&e!==t))},264642:(e,t,n)=>{function i(e=1){const t=new Uint32Array(e),i=n.g;if(i.msCrypto)i.msCrypto.getRandomValues(t);else if(i.crypto)i.crypto.getRandomValues(t);else{let n=e;for(;n--;){const e=4294967296;t[n]=Math.floor(Math.random()*e)}}return Array.from(t)}function r(e){return 0===(t=1/e,Math.floor(Math.random()*t));var t}n.d(t,{yT:()=>i,Dz:()=>r})},605145:(e,t,n)=>{n.d(t,{zB:()=>l,p_:()=>f});var i=n(364591),r=n(597204),a=n(336714),s=n(621634),o=n(809121),d=n(480354);const l=(e,t,n,i)=>{const a=r.af.getRequestCount(e),{accountEnabled:s,mri:o,objectId:d,displayName:l,givenName:h,surname:f,type:I,consumerProfileType:A,jobTitle:E,userPrincipalName:C,email:y,tenantId:T,sipProxyAddress:S,mobile:v,telephoneNumber:D,tenantName:_,decoratedDisplayName:P,cid:b,description:N,externalCalendarEmailAddress:M,homeMri:R,homeTenantId:F,mtoLabel:O,profileType:w,avatarETag:U,avatarUrl:L,searchableByProfile:k,riskScore:G,isBlockedBySystem:x,mutualFriendCount:B}=e,$={accountEnabled:s,id:(0,r.F6)(e),objectId:d,mri:o,displayName:l,givenName:h,surname:f,type:I,consumerProfileType:A,jobTitle:E,userPrincipalName:C,email:y,tenantId:n||T||null,sipProxyAddress:S,mobile:v,telephoneNumber:D,requestCount:a,preferredUserName:t,tenantName:_||null,decoratedDisplayName:P||null,cid:b,description:N,externalCalendarEmailAddress:M,emailForQuery:i,homeMri:R,homeTenantId:F,mtoLabel:O,profileType:w,avatarETag:U,avatarUrl:L,searchableByProfile:k,riskScore:G,isBlockedBySystem:x,mutualFriendCount:B};return function(e,t){const n=e.department;n&&(t.department=n)}(e,$),m(e,$),u(e,$),c(e,$),p(e,$),g($),$},c=(e,t)=>{if(function(e){const t=e;return void 0!==t.isFederated||void 0!==t.isAnonymousB2bUser||"federated"===t.type?.toLowerCase()}(e)){const{isFederated:n,fetchErrorCode:i,isAnonymousB2bUser:s}=e;t.isFederated=n||"federated"===e.type?.toLowerCase(),t.fetchErrorCode=i,t.isAnonymousB2bUser=s,e.trustReason===a.Ed.SharedChannelXTAPEnabled?t.trustworthy=r.af.getFamiliarTrustworthy("SHARED_CHANNEL"):e.trustReason===a.Ed.HighTrustFederation&&(t.trustworthy=r.af.getFamiliarTrustworthy("FEDERATED"))}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},p=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,d.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,d.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(t.avatarUrl=e.avatarUrl),t.isShortProfile=e.isShortProfile},u=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===i.Pk.botType:(0,o.Iz)(e.mri)}(e)||function(e){return"aduser"===e.type?.toLowerCase()||"aduser"===e.$$subType?.toLowerCase()}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},m=(e,t)=>{const n=e.phones;n&&(t.phones=n.map((e=>h(e))))},h=e=>({number:e.number,type:e.type}),g=e=>{const{mri:t}=e;if((0,s.Ku)(t)&&!e.displayName){const n=(0,s.IK)(t);e.displayName=n,e.givenName=n}else if(t&&(0,o.gZ)(t)&&!e.displayName){const n=(0,o.eu)(t);e.displayName=n,e.givenName=n}else e.displayName||(e.displayName="Unknown User");return e},f=e=>!!e&&!("string"!=typeof e||!r.af.isTFLSmsVerifiedMri(e))},321971:(e,t,n)=>{n.d(t,{y:()=>a});var i=n(650656),r=n(549112);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appDefinition($appId:ID!,$scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinition(appId:$appId,scope:$scope,conversationId:$conversationId,options:$options) {...appDefinition}}");return delete this.definitions,this.definitions=[...e.definitions,...r.h.definitions]}}},380446:(e,t,n)=>{n.d(t,{T:()=>a});var i=n(650656),r=n(549112);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appDefinitions($scope:AppInstallScope,$conversationId:String,$options:AppsFilterOptionsInput) {appDefinitions(scope:$scope,conversationId:$conversationId,options:$options) {...appDefinition}}");return delete this.definitions,this.definitions=[...e.definitions,...r.h.definitions]}}},431687:(e,t,n)=>{n.d(t,{qn:()=>i,e6:()=>s,bf:()=>o,xK:()=>d,ag:()=>l,Q4:()=>c,c5:()=>p,$R:()=>u,yq:()=>m,dU:()=>h,pJ:()=>g,oD:()=>f,Wl:()=>I,GD:()=>E,v8:()=>C,ZQ:()=>y,kp:()=>T,Cn:()=>S,WX:()=>v,td:()=>D,LY:()=>_,zh:()=>N,TW:()=>R});var i,r=n(814314),a=n(480354);!function(e){e.Bot="Bot",e.Connector="Connector",e.Messaging="Messaging",e.StaticTabs="StaticTabs",e.GalleryTab="GalleryTab"}(i||(i={}));const s=e=>!!e&&P(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),o=e=>b(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),d=e=>"InstalledApp"===e?.__typename&&!(0,a.isUndefined)(e?.definition),l=e=>!!e&&P(e,["InstalledAndPermanent"]),c=e=>!!e&&P(e,["Featured"]),p=e=>!!e&&P(e,["PreConsented"]),u=e=>b(e,["PreConsented"]),m=e=>P(e,["RequireConsent"]),h=e=>b(e,["RequireConsent"]),g=e=>P(e,["NotInstalled"]),f=e=>e&&(I(e.definition,i.Bot,"Personal")||I(e.definition,i.StaticTabs,"Personal"))||!1,I=(e,t,n)=>{if(!e)return!1;switch(t){case i.Bot:return e.bots&&(0,a.first)(e.bots)&&(0,a.includes)(e.bots[0].scopes,n)||!1;case i.StaticTabs:return e.staticTabs&&(0,a.first)(e.staticTabs)&&(0,a.includes)(e.staticTabs[0].scopes,n)||!1;default:return!1}},A=(e,t)=>e.installedScope&&e.installedScope.includes(t),E=e=>s(e)&&A(e,"Personal"),C=(e,t=!1)=>{const n=c(e)||s(e)&&(A(e,"GroupChat")||A(e,"Team"));return t?n||p(e):n},y=e=>!g(e)&&"Team"===e.installedScope&&"Enabled"===e.statusInfo?.status,T=e=>!g(e)&&"Team"===e.installedScope&&"Disabled"===e.statusInfo?.status,S=e=>s(e)&&(A(e,"GroupChat")||A(e,"Team")),v=e=>{const t=e.data&&e.data.installApp;return!!t&&"InstalledApp"===t.__typename},D=e=>{const t=e.data&&e.data.installCustomApp;return!!t&&"InstalledApp"===t.__typename},_=e=>{const t=e.data&&e.data.upgradeApp;return!!t&&"InstalledApp"===t.__typename},P=(e,t)=>(0,a.includes)(t,e.installationState),b=(e,t)=>(0,a.includes)(t,e),N=e=>{let t="",n="";if(e&&e.length>0){const i=e.indexOf(r.fc.statusKey),a=e.indexOf(r.fc.errorCodeKey);t=i>-1?`Http status code: ${M(e.substr(i),r.fc.statusKey)}`:`Http status code: ${r.bF}`,n=a>-1?`Error code: ${M(e.substr(a),r.fc.errorCodeKey)}`:`Error code: ${r.kb.NoSpecificErrorMessageFound} Error String: ${e}`}return`${t}. ${n}`},M=(e,t)=>{const n=e.length>0?e.split(","):[];if(n.length>0){const e=n[0].replace(/[\\"'{}\s]/g,"").split(":");if(e.length>1&&(t===r.fc.statusKey&&e[1]in r.kG||t===r.fc.errorCodeKey&&e[1]in r.kb))return e[1]}return t===r.fc.statusKey?r.bF:r.kb.NoSpecificErrorMessageFound},R=()=>`${`Http status code: ${r.bF}`}. ${`Error code: ${r.kb.NoSpecificErrorMessageFound}`}`},814314:(e,t,n)=>{var i,r;n.d(t,{kb:()=>i,kG:()=>r,bF:()=>a,fc:()=>s,gY:()=>o}),function(e){e.NoSpecificErrorMessageFound="NoSpecificErrorMessageFound",e.Unknown="Unknown",e.Unauthorized="Unauthorized",e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.NotFound="NotFound",e.AppScopeIsNotAllowed="AppScopeIsNotAllowed",e.AppIsNotInstalledInTheChat="AppIsNotInstalledInTheChat",e.AppIsNotInstalledInTheTeam="AppIsNotInstalledInTheTeam",e.AppIsNotActivelyInstalled="AppIsNotActivelyInstalled",e.AppIsBlockedByAppPermissionPolicy="AppIsBlockedByAppPermissionPolicy",e.UnknownFailureToParseTeamsAppManifest="UnknownFailureToParseTeamsAppManifest",e.UnableToParseTeamsAppManifest="UnableToParseTeamsAppManifest",e.AppSideloadingForbidden="AppSideloadingForbidden",e.CreateGroupChatAppDefinitionFailed="CreateGroupChatAppDefinitionFailed",e.AppDefinitionAlreadyExists="AppDefinitionAlreadyExists",e.AppDefinitionDoesntExist="AppDefinitionDoesntExist",e.UpdateGroupChatAppDefinitionFailed="UpdateGroupChatAppDefinitionFailed",e.GetAppDefinitionFailed="GetAppDefinitionFailed",e.GetGlobalAppDefinitionsFailed="GetGlobalAppDefinitionsFailed",e.AppDefinitionUpdateNotPermitted="AppDefinitionUpdateNotPermitted",e.AppEntitlementAlreadyExists="AppEntitlementAlreadyExists",e.CreateGroupChatAppEntitlementFailed="CreateGroupChatAppEntitlementFailed",e.CreateTeamAppEntitlementFailed="CreateTeamAppEntitlementFailed",e.GroupChatEntitlementDoesntExist="GroupChatEntitlementDoesntExist",e.TeamAppEntitlementsDontExist="TeamAppEntitlementsDontExist",e.UserAppEntitlementsDontExist="UserAppEntitlementsDontExist",e.TenantAppEntitlementsDontExist="TenantAppEntitlementsDontExist",e.UpgradeTeamAppEntitlementFailed="UpgradeTeamAppEntitlementFailed",e.UpgradeUserAppEntitlementFailed="UpgradeUserAppEntitlementFailed",e.UpgradeGroupChatAppEntitlementFailed="UpgradeGroupChatAppEntitlementFailed",e.GetUserEntitlementsFailed="GetUserEntitlementsFailed",e.GetDefaultUserAppEntitlementsFailed="GetDefaultUserAppEntitlementsFailed",e.SetUserAppEntitlementFailed="SetUserAppEntitlementFailed",e.PermanentAppEntitlementUpdateNotAllowed="PermanentAppEntitlementUpdateNotAllowed",e.GetUserAggregatedAppsFailed="GetUserAggregatedAppsFailed",e.TemplatedAppNotAllowedByTenantSettings="TemplatedAppNotAllowedByTenantSettings",e.TemplatedAppNotAllowedByUserPermissionPolicy="TemplatedAppNotAllowedByUserPermissionPolicy",e.TemplatedInstanceAppNotAllowed="TemplatedInstanceAppNotAllowed",e.GetTeamThreadFailed="GetTeamThreadFailed",e.GetTeamThreadsFailed="GetTeamThreadsFailed",e.GetChatThreadFailed="GetChatThreadFailed",e.GetTenantSettingsFailed="GetTenantSettingsFailed",e.NoPermissionToInstallApp="NoPermissionToInstallApp",e.NoPermissionToUpgradeApp="NoPermissionToUpgradeApp",e.NoPermissionToUploadCustomApp="NoPermissionToUploadCustomApp",e.FailedToCheckPermissionToManageApp="FailedToCheckPermissionToManageApp",e.AppIsTenantAdminBlocked="AppIsTenantAdminBlocked",e.AppUploadNotAllowedByTenant="AppUploadNotAllowedByTenant",e.AppUpdateNotAllowedByTenant="AppUpdateNotAllowedByTenant",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.UserAlreadyExists="UserAlreadyExists",e.Conflict="Conflict",e.AddAppBotToChatRosterFailed="AddAppBotToChatRosterFailed",e.AddAppBotToTeamRosterFailed="AddAppBotToTeamRosterFailed",e.AddBotToRosterFailedMaxLimitReached="AddBotToRosterFailedMaxLimitReached",e.UserNotFoundInSkypeTeam="UserNotFoundInSkypeTeam",e.BotIdFormatIsIncorrect="BotIdFormatIsIncorrect",e.GuestNotAllowedToInstallApps="GuestNotAllowedToInstallApps",e.GuestNotAllowedToUpdateApps="GuestNotAllowedToUpdateApps",e.GuestNotAllowedToUpgradeApps="GuestNotAllowedToUpgradeApps",e.OperationNotAllowedOnInstalledAndDeprecatedApp="OperationNotAllowedOnInstalledAndDeprecatedApp",e.AnonymousUsersInteractionNotSupported="AnonymousUsersInteractionNotSupported",e.GetUserAppSetupPoliciesAsync="GetUserAppSetupPoliciesAsync",e.InvalidHostedAppOperationForbidden="InvalidHostedAppOperationForbidden",e.OperationNotAllowedOnArchivedTeam="OperationNotAllowedOnArchivedTeam",e.ClientNetworkOffline="ClientNetworkOffline"}(i||(i={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED"}(r||(r={}));const a="NoHttpStatusCode",s={statusKey:"status",errorCodeKey:"errorCode"};var o;!function(e){e[e.BotInputMenu=1]="BotInputMenu",e[e.BotMentions=2]="BotMentions",e[e.MessageExtension=3]="MessageExtension",e[e.MessageAction=4]="MessageAction",e[e.LinkUnfurling=5]="LinkUnfurling",e[e.Webhooks=6]="Webhooks",e[e.BotCards=7]="BotCards",e[e.ChatPane=8]="ChatPane",e[e.MeetingAppNotifications=9]="MeetingAppNotifications",e[e.AppDetails=10]="AppDetails",e[e.TcPickerNavigation=11]="TcPickerNavigation",e[e.Scenes=12]="Scenes",e[e.CallEscalation=13]="CallEscalation",e[e.VivaFeedback=14]="VivaFeedback",e[e.InContextStore=15]="InContextStore",e[e.MeetingAppsFlyout=16]="MeetingAppsFlyout",e[e.AppsFlyout=17]="AppsFlyout",e[e.FreDialog=18]="FreDialog",e[e.Compose=19]="Compose",e[e.Connectors=20]="Connectors",e[e.PreviewCardFooter=21]="PreviewCardFooter",e[e.ACV2CardJITInstall=22]="ACV2CardJITInstall",e[e.MessageExtensionCardFooter=23]="MessageExtensionCardFooter",e[e.TaskModule=24]="TaskModule",e[e.MessageExtensionFlyoutCommand=25]="MessageExtensionFlyoutCommand",e[e.MessageExtensionFlyoutCommandPostInstall=26]="MessageExtensionFlyoutCommandPostInstall",e[e.GetFetchCommandApps=27]="GetFetchCommandApps",e[e.PinnedMessageExtensions=28]="PinnedMessageExtensions",e[e.ChatRoster=29]="ChatRoster",e[e.NewChat=30]="NewChat"}(o||(o={}))},189189:(e,t,n)=>{n.d(t,{N6:()=>ne,vx:()=>ee,Z1:()=>Z,NM:()=>z,at:()=>U,pW:()=>L,xR:()=>F,a:()=>O,KC:()=>w,S:()=>H,oD:()=>B,vc:()=>R,tN:()=>J,i4:()=>x,Y3:()=>j,M9:()=>G,HI:()=>Q,Pe:()=>P,JU:()=>te,L4:()=>ie,gF:()=>W,c2:()=>N});var i=n(480354),r=n(620833),a=n(396588),s=n(912435),o=n(183111),d=n(431687),l=n(380446),c=n(321971),p=n(650656);const u={kind:"Document",get definitions(){const e=(0,p.G)("query appImpressions($impressionProperty:String!) {appImpressions(impressionProperty:$impressionProperty) {appId,count}}");return delete this.definitions,this.definitions=e.definitions}},m={kind:"Document",get definitions(){const e=(0,p.G)("fragment ComponentsAppsPlatformQueriesPinAppFragment on M365ApplicationPinStatusUpdateResult {... on M365ApplicationPinStatusUpdateResult {__typename,updatedM365Applications {__typename,id,platformType,pinnedIndex}}}");return delete this.definitions,this.definitions=e.definitions}},h={kind:"Document",get definitions(){const e=(0,p.G)("mutation ComponentsAppsPlatformQueriesPinAppMutation($input:PinM365ApplicationInput!) {pinM365Application(input:$input) {...ComponentsAppsPlatformQueriesPinAppFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...m.definitions]}},g={kind:"Document",get definitions(){const e=(0,p.G)("mutation ComponentsAppsPlatformQueriesPinAppToAppBarMetaOsMutation($titleId:String!) {pinAppToAppBarForMetaOS(titleId:$titleId)}");return delete this.definitions,this.definitions=e.definitions}};var f=n(479054);const I={kind:"Document",get definitions(){const e=(0,p.G)("mutation installApp($installScope:AppInstallScope!,$appId:ID!,$conversationId:String,$installParameters:AppInstallParametersInput) {installApp(installScope:$installScope,appId:$appId,conversationId:$conversationId,installParameters:$installParameters) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...f.B.definitions]}},A={kind:"Document",get definitions(){const e=(0,p.G)("mutation upgradeApp($installScope:AppInstallScope!,$appId:ID!,$conversationId:String) {upgradeApp(installScope:$installScope,appId:$appId,conversationId:$conversationId) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...f.B.definitions]}},E={kind:"Document",get definitions(){const e=(0,p.G)("mutation deleteApp($installedScope:AppInstallScope!,$appId:ID!,$conversationId:String,$deleteParameters:AppDeleteParametersInput) {deleteApp(installedScope:$installedScope,appId:$appId,conversationId:$conversationId,deleteParameters:$deleteParameters)}");return delete this.definitions,this.definitions=e.definitions}};var C=n(411509),y=n(284300),T=n(477014),S=n(814314),v=n(91552),D=n(520722),_=n(966984);const P=(e,t,n,i,r,a,s,o,l,c,p,u,m,h,g)=>{const f={installScope:r,appId:i,conversationId:o,installParameters:{appSource:m,isCopilotPlugin:c,hasAppEnableConsent:u}},A=t.newScenario(n);return A.appendEventData({"Thread.Id":o,"App.Id":i,isStreamingThread:h,isTownHall:g}),l&&A.appendEventData(l),ne(A,o),e.mutate({mutation:I,variables:f,update:b(e,f,a,s),context:{callerInfo:p}}).then((e=>{if(!(0,d.WX)(e)||!e.data?.installApp?.definition)throw new Error("unexpected response, install app failed");return A.stop(),e.data.installApp})).catch((e=>{const t=e&&e.message?(0,d.zh)(e.message):(0,d.TW)();throw t.includes(S.kb.ClientNetworkOffline)?A.cancel({errors:t}):A.fail({errors:t}),e}))},b=(e,{installScope:t,conversationId:n},i,r)=>(a,s)=>{try{const a=(0,d.WX)(s)&&s.data;a&&a.installApp?((0,C.Cg)({client:e,installedScope:t,conversationId:n,logger:i,enableAppsQueryOptimization:r},a.installApp),n||e.cache.modify({fields:{installedAppsForMesssageAction:(e,{DELETE:t})=>t}})):i.error("mutation update, install app failed")}catch(e){i.error("Failed to add app to client cache")}},N=(e,t,n,i,r,a,s,o,l)=>{const c={installScope:r,appId:i,conversationId:o},p=t.newScenario(n);return e.mutate({mutation:A,variables:c,update:M(e,c,a,s)}).then((e=>{if(!(0,d.LY)(e)||!e.data?.upgradeApp?.definition)throw new Error("unexpected response, upgrade app failed");return l?p.stop(l):p.stop(),e.data.upgradeApp})).catch((e=>{const t=e&&e.message?(0,d.zh)(e.message):(0,d.TW)();throw l?p.fail({...l,errors:t}):p.fail({errors:t}),e}))},M=(e,{installScope:t,conversationId:n},i,r)=>(a,s)=>{try{const a=(0,d.LY)(s)&&s.data;a&&a.upgradeApp?(0,C.Cg)({client:e,installedScope:t,conversationId:n,logger:i,enableAppsQueryOptimization:r},a.upgradeApp):i.error("mutation update, upgrade app failed")}catch(e){i.error("Failed to add app to client cache")}},R=async(e,t,n,i)=>{const r=["Personal"],s=i?.conversation,o={installedScopes:s?[...r,s.scope]:r,conversationId:s&&s.id,options:{capabilityFilter:i?.capabilityFilter}},d=t.newScenario(a.Cu.ExtInstalledApps);try{const t=await(0,v.hX)(e,o,"no-cache");d.mark(a.BQ.ExtAppsFetched);const i=t?.filter((e=>e&&e.definition&&e.id===n));return d.mark(a.BQ.ExtAppsProcessed),d.stop(),i}catch(e){return d.fail({errors:`failed to get installed app id: ${n}`}),[]}},F=async(e,t,n,i,r,a)=>{let d;n&&(d=i||"GroupChat");const{data:l,error:p}=await e.query({query:c.y,variables:{appId:t,scope:d,conversationId:n,options:{allowBlockedApps:a}},context:{callerInfo:`${r}-getAppDefinition`}});if(!l||!l.appDefinition||p){const e="Get AppDefinition failed";throw(0,s.$5)("AppsHelper",o.O4.NotPresent,"getAppDefinition",void 0,p?.message??e)}return l.appDefinition},O=async(e,t,n,i,r)=>{const{data:a,error:s}=await e.query({query:l.T,variables:t,context:{callerInfo:n}});if(!a||!a.appDefinitions){const e="Get AppDefinitions failed";if(r){r(`Fail to get App definitions, error message: ${s?.message}`)}throw new Error(e)}return i&&i(),a.appDefinitions},w=async(e,t,n,i)=>{const r=await O(e,{options:{capabilityFilter:["Messaging"]},conversationId:n,scope:i},"getAppDefinitionsByContext");return U(r,t)},U=(e,t)=>e.filter((e=>k(e,t))),L=(e,t,n,r,a,s)=>{if((0,i.isEmpty)(e))return e;if((0,i.isEmpty)(t))return[];let o=e.filter((e=>!!e&&!!e.name?.toLocaleLowerCase().includes(t?.toLocaleLowerCase())));if(n&&r&&(o=o.filter((e=>!!e&&!(0,i.includes)(e.blockedConfigurations,_.H.Federation))),a)){const e=s.map((e=>e.id));o=o.filter((t=>!!t&&(0,i.includes)(e,t.id)))}return o},k=(e,t)=>{if(!t)return!0;const n=e.messageExtensions??[];if(!(0,i.isEmpty)(n))for(const e of n)if((0,i.some)(e.commands,(e=>(0,T.kS)(e,t))))return!0;return!1},G=async e=>{const{client:t,logger:n,scenarioFactory:i,enableInstalledAppsV2:r,enableAppsQueryOptimization:a,entryPoint:s,isOneOnOneBotChat:o,scope:d,convId:l,botId:c}=e;let p={};l&&(p={conversation:o?void 0:{scope:d||"GroupChat",id:l},capabilityFilter:["Bot"],shouldFetchPersonalApps:o,botId:c,entryPoint:s});const u=r?await Q(t,n,i,a,p,void 0):await $(t,n,i,p);if(r&&c){const e=u?.filter((e=>e.definition?.bots?.[0]?.id===c));return e}return u},x=async(e,t,n,i,r,a,s,o)=>i?await Q(e,t,n,r,a,s,void 0,void 0,o):await $(e,t,n,a,s),B=async(e,t,n,i)=>{const r=n.newScenario(a.Cu.ExtGetSimpleAppModel);try{const t=await(0,v.Az)(e,i??"cache-only");return r.stop(),t}catch(e){const n="getAppInstalledByCurrentUser failed";return r.fail({errors:n}),t.warn(`${n} ${e}`),[]}},$=async(e,t,n,i,r)=>{const s=n.newScenario(a.Cu.ExtInstalledApps);try{const t=[];i?.shouldFetchPersonalApps&&t.push("Personal"),i?.conversation&&t.push(i.conversation.scope);const n=await(0,v.hX)(e,{installedScopes:t,conversationId:i?.conversation?.id,options:{capabilityFilter:i?.capabilityFilter,botId:i?.botId}},i?.fetchPolicy);s.mark(a.BQ.ExtAppsFetched);const o=W(n,r);return s.mark(a.BQ.ExtAppsProcessed),s.stop(),o}catch(e){const n=`getInstalledApps failed: ${i?.botId??""}`;return s.fail({errors:n}),t.warn(`${n} ${e}`),[]}},H=async(e,t,n,i,r)=>{const d={query:u,fetchPolicy:r??"network-only",variables:{impressionProperty:i}},l=n.newScenario(a.Cu.ExtGetAppImpression),c="Get AppImpressions failed";try{const{data:t}=await e.query(d);if(!t||!t.appImpressions)throw(0,s.$5)("AppsHelper",o.O4.NotPresent,"getAppImpressions",void 0,c);return l.stop(),t.appImpressions}catch(e){return l.fail({errors:c}),t.warnToTelemetry?.(`${c} ${e}`,"platform_appsframework_appscore_apps_helper"),[]}},W=(e,t,n)=>(0,r.compose)(i.compact,(0,r.map)((e=>V(e,t))),(0,r.filter)((e=>(0,d.xK)(e)&&X(e,n))))(e),V=(e,t)=>{if(!t)return e;let n=!1,r=[];if(e.definition.messageExtensions&&(r=e.definition.messageExtensions.map((e=>{let r=e;const a=e.commands??[];return(0,i.isEmpty)(e.commands)||(r={...e,commands:a.filter((e=>!!(0,T.kS)(e,t)&&(n=!0,!0)))}),r}))),!n)return null;const a=r.length?{...e.definition,messageExtensions:r}:e.definition;return{...e,definition:a}},q=(e,{appId:t,installedScope:n,conversationId:i},r,a)=>(s,{data:o})=>{try{o&&o.deleteApp?(0,C.G7)({client:e,installedScope:n,conversationId:i,logger:r,enableAppsQueryOptimization:a},t):r.error("mutation update, delete app failed")}catch(e){r.error("Failed to remove app from client cache")}},z=async(e,t,n,i,r,a,s,o)=>{const d=t.newScenario(n);d.appendEventData({"Thread.Id":r.conversationId??void 0,"App.Id":r.appId,templatedAppId:r?.deleteParameters?.templatedAppId??void 0,origin:s,context:o}),ne(d,r.conversationId);try{const t=await e.mutate({mutation:E,variables:r,update:q(e,r,i,a)});if(!t?.data?.deleteApp)throw new Error("unexpected response, delete app failed");return d.stop(),t}catch(e){throw d.fail({errors:`failed to delete app ${r.appId}`}),e}},J=async(e,t,n,i,r,s,o)=>{const d=o||{},l=n.newScenario(a.Cu.ExtInstalledAppsV2);try{const n=[];if(o?.enableInstalledAppQueryOptimization){if(l.appendEventData({dataSource:"installedApp query",correlationId:s}),d.shouldFetchPersonalApps){const t=e.query({query:D.p,variables:{installedScope:"Personal",appId:i},context:{callerInfo:`${s}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));n.push(t)}if(d.conversation&&d.conversation.id){const t=e.query({query:D.p,variables:{installedScope:d.conversation.scope,appId:i,conversationId:d.conversation.id},context:{callerInfo:`${s}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));n.push(t)}const t=(await Promise.all(n)).filter((e=>!!e));return l.mark(a.BQ.ExtAppsProcessed),l.stop({appCount:t.length}),t}{l.appendEventData({dataSource:"installedAppsV2 query",correlationId:s});const n=(await K(e,l,t,r,`${s}-getInstalledAppsByIdV2`,d)).filter((e=>e&&e.definition&&e.id===i));return l.mark(a.BQ.ExtAppsProcessed),l.stop(),n}}catch(e){return l.fail({errors:`failed to get installed app id: ${i}`}),[]}},Q=async(e,t,n,i,r,s,o,d,l)=>{const c=n.newScenario(a.Cu.ExtInstalledAppsV2),p={"Thread.Id":r?.conversation?.id};r?.entryPoint&&(p["App.EntryPoint"]=S.gY[r.entryPoint]);try{const n=await K(e,c,t,i,r?.entryPoint?S.gY[r.entryPoint]:"getInstalledAppsV2",r,l),d=W(n,s,r);return c.mark(a.BQ.ExtAppsProcessed),c.stop(p),o&&o(),d}catch(e){const n=`getInstalledAppsV2 failed convId: ${r?.conversation?.id??""} botId: ${r?.botId??""}`;return c.fail({...p,errors:n}),d&&d(n),t.warn(`${n}`),[]}},j=async(e,t,n,i,r)=>{const a=n.newScenario(i);try{const n=await(0,v.gZ)(e,t,"network-only"),i=W(n);return a.stop(),i}catch{const e=`failed to get hosted installed apps for ${t}`;return a.fail({errors:e}),r.error(e),[]}},K=async(e,t,n,i,r,s,o)=>{let d;const{fetchPolicyForScope:l,fetchOptions:c}=await(0,y.HW)(e,n,s);let p=null,u=null;if(s?.shouldFetchPersonalApps){d={scope:"Personal",conversationId:s?.conversation?.id};p=(o?v.L5:v.kJ)(e,{installedContext:d,options:{includeUnconsentedApps:s.includeUnconsentedApps}},r,(0,y.or)(l.Personal)).then((e=>(t.mark(a.BQ.ExtAppsFetchedPersonalScope),n.log(`installedApps: ${e.length} scope: ${d.scope}`),e)))}s?.conversation&&s?.conversation.id&&(u=Y(e,t,n,i,s.conversation,l,r,o,s.capabilityFilter,s.includeUnconsentedApps));const m=[p||Promise.resolve([]),u||Promise.resolve([])],[h,g]=await Promise.all(m);return(0,y.J7)(e,n,c),h.concat(g)},Y=(e,t,n,i,r,s,o,d,l,c)=>{let p;const u=r.scope,m="Team"===r.scope,h={scope:u,conversationId:r.id},g=(0,y.or)(s[u]);return i&&!m?(p=(0,v.Am)(e,{conversationId:r.id,options:{includeUnconsentedApps:c}},g),t.mark(a.BQ.ExtAppsQueryInstalledAppsWithPreCheck)):(p=d?(0,v.L5)(e,{installedContext:h,options:{capabilityFilter:l}},o,g):(0,v.Tw)(e,{installedContext:h,options:{capabilityFilter:l,includeUnconsentedApps:c}},o,g),t.mark(a.BQ.ExtAppsQueryInstalledAppsV2)),p=p.then((e=>{n.log(`installedApps: ${e.length} scope: ${h.scope} conversationId: ${h.conversationId} enableInstalledAppsMsgActionsQueryOptimization: ${d}`);const i="Team"===u?a.BQ.ExtAppsFetchedTeamScope:a.BQ.ExtAppsFetchedGroupScope;return t.mark(i),e})),p},X=(e,t)=>{if((0,i.isEmpty)(t?.capabilityFilter))return!0;const n=e.definition;return(0,i.some)(t?.capabilityFilter,(e=>{switch(e){case"Messaging":return!(0,i.isEmpty)(n.messageExtensions);case"Tab":return!(0,i.isEmpty)(n.galleryTabs)||t?.enableStaticTabsPhase1&&!(0,i.isEmpty)(n.staticTabs);case"Bot":return!(0,i.isEmpty)(n.bots);case"Connector":return!(0,i.isEmpty)(n.connectors);case"CUSTOMBOT":return!(0,i.isEmpty)(n.customBots)}}))},Z=(e,t,n)=>{let r=ee(e,t.bots)||ee(e,t.connectors)||ee(e,t.galleryTabs)||ee(e,t.staticTabs);if("Team"===e)return r;const a=ee(e,t.messageExtensions);if(r||(r=n?a&&((e,t)=>{let n=!1;return e.messageExtensions&&e.messageExtensions.map((e=>{let r=e;const a=e.commands??[];return(0,i.isEmpty)(e.commands)||(r={...e,commands:a.filter((e=>!!(0,T.kS)(e,t)&&(n=!0,!0)))}),r})),n})(t,"Compose"):a),"Personal"!==e)return r;const s=(t.meetingExtensionDefinition?.scenes?.length??0)>0,o=(t.meetingExtensionDefinition?.filters?.length??0)>0;return r||s||o},ee=(e,t)=>(0,i.some)(t,(t=>(0,i.includes)(t.scopes,e))),te=e=>!!e&&(e.toLowerCase().includes("replychainid")||e.toLowerCase().includes("messageid")),ne=(e,t)=>{te(t)&&e.appendEventData({"Thread.Type":"Channel"})},ie=async(e,t,n,i,r,a,s,o)=>{const d=t.newScenario(n);if(d.appendEventData({"App.Id":i,correlationId:a}),o&&d.appendEventData(o),s)try{await e.mutate({mutation:g,variables:{titleId:"P_4dde49eb-738b-c12a-b9b5-e3814603a51a"},fetchPolicy:"no-cache",context:{callerInfo:a}}),r.log("Pin Copilot chat app to MetaOS app bar succeeds")}catch(e){r.error("Pin Copilot chat app to MetaOS app bar fails")}return e.mutate({mutation:h,variables:{input:{applicationID:i}},fetchPolicy:"no-cache",context:{callerInfo:a}}).then((e=>{if(!e.data?.pinM365Application?.updatedM365Applications?.[0])throw new Error("unexpected response, pin app failed");const{id:t}=e.data.pinM365Application.updatedM365Applications[0]||{};return d.stop(),Promise.resolve(t)})).catch((e=>{throw d.fail({errors:`failed to pin app ${i}`}),e}))}},698501:(e,t,n)=>{n.d(t,{N:()=>r});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("query appsInstalledByCurrentUser {appsInstalledByCurrentUser}");return delete this.definitions,this.definitions=e.definitions}}},723002:(e,t,n)=>{n.d(t,{n:()=>a});var i=n(650656),r=n(386143);const a={kind:"Document",get definitions(){const e=(0,i.G)("query appsUsage {appsUsage {...appsUsageFields}}");return delete this.definitions,this.definitions=[...e.definitions,...r.j.definitions]}}},284300:(e,t,n)=>{n.d(t,{HW:()=>o,or:()=>p,J7:()=>l,zy:()=>c});var i=n(650656);const r={kind:"Document",get definitions(){const e=(0,i.G)("query platformAppsBatchFetchPolicy($options:[PlatformAppsFetchPolicyOptions!]!) {platformAppsBatchFetchPolicy(options:$options) @client(always:true) {id,scope,convId,forceNetworkFetch}}");return delete this.definitions,this.definitions=e.definitions}},a={kind:"Document",get definitions(){const e=(0,i.G)("mutation DataClientPlatformUpdateAllAppsFetchPoliciesMutation($fetchSource:PlatformAppsFetchSource!) {updateAllPlatformAppsFetchPolicies(fetchSource:$fetchSource) @client}");return delete this.definitions,this.definitions=e.definitions}};var s=n(535565);const o=async(e,t,n)=>{const i={};let r=[];try{n?.shouldFetchPersonalApps&&(r=[{scope:"Personal"}]),n?.conversation&&n?.conversation.id&&(r=[...r,{scope:n.conversation.scope,convId:n.conversation.id}]);const i=await d(e,r);return t.log("getFetchPolicy for installedApps",i),{fetchPolicyForScope:i,fetchOptions:r}}catch(e){return t.error("getFetchPolicy for installedApps failed"),{fetchPolicyForScope:i,fetchOptions:r}}},d=async(e,t)=>{const{data:n}=await e.query({query:r,variables:{options:t}}),i={},a=n?.platformAppsBatchFetchPolicy?.reduce(((e,t)=>({...e,[t.scope]:t.forceNetworkFetch})),i);return a??i},l=(e,t,n,i)=>{const r=i??"Cache",a=n.map((e=>({...e,fetchSource:r})));return e.mutate({mutation:s.J,variables:{input:a}}).catch((e=>(t.error("failed to set fetch policy to ",r),Promise.resolve(void 0))))},c=(e,t,n)=>{e.mutate({mutation:a,variables:{fetchSource:n}}).catch((e=>{t.error("failed to update all fetch policies to ",n)}))},p=e=>e?"network-only":"cache-first"},520722:(e,t,n)=>{n.d(t,{p:()=>a});var i=n(650656),r=n(479054);const a={kind:"Document",get definitions(){const e=(0,i.G)("query installedApp($installedScope:AppInstallScope!,$appId:ID!,$conversationId:String) {installedApp(installedScope:$installedScope,appId:$appId,conversationId:$conversationId) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...r.B.definitions]}}},478734:(e,t,n)=>{n.d(t,{s:()=>a});var i=n(650656),r=n(479054);const a={kind:"Document",get definitions(){const e=(0,i.G)("query installedAppsV2($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsV2(installedContext:$installedContext,options:$options) {...installedAppFields,statusInfo {status}}}");return delete this.definitions,this.definitions=[...e.definitions,...r.B.definitions]}}},91552:(e,t,n)=>{n.d(t,{Az:()=>C,g_:()=>E,Am:()=>f,hX:()=>T,gZ:()=>y,kJ:()=>A,Tw:()=>I,L5:()=>S});var i=n(478734),r=n(650656),a=n(479054);const s={kind:"Document",get definitions(){const e=(0,r.G)("query installedAppsForContainerApp($containerAppId:String!) {installedAppsForContainerApp(containerAppId:$containerAppId) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}},o={kind:"Document",get definitions(){const e=(0,r.G)("query installedChatAppsWithPreCheck($conversationId:String!,$options:InstalledAppsOptions) {installedChatAppsWithPreCheck(conversationId:$conversationId,options:$options) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}},d={kind:"Document",get definitions(){const e=(0,r.G)("query installedApps($installedScopes:[AppInstallScope!]!,$conversationId:String,$options:AppsFilterOptionsInput) {installedApps(installedScopes:$installedScopes,conversationId:$conversationId,options:$options) {...installedAppFields}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}};var l=n(723002),c=n(698501),p=n(458782);const u={kind:"Document",get definitions(){const e=(0,r.G)("fragment DataFragmentsCommonAppDefinitionMsgActionFragment on AppDefinition {id,name,largeImageUrl,validDomains,accentColor,isFullScreenApp,isFullTrustApp,tenantId,externalId,isMicrosoftOwned,webApplicationInfo {id,appKey,resource},messageExtensions {type,botId,canUpdateConfiguration,fetchCommands,scopes,commands {id,title,context,description,initialRun,type,parameters {name,title,description,isRequired,inputType,choices {title,value}},appKey,fetchTask,taskInfo {title,height {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},width {... on DimensionInFloat {customValue:value},... on DimensionInString {predefinedValue:value}},url}},authorization {authType,microsoftEntraConfiguration {supportsSingleSignOn}}}}");return delete this.definitions,this.definitions=e.definitions}},m={kind:"Document",get definitions(){const e=(0,r.G)("fragment DataFragmentsCommonInstalledAppMsgActionFragment on InstalledApp {id,installedScope,installationState,messageExtensionStates {...messageExtensionState},definition {...DataFragmentsCommonAppDefinitionMsgActionFragment},statusInfo {status}}");return delete this.definitions,this.definitions=[...e.definitions,...p.O.definitions,...u.definitions]}},h={kind:"Document",get definitions(){const e=(0,r.G)("query ComponentsAppsPlatformQueriesInstalledAppsV2MessageActionsQuery($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsForMesssageAction(installedContext:$installedContext,options:$options) {...DataFragmentsCommonInstalledAppMsgActionFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...m.definitions]}},g={kind:"Document",get definitions(){const e=(0,r.G)("query ComponentsAppsPlatformQueriesInstalledAppsForMessageActionQuery($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsForMesssageAction(installedContext:$installedContext,options:$options) {...installedAppFields,statusInfo {status}}}");return delete this.definitions,this.definitions=[...e.definitions,...a.B.definitions]}},f=async(e,t,n)=>{const{data:i}=await e.query({query:o,variables:t,fetchPolicy:n});return i&&i.installedChatAppsWithPreCheck?i.installedChatAppsWithPreCheck:[]},I=async(e,t,n,r)=>{const{data:a}=await e.query({query:i.s,variables:t,fetchPolicy:r,context:{callerInfo:n}});return a&&a.installedAppsV2?a.installedAppsV2:[]},A=async(e,t,n,i)=>{const{data:r}=await e.query({query:g,variables:t,fetchPolicy:i,context:{callerInfo:n}});return r&&r.installedAppsForMesssageAction?r.installedAppsForMesssageAction:[]},E=async(e,t)=>{const{data:n}=await e.query({query:l.n,fetchPolicy:t});return n?.appsUsage?n.appsUsage:{__typename:"AppsUsage",appIds:[],appActions:[],appScenes:[],appsMru:[],appCommands:[]}},C=async(e,t)=>{const n=await e.query({query:c.N,fetchPolicy:t}),{data:i}=n;return i?.appsInstalledByCurrentUser?i.appsInstalledByCurrentUser:[]},y=async(e,t,n)=>{const{data:i}=await e.query({query:s,variables:{containerAppId:t},fetchPolicy:n});return i?.installedAppsForContainerApp?i.installedAppsForContainerApp:[]},T=async(e,t,n)=>{const{data:i}=await e.query({query:d,variables:t,fetchPolicy:n});return i&&i.installedApps?i.installedApps:[]},S=async(e,t,n,i)=>{const{data:r}=await e.query({query:h,variables:t,fetchPolicy:i,context:{callerInfo:n}});return r?.installedAppsForMesssageAction?r.installedAppsForMesssageAction:[]}},411509:(e,t,n)=>{n.d(t,{Cg:()=>g,JU:()=>u,G7:()=>h});var i=n(480354),r=n(650656);const a={kind:"Document",get definitions(){const e=(0,r.G)("query installedAppsIdList($installedContext:AppInstallContext!,$options:InstalledAppsOptions) {installedAppsV2(installedContext:$installedContext,options:$options) {id,conversationId,installedScope,installedVersion}}");return delete this.definitions,this.definitions=e.definitions}};var s=n(284300);const o={kind:"Document",get definitions(){const e=(0,r.G)("query installedChatAppsIdsList($conversationId:String!,$options:InstalledAppsOptions) {installedChatAppsWithPreCheck(conversationId:$conversationId,options:$options) {id,conversationId,installedScope,installedVersion}}");return delete this.definitions,this.definitions=e.definitions}};var d=n(520722);const l=(e,t,n)=>"Personal"===e?{installedScope:e,appId:t}:{installedScope:e,appId:t,conversationId:n},c=(e,t)=>({installedContext:"Personal"===e?{scope:e}:{scope:e,conversationId:t}}),p=e=>({conversationId:e}),u=(e,t,n,i,r)=>{const a=n.newLogger("UpdateAppsCache","components-apps-platform-queries");try{if(!t.installedAppsUpdateEventV2)return;const{installedAppsUpdateEventV2:{installedScope:n,app:s,appId:o,eventType:d,conversationId:l}}=t,c={client:e,installedScope:n,conversationId:l,logger:a,enableAppsQueryOptimization:i};if(r&&"Personal"===n)return void m(n,l,e,a,r);switch(d){case"Added":g(c,s);break;case"Removed":h(c,o);break;case"Synced":m(n,l,e,a,r)}}catch(e){a.error("update apps cache failed")}},m=(e,t,n,i,r)=>{if(t&&("GroupChat"===e||"Team"===e)||!t&&"Personal"===e){if(r&&"Personal"===e)return void(0,s.zy)(n,i,"Network");let a=[];a=[{scope:e,convId:t}],(0,s.J7)(n,i,a,"Network")}},h=(e,t)=>{const{logger:n,client:r,installedScope:a,conversationId:s}=e;if((0,i.isNull)(t)||"Personal"!==a&&!s)return void n.warn("removeAppFromCache - invalid input",t,a,s);const o=l(a,t,s);try{r.writeQuery({query:d.p,variables:o,data:{installedApp:null}})}catch(e){throw n.error("removeAppFromCache - failed to update installedApp query",t,a,s),e}const c=I(e);if((0,i.isNull)(c))return void n.warn("removeAppFromCache - no apps in cache",t);const p=(0,i.filter)(c,(e=>null===e||e.id!==t));p.length!==c.length?(n.log("Removing from apps cache "),A(e,p)):n.warn("app to delete already removed from cache")},g=(e,t)=>{const{logger:n,client:r,installedScope:a,conversationId:s}=e;if((0,i.isNull)(t)||"Personal"!==a&&!s)return void n.warn("addAppToCache - invalid input",t,a,s);const{id:o,installedVersion:c,conversationId:p,__typename:u}=t,m=l(a,o,s);try{r.writeQuery({query:d.p,variables:m,data:{installedApp:t}})}catch(e){throw n.error("addAppToCache - failed to update installedApp query",t,a,s),e}const h=I(e);if((0,i.isNull)(h))return void n.warn("addAppToCache - no apps in cache",t);const g=t.id,f=(0,i.find)(h,(e=>e?.id===g));(0,i.isNil)(f)?(n.log("Adding to apps cache"),A(e,[...h,{id:o,conversationId:p,installedVersion:c,installedScope:a,__typename:u}])):n.warn("app to add already in cache",f)},f=(e,t)=>"GroupChat"===e&&t,I=({client:e,installedScope:t,conversationId:n,logger:i,enableAppsQueryOptimization:r})=>{try{if(f(t,r)){if(n){const t=e.readQuery({query:o,variables:p(n)});return t&&t.installedChatAppsWithPreCheck?t.installedChatAppsWithPreCheck:(i.warn("readQuery for group scope returned no results"),null)}return i.error("invalid convid for cache read"),null}{const r=e.readQuery({query:a,variables:c(t,n)});return r&&r.installedAppsV2?r.installedAppsV2:(i.warn("readQuery returned no results"),null)}}catch(e){throw e}},A=({client:e,installedScope:t,conversationId:n,enableAppsQueryOptimization:i,logger:r},s)=>{try{f(t,i)?n?e.writeQuery({query:o,variables:p(n),data:{installedChatAppsWithPreCheck:s}}):r.error("invalid convid for cache update"):e.writeQuery({query:a,variables:c(t,n),data:{installedAppsV2:s}})}catch(e){throw e}}},168923:(e,t,n)=>{var i;n.d(t,{i:()=>i}),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(i||(i={}))},477014:(e,t,n)=>{n.d(t,{Dr:()=>p,YB:()=>m,e1:()=>h,rh:()=>g,u2:()=>f,Ze:()=>I,dP:()=>A,Bd:()=>E,kS:()=>T,js:()=>v,Nv:()=>D,Jm:()=>b,OH:()=>N,sr:()=>F});var i=n(480354),r=n(620833),a=n(168923),s=n(259521),o=n(394784),d=n(915344);const l="Required",c=["Compose","Commandbox"],p=(e,t,n)=>{if(!t.id)return null;const i=E(t),a=C(t),s=i?u(i):null,[o,d]=(0,r.compose)((0,r.partition)(S),(0,r.map)((t=>_(e,t))),(0,r.filter)((e=>T(e,n))),y)(i);return{appInfo:a,validDomains:t.validDomains||[],type:i?.type,botId:i&&i.botId||"",actionCommands:o,queryCommands:d,authorization:s||void 0,galleryTabs:t.galleryTabs||[]}},u=e=>{if("ApiBased"!==e.type)return null;const{authorization:t}=e;return t&&"microsoftEntra"===t.authType&&t.microsoftEntraConfiguration?{authType:a.i.MicrosoftEntra,microsoftEntraConfiguration:{supportsSingleSignOn:!!t.microsoftEntraConfiguration.supportsSingleSignOn}}:{authType:a.i.None}},m=e=>!(0,i.isEmpty)(e.appInfo.tenantId),h=e=>{const t=(0,r.first)(e.messageExtensions),n=t&&t.botId||"";return`${s.gN.BotPrefix}${n}`},g=e=>e&&(0,i.isEmpty)(e.queryCommands)&&(0,i.isArray)(e.actionCommands)&&e.actionCommands.length>=1,f=e=>e&&(0,i.isEmpty)(e.queryCommands)&&(0,i.isArray)(e.actionCommands)&&1===e.actionCommands.length,I=e=>e&&(0,i.isEmpty)(e.queryCommands)&&(0,i.isArray)(e.actionCommands)&&e.actionCommands.length>1,A=e=>e&&(0,i.isArray)(e.queryCommands)&&e.queryCommands.length>1,E=e=>e&&(0,r.first)(e.messageExtensions),C=e=>({accentColor:e.accentColor||"",appId:e.id,appName:e.name||"",appIcon:e.largeImageUrl||"",isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,tenantId:e.tenantId||"",externalId:e.externalId||"",resource:e.webApplicationInfo?.resource||"",isMicrosoftOwned:e.isMicrosoftOwned||!1}),y=e=>e&&e.commands||[],T=(e,t)=>(0,i.isEmpty)(e.context)?(0,i.includes)(c,t):(0,i.includes)(e.context,t),S=e=>e&&(0,i.isString)(e.type)&&e.type.toLowerCase()==="Action".toLowerCase(),v=e=>{const t=E(e);if(t)return"ApiBased"===t.type?"ApiBased":"BotBased"},D=(e,t)=>(e=>"ApiBased"===e.type)(t)?e?`${s.gN.TeamsAppPrefix}${t.appInfo.appId}`:"":`${s.gN.BotPrefix}${t.botId}`,_=(e,t)=>({id:t.id,type:t.type||"Query",context:t.context,fetchTask:!!t.fetchTask,description:t.description,initialRun:!!t.initialRun,parameters:t.parameters,title:t.title||"",appKey:t.appKey,taskInfo:b(e,t.taskInfo,t.parameters)}),P=(e,t)=>{const n={};return e&&(n.title=e.title||"",n.height=F(e.height),n.width=F(e.width)||t),n},b=(e,t,n)=>{if(t?.url)return{...P(t),url:t.url};const i=M(n);if(i){const n=e.stringTranslate("extensibility","inputExtension_task_module_button_title");return i.addSubmitAction("submitButton",n,{id:"submitButton"}),{...P(t,o.j4.Large),card:i.getCard()}}return t?{...P(t)}:void 0},N=e=>M(e)?.getRawJson()??null,M=e=>{if(!e||(0,i.isEmpty)(e))return null;const t=new d.a;return e.forEach((e=>R(t,e))),t},R=(e,t)=>{if(!t)return;const n=t.title||"",i=t.name||"",r=t.description||"",a=t.value??void 0,s=t.isRequired??!1;switch(t.inputType||"Text"){case"Text":e.addTextInput(i,r,a,200,!1,{label:n,isRequired:s,errorMessage:l});break;case"Textarea":e.addTextInput(i,r,a,1e3,!0,{label:n,isRequired:s,errorMessage:l});break;case"Number":e.addNumberInput(i,r,a,{label:n,isRequired:s,errorMessage:l});break;case"Date":e.addDateInput(i,r,a,{label:n,isRequired:s,errorMessage:l});break;case"Time":e.addTimeInput(i,r,a,{label:n,isRequired:s,errorMessage:l});break;case"Toggle":e.addToggle(i,n,a,{isRequired:s,errorMessage:l});break;case"Choiceset":const o=(t.choices??[]).map((e=>({title:e.title??"",value:e.value??""})));e.addChoiceSet(i,n,!1,!0,o,a,{label:n,isRequired:s,errorMessage:l})}},F=e=>{if(!(0,i.isNil)(e))return O(e)?(0,i.isNil)(e.customValue)?void 0:e.customValue:w(e)?U(e):void 0},O=e=>"DimensionInFloat"===e.__typename,w=e=>"DimensionInString"===e.__typename,U=e=>{if((0,i.isNil)(e.predefinedValue))return;switch(e.predefinedValue.toLowerCase()){case"small":return o.j4.Small;case"medium":return o.j4.Medium;case"large":return o.j4.Large;default:return}}},75190:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(650656),r=n(35105);const a={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsChatQueriesChatQuery($convId:ID!) {chat(convId:$convId) {...ComponentsChatQueriesConversationFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...r.q.definitions]}}},35105:(e,t,n)=>{n.d(t,{q:()=>T});var i=n(650656),r=n(697615),a=n(350556),s=n(538112),o=n(420065),d=n(944366),l=n(208976),c=n(557830),p=n(253793),u=n(989990),m=n(831051),h=n(12183),g=n(371466),f=n(96065),I=n(610238),A=n(753648),E=n(430704),C=n(681677),y=n(593697);const T={kind:"Document",get definitions(){const e=(0,i.G)("fragment ComponentsChatQueriesConversationFragment on Conversation {id,title,shortTitle,themeId,picture,isBotBlocked,isOneOnOne,isOneOnOneBotChat,isDisabled,lobbyThreadId,teamId,disabledReason {code,newlyCreatedUserId},meetingChatPolicy,chatSubType,chatType,isSfB @client,isMeeting @client,isOneOnOne,isMuted,isFederated @client,isChannel,isHidden,isRead,isRetentionHorizonSet,isModerator,replyPermission,isAdmin,isUserAnonymous,substrateGroupId,importMetadata {importState},lastMessage {...lastMessageFields},me {...userFields},consumptionHorizon {...consumptionHorizonFields},consumptionHorizonBookmark {...consumptionHorizonBookmarkFields},userConsumptionHorizon {...consumptionHorizonBookmarkFields},memberIds,membersLimited {...userFields},...DataFragmentsCommonHeaderWithChatDataFragment,memberDisplayNamesLimited,oneOnOneChatHeaderCallButtonValue,hasFederatedUser,hasGuestUser,hasTflConsumerUser,cfet,hasEnterpriseUser,hasUnknownConsumerUser,hasUnknownEnterpriseUser,hasUnresolvedFederatedUser,isImpersonation,hasImpersonation,isDeletedOrDead,hasTflSmsUnverifiedUser,hasTflSmsVerifiedUser,nonTeamsFederatedUserLimitedNames,nonTeamsFederatedUsersLength,isPrivateChatPolicyDefinedScenario,isChatDisabledForRecipients,guardianChatInfo,isInQuarantine,quarantineCounter,tflOffNetworkUser {...userFields},tflOffNetworkUserLength,hasBotMember,isUserMember,botMembers {id},userAdminSettings {adminDeleteEnabled,deleteMessagesEnabled},creator,meetingInformation {id,meetingType,startTime,endTime,meetingData {meetingCode,passcode,meetingUrl},iCalUid,resolvedSensitivityLabelId,isCopyRestrictionEnforced,tenantId,organizerId,meetingJoinUrl,scenario,isCancelled,...DataFragmentsCommonRecordingMessageMiFragment,messagingPolicy {textOnlyChat},templateDetails {id}},tenantId,chatDisabledContext @client {isUIDisabled,disabledReason,extendedData,lastUpdatedTime},interopConversationStatus,extendedDirectoryRedemptionRequired,hasExtendedDirectoryUsers,chatScheduleSuggestionSuppressUntil,chatHistoryHiddenTime,clearHistoryTime,userProperties {...userProperties},pinnedConversationItems {... on Message {...pinnedMessageItemFields}},addedBy,addedByTenantId,identityMaskEnabled,sensitivityLabel {id,isCopyBlocked},createdAt,lastJoinAt,isCommentStream,isCommentStreamMeetingStarted,isConversationThreadDeleted,avatarUrl,meetingChatType,...DataFragmentsCommonUseExternalTagFragment,...DataFragmentsCommonChatMtoTelemetryFragment,...DataFragmentsCommonChatWithMtoUserBannerFragment,...DataFragmentsCommonChatRecapFragment,...DataFragmentsCommonUseMtoUserBannerFragment,...DataFragmentsCommonChatPaneLayoutFragment,...DataFragmentsCommonChatAddMembersFragment,...DataFragmentsCommonChatSmartCardInfoFragment @nonreactive,awarenessLiveState {key,value},groupCopilotInfo {id,allowInstallation,allowInteraction},notes {id,isSynthesisAvailable,showConvergedUx},pendingBots,isConversationalUXEnabled,isChatPartialHistoryShared,isChatFullHistoryAccessible,anyMemberHasPartialHistoryAccess,meetingChatType,showRedDot,activeCall {...DataFragmentsCommonActiveCallFragment},isSkypeModeratedConversation,isSkypeConversation,pinnedMessages(pinnedMessageCallerSource:PINNED_MESSAGE_BANNER,first:1) {id,edges {cursor,node {id,...DataFragmentsCommonChatPinnedMessageFragment}}},isBilateralChat}");return delete this.definitions,this.definitions=[...e.definitions,...r.L.definitions,...a.x.definitions,...s.U.definitions,...o.q.definitions,...d.I.definitions,...l.x.definitions,...c.p.definitions,...p.M.definitions,...u.n.definitions,...m.Y.definitions,...h.I.definitions,...g.W.definitions,...f.P.definitions,...I.F.definitions,...A.h.definitions,...E._.definitions,...C.n.definitions,...y.Y.definitions]}}},82327:(e,t,n)=>{n.d(t,{v6:()=>i,Nr:()=>r,Lx:()=>a,Hy:()=>s,$j:()=>o,te:()=>d,kc:()=>l,Wj:()=>c,I5:()=>p,XJ:()=>h,yj:()=>f,r2:()=>I,R$:()=>A,BK:()=>E,Rp:()=>C,Q$:()=>y,g0:()=>T,Jr:()=>S,Jh:()=>v,wu:()=>D,qf:()=>_,_l:()=>P,MI:()=>b,T9:()=>N});const i="resourceRequiresConsent",r="resourceRequiresMfa",a="InteractionRequired",s="tokenRevoked",o="list-chiclet-icon",d="list-item-chiclet-icon",l="list-form-chiclet-icon",c="list-playlist-chiclet-icon";var p,u,m;!function(e){e.Chat="chat",e.MeetingChat="meetingChat",e.HoloLensChat="holoLensChat",e.EmbedFeedbackChat="embedFeedbackChat",e.SmartReply="smartReply",e.MeetingPPT="meetingPPT",e.Channel="channel",e.ChannelMeeting="channelMeeting",e.ChannelMeetingPPT="channelMeetingPPT",e.ChatFilesTab="chatFilesTab",e.Unknown="unknown"}(p||(p={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(u||(u={})),function(e){e[e.Recent=0]="Recent",e[e.Aggregate=1]="Aggregate",e[e.Personal=2]="Personal",e[e.Teams=3]="Teams",e[e.Channels=4]="Channels",e[e.Downloads=5]="Downloads",e[e.PersonalWopi=6]="PersonalWopi",e[e.PersonalGoogle=7]="PersonalGoogle",e[e.CustomSpo=8]="CustomSpo",e[e.SharedWithMe=9]="SharedWithMe",e[e.Chats=10]="Chats"}(m||(m={}));const h=(new Map).set("Sharepoint",u.Sharepoint).set("WOPI",u.WOPI).set("Google",u.Google).set("OneDrive",u.OneDrive).set("Recent",u.Recent).set("Aggregate",u.Aggregate).set("FileSystem",u.FileSystem).set("Search",u.Search).set("AllFiles",u.AllFiles).set("SharedWithMe",u.SharedWithMe);var g,f,I;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google"}(g||(g={})),function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE"}(f||(f={})),function(e){e.Secure="Secure",e.InvalidFormat="InvalidFormat",e.InvalidProtocol="InvalidProtocol",e.InvalidExternalProviderDomain="InvalidExternalProviderDomain",e.DomainMismatchForDifferentUrl="DomainMismatchForDifferentUrl",e.InvalidInternalDomain="InvalidInternalDomain",e.ObjectUrlMissing="ObjectUrlMissing"}(I||(I={}));const A=new Map;A.set("DROPBOX",g.WopiIntegration).set("BOX",g.WopiIntegration).set("SHAREFILE",g.WopiIntegration).set("EGNYTE",g.WopiIntegration).set("GOOGLEDRIVE",g.Google);const E=new Map;E.set(u.Sharepoint,"Sharepoint").set(u.WOPI,"WOPI").set(u.Google,"Google").set(u.OneDrive,"OneDrive").set(u.Recent,"Recent").set(u.Aggregate,"Aggregate").set(u.FileSystem,"FileSystem").set(u.Search,"Search").set(u.AllFiles,"AllFiles").set(u.SharedWithMe,"SharedWithMe");const C=new Map;C.set("DROPBOX",f.Dropbox).set("BOX",f.Box).set("SHAREFILE",f.Sharefile).set("GOOGLEDRIVE",f.GoogleDrive).set("EGNYTE",f.Egnyte);const y=new Map;y.set("Recent",m.Recent).set("Aggregate",m.Aggregate).set("Personal",m.Personal).set("Teams",m.Teams).set("Channels",m.Channels).set("Downloads",m.Downloads).set("PersonalWopi",m.PersonalWopi).set("PersonalGoogle",m.PersonalGoogle).set("CustomSpo",m.CustomSpo).set("SharedWithMe",m.SharedWithMe).set("Chats",m.Chats);const T=e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}},S=e=>{switch(e){case u.Sharepoint:return"Sharepoint";case u.WOPI:return"WOPI";case u.Google:return"Google";case u.OneDrive:return"OneDrive";case u.Recent:return"Recent";case u.Aggregate:return"Aggregate";case u.FileSystem:return"FileSystem";case u.Search:return"Search";case u.AllFiles:return"AllFiles";case u.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}},v="https://teams.microsoft.com/scripts/items-view-strings.js",D=/[\u202A-\u202E\u2066-\u2069]/g,_="",P=/[\u0590-\u05FF\u0600-\u06FF\u0700-\u074F\u0750-\u077F\u0780-\u07BF\u07C0-\u07FF\uFB1D-\uFB4F\uFB50-\uFDFF\uFE70-\uFEFF]/,b="GetValidFileDomains";var N;!function(e){e.Visible="Visible",e.Closed="Closed",e.Hidden="Hidden"}(N||(N={}))},436852:(e,t,n)=>{n.d(t,{u:()=>d,C:()=>l});var i=n(957032),r=n(480354),a=n(513432),s=n(591831);const o=a.createContext(void 0),d=e=>{const{children:t,...n}=e,a={...n,activeWindowService:n.activeWindowsService.getWindowLayoutService(n.windowId),context:{hostCommunicationService:n.hostCommunicationService}};return(0,i.Y)(o.Provider,{value:(0,s.F)(a,r.isEqual),children:t})},l=()=>a.useContext(o)}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/247070-a90cfac3ddccd0b8.js.map